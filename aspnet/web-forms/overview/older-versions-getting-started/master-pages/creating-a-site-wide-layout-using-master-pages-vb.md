---
uid: web-forms/overview/older-versions-getting-started/master-pages/creating-a-site-wide-layout-using-master-pages-vb
title: 建立全站台的版面配置使用主版頁面 (VB) |Microsoft 文件
author: rick-anderson
description: 本教學課程會顯示主版頁面的基本概念。 也就是為何主版頁面的運作方式之一建立主版頁面、 什麼是內容預留位置的運作方式一個 cr...
ms.author: aspnetcontent
manager: wpickett
ms.date: 05/21/2008
ms.topic: article
ms.assetid: 30945276-8ed9-4b27-8e50-4309244d3559
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/creating-a-site-wide-layout-using-master-pages-vb
msc.type: authoredcontent
ms.openlocfilehash: d18993af7159de552db0c622fbef58e814e36ebb
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/06/2018
ms.locfileid: "30890875"
---
<a name="creating-a-site-wide-layout-using-master-pages-vb"></a><span data-ttu-id="5e664-104">建立全站台的版面配置使用主版頁面 (VB)</span><span class="sxs-lookup"><span data-stu-id="5e664-104">Creating a Site-Wide Layout Using Master Pages (VB)</span></span>
====================
<span data-ttu-id="5e664-105">由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="5e664-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="5e664-106">[下載程式碼](http://download.microsoft.com/download/e/e/f/eef369f5-743a-4a52-908f-b6532c4ce0a4/ASPNET_MasterPages_Tutorial_01_VB.zip)或[下載 PDF](http://download.microsoft.com/download/8/f/6/8f6349e4-6554-405a-bcd7-9b094ba5089a/ASPNET_MasterPages_Tutorial_01_VB.pdf)</span><span class="sxs-lookup"><span data-stu-id="5e664-106">[Download Code](http://download.microsoft.com/download/e/e/f/eef369f5-743a-4a52-908f-b6532c4ce0a4/ASPNET_MasterPages_Tutorial_01_VB.zip) or [Download PDF](http://download.microsoft.com/download/8/f/6/8f6349e4-6554-405a-bcd7-9b094ba5089a/ASPNET_MasterPages_Tutorial_01_VB.pdf)</span></span>

> <span data-ttu-id="5e664-107">本教學課程會顯示主版頁面的基本概念。</span><span class="sxs-lookup"><span data-stu-id="5e664-107">This tutorial will show master page basics.</span></span> <span data-ttu-id="5e664-108">也就是為何主版頁面，其中一個要如何建立主版頁面內容的預留位置是什麼，如何一個建立的 ASP.NET 網頁，會使用主版頁面上，如何修改主版頁面自動反映在其相關聯的內容頁面，等等。</span><span class="sxs-lookup"><span data-stu-id="5e664-108">Namely, what are master pages, how does one create a master page, what are content place holders, how does one create an ASP.NET page that uses a master page, how modifying the master page is automatically reflected in its associated content pages, and so on.</span></span>


## <a name="introduction"></a><span data-ttu-id="5e664-109">簡介</span><span class="sxs-lookup"><span data-stu-id="5e664-109">Introduction</span></span>

<span data-ttu-id="5e664-110">設計良好的一個屬性是網站的一致的全站台的頁面配置。</span><span class="sxs-lookup"><span data-stu-id="5e664-110">One attribute of a well-designed website is a consistent site-wide page layout.</span></span> <span data-ttu-id="5e664-111">Www.asp.net 網站後，為例。</span><span class="sxs-lookup"><span data-stu-id="5e664-111">Take the www.asp.net website, for example.</span></span> <span data-ttu-id="5e664-112">在撰寫本文時，每一頁會具有相同的內容，在頂端和頁面底部。</span><span class="sxs-lookup"><span data-stu-id="5e664-112">At the time of this writing, every page has the same content at the top and bottom of the page.</span></span> <span data-ttu-id="5e664-113">如圖 1 所示，每一頁的開頭處會顯示一份 Microsoft 社群的灰色列。</span><span class="sxs-lookup"><span data-stu-id="5e664-113">As Figure 1 shows, the very top of each page displays a gray bar with a list of Microsoft Communities.</span></span> <span data-ttu-id="5e664-114">下方也就是網站標誌、 所在站台已轉譯，語言和核心區段的清單： 首頁、 開始、 深入了解、 下載及其他等等。</span><span class="sxs-lookup"><span data-stu-id="5e664-114">Beneath that is the site logo, the list of languages into which the site has been translated, and the core sections: Home, Get Started, Learn, Downloads, and so forth.</span></span> <span data-ttu-id="5e664-115">同樣地，頁面底部包含 www.asp.net、 著作權的陳述式，以及隱私權聲明連結廣告的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="5e664-115">Likewise, the bottom of the page includes information about advertising on www.asp.net, a copyright statement, and a link to the privacy statement.</span></span>


<span data-ttu-id="5e664-116">[![Www.asp.net 網站所有頁面採用一致的外觀及操作](creating-a-site-wide-layout-using-master-pages-vb/_static/image2.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="5e664-116">[![The www.asp.net Website Employs a Consistent Look and Feel Across All Pages](creating-a-site-wide-layout-using-master-pages-vb/_static/image2.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image1.png)</span></span>

<span data-ttu-id="5e664-117"><strong>圖 01</strong>: www.asp.net 網站採用一致的外觀和感覺跨所有頁面 ([按一下以檢視完整大小的影像](creating-a-site-wide-layout-using-master-pages-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="5e664-117"><strong>Figure 01</strong>: The www.asp.net Website Employs a Consistent Look and Feel Across All Pages  ([Click to view full-size image](creating-a-site-wide-layout-using-master-pages-vb/_static/image3.png))</span></span>


<span data-ttu-id="5e664-118">設計良好的站台的另一個屬性是的簡易可以變更站台的外觀。</span><span class="sxs-lookup"><span data-stu-id="5e664-118">Another attribute of a well-designed site is the ease with which the site's appearance can be changed.</span></span> <span data-ttu-id="5e664-119">圖 1 顯示在 www.asp.net 首頁上，從 2008 年 3 月開始，但現在與本教學課程中的發行集，之間可能變更外觀與風格。</span><span class="sxs-lookup"><span data-stu-id="5e664-119">Figure 1 shows the www.asp.net homepage as of March 2008, but between now and this tutorial's publication, the look and feel may have changed.</span></span> <span data-ttu-id="5e664-120">可能會展開上方的功能表項目，包括 MVC 架構的新區段。</span><span class="sxs-lookup"><span data-stu-id="5e664-120">Perhaps the menu items along the top will expand to include a new section for the MVC framework.</span></span> <span data-ttu-id="5e664-121">否則可能會市嶄新的設計，含有不同的色彩、 字型和配置。</span><span class="sxs-lookup"><span data-stu-id="5e664-121">Or maybe a radically new design with different colors, fonts, and layout will be unveiled.</span></span> <span data-ttu-id="5e664-122">將這類變更套用至整個站台，應該是網頁的既快速又簡單的程序不需要修改數千個組成該網站。</span><span class="sxs-lookup"><span data-stu-id="5e664-122">Applying such changes to the entire site should be a fast and simple process that does not require modifying the thousands of web pages that make up the site.</span></span>

<span data-ttu-id="5e664-123">在 ASP.NET 中建立全網站頁面範本可透過使用的*主版頁面*。</span><span class="sxs-lookup"><span data-stu-id="5e664-123">Creating a site-wide page template in ASP.NET is possible through the use of *master pages*.</span></span> <span data-ttu-id="5e664-124">簡而言之，主版頁面是一種特殊類型的定義中所有常見的標記的 ASP.NET 網頁*內容頁面*以及自訂內容頁面的內容頁面為基礎的區域。</span><span class="sxs-lookup"><span data-stu-id="5e664-124">In a nutshell, a master page is a special type of ASP.NET page that defines the markup that is common among all *content pages* as well as regions that are customizable on a content page-by-content page basis.</span></span> <span data-ttu-id="5e664-125">（內容的頁面是繫結至主版頁面的 ASP.NET 網頁）。每當變更主版頁面的版面配置或格式化時，所有其內容頁的輸出會同樣的立即更新，這讓使用者套用全站台的外觀會變更，只要更新和部署到單一檔案 （也就是主版頁面）。</span><span class="sxs-lookup"><span data-stu-id="5e664-125">(A content page is an ASP.NET page that is bound to the master page.) Whenever a master page's layout or formatting is changed, all of its content pages' output is likewise immediately updated, which makes applying site-wide appearance changes as easy as updating and deploying a single file (namely, the master page).</span></span>

<span data-ttu-id="5e664-126">這是一系列瀏覽使用主版頁面的教學課程中的第一個教學課程。</span><span class="sxs-lookup"><span data-stu-id="5e664-126">This is the first tutorial in a series of tutorials that explore using master pages.</span></span> <span data-ttu-id="5e664-127">在此教學課程系列的過程中我們：</span><span class="sxs-lookup"><span data-stu-id="5e664-127">Over the course of this tutorial series we:</span></span>

- <span data-ttu-id="5e664-128">檢查建立主版頁面和其相關聯的內容頁面</span><span class="sxs-lookup"><span data-stu-id="5e664-128">Examine creating master pages and their associated content pages,</span></span>
- <span data-ttu-id="5e664-129">討論各種不同的提示、 秘訣和設陷，</span><span class="sxs-lookup"><span data-stu-id="5e664-129">Discuss a variety of tips, tricks, and traps,</span></span>
- <span data-ttu-id="5e664-130">識別常見主版頁面的問題和因應措施，瀏覽</span><span class="sxs-lookup"><span data-stu-id="5e664-130">Identify common master page pitfalls and explore workarounds,</span></span>
- <span data-ttu-id="5e664-131">請參閱 < 如何從內容頁面和 a-相反，存取主版頁面</span><span class="sxs-lookup"><span data-stu-id="5e664-131">See how to access the master page from a content page and vice-a-versa,</span></span>
- <span data-ttu-id="5e664-132">了解如何指定在執行階段的內容頁面的主版頁面和</span><span class="sxs-lookup"><span data-stu-id="5e664-132">Learn how to specify a content page's master page at runtime, and</span></span>
- <span data-ttu-id="5e664-133">其他進階主版頁面的主題。</span><span class="sxs-lookup"><span data-stu-id="5e664-133">Other advanced master page topics.</span></span>

<span data-ttu-id="5e664-134">這些教學課程被專很簡潔，並提供具有足夠的螢幕擷取畫面來引導您完成程序以視覺化方式的逐步指示。</span><span class="sxs-lookup"><span data-stu-id="5e664-134">These tutorials are geared to be concise and provide step-by-step instructions with plenty of screen shots to walk you through the process visually.</span></span> <span data-ttu-id="5e664-135">每一個教學課程使用在 C# 和 Visual Basic 版本，包括使用的完整程式碼的下載。</span><span class="sxs-lookup"><span data-stu-id="5e664-135">Each tutorial is available in C# and Visual Basic versions and includes a download of the complete code used.</span></span>

<span data-ttu-id="5e664-136">本教學課程中我開頭看主版頁面的基本概念。</span><span class="sxs-lookup"><span data-stu-id="5e664-136">This inaugural tutorial starts with a look at master page basics.</span></span> <span data-ttu-id="5e664-137">我們討論主版頁面的運作方式、 查看建立主版頁面和使用 Visual Web Developer 中，相關聯的內容頁面，請參閱如何主版頁面的變更會立即反映在其內容頁。</span><span class="sxs-lookup"><span data-stu-id="5e664-137">We discuss how master pages work, look at creating a master page and associated content pages using Visual Web Developer, and see how changes to a master page are immediately reflected in its content pages.</span></span> <span data-ttu-id="5e664-138">讓我們開始吧 ！</span><span class="sxs-lookup"><span data-stu-id="5e664-138">Let's get started!</span></span>

## <a name="understanding-how-master-pages-work"></a><span data-ttu-id="5e664-139">了解主版頁面的運作方式</span><span class="sxs-lookup"><span data-stu-id="5e664-139">Understanding How Master Pages Work</span></span>

<span data-ttu-id="5e664-140">建立具有一致的全站台的頁面配置的網站需要每個網頁發出除了其自訂內容的一般格式標記。</span><span class="sxs-lookup"><span data-stu-id="5e664-140">Building a website with a consistent site-wide page layout requires that each web page emit common formatting markup in addition to its custom content.</span></span> <span data-ttu-id="5e664-141">例如，雖然 www.asp.net 上的每個教學課程或論壇文章都有自己唯一的內容，每個網頁也呈現一系列的一般`<div>`顯示最上層區段連結的項目： 首頁、 開始、 了解，等等。</span><span class="sxs-lookup"><span data-stu-id="5e664-141">For example, while each tutorial or forum post on www.asp.net have their own unique content, each of these pages also render a series of common `<div>` elements that display the top-level section links: Home, Get Started, Learn, and so on.</span></span>

<span data-ttu-id="5e664-142">有各種不同的技術，用於建立具有一致的外觀及操作的 web 網頁。</span><span class="sxs-lookup"><span data-stu-id="5e664-142">There are a variety of techniques for creating web pages with a consistent look and feel.</span></span> <span data-ttu-id="5e664-143">貝氏方法是只要複製並貼到所有的網頁，一般的版面配置標記，但這種方法有一些缺點。</span><span class="sxs-lookup"><span data-stu-id="5e664-143">A naive approach is to simply copy and paste the common layout markup into all web pages, but this approach has a number of downsides.</span></span> <span data-ttu-id="5e664-144">簡單來說，每次建立新的頁面時，您必須記得複製並貼到頁面的 共用的內容。</span><span class="sxs-lookup"><span data-stu-id="5e664-144">For starters, every time a new page is created, you must remember to copy and paste the shared content into the page.</span></span> <span data-ttu-id="5e664-145">這類複製和貼上作業與敞開錯誤可能不小心將共用標記的子集複製到新頁面。</span><span class="sxs-lookup"><span data-stu-id="5e664-145">Such copying and pasting operations are ripe for error as you may accidentally copy only a subset of the shared markup into a new page.</span></span> <span data-ttu-id="5e664-146">和上方它，這個方法可讓新的實際痛苦因為必須編輯每個站台中的單一頁面，才能使用新的外觀及操作以取代現有的全站台的外觀。</span><span class="sxs-lookup"><span data-stu-id="5e664-146">And to top it off, this approach makes replacing the existing site-wide appearance with a new one a real pain because every single page in the site must be edited in order to use the new look and feel.</span></span>

<span data-ttu-id="5e664-147">在 ASP.NET 2.0 版中前, 頁面上通常用來放置常見標記中的開發人員[使用者控制項](https://msdn.microsoft.com/library/y6wb1a0e.aspx)然後在每個頁面中加入這些使用者控制項。</span><span class="sxs-lookup"><span data-stu-id="5e664-147">Prior to ASP.NET version 2.0, page developers often placed common markup in [User Controls](https://msdn.microsoft.com/library/y6wb1a0e.aspx) and then added these User Controls to each and every page.</span></span> <span data-ttu-id="5e664-148">這種方法需要網頁開發人員手動將使用者控制項加入至每個新的頁面，請記住，但允許的簡單全站台的修改，因為更新的一般標記時使用者控制項所需修改。</span><span class="sxs-lookup"><span data-stu-id="5e664-148">This approach required that the page developer remember to manually add the User Controls to every new page, but allowed for easier site-wide modifications because when updating the common markup only the User Controls needed to be modified.</span></span> <span data-ttu-id="5e664-149">不幸的是，Visual Studio.NET 2002年和 2003-版本的 Visual Studio 用來建立 ASP.NET 1.x 應用程式-以灰色方塊呈現在 [設計] 檢視中的使用者控制項。</span><span class="sxs-lookup"><span data-stu-id="5e664-149">Unfortunately, Visual Studio .NET 2002 and 2003 - the versions of Visual Studio used to create ASP.NET 1.x applications - rendered User Controls in the Design view as gray boxes.</span></span> <span data-ttu-id="5e664-150">因此，使用這種方法的網頁開發人員未不喜歡 WYSIWYG 的設計階段環境。</span><span class="sxs-lookup"><span data-stu-id="5e664-150">Consequently, page developers using this approach did not enjoy a WYSIWYG design-time environment.</span></span>

<span data-ttu-id="5e664-151">使用使用者控制項的缺點已解決在 ASP.NET 2.0 版和 Visual Studio 2005 中導入*主版頁面*。</span><span class="sxs-lookup"><span data-stu-id="5e664-151">The shortcomings of using User Controls were addressed in ASP.NET version 2.0 and Visual Studio 2005 with the introduction of *master pages*.</span></span> <span data-ttu-id="5e664-152">主版頁面是一種特殊的 ASP.NET 頁面，定義全站台的標記和*區域*其中相關聯*內容頁面*定義其自訂的標記。</span><span class="sxs-lookup"><span data-stu-id="5e664-152">A master page is a special type of ASP.NET page that defines both the site-wide markup and the *regions* where associated *content pages* define their custom markup.</span></span> <span data-ttu-id="5e664-153">我們將會看到在步驟 1 中，這些區域是由 ContentPlaceHolder 控制項中定義。</span><span class="sxs-lookup"><span data-stu-id="5e664-153">As we will see in Step 1, these regions are defined by ContentPlaceHolder controls.</span></span> <span data-ttu-id="5e664-154">ContentPlaceHolder 控制項只是表示主版頁面控制項階層架構中，由內容頁面可以插入自訂內容的位置。</span><span class="sxs-lookup"><span data-stu-id="5e664-154">The ContentPlaceHolder control simply denotes a position in the master page's control hierarchy where custom content can be injected by a content page.</span></span>

> [!NOTE]
> <span data-ttu-id="5e664-155">ASP.NET 2.0 版後尚未變更的核心概念和主版頁面的功能。</span><span class="sxs-lookup"><span data-stu-id="5e664-155">The core concepts and functionality of master pages has not changed since ASP.NET version 2.0.</span></span> <span data-ttu-id="5e664-156">不過，Visual Studio 2008 提供設計階段支援巢狀主版頁面，在 Visual Studio 2005 所缺少的功能。</span><span class="sxs-lookup"><span data-stu-id="5e664-156">However, Visual Studio 2008 offers design-time support for nested master pages, a feature that was lacking in Visual Studio 2005.</span></span> <span data-ttu-id="5e664-157">我們將在未來的教學課程中使用巢狀主版頁面。</span><span class="sxs-lookup"><span data-stu-id="5e664-157">We will look at using nested master pages in a future tutorial.</span></span>


<span data-ttu-id="5e664-158">圖 2 顯示 www.asp.net 主版頁面的樣子。</span><span class="sxs-lookup"><span data-stu-id="5e664-158">Figure 2 shows what the master page for www.asp.net might look like.</span></span> <span data-ttu-id="5e664-159">請注意主版頁面定義常用全站台的版面配置的頂端、 底端，和每個頁面的右邊標記-，以及 ContentPlaceHolder 左方，每個個別的網頁的唯一內容所在的位置中。</span><span class="sxs-lookup"><span data-stu-id="5e664-159">Note that the master page defines the common site-wide layout - the markup at the top, bottom, and right of every page - as well as a ContentPlaceHolder in the middle-left, where the unique content for each individual web page is located.</span></span>


![主版頁面定義全站台的配置和可編輯區域為基礎內容頁面的內容頁面](creating-a-site-wide-layout-using-master-pages-vb/_static/image4.png)

<span data-ttu-id="5e664-161">**圖 02**： 主版頁面定義全站台的配置和可編輯區域為基礎內容頁面的內容頁面</span><span class="sxs-lookup"><span data-stu-id="5e664-161">**Figure 02**: A Master Page Defines the Site-Wide Layout and the Regions Editable on a Content Page-by-Content Page Basis</span></span>


<span data-ttu-id="5e664-162">一旦定義主版頁面可以繫結至新的 ASP.NET 網頁，透過的刻度核取方塊。</span><span class="sxs-lookup"><span data-stu-id="5e664-162">Once a master page has been defined it can be bound to new ASP.NET pages through the tick of a checkbox.</span></span> <span data-ttu-id="5e664-163">呼叫內容頁面-這些 ASP.NET 網頁包括每個主版頁面的 ContentPlaceHolder 控制項內容的控制項。</span><span class="sxs-lookup"><span data-stu-id="5e664-163">These ASP.NET pages - called content pages - include a Content control for each of the master page's ContentPlaceHolder controls.</span></span> <span data-ttu-id="5e664-164">當透過瀏覽器瀏覽內容的頁面時 ASP.NET 引擎建立的主版頁面控制項階層架構，並插入到適當的位置內容的頁面控制項階層架構。</span><span class="sxs-lookup"><span data-stu-id="5e664-164">When the content page is visited through a browser the ASP.NET engine creates the master page's control hierarchy and injects the content page's control hierarchy into the appropriate places.</span></span> <span data-ttu-id="5e664-165">轉譯此結合的控制項階層架構，而且產生的 HTML 會傳回給終端使用者的瀏覽器。</span><span class="sxs-lookup"><span data-stu-id="5e664-165">This combined control hierarchy is rendered and the resulting HTML is returned to the end user's browser.</span></span> <span data-ttu-id="5e664-166">因此，[內容] 頁面會發出 ContentPlaceHolder 控制其主版頁面中定義的一般標記和定義於它自己的內容控制項內特定頁面的標記。</span><span class="sxs-lookup"><span data-stu-id="5e664-166">Consequently, the content page emits both the common markup defined in its master page outside of the ContentPlaceHolder controls and the page-specific markup defined within its own Content controls.</span></span> <span data-ttu-id="5e664-167">圖 3 說明這個概念。</span><span class="sxs-lookup"><span data-stu-id="5e664-167">Figure 3 illustrates this concept.</span></span>


<span data-ttu-id="5e664-168">[![要求的網頁標記為 Fused 至主版頁面](creating-a-site-wide-layout-using-master-pages-vb/_static/image6.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="5e664-168">[![The Requested Page's Markup is Fused into the Master Page](creating-a-site-wide-layout-using-master-pages-vb/_static/image6.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image5.png)</span></span>

<span data-ttu-id="5e664-169">**圖 03**: 要求網頁的標記 Fused 至主版頁面 ([按一下以檢視完整大小的影像](creating-a-site-wide-layout-using-master-pages-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="5e664-169">**Figure 03**: The Requested Page's Markup is Fused into the Master Page  ([Click to view full-size image](creating-a-site-wide-layout-using-master-pages-vb/_static/image7.png))</span></span>


<span data-ttu-id="5e664-170">既然我們已經討論過主版頁面工作的方式，讓我們看看建立主版頁面和使用 Visual Web Developer 中相關聯的內容頁面。</span><span class="sxs-lookup"><span data-stu-id="5e664-170">Now that we have discussed how master pages work, let's take a look at creating a master page and associated content pages using Visual Web Developer.</span></span>

> [!NOTE]
> <span data-ttu-id="5e664-171">若要前往的最大的可能對象，我們在此教學課程系列整個建置 ASP.NET 網站來建立 ASP.NET 3.5 與 Microsoft 的免費版本的 Visual Studio 2008， [Visual Web Developer 2008](https://www.microsoft.com/express/vwd/)。</span><span class="sxs-lookup"><span data-stu-id="5e664-171">In order to reach the widest possible audience, the ASP.NET website we build throughout this tutorial series will be created using ASP.NET 3.5 with Microsoft's free version of Visual Studio 2008, [Visual Web Developer 2008](https://www.microsoft.com/express/vwd/).</span></span> <span data-ttu-id="5e664-172">如果您還沒有升級至 ASP.NET 3.5 中，也請別擔心-在這些教學課程工作中所討論的概念也使用 ASP.NET 2.0 和 Visual Studio 2005。</span><span class="sxs-lookup"><span data-stu-id="5e664-172">If you have not yet upgraded to ASP.NET 3.5, don't worry - the concepts discussed in these tutorials work equally well with ASP.NET 2.0 and Visual Studio 2005.</span></span> <span data-ttu-id="5e664-173">但是，某些示範應用程式可以使用以.NET Framework 3.5 版; 新增功能當使用 3.5 特有功能時，包含附註，討論如何在 2.0 版中實作類似的功能。</span><span class="sxs-lookup"><span data-stu-id="5e664-173">However, some demo applications may use features new to the .NET Framework version 3.5; when 3.5-specific features are used, I include a note that discusses how to implement similar functionality in version 2.0.</span></span> <span data-ttu-id="5e664-174">不要記住，示範應用程式可供下載從每個教學課程的目標.NET Framework 3.5 版中，會導致`Web.config`檔案，其中包含 3.5 特有的組態項目。</span><span class="sxs-lookup"><span data-stu-id="5e664-174">Do keep in mind that the demo applications available for download from each tutorial target the .NET Framework version 3.5, which results in a `Web.config` file that includes 3.5-specific configuration elements.</span></span> <span data-ttu-id="5e664-175">未先移除 3.5 特定標記的來源，將無法運作長劇本短時，如果您有尚未然後可下載的 web 應用程式的電腦上安裝.NET 3.5 `Web.config`。</span><span class="sxs-lookup"><span data-stu-id="5e664-175">Long story short, if you have yet to install .NET 3.5 on your computer then the downloadable web application will not work without first removing the 3.5-specific markup from `Web.config`.</span></span> <span data-ttu-id="5e664-176">請參閱[將分解 ASP.NET 3.5 版的`Web.config`檔案](http://www.4guysfromrolla.com/articles/121207-1.aspx)如需有關本主題。</span><span class="sxs-lookup"><span data-stu-id="5e664-176">See [Dissecting ASP.NET Version 3.5's `Web.config` File](http://www.4guysfromrolla.com/articles/121207-1.aspx) for more information on this topic.</span></span>


## <a name="step-1-creating-a-master-page"></a><span data-ttu-id="5e664-177">步驟 1： 建立主版頁面</span><span class="sxs-lookup"><span data-stu-id="5e664-177">Step 1: Creating a Master Page</span></span>

<span data-ttu-id="5e664-178">我們可以建立和使用主要和內容頁面瀏覽之前，我們先需要 ASP.NET 網站。</span><span class="sxs-lookup"><span data-stu-id="5e664-178">Before we can explore creating and using master and content pages, we first need an ASP.NET website.</span></span> <span data-ttu-id="5e664-179">開始建立新檔案系統以 ASP.NET 網站。</span><span class="sxs-lookup"><span data-stu-id="5e664-179">Start by creating a new file system-based ASP.NET website.</span></span> <span data-ttu-id="5e664-180">若要完成此動作，啟動 Visual Web Developer 然後移至 檔案 功能表並選擇新的網站，顯示新的網站 對話方塊 （請參閱圖 4）。</span><span class="sxs-lookup"><span data-stu-id="5e664-180">To accomplish this, launch Visual Web Developer and then go to the File menu and choose New Web Site, displaying the New Web Site dialog box (see Figure 4).</span></span> <span data-ttu-id="5e664-181">選擇 ASP.NET 網站範本、 設定到檔案系統位置下拉式清單中，選擇要將網站的資料夾和設定的語言為 Visual Basic。</span><span class="sxs-lookup"><span data-stu-id="5e664-181">Choose the ASP.NET Web Site template, set the Location drop-down list to File System, choose a folder to place the web site, and set the language to Visual Basic.</span></span> <span data-ttu-id="5e664-182">這會建立新的網站與`Default.aspx`ASP.NET 網頁`App_Data`資料夾，和`Web.config`檔案。</span><span class="sxs-lookup"><span data-stu-id="5e664-182">This will create a new web site with a `Default.aspx` ASP.NET page, an `App_Data` folder, and a `Web.config` file.</span></span>

> [!NOTE]
> <span data-ttu-id="5e664-183">Visual Studio 支援的專案管理的兩種模式： 網站專案和 Web 應用程式專案。</span><span class="sxs-lookup"><span data-stu-id="5e664-183">Visual Studio supports two modes of project management: Web Site Projects and Web Application Projects.</span></span> <span data-ttu-id="5e664-184">網站專案缺少專案檔，而 Web 應用程式專案模仿專案架構在 Visual Studio.NET 2002年/2003年-它們包括專案檔和編譯成單一組件，放在專案的原始程式碼`/bin`資料夾。</span><span class="sxs-lookup"><span data-stu-id="5e664-184">Web Site Projects lack a project file, whereas Web Application Projects mimic the project architecture in Visual Studio .NET 2002/2003 - they include a project file and compile the project's source code into a single assembly, which is placed in the `/bin` folder.</span></span> <span data-ttu-id="5e664-185">Visual Studio 2005 一開始只支援的網站專案，雖然 Web 應用程式專案模型已經重新引入含 Service Pack 1。Visual Studio 2008 提供這兩個專案的模型。</span><span class="sxs-lookup"><span data-stu-id="5e664-185">Visual Studio 2005 initially only supported Web Site Projects, although the Web Application Project model was reintroduced with Service Pack 1; Visual Studio 2008 offers both project models.</span></span> <span data-ttu-id="5e664-186">Visual Web Developer 2005 和 2008年版本，不過，僅支援的網站專案。</span><span class="sxs-lookup"><span data-stu-id="5e664-186">The Visual Web Developer 2005 and 2008 editions, however, only support Web Site Projects.</span></span> <span data-ttu-id="5e664-187">我使用我的示範，本教學課程系列的網站專案模型。</span><span class="sxs-lookup"><span data-stu-id="5e664-187">I use the Web Site Project model for my demos in this tutorial series.</span></span> <span data-ttu-id="5e664-188">如果您正在使用非 Express edition，而且想要使用[Web 應用程式專案模型](https://msdn.microsoft.com/library/aa730880(vs.80).aspx)相反地，您可以任意去以執行這項操作，但請注意螢幕和相對於必須採取的步驟上看到的內容之間可能會有些不一致螢幕擷取畫面所示，在這些教學課程所提供的指示。</span><span class="sxs-lookup"><span data-stu-id="5e664-188">If you are using a non-Express edition and want to use the [Web Application Project model](https://msdn.microsoft.com/library/aa730880(vs.80).aspx) instead, feel free to do so but be aware that there may be some discrepancies between what you see on your screen and the steps you must take versus the screen shots shown and instructions provided in these tutorials.</span></span>


<span data-ttu-id="5e664-189">[![建立新檔案系統為基礎的網站](creating-a-site-wide-layout-using-master-pages-vb/_static/image9.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="5e664-189">[![Create a New File System-Based Web Site](creating-a-site-wide-layout-using-master-pages-vb/_static/image9.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image8.png)</span></span>

<span data-ttu-id="5e664-190">**圖 04**： 建立 New File System-Based 網站 ([按一下以檢視完整大小的影像](creating-a-site-wide-layout-using-master-pages-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="5e664-190">**Figure 04**: Create a New File System-Based Web Site  ([Click to view full-size image](creating-a-site-wide-layout-using-master-pages-vb/_static/image10.png))</span></span>


<span data-ttu-id="5e664-191">接下來，加入主版頁面的根目錄中的站台的專案名稱上按一下滑鼠右鍵，選擇 加入新項目並選取主版頁面的範本。</span><span class="sxs-lookup"><span data-stu-id="5e664-191">Next, add a master page to the site in the root directory by right-clicking on the Project name, choosing Add New Item, and selecting the Master Page template.</span></span> <span data-ttu-id="5e664-192">請注意主版頁面結尾副檔名`.master`。</span><span class="sxs-lookup"><span data-stu-id="5e664-192">Note that master pages end with the extension `.master`.</span></span> <span data-ttu-id="5e664-193">這個新的主版頁面命名為`Site.master`並按一下 [新增]。</span><span class="sxs-lookup"><span data-stu-id="5e664-193">Name this new master page `Site.master` and click Add.</span></span>


<span data-ttu-id="5e664-194">[![加入主版頁面名稱為網站 Site.master](creating-a-site-wide-layout-using-master-pages-vb/_static/image12.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="5e664-194">[![Add a Master Page Named Site.master to the Website](creating-a-site-wide-layout-using-master-pages-vb/_static/image12.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image11.png)</span></span>

<span data-ttu-id="5e664-195">**圖 05**： 加入主版頁面具名`Site.master`網站 ([按一下以檢視完整大小的影像](creating-a-site-wide-layout-using-master-pages-vb/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="5e664-195">**Figure 05**: Add a Master Page Named `Site.master` to the Website  ([Click to view full-size image](creating-a-site-wide-layout-using-master-pages-vb/_static/image13.png))</span></span>


<span data-ttu-id="5e664-196">以下列宣告式標記會加入新的主版頁面檔案透過 Visual Web Developer 中建立主版頁面：</span><span class="sxs-lookup"><span data-stu-id="5e664-196">Adding a new master page file through Visual Web Developer creates a master page with the following declarative markup:</span></span>

[!code-aspx[Main](creating-a-site-wide-layout-using-master-pages-vb/samples/sample1.aspx)]

<span data-ttu-id="5e664-197">宣告式標記中的第一行是[`@Master`指示詞](https://msdn.microsoft.com/library/ms228176.aspx)。</span><span class="sxs-lookup"><span data-stu-id="5e664-197">The first line in the declarative markup is the [`@Master` directive](https://msdn.microsoft.com/library/ms228176.aspx).</span></span> <span data-ttu-id="5e664-198">`@Master`指示詞是類似於[`@Page`指示詞](https://msdn.microsoft.com/library/ydy4x04a.aspx)出現在 ASP.NET 網頁中。</span><span class="sxs-lookup"><span data-stu-id="5e664-198">The `@Master` directive is similar to the [`@Page` directive](https://msdn.microsoft.com/library/ydy4x04a.aspx) that appears in ASP.NET pages.</span></span> <span data-ttu-id="5e664-199">它會定義的伺服器端語言 (VB) 和資訊的位置和主版頁面的程式碼後置類別的繼承。</span><span class="sxs-lookup"><span data-stu-id="5e664-199">It defines the server-side language (VB) and information about the location and inheritance of the master page's code-behind class.</span></span>

<span data-ttu-id="5e664-200">`DOCTYPE`和網頁的宣告式標記下方`@Master`指示詞。</span><span class="sxs-lookup"><span data-stu-id="5e664-200">The `DOCTYPE` and the page's declarative markup appears beneath the `@Master` directive.</span></span> <span data-ttu-id="5e664-201">此頁面包含四個伺服器端控制項以及靜態 HTML:</span><span class="sxs-lookup"><span data-stu-id="5e664-201">The page includes static HTML along with four server-side controls:</span></span>

- <span data-ttu-id="5e664-202">**Web Form ( `<form runat="server">`)** -因為所有 ASP.NET 網頁通常 Web Form-因為主版頁面可能包含必須出現在 Web 表單中的 Web 控制項務必要將 Web Form 加入至您的主版頁面 （而非 Web Form 加入 e除此之外，每個內容頁面）。</span><span class="sxs-lookup"><span data-stu-id="5e664-202">**A Web Form (the `<form runat="server">`)** - because all ASP.NET pages typically have a Web Form - and because the master page may include Web controls that must appear within a Web Form - be sure to add the Web Form to your master page (rather than adding a Web Form to each content page).</span></span>
- <span data-ttu-id="5e664-203">**ContentPlaceHolder 控制項，名為`ContentPlaceHolder1`**  -這個 ContentPlaceHolder 控制項中的 Web 表單隨即出現，並做為內容頁面的使用者介面區域。</span><span class="sxs-lookup"><span data-stu-id="5e664-203">**A ContentPlaceHolder control named `ContentPlaceHolder1`** - this ContentPlaceHolder control appears within the Web Form and serves as the region for the content page's user interface.</span></span>
- <span data-ttu-id="5e664-204">**伺服器端`<head>`元素**-`<head>`項目具有`runat="server"`屬性，因此可透過伺服器端程式碼存取。</span><span class="sxs-lookup"><span data-stu-id="5e664-204">**A server-side `<head>` element** - the `<head>` element has the `runat="server"` attribute, making it accessible through server-side code.</span></span> <span data-ttu-id="5e664-205">`<head>`項目實作這種方式，讓網頁的標題和其他`<head>`-相關的標記可能加入，或以程式設計方式調整。</span><span class="sxs-lookup"><span data-stu-id="5e664-205">The `<head>` element is implemented this way so that the page's title and other `<head>`-related markup may be added or adjusted programmatically.</span></span> <span data-ttu-id="5e664-206">例如，設定 ASP.NET 網頁的`Title`屬性變更`<title>`所呈現項目`<head>`伺服器控制項。</span><span class="sxs-lookup"><span data-stu-id="5e664-206">For example, setting an ASP.NET page's `Title` property changes the `<title>` element rendered by the `<head>` server control.</span></span>
- <span data-ttu-id="5e664-207">**ContentPlaceHolder 控制項，名為`head`**  -這個 ContentPlaceHolder 控制項出現在內`<head>`伺服器控制項，並可用來以宣告方式將內容加入到`<head>`項目。</span><span class="sxs-lookup"><span data-stu-id="5e664-207">**A ContentPlaceHolder control named `head`** - this ContentPlaceHolder control appears within the `<head>` server control and can be used to declaratively add content to the `<head>` element.</span></span>

<span data-ttu-id="5e664-208">此預設主版頁面的宣告式標記做為起點來設計您自己的主版頁面。</span><span class="sxs-lookup"><span data-stu-id="5e664-208">This default master page declarative markup serves as a starting point for designing your own master pages.</span></span> <span data-ttu-id="5e664-209">隨意編輯 HTML 或加入其他 Web 控制項或 ContentPlaceHolders 主版頁面。</span><span class="sxs-lookup"><span data-stu-id="5e664-209">Feel free to edit the HTML or to add additional Web controls or ContentPlaceHolders to the master page.</span></span>

> [!NOTE]
> <span data-ttu-id="5e664-210">當設計主版頁面，確定主版頁面包含 Web Form，而且至少一個 ContentPlaceHolder 控制會出現在此 Web Form。</span><span class="sxs-lookup"><span data-stu-id="5e664-210">When designing a master page make sure that the master page contains a Web Form and that at least one ContentPlaceHolder control appears within this Web Form.</span></span>


### <a name="creating-a-simple-site-layout"></a><span data-ttu-id="5e664-211">建立簡單的站台版面配置</span><span class="sxs-lookup"><span data-stu-id="5e664-211">Creating a Simple Site Layout</span></span>

<span data-ttu-id="5e664-212">讓我們來展開`Site.master`的預設宣告式標記建立其中所有頁面的都共用的網站配置： 常見的標頭; 瀏覽、 新聞和其他全站台的內容，會顯示 「 電源的 Microsoft ASP.NET 」 圖示頁尾與左側資料行。</span><span class="sxs-lookup"><span data-stu-id="5e664-212">Let's expand `Site.master`'s default declarative markup to create a site layout where all pages share: a common header; a left column with navigation, news and other site-wide content; and a footer that displays the "Powered by Microsoft ASP.NET" icon.</span></span> <span data-ttu-id="5e664-213">圖 6 顯示主版頁面的最終結果，其內容頁的其中一個透過瀏覽器檢視時。</span><span class="sxs-lookup"><span data-stu-id="5e664-213">Figure 6 shows the end result of the master page when one of its content pages is viewed through a browser.</span></span> <span data-ttu-id="5e664-214">圖 6 中的紅色圈選的區域旨在說明所造訪的頁面 (`Default.aspx`); 其他內容是在主版頁面中定義且因此一致跨所有內容頁面。</span><span class="sxs-lookup"><span data-stu-id="5e664-214">The red circled region in Figure 6 is specific to the page being visited (`Default.aspx`); the other content is defined in the master page and therefore consistent across all content pages.</span></span>


<span data-ttu-id="5e664-215">[![主版頁面的頂端、 左邊和下方部分定義標記](creating-a-site-wide-layout-using-master-pages-vb/_static/image15.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="5e664-215">[![The Master Page Defines the Markup for the Top, Left, and Bottom Portions](creating-a-site-wide-layout-using-master-pages-vb/_static/image15.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image14.png)</span></span>

<span data-ttu-id="5e664-216">**圖 06**： 主版頁面的頂端、 左邊和下方部分定義標記 ([按一下以檢視完整大小的影像](creating-a-site-wide-layout-using-master-pages-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="5e664-216">**Figure 06**: The Master Page Defines the Markup for the Top, Left, and Bottom Portions  ([Click to view full-size image](creating-a-site-wide-layout-using-master-pages-vb/_static/image16.png))</span></span>


<span data-ttu-id="5e664-217">若要達到圖 6 中所顯示的網站配置，一開始更新`Site.master`主版頁面，使其包含下列的宣告式標記：</span><span class="sxs-lookup"><span data-stu-id="5e664-217">To achieve the site layout shown in Figure 6, start by updating the `Site.master` master page so that it contains the following declarative markup:</span></span>

[!code-aspx[Main](creating-a-site-wide-layout-using-master-pages-vb/samples/sample2.aspx)]

<span data-ttu-id="5e664-218">主版頁面的配置會定義使用一系列的`<div>`HTML 項目。</span><span class="sxs-lookup"><span data-stu-id="5e664-218">The master page's layout is defined using a series of `<div>` HTML elements.</span></span> <span data-ttu-id="5e664-219">`topContent` `<div>`包含出現在每個頁面頂端的標記時`mainContent`， `leftContent`，和`footerContent` `<div>` s 用來顯示頁面的內容、 左側資料行和 「 電源已由 MicrosoftASP.NET"圖示，分別。</span><span class="sxs-lookup"><span data-stu-id="5e664-219">The `topContent` `<div>` contains the markup that appears at the top of each page, while the `mainContent`, `leftContent`, and `footerContent` `<div>` s are used to display the page's content, the left column, and the "Powered by Microsoft ASP.NET" icon, respectively.</span></span> <span data-ttu-id="5e664-220">除了新增這些`<div>`項目，我也重新命名`ID`主要 ContentPlaceHolder 控制項從屬性`ContentPlaceHolder1`至`MainContent`。</span><span class="sxs-lookup"><span data-stu-id="5e664-220">In addition to adding these `<div>` elements, I also renamed the `ID` property of the primary ContentPlaceHolder control from `ContentPlaceHolder1` to `MainContent`.</span></span>

<span data-ttu-id="5e664-221">格式和配置規則，這些各種`<div>`項目拼寫中[階層式樣式表 (CSS)](http://en.wikipedia.org/wiki/Cascading_Style_Sheets)檔案`Styles.css`，透過指定`<link>`項目中的主版頁面的`<head>`項目。</span><span class="sxs-lookup"><span data-stu-id="5e664-221">The formatting and layout rules for these assorted `<div>` elements is spelled out in the [Cascading Stylesheet (CSS)](http://en.wikipedia.org/wiki/Cascading_Style_Sheets) file `Styles.css`, which is specified via a `<link>` element in the master page's `<head>` element.</span></span> <span data-ttu-id="5e664-222">這些不同的規則定義的每個外觀與風格`<div>`先前所述的項目。</span><span class="sxs-lookup"><span data-stu-id="5e664-222">These various rules define the look and feel of each `<div>` element noted above.</span></span> <span data-ttu-id="5e664-223">例如， `topContent` `<div>`元素，會顯示"主版頁面教學課程 」 文字及連結，其具有格式規則中指定`Styles.css`，如下所示：</span><span class="sxs-lookup"><span data-stu-id="5e664-223">For example, the `topContent` `<div>` element, which displays the "Master Pages Tutorials" text and link, has its formatting rules specified in `Styles.css` as follows:</span></span>

[!code-css[Main](creating-a-site-wide-layout-using-master-pages-vb/samples/sample3.css)]

<span data-ttu-id="5e664-224">如果您要遵照在您的電腦，您必須下載本教學課程隨附的程式碼並將加入`Styles.css`檔案加入專案。</span><span class="sxs-lookup"><span data-stu-id="5e664-224">If you are following along at your computer, you will need to download this tutorial's accompanying code and add the `Styles.css` file to your project.</span></span> <span data-ttu-id="5e664-225">同樣地，您也需要建立一個名為資料夾`Images`並下載的示範網站的 「 電源的 Microsoft ASP.NET 」 圖示將複製到您的專案。</span><span class="sxs-lookup"><span data-stu-id="5e664-225">Similarly, you will also need to create a folder named `Images` and copy the "Powered by Microsoft ASP.NET" icon from the downloaded demo website to your project.</span></span>

> [!NOTE]
> <span data-ttu-id="5e664-226">CSS 和網頁格式的討論超出本文章的範圍。</span><span class="sxs-lookup"><span data-stu-id="5e664-226">A discussion of CSS and web page formatting is beyond the scope of this article.</span></span> <span data-ttu-id="5e664-227">如需 CSS 的詳細資訊，請參閱[CSS 教學課程](http://www.w3schools.com/css/default.asp)在[W3Schools.com](http://www.w3schools.com/)。也建議您下載本教學課程隨附的程式碼、 使用中的 CSS 設定`Styles.css`來查看不同的格式規則的效果。</span><span class="sxs-lookup"><span data-stu-id="5e664-227">For more on CSS, check out the [CSS Tutorials](http://www.w3schools.com/css/default.asp) at [W3Schools.com](http://www.w3schools.com/). I also encourage you to download this tutorial's accompanying code and play with the CSS settings in `Styles.css` to see the effects of different formatting rules.</span></span>


### <a name="creating-a-master-page-using-an-existing-design-template"></a><span data-ttu-id="5e664-228">建立使用現有設計範本主版頁面</span><span class="sxs-lookup"><span data-stu-id="5e664-228">Creating a Master Page Using an Existing Design Template</span></span>

<span data-ttu-id="5e664-229">過去幾年我建立 ASP.NET web 應用程式的小型-至中型公司的數的字。</span><span class="sxs-lookup"><span data-stu-id="5e664-229">Over the years I've built a number of ASP.NET web applications for small- to medium-sized companies.</span></span> <span data-ttu-id="5e664-230">某些用戶端有現有的站台版面配置，選擇他們想要使用;其他人雇用一流的圖形設計工具。</span><span class="sxs-lookup"><span data-stu-id="5e664-230">Some of my clients had an existing site layout they wanted to use; others hired a competent graphics designer.</span></span> <span data-ttu-id="5e664-231">幾個託給我設計網站配置。</span><span class="sxs-lookup"><span data-stu-id="5e664-231">A few entrusted me to design the website layout.</span></span> <span data-ttu-id="5e664-232">如您所見的圖 6，工作的程式設計人員設計的網站配置最好是通常為為具有您會計執行 open-heart surgery 而醫生則您的稅金。</span><span class="sxs-lookup"><span data-stu-id="5e664-232">As you can tell by Figure 6, tasking a programmer to design a website's layout is usually as wise as having your accountant perform open-heart surgery while your doctor does your taxes.</span></span>

<span data-ttu-id="5e664-233">幸運的是，有提供免費的 HTML 設計範本的 innumerous 網站-Google 傳回超過 6 百萬個結果的搜尋字詞 」 可用的網站範本 」。</span><span class="sxs-lookup"><span data-stu-id="5e664-233">Fortunately, there are innumerous websites that offer free HTML design templates - Google returned more than six million results for the search term "free website templates."</span></span> <span data-ttu-id="5e664-234">我最喜歡的項目是[OpenDesigns.org](http://opendesigns.org/)。一旦您找到您要的網站範本，將 CSS 檔案和影像加入至您的網站專案，並將範本的 HTML 整合到您的主版頁面。</span><span class="sxs-lookup"><span data-stu-id="5e664-234">One of my favorite ones is [OpenDesigns.org](http://opendesigns.org/). Once you find a website template you like, add the CSS files and images to your website project and integrate the template's HTML into your master page.</span></span>

> [!NOTE]
> <span data-ttu-id="5e664-235">Microsoft 也提供了許多[釋放 ASP.NET 設計開始套件範本](https://msdn.microsoft.com/asp.net/aa336613.aspx)，整合到 Visual Studio 中的 [新的網站] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="5e664-235">Microsoft also offers a number of [free ASP.NET Design Start Kit Templates](https://msdn.microsoft.com/asp.net/aa336613.aspx) that integrate into the New Web Site dialog box in Visual Studio.</span></span>


## <a name="step-2-creating-associated-content-pages"></a><span data-ttu-id="5e664-236">步驟 2： 建立相關聯的內容頁面</span><span class="sxs-lookup"><span data-stu-id="5e664-236">Step 2: Creating Associated Content Pages</span></span>

<span data-ttu-id="5e664-237">建立主版頁面時，我們已經準備好開始建立 ASP.NET 網頁繫結至主版頁面項目。</span><span class="sxs-lookup"><span data-stu-id="5e664-237">With the master page created, we are ready to start creating ASP.NET pages that are bound to the master page.</span></span> <span data-ttu-id="5e664-238">這類頁面指*內容頁面*。</span><span class="sxs-lookup"><span data-stu-id="5e664-238">Such pages are referred to as *content pages*.</span></span>

<span data-ttu-id="5e664-239">讓我們加入專案中加入新的 ASP.NET 頁面，並將它繫結`Site.master`主版頁面。</span><span class="sxs-lookup"><span data-stu-id="5e664-239">Let's add a new ASP.NET page to the project and bind it to the `Site.master` master page.</span></span> <span data-ttu-id="5e664-240">在 方案總管 中的專案名稱上按一下滑鼠右鍵，然後選擇 加入新項目選項。</span><span class="sxs-lookup"><span data-stu-id="5e664-240">Right-click on the project name in Solution Explorer and choose the Add New Item option.</span></span> <span data-ttu-id="5e664-241">選取的 Web 表單範本中，輸入名稱`About.aspx`，如圖 7 所示，然後核取 選取主版頁面 」 核取方塊。</span><span class="sxs-lookup"><span data-stu-id="5e664-241">Select the Web Form template, enter the name `About.aspx`, and then check the "Select master page" checkbox as shown in Figure 7.</span></span> <span data-ttu-id="5e664-242">如此一來就會顯示 選取主版頁面對話方塊方塊中您可以在其中選擇要使用的主版頁面的 （請參閱圖 8）。</span><span class="sxs-lookup"><span data-stu-id="5e664-242">Doing so will display the Select a Master Page dialog box (see Figure 8) from where you can choose the master page to use.</span></span>

> [!NOTE]
> <span data-ttu-id="5e664-243">如果您已建立您的 ASP.NET 網站使用的 Web 應用程式專案的模型，而不網站專案模型不會看到圖 7 所示的 [加入新項目] 對話方塊中，「 選取主版頁面 」 核取方塊。</span><span class="sxs-lookup"><span data-stu-id="5e664-243">If you created your ASP.NET website using the Web Application Project model instead of the Web Site Project model you will not see the "Select master page" checkbox in the Add New Item dialog box shown in Figure 7.</span></span> <span data-ttu-id="5e664-244">若要建立內容頁面時使用 Web 應用程式專案模型您必須選擇 Web 內容表單範本，而不是 Web 表單範本。</span><span class="sxs-lookup"><span data-stu-id="5e664-244">To create a content page when using the Web Application Project model you must choose the Web Content Form template instead of the Web Form template.</span></span> <span data-ttu-id="5e664-245">選取 Web 內容的表單範本，然後按一下 [新增] 之後, 相同選取主版頁面圖 8 所示的對話方塊隨即出現。</span><span class="sxs-lookup"><span data-stu-id="5e664-245">After selecting the Web Content Form template and clicking Add, the same Select a Master Page dialog box shown in Figure 8 will appear.</span></span>


<span data-ttu-id="5e664-246">[![加入新的內容頁面](creating-a-site-wide-layout-using-master-pages-vb/_static/image18.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="5e664-246">[![Add a New Content Page](creating-a-site-wide-layout-using-master-pages-vb/_static/image18.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image17.png)</span></span>

<span data-ttu-id="5e664-247">**圖 07**： 加入新的內容頁面 ([按一下以檢視完整大小的影像](creating-a-site-wide-layout-using-master-pages-vb/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="5e664-247">**Figure 07**: Add a New Content Page  ([Click to view full-size image](creating-a-site-wide-layout-using-master-pages-vb/_static/image19.png))</span></span>


<span data-ttu-id="5e664-248">[![選取 Site.master 主版頁面](creating-a-site-wide-layout-using-master-pages-vb/_static/image21.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="5e664-248">[![Select the Site.master Master Page](creating-a-site-wide-layout-using-master-pages-vb/_static/image21.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image20.png)</span></span>

<span data-ttu-id="5e664-249">**圖 08**： 選取`Site.master`主版頁面 ([按一下以檢視完整大小的影像](creating-a-site-wide-layout-using-master-pages-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="5e664-249">**Figure 08**: Select the `Site.master` Master Page  ([Click to view full-size image](creating-a-site-wide-layout-using-master-pages-vb/_static/image22.png))</span></span>


<span data-ttu-id="5e664-250">如下列宣告式標記顯示，新的內容頁面包含`@Page`，往回指向其主版頁面和內容控制項主版頁面的 ContentPlaceHolder 控制項的每個指示詞。</span><span class="sxs-lookup"><span data-stu-id="5e664-250">As the following declarative markup shows, a new content page contains a `@Page` directive that points back to its master page and a Content control for each of the master page's ContentPlaceHolder controls.</span></span>

[!code-aspx[Main](creating-a-site-wide-layout-using-master-pages-vb/samples/sample4.aspx)]

> [!NOTE]
> <span data-ttu-id="5e664-251">在步驟 1 中的 「 建立簡單的網站 」 版面配置區段我重新命名為`ContentPlaceHolder1`至`MainContent`。</span><span class="sxs-lookup"><span data-stu-id="5e664-251">In the "Creating a Simple Site Layout" section in Step 1 I renamed `ContentPlaceHolder1` to `MainContent`.</span></span> <span data-ttu-id="5e664-252">如果您未重新命名此 ContentPlaceHolder 控制項`ID`同樣地，在內容頁面的宣告式標記會稍有不同的標記，如上所示。</span><span class="sxs-lookup"><span data-stu-id="5e664-252">If you did not rename this ContentPlaceHolder control's `ID` in the same way, your content page's declarative markup will differ slightly from the markup shown above.</span></span> <span data-ttu-id="5e664-253">也就是第二個內容控制項的`ContentPlaceHolderID`會反映`ID`對應 ContentPlaceHolder 的控制您的主版頁面中。</span><span class="sxs-lookup"><span data-stu-id="5e664-253">Namely, the second Content control's `ContentPlaceHolderID` will reflect the `ID` of the corresponding ContentPlaceHolder control in your master page.</span></span>


<span data-ttu-id="5e664-254">ASP.NET 引擎時呈現內容頁面，必須將網頁的內容使用其主版頁面的 ContentPlaceHolder 控制項的控制項。</span><span class="sxs-lookup"><span data-stu-id="5e664-254">When rendering a content page, the ASP.NET engine must fuse the page's Content controls with its master page's ContentPlaceHolder controls.</span></span> <span data-ttu-id="5e664-255">ASP.NET 引擎會決定內容頁面的主版頁面從`@Page`指示詞的`MasterPageFile`屬性。</span><span class="sxs-lookup"><span data-stu-id="5e664-255">The ASP.NET engine determines the content page's master page from the `@Page` directive's `MasterPageFile` attribute.</span></span> <span data-ttu-id="5e664-256">此內容的頁面如下所示的上述的標記，繫結至`~/Site.master`。</span><span class="sxs-lookup"><span data-stu-id="5e664-256">As the above markup shows, this content page is bound to `~/Site.master`.</span></span>

<span data-ttu-id="5e664-257">因為主版頁面有兩個 ContentPlaceHolder 控制項-`head`和`MainContent`-Visual Web Developer 中產生兩個內容控制項。</span><span class="sxs-lookup"><span data-stu-id="5e664-257">Because the master page has two ContentPlaceHolder controls - `head` and `MainContent` - Visual Web Developer generated two Content controls.</span></span> <span data-ttu-id="5e664-258">每個內容控制項參考特定 ContentPlaceHolder 透過其`ContentPlaceHolderID`屬性。</span><span class="sxs-lookup"><span data-stu-id="5e664-258">Each Content control references a particular ContentPlaceHolder via its `ContentPlaceHolderID` property.</span></span>

<span data-ttu-id="5e664-259">透過先前的全站台的範本技術地位主版頁面的位置是設計階段支援。</span><span class="sxs-lookup"><span data-stu-id="5e664-259">Where master pages shine over previous site-wide template techniques is with their design-time support.</span></span> <span data-ttu-id="5e664-260">圖 9 顯示`About.aspx`透過 Visual Web Developer 的 [設計] 檢視中檢視時的內容頁面。</span><span class="sxs-lookup"><span data-stu-id="5e664-260">Figure 9 shows the `About.aspx` content page when viewed through Visual Web Developer's Design view.</span></span> <span data-ttu-id="5e664-261">請注意，在主版頁面內容時顯示，它會呈現灰色且無法修改。</span><span class="sxs-lookup"><span data-stu-id="5e664-261">Note that while the master page content is visible, it is grayed out and cannot be modified.</span></span> <span data-ttu-id="5e664-262">對應至主版頁面的 ContentPlaceHolders 將內容控制項，不過，是可編輯。</span><span class="sxs-lookup"><span data-stu-id="5e664-262">The Content controls corresponding to the master page's ContentPlaceHolders are, however, editable.</span></span> <span data-ttu-id="5e664-263">就像其他任何 ASP.NET 網頁，您可以建立內容頁面的介面加入透過來源或設計檢視的 Web 控制項。</span><span class="sxs-lookup"><span data-stu-id="5e664-263">And just like with any other ASP.NET page, you can create the content page's interface by adding Web controls through the Source or Design views.</span></span>


<span data-ttu-id="5e664-264">[![內容頁面的 [設計] 檢視會顯示這兩個指定頁面和主版頁面內容](creating-a-site-wide-layout-using-master-pages-vb/_static/image24.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="5e664-264">[![The Content Page's Design View Displays Both the Page-Specific and Master Page Contents](creating-a-site-wide-layout-using-master-pages-vb/_static/image24.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image23.png)</span></span>

<span data-ttu-id="5e664-265">**圖 09**: 內容頁面的設計檢視會顯示頁面專屬和都主版頁面內容 ([按一下以檢視完整大小的影像](creating-a-site-wide-layout-using-master-pages-vb/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="5e664-265">**Figure 09**: The Content Page's Design View Displays Both the Page-Specific and Master Page Contents  ([Click to view full-size image](creating-a-site-wide-layout-using-master-pages-vb/_static/image25.png))</span></span>


### <a name="adding-markup-and-web-controls-to-the-content-page"></a><span data-ttu-id="5e664-266">內容頁面中加入標記和 Web 控制項</span><span class="sxs-lookup"><span data-stu-id="5e664-266">Adding Markup and Web Controls to the Content Page</span></span>

<span data-ttu-id="5e664-267">請花一點時間建立的某些內容`About.aspx`頁面。</span><span class="sxs-lookup"><span data-stu-id="5e664-267">Take a moment to create some content for the `About.aspx` page.</span></span> <span data-ttu-id="5e664-268">您可以看到在圖 10 中，輸入 「 關於作者 」 標題和幾個段落的文字，不過可自由太新增 Web 控制項。</span><span class="sxs-lookup"><span data-stu-id="5e664-268">As you can see in Figure 10, I entered an "About the Author" heading and a couple of paragraphs of text, but feel free to add Web controls, too.</span></span> <span data-ttu-id="5e664-269">在建立之後這個介面，請瀏覽`About.aspx`透過瀏覽器的頁面。</span><span class="sxs-lookup"><span data-stu-id="5e664-269">After creating this interface, visit the `About.aspx` page through a browser.</span></span>


<span data-ttu-id="5e664-270">[![瀏覽 about.aspx 的網頁 頁面，透過瀏覽器](creating-a-site-wide-layout-using-master-pages-vb/_static/image27.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="5e664-270">[![Visit the About.aspx Page Through a Browser](creating-a-site-wide-layout-using-master-pages-vb/_static/image27.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image26.png)</span></span>

<span data-ttu-id="5e664-271">**圖 10**： 瀏覽`About.aspx`頁面透過瀏覽器 ([按一下以檢視完整大小的影像](creating-a-site-wide-layout-using-master-pages-vb/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="5e664-271">**Figure 10**: Visit the `About.aspx` Page Through a Browser  ([Click to view full-size image](creating-a-site-wide-layout-using-master-pages-vb/_static/image28.png))</span></span>


<span data-ttu-id="5e664-272">請務必了解，要求的內容頁面和其相關聯的主版頁面 fused 而呈現整個完全在 web 伺服器上。</span><span class="sxs-lookup"><span data-stu-id="5e664-272">It is important to understand that the requested content page and its associated master page are fused and rendered as a whole entirely on the web server.</span></span> <span data-ttu-id="5e664-273">然後，終端使用者的瀏覽器會傳送產生、 合成 HTML。</span><span class="sxs-lookup"><span data-stu-id="5e664-273">The end user's browser is then sent the resulting, fused HTML.</span></span> <span data-ttu-id="5e664-274">若要確認這種情況，請檢視瀏覽器移至 [檢視] 功能表並選擇來源收到的 HTML。</span><span class="sxs-lookup"><span data-stu-id="5e664-274">To verify this, view the HTML received by the browser by going to the View menu and choosing Source.</span></span> <span data-ttu-id="5e664-275">請注意，有任何框架或其他任何特殊的技術，在單一視窗中顯示兩個不同的網頁。</span><span class="sxs-lookup"><span data-stu-id="5e664-275">Note that there are no frames or any other specialized techniques for displaying two different web pages in a single window.</span></span>

### <a name="binding-a-master-page-to-an-existing-aspnet-page"></a><span data-ttu-id="5e664-276">繫結至現有的 ASP.NET 網頁的主版頁面</span><span class="sxs-lookup"><span data-stu-id="5e664-276">Binding a Master Page to an Existing ASP.NET Page</span></span>

<span data-ttu-id="5e664-277">如我們在此步驟中所見，ASP.NET web 應用程式中加入新的內容頁面是容易，只要選取 「 選取主版頁面 」 的核取方塊，然後挑選主版頁面。</span><span class="sxs-lookup"><span data-stu-id="5e664-277">As we saw in this step, adding a new content page to an ASP.NET web application is as easy as checking the "Select master page" checkbox and picking the master page.</span></span> <span data-ttu-id="5e664-278">不幸的是，將現有的 ASP.NET 網頁轉換成主版頁面也不簡單。</span><span class="sxs-lookup"><span data-stu-id="5e664-278">Unfortunately, converting an existing ASP.NET page to a master page is not as easy.</span></span>

<span data-ttu-id="5e664-279">要繫結至現有的 ASP.NET 網頁的主版頁面中，您必須執行下列步驟：</span><span class="sxs-lookup"><span data-stu-id="5e664-279">To bind a master page to an existing ASP.NET page you need to perform the following steps:</span></span>

1. <span data-ttu-id="5e664-280">新增`MasterPageFile`屬性加入 ASP.NET 網頁的`@Page`指示詞，指向適當的主版頁面。</span><span class="sxs-lookup"><span data-stu-id="5e664-280">Add the `MasterPageFile` attribute to the ASP.NET page's `@Page` directive, pointing it to the appropriate master page.</span></span>
2. <span data-ttu-id="5e664-281">ContentPlaceHolders 主版頁面中的每個將內容控制項。</span><span class="sxs-lookup"><span data-stu-id="5e664-281">Add Content controls for each of the ContentPlaceHolders in the master page.</span></span>
3. <span data-ttu-id="5e664-282">選擇性地剪下並將現有的 ASP.NET 網頁的內容貼到適當的內容控制項。</span><span class="sxs-lookup"><span data-stu-id="5e664-282">Selectively cut and paste the ASP.NET page's existing content into the appropriate Content controls.</span></span> <span data-ttu-id="5e664-283">我說 「 選擇性 」 此處，因為 ASP.NET 頁面可能包含標記為已透過表示主版頁面中，例如`DOCTYPE`、`<html>`項目和 Web Form。</span><span class="sxs-lookup"><span data-stu-id="5e664-283">I say "selectively" here because the ASP.NET page likely contains markup that's already expressed by the master page, such as the `DOCTYPE`, the `<html>` element, and the Web Form.</span></span>

<span data-ttu-id="5e664-284">如需這個程序，以及螢幕擷取畫面的逐步指示，請參閱[Scott Guthrie](https://weblogs.asp.net/scottgu/)的[使用主版頁面和站台瀏覽](http://webproject.scottgu.com/VisualBasic/MasterPages/MasterPages.aspx)教學課程。</span><span class="sxs-lookup"><span data-stu-id="5e664-284">For step-by-step instructions on this process along with screen shots, check out [Scott Guthrie](https://weblogs.asp.net/scottgu/)'s [Using Master Pages and Site Navigation](http://webproject.scottgu.com/VisualBasic/MasterPages/MasterPages.aspx) tutorial.</span></span> <span data-ttu-id="5e664-285">「 更新`Default.aspx`和`DataSample.aspx`使用主版頁面 」 一節詳細說明這些步驟。</span><span class="sxs-lookup"><span data-stu-id="5e664-285">The "Update `Default.aspx` and `DataSample.aspx` to use the Master Page" section details these steps.</span></span>

<span data-ttu-id="5e664-286">因為它更容易建立新的內容頁面，比轉換的內容頁面中的現有 ASP.NET 網頁，建議您每當您建立新的 ASP.NET 網站會將主版頁面新增至站台。</span><span class="sxs-lookup"><span data-stu-id="5e664-286">Because it is much easier to create new content pages than it is to convert existing ASP.NET pages into content pages, I recommend that whenever you create a new ASP.NET website add a master page to the site.</span></span> <span data-ttu-id="5e664-287">將所有新的 ASP.NET 網頁的繫結至這個主版頁面。</span><span class="sxs-lookup"><span data-stu-id="5e664-287">Bind all new ASP.NET pages to this master page.</span></span> <span data-ttu-id="5e664-288">別擔心，如果初始的主版頁面很簡單或純文字。您可以在稍後更新主版頁面。</span><span class="sxs-lookup"><span data-stu-id="5e664-288">Don't worry if the initial master page is very simple or plain; you can update the master page later.</span></span>

> [!NOTE]
> <span data-ttu-id="5e664-289">在建立新的 ASP.NET 應用程式時，Visual Web Developer 中加入`Default.aspx`並未繫結至主版頁面的頁面。</span><span class="sxs-lookup"><span data-stu-id="5e664-289">When creating a new ASP.NET application, Visual Web Developer adds a `Default.aspx` page that isn't bound to a master page.</span></span> <span data-ttu-id="5e664-290">如果您想要將現有的 ASP.NET 網頁轉換成內容頁的練習，請繼續進行和執行這項操作與`Default.aspx`。</span><span class="sxs-lookup"><span data-stu-id="5e664-290">If you want to practice converting an existing ASP.NET page into a content page, go ahead and do so with `Default.aspx`.</span></span> <span data-ttu-id="5e664-291">或者，您可以刪除`Default.aspx`然後重新加入，但是這次檢查 「 選取的主版頁面 」 核取方塊。</span><span class="sxs-lookup"><span data-stu-id="5e664-291">Alternatively, you can delete `Default.aspx` and then re-add it, but this time checking the "Select master page" checkbox.</span></span>


## <a name="step-3-updating-the-master-pages-markup"></a><span data-ttu-id="5e664-292">步驟 3： 更新主版頁面的標記</span><span class="sxs-lookup"><span data-stu-id="5e664-292">Step 3: Updating the Master Page's Markup</span></span>

<span data-ttu-id="5e664-293">主版頁面的主要優點之一是單一的主版頁面可能用於在網站上定義許多網頁的整體配置。</span><span class="sxs-lookup"><span data-stu-id="5e664-293">One of the primary benefits of master pages is that a single master page may be used to define the overall layout for numerous pages on the site.</span></span> <span data-ttu-id="5e664-294">因此，更新站台的外觀及操作，需要更新單一檔案的主版頁面。</span><span class="sxs-lookup"><span data-stu-id="5e664-294">Therefore, updating the site's look and feel requires updating a single file - the master page.</span></span>

<span data-ttu-id="5e664-295">若要將說明此行為，讓我們來更新我們包含頂端的左側資料行中的目前日期的主版頁面。</span><span class="sxs-lookup"><span data-stu-id="5e664-295">To illustrate this behavior, let's update our master page to include the current date in at the top of the left column.</span></span> <span data-ttu-id="5e664-296">新增名為標籤`DateDisplay`至`leftContent` `<div>`。</span><span class="sxs-lookup"><span data-stu-id="5e664-296">Add a Label named `DateDisplay` to the `leftContent` `<div>`.</span></span>

[!code-aspx[Main](creating-a-site-wide-layout-using-master-pages-vb/samples/sample5.aspx)]

<span data-ttu-id="5e664-297">接下來，建立`Page_Load`事件處理常式的主要頁面上，並加入下列程式碼：</span><span class="sxs-lookup"><span data-stu-id="5e664-297">Next, create a `Page_Load` event handler for the master page and add the following code:</span></span>

[!code-vb[Main](creating-a-site-wide-layout-using-master-pages-vb/samples/sample6.vb)]

<span data-ttu-id="5e664-298">上述程式碼會設定標籤的`Text`屬性目前的日期和時間格式化為一週的星期幾、 月份和兩位數天數的名稱 （請參閱圖 11）。</span><span class="sxs-lookup"><span data-stu-id="5e664-298">The above code sets the Label's `Text` property to the current date and time formatted as the day of the week, the name of the month, and the two-digit day (see Figure 11).</span></span> <span data-ttu-id="5e664-299">透過這項變更，重新檢查您的內容頁面。</span><span class="sxs-lookup"><span data-stu-id="5e664-299">With this change, revisit one of your content pages.</span></span> <span data-ttu-id="5e664-300">圖 11 顯示，因為產生的標記會立即更新要包含的主版頁面的變更。</span><span class="sxs-lookup"><span data-stu-id="5e664-300">As Figure 11 shows, the resulting markup is immediately updated to include the change to the master page.</span></span>


<span data-ttu-id="5e664-301">[![主版頁面所做的變更會反映時檢視內容頁面](creating-a-site-wide-layout-using-master-pages-vb/_static/image30.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="5e664-301">[![The Changes to the Master Page are Reflected When Viewing the a Content Page](creating-a-site-wide-layout-using-master-pages-vb/_static/image30.png)](creating-a-site-wide-layout-using-master-pages-vb/_static/image29.png)</span></span>

<span data-ttu-id="5e664-302">**圖 11**： 主版頁面的變更會反映時檢視內容頁面 ([按一下以檢視完整大小的影像](creating-a-site-wide-layout-using-master-pages-vb/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="5e664-302">**Figure 11**: The Changes to the Master Page are Reflected When Viewing the a Content Page  ([Click to view full-size image](creating-a-site-wide-layout-using-master-pages-vb/_static/image31.png))</span></span>


> [!NOTE]
> <span data-ttu-id="5e664-303">如本範例所示，主版頁面可能包含伺服器端 Web 控制項，程式碼和事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="5e664-303">As this example illustrates, master pages may contain server-side Web controls, code, and event handlers.</span></span>


## <a name="summary"></a><span data-ttu-id="5e664-304">總結</span><span class="sxs-lookup"><span data-stu-id="5e664-304">Summary</span></span>

<span data-ttu-id="5e664-305">主版頁面可讓 ASP.NET 開發人員設計可輕鬆地更新一致全站台的配置。</span><span class="sxs-lookup"><span data-stu-id="5e664-305">Master pages enable ASP.NET developers to design a consistent site-wide layout that is easily updateable.</span></span> <span data-ttu-id="5e664-306">建立主版頁面和其相關聯的內容頁很簡單，只建立標準的 ASP.NET 網頁，Visual Web Developer 提供豐富的設計階段支援。</span><span class="sxs-lookup"><span data-stu-id="5e664-306">Creating master pages and their associated content pages is as simple as creating standard ASP.NET pages, as Visual Web Developer offers rich design-time support.</span></span>

<span data-ttu-id="5e664-307">我們在本教學課程中建立的主版頁面範例有兩個 ContentPlaceHolder 控制項，前端和 MainContent。</span><span class="sxs-lookup"><span data-stu-id="5e664-307">The master page example we created in this tutorial had two ContentPlaceHolder controls, head and MainContent.</span></span> <span data-ttu-id="5e664-308">我們僅指定 MainContent ContentPlaceHolder 控制項標記在內容頁面中，不過。</span><span class="sxs-lookup"><span data-stu-id="5e664-308">We only specified markup for the MainContent ContentPlaceHolder control in our content page, however.</span></span> <span data-ttu-id="5e664-309">我們在下一個教學課程中使用多個內容控制項的內容頁面。</span><span class="sxs-lookup"><span data-stu-id="5e664-309">In the next tutorial we look at using multiple Content controls in the content page.</span></span> <span data-ttu-id="5e664-310">我們也會了解如何定義預設標記的內容控制項內主版頁面中，以及如何若要切換使用預設標記中定義主要頁面，並提供自訂的標記，從 [內容] 頁面。</span><span class="sxs-lookup"><span data-stu-id="5e664-310">We also see how to define default markup for Content controls within the master page, as well as how to toggle between using the default markup defined in the master page and providing custom markup from the content page.</span></span>

<span data-ttu-id="5e664-311">祝您程式設計 ！</span><span class="sxs-lookup"><span data-stu-id="5e664-311">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="5e664-312">進一步閱讀</span><span class="sxs-lookup"><span data-stu-id="5e664-312">Further Reading</span></span>

<span data-ttu-id="5e664-313">如需有關在本教學課程所討論的主題的詳細資訊，請參閱下列資源：</span><span class="sxs-lookup"><span data-stu-id="5e664-313">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="5e664-314">ASP.NET 設計工具： 上建置 ASP.NET 網站使用 Web 標準釋放設計範本和指引</span><span class="sxs-lookup"><span data-stu-id="5e664-314">ASP.NET for Designers: Free Design Templates and Guidance on Building ASP.NET Websites Using Web Standards</span></span>](https://msdn.microsoft.com/asp.net/aa336602.aspx)
- [<span data-ttu-id="5e664-315">ASP.NET 主版頁面概觀</span><span class="sxs-lookup"><span data-stu-id="5e664-315">ASP.NET Master Pages Overview</span></span>](https://msdn.microsoft.com/library/wtxbf3hh.aspx)
- [<span data-ttu-id="5e664-316">階層式樣式表 (CSS) 教學課程</span><span class="sxs-lookup"><span data-stu-id="5e664-316">Cascading Stylesheets (CSS) Tutorials</span></span>](http://www.w3schools.com/css/default.asp)
- [<span data-ttu-id="5e664-317">動態設定頁面的標題</span><span class="sxs-lookup"><span data-stu-id="5e664-317">Dynamically Setting the Page's Title</span></span>](http://aspnet.4guysfromrolla.com/articles/051006-1.aspx)
- [<span data-ttu-id="5e664-318">在 ASP.NET 中的主版頁面</span><span class="sxs-lookup"><span data-stu-id="5e664-318">Master Pages in ASP.NET</span></span>](http://www.odetocode.com/articles/419.aspx)
- [<span data-ttu-id="5e664-319">主版頁面的快速入門教學課程</span><span class="sxs-lookup"><span data-stu-id="5e664-319">Master Pages QuickStart Tutorials</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/masterpages/default.aspx)

### <a name="about-the-author"></a><span data-ttu-id="5e664-320">關於作者</span><span class="sxs-lookup"><span data-stu-id="5e664-320">About the Author</span></span>

<span data-ttu-id="5e664-321">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，作者的多個 ASP/ASP.NET 書籍和 4GuysFromRolla.com 的創辦，目前正在使用 Microsoft Web 技術從 1998 年。</span><span class="sxs-lookup"><span data-stu-id="5e664-321">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="5e664-322">Scott 可做為獨立顧問、 訓練和寫入器。</span><span class="sxs-lookup"><span data-stu-id="5e664-322">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="5e664-323">他最新的活頁簿[ *Sam 教導您自己 ASP.NET 3.5 24 小時內*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="5e664-323">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="5e664-324">在可到達 Scott [ mitchell@4GuysFromRolla.com ](mailto:mitchell@4GuysFromRolla.com)或透過在他的部落格[ http://ScottOnWriting.NET ](http://scottonwriting.net/)。</span><span class="sxs-lookup"><span data-stu-id="5e664-324">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="5e664-325">特別感謝</span><span class="sxs-lookup"><span data-stu-id="5e664-325">Special Thanks To</span></span>

<span data-ttu-id="5e664-326">檢閱我即將推出的 MSDN 文件有興趣嗎？</span><span class="sxs-lookup"><span data-stu-id="5e664-326">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="5e664-327">如果是這樣，卸除我一行[ mitchell@4GuysFromRolla.com ](mailto:mitchell@4GuysFromRolla.com)。</span><span class="sxs-lookup"><span data-stu-id="5e664-327">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="5e664-328">[上一頁](nested-master-pages-cs.md)
> [下一頁](multiple-contentplaceholders-and-default-content-vb.md)</span><span class="sxs-lookup"><span data-stu-id="5e664-328">[Previous](nested-master-pages-cs.md)
[Next](multiple-contentplaceholders-and-default-content-vb.md)</span></span>
