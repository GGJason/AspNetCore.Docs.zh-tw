---
uid: web-forms/overview/older-versions-getting-started/aspnet-ajax/understanding-asp-net-ajax-updatepanel-triggers
title: 了解 ASP.NET AJAX UpdatePanel 觸發程序 |Microsoft 文件
author: scottcate
description: 當使用 Visual Studio 中的標記編輯器中，您可能會注意到 （從 IntelliSense) 有兩個子項目的 UpdatePanel 控制項。 其中一個北...
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/12/2008
ms.topic: article
ms.assetid: faab8503-2984-48a9-8a40-7728461abc50
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-getting-started/aspnet-ajax/understanding-asp-net-ajax-updatepanel-triggers
msc.type: authoredcontent
ms.openlocfilehash: f30f2ead402d2f49a89b2caf47cc30b6445d4cfb
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/06/2018
ms.locfileid: "30890745"
---
<a name="understanding-aspnet-ajax-updatepanel-triggers"></a><span data-ttu-id="539f6-104">了解 ASP.NET AJAX UpdatePanel 觸發程序</span><span class="sxs-lookup"><span data-stu-id="539f6-104">Understanding ASP.NET AJAX UpdatePanel Triggers</span></span>
====================
<span data-ttu-id="539f6-105">由[Scott 類別](https://github.com/scottcate)</span><span class="sxs-lookup"><span data-stu-id="539f6-105">by [Scott Cate](https://github.com/scottcate)</span></span>

[<span data-ttu-id="539f6-106">下載 PDF</span><span class="sxs-lookup"><span data-stu-id="539f6-106">Download PDF</span></span>](http://download.microsoft.com/download/C/1/9/C19A3451-1D14-477C-B703-54EF22E197EE/AJAX_tutorial02_Triggers_cs.pdf)

> <span data-ttu-id="539f6-107">當使用 Visual Studio 中的標記編輯器中，您可能會注意到 （從 IntelliSense) 有兩個子項目的 UpdatePanel 控制項。</span><span class="sxs-lookup"><span data-stu-id="539f6-107">When working in the markup editor in Visual Studio, you may notice (from IntelliSense) that there are two child elements of an UpdatePanel control.</span></span> <span data-ttu-id="539f6-108">其中是觸發程序項目，其指定的頁面 （或使用者控制項，如果您使用其中一個） 控制項，將會觸發 UpdatePanel 控制項的項目所在的部分呈現。</span><span class="sxs-lookup"><span data-stu-id="539f6-108">One of which is the Triggers element, which specifies the controls on the page (or the user control, if you are using one) that will trigger a partial render of the UpdatePanel control in which the element resides.</span></span>


## <a name="introduction"></a><span data-ttu-id="539f6-109">簡介</span><span class="sxs-lookup"><span data-stu-id="539f6-109">Introduction</span></span>

<span data-ttu-id="539f6-110">Microsoft ASP.NET 技術，帶來物件導向和事件驅動的程式設計模型，與聯集它已編譯程式碼的優點。</span><span class="sxs-lookup"><span data-stu-id="539f6-110">Microsoft's ASP.NET technology brings an object-oriented and event-driven programming model and unites it with the benefits of compiled code.</span></span> <span data-ttu-id="539f6-111">不過，其伺服器端處理模型有幾項技術，其中有許多您可以解決 Microsoft ASP.NET 3.5 AJAX 擴充功能中包含的新功能的固有的錯誤。</span><span class="sxs-lookup"><span data-stu-id="539f6-111">However, its server-side processing model has several drawbacks inherent in the technology, many of which can be addressed by the new features included in the Microsoft ASP.NET 3.5 AJAX Extensions.</span></span> <span data-ttu-id="539f6-112">這些延伸可讓許多豐富型用戶端的新功能，包括局部網頁呈現，而不需要完整頁面重新整理，透過用戶端指令碼 （包括 ASP.NET 程式碼剖析 API） 和廣泛的 API，用戶端存取 Web 服務的能力設計來鏡射許多 ASP.NET 伺服器端控制項集合中所見的控制項配置。</span><span class="sxs-lookup"><span data-stu-id="539f6-112">These extensions enable many new rich client features, including partial rendering of pages without requiring a full page refresh, the ability to access Web Services via client script (including the ASP.NET profiling API), and an extensive client-side API designed to mirror many of the control schemes seen in the ASP.NET server-side control set.</span></span>

<span data-ttu-id="539f6-113">本白皮書會檢查 XML 觸發程序功能的 ASP.NET AJAX`UpdatePanel`元件。</span><span class="sxs-lookup"><span data-stu-id="539f6-113">This whitepaper examines the XML Triggers functionality of the ASP.NET AJAX `UpdatePanel` component.</span></span> <span data-ttu-id="539f6-114">XML 觸發程序提供更精確地控制造成部分呈現特定 UpdatePanel 控制項的元件。</span><span class="sxs-lookup"><span data-stu-id="539f6-114">XML Triggers give granular control over the components that can cause partial rendering for specific UpdatePanel controls.</span></span>

<span data-ttu-id="539f6-115">本白皮書為基礎的.NET Framework 3.5 Beta 2 版本和 Visual Studio 2008。</span><span class="sxs-lookup"><span data-stu-id="539f6-115">This whitepaper is based on the Beta 2 release of the .NET Framework 3.5 and Visual Studio 2008.</span></span> <span data-ttu-id="539f6-116">ASP.NET AJAX Extensions 中先前的附加元件組件為目標的 ASP.NET 2.0 中，現在已整合至.NET Framework 基底類別程式庫。</span><span class="sxs-lookup"><span data-stu-id="539f6-116">The ASP.NET AJAX Extensions, previously an add-on assembly targeted at ASP.NET 2.0, are now integrated into the .NET Framework Base Class Library.</span></span> <span data-ttu-id="539f6-117">本白皮書也會假設您會使用 Visual Studio 2008 中，不 Visual Web Developer Express，並將提供逐步解說根據 Visual Studio 的使用者介面 （雖然會完全相容，不論程式碼清單開發環境）。</span><span class="sxs-lookup"><span data-stu-id="539f6-117">This whitepaper also assumes that you will be working with Visual Studio 2008, not Visual Web Developer Express, and will provide walkthroughs according to the user interface of Visual Studio (although code listings will be entirely compatible regardless of development environment).</span></span>

## <a name="triggers"></a><span data-ttu-id="539f6-118">*觸發程序*</span><span class="sxs-lookup"><span data-stu-id="539f6-118">*Triggers*</span></span>

<span data-ttu-id="539f6-119">觸發程序，為給定的 UpdatePanel，根據預設，會自動包含叫用回傳，（例如） 包括 TextBox 控制項具有任何子控制項及其`AutoPostBack`屬性設定為**true**。</span><span class="sxs-lookup"><span data-stu-id="539f6-119">Triggers for a given UpdatePanel, by default, automatically include any child controls that invoke a postback, including (for example) TextBox controls that have their `AutoPostBack` property set to **true**.</span></span> <span data-ttu-id="539f6-120">不過，觸發程序也可以包含以宣告方式使用的標記。這是內`<triggers>`UpdatePanel 控制項宣告一節。</span><span class="sxs-lookup"><span data-stu-id="539f6-120">However, triggers can also be included declaratively using markup; this is done within the `<triggers>` section of the UpdatePanel control declaration.</span></span> <span data-ttu-id="539f6-121">雖然可以透過存取觸發程序`Triggers`集合屬性，建議您註冊執行階段的任何部分呈現觸發程序，（比方說，如果控制項不是在設計階段可用） 使用`RegisterAsyncPostBackControl(Control)`方法ScriptManager 內物件的頁面，請`Page_Load`事件。</span><span class="sxs-lookup"><span data-stu-id="539f6-121">Although triggers can be accessed via the `Triggers` collection property, it is recommended that you register any partial render triggers at run-time (for instance, if a control is not available at design time) by using the `RegisterAsyncPostBackControl(Control)` method of the ScriptManager object for your page, within the `Page_Load` event.</span></span> <span data-ttu-id="539f6-122">請記住，頁面是無狀態，因此您應該重新註冊這些控制項每次建立。</span><span class="sxs-lookup"><span data-stu-id="539f6-122">Remember that Pages are stateless, and so you should re-register these controls every time they are created.</span></span>

<span data-ttu-id="539f6-123">自動子觸發程序包含可以也會停用 （以便建立回傳的子控制項不會自動觸發部分呈現） 藉由設定`ChildrenAsTriggers`屬性**false**。</span><span class="sxs-lookup"><span data-stu-id="539f6-123">Automatic child trigger inclusion can also be disabled (so that child controls that create postbacks do not automatically trigger partial renders) by setting the `ChildrenAsTriggers` property to **false**.</span></span> <span data-ttu-id="539f6-124">這可讓您指派哪些特定控制項的最大彈性可能叫用網頁呈現，並建議使用，以便開發人員會選擇加入以回應事件，而不是處理任何可能發生的事件。</span><span class="sxs-lookup"><span data-stu-id="539f6-124">This allows you the greatest flexibility in assigning which specific controls may invoke a page render, and is recommended, so that a developer will opt-in to respond to an event, rather than handling any events that may arise.</span></span>

<span data-ttu-id="539f6-125">請注意，當 UpdatePanel 控制項為巢狀，當 UpdateMode 設定成**條件**，如果子 UpdatePanel 隨即觸發，但父系不是，然後會重新整理 UpdatePanel 的子系。</span><span class="sxs-lookup"><span data-stu-id="539f6-125">Note that when UpdatePanel controls are nested, when the UpdateMode is set to **Conditional**, if the child UpdatePanel is triggered, but the parent is not, then only the child UpdatePanel will refresh.</span></span> <span data-ttu-id="539f6-126">不過，如果父 UpdatePanel 重新整理，然後 UpdatePanel 的子系也會重新整理。</span><span class="sxs-lookup"><span data-stu-id="539f6-126">However, if the parent UpdatePanel is refreshed, then the child UpdatePanel will also be refreshed.</span></span>

## <a name="the-lttriggersgt-element"></a><span data-ttu-id="539f6-127">*&lt;觸發程序&gt;項目*</span><span class="sxs-lookup"><span data-stu-id="539f6-127">*The &lt;Triggers&gt; Element*</span></span>

<span data-ttu-id="539f6-128">當使用 Visual Studio 中的標記編輯器中，您可能會注意到 （從 IntelliSense) 有兩個子元素的`UpdatePanel`控制項。</span><span class="sxs-lookup"><span data-stu-id="539f6-128">When working in the markup editor in Visual Studio, you may notice (from IntelliSense) that there are two child elements of an `UpdatePanel` control.</span></span> <span data-ttu-id="539f6-129">最常看到的項目，則`<ContentTemplate>`元素，其本質上會封裝將交易所更新面板的內容 （我們啟用局部呈現內容）。</span><span class="sxs-lookup"><span data-stu-id="539f6-129">The most-frequently seen element is the `<ContentTemplate>` element, which essentially encapsulates the content that will be held by the update panel (the content for which we are enabling partial rendering).</span></span> <span data-ttu-id="539f6-130">另一個項目是`<Triggers>`元素，其指定的頁面 （或使用者控制項，如果您使用其中一個） 控制項，將會觸發 UpdatePanel 控制項中的部分呈現&lt;觸發程序&gt;位於項目。</span><span class="sxs-lookup"><span data-stu-id="539f6-130">The other element is the `<Triggers>` element, which specifies the controls on the page (or the user control, if you are using one) that will trigger a partial render of the UpdatePanel control in which the &lt;Triggers&gt; element resides.</span></span>

<span data-ttu-id="539f6-131">`<Triggers>`項目可以包含任何數目每兩個子節點：`<asp:AsyncPostBackTrigger>`和`<asp:PostBackTrigger>`。</span><span class="sxs-lookup"><span data-stu-id="539f6-131">The `<Triggers>` element can contain any number each of two child nodes: `<asp:AsyncPostBackTrigger>` and `<asp:PostBackTrigger>`.</span></span> <span data-ttu-id="539f6-132">它們都接受兩個屬性，`ControlID`和`EventName`，而且可以指定目前的封裝 （encapsulation） 單位內的任何控制項 （例如，如果 UpdatePanel 控制項位於 Web 使用者控制項中，您不應嘗試參考上的控制項使用者控制項所在頁面）。</span><span class="sxs-lookup"><span data-stu-id="539f6-132">They both accept two attributes, `ControlID` and `EventName`, and can specify any Control within the current unit of encapsulation (for instance, if your UpdatePanel control resides within a Web User Control, you should not attempt to reference a Control on the Page on which the User Control will reside).</span></span>

<span data-ttu-id="539f6-133">`<asp:AsyncPostBackTrigger>`項目會特別有用，因為它可以將目標從控制項的子系的任何事件*任何*UpdatePanel 控制項中的封裝，而不只是在其下此觸發程序是子系 UpdatePanel 單位.</span><span class="sxs-lookup"><span data-stu-id="539f6-133">The `<asp:AsyncPostBackTrigger>` element is particularly useful in that it can target any event from a Control that exists as a child of *any* UpdatePanel control in the unit of encapsulation, not just the UpdatePanel under which this trigger is a child.</span></span> <span data-ttu-id="539f6-134">因此，任何控制項可以對觸發程序的部分頁面更新。</span><span class="sxs-lookup"><span data-stu-id="539f6-134">Thus, any control can be made to trigger a partial page update.</span></span>

<span data-ttu-id="539f6-135">同樣地，`<asp:PostBackTrigger>`項目可用來觸發程序部分頁面轉譯，但需要完整往返伺服器。</span><span class="sxs-lookup"><span data-stu-id="539f6-135">Similarly, the `<asp:PostBackTrigger>` element can be used to trigger a partial page render, but one that requires a full round-trip to the server.</span></span> <span data-ttu-id="539f6-136">這個觸發程序項目也可用來強制執行完整頁面呈現控制項通常會否則觸發部分頁面轉譯時 (例如，當`Button`控制項存在於`<ContentTemplate>`UpdatePanel 控制項項目的)。</span><span class="sxs-lookup"><span data-stu-id="539f6-136">This trigger element can also be used to force a full page render when a control would otherwise normally trigger a partial page render (for instance, when a `Button` control exists in the `<ContentTemplate>` element of an UpdatePanel control).</span></span> <span data-ttu-id="539f6-137">同樣地，PostBackTrigger 元素可以指定是在目前封裝的單位中任何 UpdatePanel 控制項的子系的任何控制項。</span><span class="sxs-lookup"><span data-stu-id="539f6-137">Again, the PostBackTrigger element can specify any control that is a child of any UpdatePanel control in the current unit of encapsulation.</span></span>

## <a name="lttriggersgt-element-reference"></a><span data-ttu-id="539f6-138">*&lt;觸發程序&gt;項目參考*</span><span class="sxs-lookup"><span data-stu-id="539f6-138">*&lt;Triggers&gt; Element Reference*</span></span>

<span data-ttu-id="539f6-139">*標記下階：*</span><span class="sxs-lookup"><span data-stu-id="539f6-139">*Markup Descendants:*</span></span>

| <span data-ttu-id="539f6-140">**標記**</span><span class="sxs-lookup"><span data-stu-id="539f6-140">**Tag**</span></span> | <span data-ttu-id="539f6-141">**描述**</span><span class="sxs-lookup"><span data-stu-id="539f6-141">**Description**</span></span> |
| --- | --- |
| <span data-ttu-id="539f6-142">&lt;asp:AsyncPostBackTrigger&gt;</span><span class="sxs-lookup"><span data-stu-id="539f6-142">&lt;asp:AsyncPostBackTrigger&gt;</span></span> | <span data-ttu-id="539f6-143">指定控制項，可能會造成部分頁面更新，其中包含這個觸發程序參考 UpdatePanel 的事件。</span><span class="sxs-lookup"><span data-stu-id="539f6-143">Specifies a control and event that will cause a partial page update for the UpdatePanel that contains this trigger reference.</span></span> |
| <span data-ttu-id="539f6-144">&lt;asp:PostBackTrigger&gt;</span><span class="sxs-lookup"><span data-stu-id="539f6-144">&lt;asp:PostBackTrigger&gt;</span></span> | <span data-ttu-id="539f6-145">指定控制項和事件，會造成完整的頁面更新 （完整頁面重新整理）。</span><span class="sxs-lookup"><span data-stu-id="539f6-145">Specifies a control and event that will cause a full page update (a full page refresh).</span></span> <span data-ttu-id="539f6-146">這個標記可以用來控制否則會觸發局部呈現時，強制執行完整的重新整理。</span><span class="sxs-lookup"><span data-stu-id="539f6-146">This tag can be used to force a full refresh when a control would otherwise trigger partial rendering.</span></span> |

## <a name="walkthrough-cross-updatepanel-triggers"></a><span data-ttu-id="539f6-147">*逐步解說： 跨 UpdatePanel 觸發程序*</span><span class="sxs-lookup"><span data-stu-id="539f6-147">*Walkthrough: Cross-UpdatePanel Triggers*</span></span>

1. <span data-ttu-id="539f6-148">建立新的 ASP.NET 網頁與設定以啟用局部呈現 ScriptManager 物件。</span><span class="sxs-lookup"><span data-stu-id="539f6-148">Create a new ASP.NET page with a ScriptManager object set to enable partial rendering.</span></span> <span data-ttu-id="539f6-149">將兩個 updatepanel 就加入至這個頁面-第一個範圍中，包括標籤控制項 (Label1) 和兩個按鈕控制項 （Button1 和 Button2）。</span><span class="sxs-lookup"><span data-stu-id="539f6-149">Add two UpdatePanels to this page - in the first, include a Label control ( Label1 ) and two Button controls ( Button1 and Button2 ).</span></span> <span data-ttu-id="539f6-150">Button1 應該會顯示按一下即可更新和 Button2 應該會顯示按一下即可更新，或沿著這些項目。</span><span class="sxs-lookup"><span data-stu-id="539f6-150">Button1 should say Click to Update Both and Button2 should say Click to Update This, or something along those lines.</span></span> <span data-ttu-id="539f6-151">在第二個 UpdatePanel，包含只標籤控制項 (Label2)，但將其 ForeColor 屬性設定為預設值，使它有別以外的項目。</span><span class="sxs-lookup"><span data-stu-id="539f6-151">In the second UpdatePanel, include only a Label control ( Label2 ), but set its ForeColor property to something other than the default to differentiate it.</span></span>
2. <span data-ttu-id="539f6-152">設定更新模式屬性，這兩個 UpdatePanel 標記的**條件**。</span><span class="sxs-lookup"><span data-stu-id="539f6-152">Set the UpdateMode property of both UpdatePanel tags to **Conditional**.</span></span>

<span data-ttu-id="539f6-153">**清單 1: Default.aspx 標記：**</span><span class="sxs-lookup"><span data-stu-id="539f6-153">**Listing 1: Markup for default.aspx:**</span></span> 

[!code-aspx[Main](understanding-asp-net-ajax-updatepanel-triggers/samples/sample1.aspx)]

1. <span data-ttu-id="539f6-154">在 Button1 Click 事件處理常式，設定為其他項目 （例如 DateTime.Now.ToLongTimeString()) 時間相依 Label1.Text 及 Label2.Text。</span><span class="sxs-lookup"><span data-stu-id="539f6-154">In the Click event handler for Button1, set Label1.Text and Label2.Text to something time-dependent (such as DateTime.Now.ToLongTimeString()).</span></span> <span data-ttu-id="539f6-155">按一下 Button2 的事件處理常式會將只 Label1.Text 設時間相依值。</span><span class="sxs-lookup"><span data-stu-id="539f6-155">For the Click event handler for Button2, set only Label1.Text to the time-dependent value.</span></span>

<span data-ttu-id="539f6-156">**表 2： 程式碼後置 （修剪） default.aspx.cs:**</span><span class="sxs-lookup"><span data-stu-id="539f6-156">**Listing 2: Codebehind (trimmed) in default.aspx.cs:**</span></span> 

[!code-csharp[Main](understanding-asp-net-ajax-updatepanel-triggers/samples/sample2.cs)]

1. <span data-ttu-id="539f6-157">按 F5 以建置並執行專案。</span><span class="sxs-lookup"><span data-stu-id="539f6-157">Press F5 to build and run the project.</span></span> <span data-ttu-id="539f6-158">請注意，當您按一下更新同時面板，這兩個標籤，變更文字;不過，當您按一下此面板的更新時，只有 Label1 更新。</span><span class="sxs-lookup"><span data-stu-id="539f6-158">Note that, when you click Update Both Panels, both labels change text; however, when you click Update This Panel, only Label1 updates.</span></span>


[![](understanding-asp-net-ajax-updatepanel-triggers/_static/image2.png)](understanding-asp-net-ajax-updatepanel-triggers/_static/image1.png)

<span data-ttu-id="539f6-159">([按一下以檢視完整大小的影像](understanding-asp-net-ajax-updatepanel-triggers/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="539f6-159">([Click to view full-size image](understanding-asp-net-ajax-updatepanel-triggers/_static/image3.png))</span></span>


## <a name="under-the-hood"></a><span data-ttu-id="539f6-160">*深入探討*</span><span class="sxs-lookup"><span data-stu-id="539f6-160">*Under the Hood*</span></span>

<span data-ttu-id="539f6-161">使用我們剛才建構的範例，我們可以看一下 ASP.NET AJAX 做什麼，以及我們 UpdatePanel 跨面板觸發程序的運作方式。</span><span class="sxs-lookup"><span data-stu-id="539f6-161">Utilizing the example we just constructed, we can take a look at what ASP.NET AJAX is doing and how our UpdatePanel cross-panel triggers work.</span></span> <span data-ttu-id="539f6-162">若要這樣做，我們將使用產生的網頁原始檔 HTML、 以及 Mozilla Firefox 擴充功能呼叫 firebug 這類-有了它，我們可以輕鬆地檢查 AJAX 回傳。</span><span class="sxs-lookup"><span data-stu-id="539f6-162">To do so, we will work with the generated page source HTML, as well as the Mozilla Firefox extension called FireBug - with it, we can easily examine the AJAX postbacks.</span></span> <span data-ttu-id="539f6-163">我們也會使用.NET 反映程式工具，以選取 Lutz Roeder。</span><span class="sxs-lookup"><span data-stu-id="539f6-163">We will also use the .NET Reflector tool by Lutz Roeder.</span></span> <span data-ttu-id="539f6-164">這兩種工具都在線上，免費提供，並在網際網路上搜尋，即可找到。</span><span class="sxs-lookup"><span data-stu-id="539f6-164">Both of these tools are freely available online, and can be found with an internet search.</span></span>

<span data-ttu-id="539f6-165">檢查網頁原始碼顯示幾乎是 nothing 的事項。UpdatePanel 控制項轉譯為`<div>`容器，所以我們可以看到指令碼資源包括提供由`<asp:ScriptManager>`。</span><span class="sxs-lookup"><span data-stu-id="539f6-165">An examination of the page source code shows almost nothing out of the ordinary; the UpdatePanel controls are rendered as `<div>` containers, and we can see the script resource includes provided by the `<asp:ScriptManager>`.</span></span> <span data-ttu-id="539f6-166">也有一些新 AJAX 特定呼叫 PageRequestManager AJAX 用戶端指令碼程式庫內部的。</span><span class="sxs-lookup"><span data-stu-id="539f6-166">There are also some new AJAX-specific calls to the PageRequestManager that are internal to the AJAX client script library.</span></span> <span data-ttu-id="539f6-167">最後，我們會看到兩個 UpdatePanel 容器-呈現一個`<input>`含有兩個按鈕`<asp:Label>`控制項轉譯為`<span>`容器。</span><span class="sxs-lookup"><span data-stu-id="539f6-167">Finally, we see the two UpdatePanel containers - one with the rendered `<input>` buttons with the two `<asp:Label>` controls rendered as `<span>` containers.</span></span> <span data-ttu-id="539f6-168">（如果您檢查 firebug 這類在 DOM 樹狀結構，您會注意到標籤會呈暗灰色，表示他們無法產生可見的內容）。</span><span class="sxs-lookup"><span data-stu-id="539f6-168">(If you inspect the DOM tree in FireBug, you will notice that the labels are dimmed to indicate that they are not producing visible content).</span></span>

<span data-ttu-id="539f6-169">按一下 [更新這個面板] 按鈕，並注意上方的 UpdatePanel 會更新為目前的伺服器時間。</span><span class="sxs-lookup"><span data-stu-id="539f6-169">Click the Update This Panel button, and notice the top UpdatePanel will be updated with the current server time.</span></span> <span data-ttu-id="539f6-170">在 firebug 這類，選擇 [主控台] 索引標籤，以便您可以檢查要求。</span><span class="sxs-lookup"><span data-stu-id="539f6-170">In FireBug, choose the Console tab so that you can examine the request.</span></span> <span data-ttu-id="539f6-171">第一次檢查 POST 要求參數：</span><span class="sxs-lookup"><span data-stu-id="539f6-171">Examine the POST request parameters first:</span></span>


[![](understanding-asp-net-ajax-updatepanel-triggers/_static/image5.png)](understanding-asp-net-ajax-updatepanel-triggers/_static/image4.png)

<span data-ttu-id="539f6-172">([按一下以檢視完整大小的影像](understanding-asp-net-ajax-updatepanel-triggers/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="539f6-172">([Click to view full-size image](understanding-asp-net-ajax-updatepanel-triggers/_static/image6.png))</span></span>


<span data-ttu-id="539f6-173">請注意，UpdatePanel 指出伺服器端 AJAX 程式碼的控制項樹狀結構精確地引發透過 ScriptManager1 參數：`Button1`的`UpdatePanel1`控制項。</span><span class="sxs-lookup"><span data-stu-id="539f6-173">Note that the UpdatePanel has indicated to the server-side AJAX code precisely which control tree was fired via the ScriptManager1 parameter: `Button1` of the `UpdatePanel1` control.</span></span> <span data-ttu-id="539f6-174">現在，按一下 更新同時面板按鈕。</span><span class="sxs-lookup"><span data-stu-id="539f6-174">Now, click on the Update Both Panels button.</span></span> <span data-ttu-id="539f6-175">接著，檢查回應，我們看到垂直線分隔一連串的字串; 字串中設定變數具體來說，我們會了解最上層的 UpdatePanel， `UpdatePanel1`，具有其 HTML 瀏覽器的全部內容。</span><span class="sxs-lookup"><span data-stu-id="539f6-175">Then, examining the response, we see a pipe-delimited series of variables set in a string; specifically, we see the top UpdatePanel, `UpdatePanel1`, has the entirety of its HTML sent to the browser.</span></span> <span data-ttu-id="539f6-176">AJAX 用戶端指令碼程式庫會替代 UpdatePanel 的原始的 HTML 內容，以透過新的內容`.innerHTML`屬性，並讓伺服器傳送 html 格式的伺服器已變更的內容。</span><span class="sxs-lookup"><span data-stu-id="539f6-176">The AJAX client script library substitutes the UpdatePanel's original HTML content with the new content via the `.innerHTML` property, and so the server sends the changed content from the server as HTML.</span></span>

<span data-ttu-id="539f6-177">現在，按一下 更新同時面板按鈕，並檢查結果，從伺服器。</span><span class="sxs-lookup"><span data-stu-id="539f6-177">Now, click on the Update Both Panels button and examine the results from the server.</span></span> <span data-ttu-id="539f6-178">會有非常類似的結果-這兩個 updatepanel 就從伺服器收到新的 HTML。</span><span class="sxs-lookup"><span data-stu-id="539f6-178">The results are very similar - both UpdatePanels receive new HTML from the server.</span></span> <span data-ttu-id="539f6-179">如同先前的回呼，會傳送其他的頁面狀態。</span><span class="sxs-lookup"><span data-stu-id="539f6-179">As with the previous callback, additional page state is sent.</span></span>

<span data-ttu-id="539f6-180">我們可以看到，因為沒有特殊的程式碼用來執行 AJAX 回傳，AJAX 用戶端指令碼程式庫便能攔截表單回傳，沒有任何額外的程式碼。</span><span class="sxs-lookup"><span data-stu-id="539f6-180">As we can see, because no special code is utilized to perform an AJAX postback, the AJAX client script library is able to intercept form postbacks without any additional code.</span></span> <span data-ttu-id="539f6-181">伺服器控制項自動使用 JavaScript，使它們不會自動送出表單-ASP.NET 自動會將程式碼的表單驗證和狀態，主要是透過自動指令碼資源包含 PostBackOptions 類別與 ClientScriptManager 類別。</span><span class="sxs-lookup"><span data-stu-id="539f6-181">Server controls automatically utilize JavaScript so that they do not automatically submit the form - ASP.NET automatically injects code for form validation and state already, primarily achieved by automatic script resource inclusion, the PostBackOptions class, and the ClientScriptManager class.</span></span>

<span data-ttu-id="539f6-182">例如，請考慮核取方塊控制項。檢查.NET 反映程式中的類別反組譯碼。</span><span class="sxs-lookup"><span data-stu-id="539f6-182">For instance, consider a CheckBox control; examine the class disassembly in .NET Reflector.</span></span> <span data-ttu-id="539f6-183">若要這樣做，請確定您 System.Web 組件已經開啟，並瀏覽至`System.Web.UI.WebControls.CheckBox`類別中，開啟`RenderInputTag`方法。</span><span class="sxs-lookup"><span data-stu-id="539f6-183">To do so, ensure that your System.Web assembly is open, and navigate to the `System.Web.UI.WebControls.CheckBox` class, opening the `RenderInputTag` method.</span></span> <span data-ttu-id="539f6-184">尋找檢查的條件`AutoPostBack`屬性：</span><span class="sxs-lookup"><span data-stu-id="539f6-184">Look for a conditional that checks the `AutoPostBack` property:</span></span>


[![](understanding-asp-net-ajax-updatepanel-triggers/_static/image8.png)](understanding-asp-net-ajax-updatepanel-triggers/_static/image7.png)

<span data-ttu-id="539f6-185">([按一下以檢視完整大小的影像](understanding-asp-net-ajax-updatepanel-triggers/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="539f6-185">([Click to view full-size image](understanding-asp-net-ajax-updatepanel-triggers/_static/image9.png))</span></span>


<span data-ttu-id="539f6-186">當已啟用自動回傳`CheckBox`控制 （透過 AutoPostBack 屬性為 true），結果`<input>`標記因此呈現使用 ASP.NET 事件處理中的指令碼其`onclick`屬性。</span><span class="sxs-lookup"><span data-stu-id="539f6-186">When automatic postback is enabled on a `CheckBox` control (via the AutoPostBack property being true), the resultant `<input>` tag is therefore rendered with an ASP.NET event handling script in its `onclick` attribute.</span></span> <span data-ttu-id="539f6-187">表單提交，然後，攔截允許 nonintrusively，無法插入至網頁的 ASP.NET AJAX 協助避免任何可能的重大變更，可能藉由使用可能是不精確的字串取代。</span><span class="sxs-lookup"><span data-stu-id="539f6-187">The interception of the form's submission, then, allows ASP.NET AJAX to be injected into the page nonintrusively, helping to avoid any potential breaking changes that might occur by utilizing a possibly-imprecise string replacement.</span></span> <span data-ttu-id="539f6-188">此外，這可讓*任何*自訂 ASP.NET 控制項，以運用 ASP.NET AJAX 沒有任何額外的程式碼以支援其使用 UpdatePanel 容器內。</span><span class="sxs-lookup"><span data-stu-id="539f6-188">Furthermore, this enables *any* custom ASP.NET control to utilize the power of ASP.NET AJAX without any additional code to support its use within an UpdatePanel container.</span></span>

<span data-ttu-id="539f6-189">`<triggers>`功能對應至 PageRequestManager 呼叫中初始化的值\_updateControls （ASP.NET AJAX 用戶端指令碼程式庫使用的慣例，該方法、 事件和欄位名稱開頭的附註以底線標示為內部，並不一定會用於程式庫本身以外使用）。</span><span class="sxs-lookup"><span data-stu-id="539f6-189">The `<triggers>` functionality corresponds to the values initialized in the PageRequestManager call to \_updateControls (note that the ASP.NET AJAX client script library utilizes the convention that methods, events, and field names that begin with an underscore are marked as internal, and are not meant for use outside of the library itself).</span></span> <span data-ttu-id="539f6-190">有了它，我們可以觀察哪些控制項要使 AJAX 回傳。</span><span class="sxs-lookup"><span data-stu-id="539f6-190">With it, we can observe which controls are intended to cause AJAX postbacks.</span></span>

<span data-ttu-id="539f6-191">比方說，我們將兩個其他控制項加入頁面上，完全，留下一個 updatepanel 就之外的控制項，並讓其中一個 UpdatePanel 內。</span><span class="sxs-lookup"><span data-stu-id="539f6-191">For example, let's add two additional controls to the page, leaving one control outside of the UpdatePanels entirely, and leaving one within an UpdatePanel.</span></span> <span data-ttu-id="539f6-192">我們會將核取方塊控制項上方 UpdatePanel 內拖放 DropDownList 清單內所定義的色彩數目。</span><span class="sxs-lookup"><span data-stu-id="539f6-192">We will add a CheckBox control within the upper UpdatePanel, and drop a DropDownList with a number of colors defined within the list.</span></span> <span data-ttu-id="539f6-193">以下是新標記：</span><span class="sxs-lookup"><span data-stu-id="539f6-193">Here is the new markup:</span></span>

<span data-ttu-id="539f6-194">**列出 3： 新增標記**</span><span class="sxs-lookup"><span data-stu-id="539f6-194">**Listing 3: New Markup**</span></span>

[!code-aspx[Main](understanding-asp-net-ajax-updatepanel-triggers/samples/sample3.aspx)]

<span data-ttu-id="539f6-195">此外，這裡有新程式碼後置：</span><span class="sxs-lookup"><span data-stu-id="539f6-195">And here is the new code-behind:</span></span>

<span data-ttu-id="539f6-196">**列出 4： 程式碼後置**</span><span class="sxs-lookup"><span data-stu-id="539f6-196">**Listing 4: Codebehind**</span></span>

[!code-csharp[Main](understanding-asp-net-ajax-updatepanel-triggers/samples/sample4.cs)]

<span data-ttu-id="539f6-197">此頁面背後的概念是下拉式清單選取一個三種色彩顯示第二個標籤的核取方塊決定是否為粗體，和標籤是否顯示日期和時間。</span><span class="sxs-lookup"><span data-stu-id="539f6-197">The idea behind this page is that the drop-down list selects one of three colors to show the second label, that the check box determines both whether it is bold, and whether the labels display the date as well as the time.</span></span> <span data-ttu-id="539f6-198">核取方塊不會造成 AJAX 更新，但應該下拉式清單，即使它不會儲存在 UpdatePanel 內。</span><span class="sxs-lookup"><span data-stu-id="539f6-198">The check box should not cause an AJAX update, but the drop-down list should, even though it is not housed within an UpdatePanel.</span></span>


[![](understanding-asp-net-ajax-updatepanel-triggers/_static/image11.png)](understanding-asp-net-ajax-updatepanel-triggers/_static/image10.png)

<span data-ttu-id="539f6-199">([按一下以檢視完整大小的影像](understanding-asp-net-ajax-updatepanel-triggers/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="539f6-199">([Click to view full-size image](understanding-asp-net-ajax-updatepanel-triggers/_static/image12.png))</span></span>


<span data-ttu-id="539f6-200">如同上面的螢幕擷取畫面呈現，最新的按鈕，按一下已更新此面板，更新前的時間無關的底部時間是右按鈕。</span><span class="sxs-lookup"><span data-stu-id="539f6-200">As is apparent in the above screen shot, the most-recent button to be clicked was the right button Update This Panel, which updated the top time independent of the bottom time.</span></span> <span data-ttu-id="539f6-201">日期已也關閉之間按下，因為日期是顯示在下方的標籤。</span><span class="sxs-lookup"><span data-stu-id="539f6-201">The date was also switched off between clicks, as the date is visible in the bottom label.</span></span> <span data-ttu-id="539f6-202">最後的優點是下方的標籤色彩： 比標籤的文字，示範控制項狀態，是重要的是，最近有更新，而且使用者預期會保留透過 AJAX 回傳。</span><span class="sxs-lookup"><span data-stu-id="539f6-202">Finally of interest is the bottom label's color: it was updated more recently than the label's text, which demonstrates that control state is important, and users expect it to be preserved through AJAX postbacks.</span></span> <span data-ttu-id="539f6-203">*不過*，未更新的時間。</span><span class="sxs-lookup"><span data-stu-id="539f6-203">*However*, the time was not updated.</span></span> <span data-ttu-id="539f6-204">時間會自動重新擴展，透過持續性的\_\_解譯 ASP.NET 執行階段時控制在伺服器上重新轉譯頁面的 VIEWSTATE 欄位。</span><span class="sxs-lookup"><span data-stu-id="539f6-204">The time was automatically repopulated through the persistence of the \_\_VIEWSTATE field of the page being interpreted by the ASP.NET runtime when the control was being re-rendered on the server.</span></span> <span data-ttu-id="539f6-205">ASP.NET AJAX 伺服器程式碼無法辨識方法控制項要在其中變更狀態;它只是重新填入從檢視狀態，並執行適當的事件。</span><span class="sxs-lookup"><span data-stu-id="539f6-205">The ASP.NET AJAX server code does not recognize in which methods the controls are changing state; it simply repopulates from view state and then runs the events that are appropriate.</span></span>

<span data-ttu-id="539f6-206">它應該要指出，不過，，有我初始化頁面內的時間\_載入事件的時間會有已正確地遞增。</span><span class="sxs-lookup"><span data-stu-id="539f6-206">It should be pointed out, however, that had I initialized the time within the Page\_Load event, the time would have been incremented correctly.</span></span> <span data-ttu-id="539f6-207">因此，開發人員應該小心在適當的事件處理常式中，執行適當的程式碼，並避免使用分頁\_控制項的事件處理常式會是適當時載入。</span><span class="sxs-lookup"><span data-stu-id="539f6-207">Consequently, developers should be wary that the appropriate code is being run during the appropriate event handlers, and avoid use of Page\_Load when a control event handler would be appropriate.</span></span>

## <a name="summary"></a><span data-ttu-id="539f6-208">總結</span><span class="sxs-lookup"><span data-stu-id="539f6-208">Summary</span></span>

<span data-ttu-id="539f6-209">ASP.NET AJAX 擴充功能 UpdatePanel 控制項的用途多，而且可以利用多種方法來識別應該會更新它的控制項事件。</span><span class="sxs-lookup"><span data-stu-id="539f6-209">The ASP.NET AJAX Extensions UpdatePanel control is versatile, and can utilize a number of methods for identifying control events that should cause it to be updated.</span></span> <span data-ttu-id="539f6-210">它支援正由它的子控制項的自動更新，但是也可以回應至其他位置在頁面上的控制項事件。</span><span class="sxs-lookup"><span data-stu-id="539f6-210">It supports being updated automatically by its child controls, but can also respond to control events elsewhere on the page.</span></span>

<span data-ttu-id="539f6-211">若要減少潛在的伺服器處理負載，建議`ChildrenAsTriggers`UpdatePanel 的屬性設定為`false`，而且會選擇執行而不是預設包含的事件。</span><span class="sxs-lookup"><span data-stu-id="539f6-211">To reduce potential for server processing load, it is recommended that the `ChildrenAsTriggers` property of an UpdatePanel be set to `false`, and that events be opted-into rather than included by default.</span></span> <span data-ttu-id="539f6-212">這也可防止任何不必要的事件造成潛在有害的效果，包括驗證和輸入欄位的變更。</span><span class="sxs-lookup"><span data-stu-id="539f6-212">This also prevents any unneeded events from causing potentially-unwanted effects, including validation, and changes to input fields.</span></span> <span data-ttu-id="539f6-213">這種錯誤可能會難以找出，因為頁面會以透明的方式更新使用者，而且可能的原因可能因此不會立即。</span><span class="sxs-lookup"><span data-stu-id="539f6-213">These types of bugs may be difficult to isolate, because the page updates transparently to the user, and the cause may therefore not be immediately obvious.</span></span>

<span data-ttu-id="539f6-214">藉由檢查 ASP.NET AJAX 表單的內部運作張貼攔截模型，我們無法判斷此案例使用所提供的 ASP.NET framework。</span><span class="sxs-lookup"><span data-stu-id="539f6-214">By examining the inner workings of the ASP.NET AJAX form post interception model, we were able to determine that it utilizes the framework already provided by ASP.NET.</span></span> <span data-ttu-id="539f6-215">在此情況下，它會保留最大的相容性與使用相同的架構設計的控制項，並干擾最少需任何額外的 JavaScript 頁面寫入。</span><span class="sxs-lookup"><span data-stu-id="539f6-215">In doing so, it preserves maximum compatibility with controls designed using the same framework, and intrudes minimally on any additional JavaScript written for the page.</span></span>

## <a name="bio"></a><span data-ttu-id="539f6-216">簡歷</span><span class="sxs-lookup"><span data-stu-id="539f6-216">Bio</span></span>

<span data-ttu-id="539f6-217">Rob Paveza 是資深的.NET 應用程式開發人員，在 Terralever ([www.terralever.com](http://www.terralever.com))，在 Tempe，AZ.前置的互動式行銷公司</span><span class="sxs-lookup"><span data-stu-id="539f6-217">Rob Paveza is a senior .NET application developer at Terralever ([www.terralever.com](http://www.terralever.com)), a leading interactive marketing firm in Tempe, AZ.</span></span> <span data-ttu-id="539f6-218">他可以在達到[ robpaveza@gmail.com ](mailto:robpaveza@gmail.com)，他的部落格位於[ http://geekswithblogs.net/robp/ ](http://geekswithblogs.net/robp/)。</span><span class="sxs-lookup"><span data-stu-id="539f6-218">He can be reached at [robpaveza@gmail.com](mailto:robpaveza@gmail.com), and his blog is located at [http://geekswithblogs.net/robp/](http://geekswithblogs.net/robp/).</span></span>

<span data-ttu-id="539f6-219">Scott 是否已從 1997 年使用 Microsoft Web 技術，且 myKB.com 總統 ([www.myKB.com](http://www.myKB.com)) 擅長撰寫 ASP.NET 架構的重點 Knowledge Base 軟體解決方案的應用程式。</span><span class="sxs-lookup"><span data-stu-id="539f6-219">Scott Cate has been working with Microsoft Web technologies since 1997 and is the President of myKB.com ([www.myKB.com](http://www.myKB.com)) where he specializes in writing ASP.NET based applications focused on Knowledge Base Software solutions.</span></span> <span data-ttu-id="539f6-220">透過在電子郵件，即可以聯繫 Scott [ scott.cate@myKB.com ](mailto:scott.cate@myKB.com)或在他的部落格[ScottCate.com](http://ScottCate.com)</span><span class="sxs-lookup"><span data-stu-id="539f6-220">Scott can be contacted via email at [scott.cate@myKB.com](mailto:scott.cate@myKB.com) or his blog at [ScottCate.com](http://ScottCate.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="539f6-221">[上一頁](understanding-partial-page-updates-with-asp-net-ajax.md)
> [下一頁](understanding-asp-net-ajax-authentication-and-profile-application-services.md)</span><span class="sxs-lookup"><span data-stu-id="539f6-221">[Previous](understanding-partial-page-updates-with-asp-net-ajax.md)
[Next](understanding-asp-net-ajax-authentication-and-profile-application-services.md)</span></span>
