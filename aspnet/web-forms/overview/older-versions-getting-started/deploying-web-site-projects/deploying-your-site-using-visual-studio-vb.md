---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/deploying-your-site-using-visual-studio-vb
title: 部署您使用 Visual Studio (VB) 的網站 |Microsoft 文件
author: rick-anderson
description: Visual Studio 包含工具部署網站。 深入了解這些工具在本教學課程。
ms.author: aspnetcontent
manager: wpickett
ms.date: 04/01/2009
ms.topic: article
ms.assetid: 977105f3-7987-4e50-8be7-afb53b4ca28a
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/deploying-your-site-using-visual-studio-vb
msc.type: authoredcontent
ms.openlocfilehash: 1c0e094761a92b10555d2cfcef586ad8c2fb8d27
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/06/2018
ms.locfileid: "30888873"
---
<a name="deploying-your-site-using-visual-studio-vb"></a><span data-ttu-id="6a8d5-104">部署您的網站使用 Visual Studio (VB)</span><span class="sxs-lookup"><span data-stu-id="6a8d5-104">Deploying Your Site Using Visual Studio (VB)</span></span>
====================
<span data-ttu-id="6a8d5-105">由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="6a8d5-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="6a8d5-106">[下載程式碼](http://download.microsoft.com/download/4/5/F/45F815EC-8B0E-46D3-9FB8-2DC015CCA306/ASPNET_Hosting_Tutorial_04_VB.zip)或[下載 PDF](http://download.microsoft.com/download/E/8/9/E8920AE6-D441-41A7-8A77-9EF8FF970D8B/aspnet_tutorial04_DeployingViaVS_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="6a8d5-106">[Download Code](http://download.microsoft.com/download/4/5/F/45F815EC-8B0E-46D3-9FB8-2DC015CCA306/ASPNET_Hosting_Tutorial_04_VB.zip) or [Download PDF](http://download.microsoft.com/download/E/8/9/E8920AE6-D441-41A7-8A77-9EF8FF970D8B/aspnet_tutorial04_DeployingViaVS_vb.pdf)</span></span>

> <span data-ttu-id="6a8d5-107">Visual Studio 包含工具部署網站。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-107">Visual Studio includes tools for deploying a website.</span></span> <span data-ttu-id="6a8d5-108">深入了解這些工具在本教學課程。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-108">Learn more about these tools in this tutorial.</span></span>


## <a name="introduction"></a><span data-ttu-id="6a8d5-109">簡介</span><span class="sxs-lookup"><span data-stu-id="6a8d5-109">Introduction</span></span>

<span data-ttu-id="6a8d5-110">前述教學課程探討了解如何部署簡單的 ASP.NET web 應用程式，到 web 主機提供者。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-110">The preceding tutorial looked at how to deploy a simple ASP.NET web application to a web host provider.</span></span> <span data-ttu-id="6a8d5-111">具體來說，本教學課程示範了如何使用像 FileZilla FTP 用戶端從開發環境的必要的檔案傳輸到生產環境。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-111">Specifically, the tutorial showed how to use an FTP client like FileZilla to transfer the necessary files from the development environment to the production environment.</span></span> <span data-ttu-id="6a8d5-112">Visual Studio 也提供內建的工具，以便部署到 web 主機提供者。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-112">Visual Studio also offers built-in tools to facilitate deployment to a web host provider.</span></span> <span data-ttu-id="6a8d5-113">本教學課程會檢查這些工具的兩個： 複製網站工具，與使用 FTP 或 FrontPage Server Extensions; 遠端網頁伺服器，可以移動檔案和 [發行] 工具，將整個網站複製到指定的位置。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-113">This tutorial examines two of these tools: the Copy Web Site tool, where you can move files to and from a remote web server using FTP or FrontPage Server Extensions; and the Publish tool, which copies the entire website to a specified location.</span></span>


> [!NOTE]
> <span data-ttu-id="6a8d5-114">Visual Studio 所提供其他部署相關的工具包括[Web 安裝專案](https://msdn.microsoft.com/library/wx3b589t.aspx)和[Web 部署專案](https://www.microsoft.com/downloads/details.aspx?FamilyId=0AA30AE8-C73B-4BDD-BB1B-FE697256C459&amp;displaylang=en)增益集。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-114">Other deployment-related tools offered by Visual Studio include [Web Setup Projects](https://msdn.microsoft.com/library/wx3b589t.aspx) and [Web Deployment Projects](https://www.microsoft.com/downloads/details.aspx?FamilyId=0AA30AE8-C73B-4BDD-BB1B-FE697256C459&amp;displaylang=en) Add-In.</span></span> <span data-ttu-id="6a8d5-115">Web 安裝專案封裝的網站內容與組態資訊成單一的 MSI 檔案。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-115">Web Setup Projects package a website's contents and configuration information into a single MSI file.</span></span> <span data-ttu-id="6a8d5-116">此選項便會在內部部署的網站或公司販售客戶安裝在他們自己的網頁伺服器的預先封裝的 web 應用程式的最有用的。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-116">This option is most useful for websites that are deployed within an intranet or for companies that sell a pre-packaged web application that customers install on their own web servers.</span></span> <span data-ttu-id="6a8d5-117">Web 部署專案增益集是 Visual Studio 增益集，可促進差異指定組態建置開發環境和生產環境。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-117">The Web Deployment Projects Add-In is a Visual Studio Add-In that facilitates specifying configuration differences between builds for development environments and production environments.</span></span> <span data-ttu-id="6a8d5-118">本教學課程系列; 將不會討論 web 安裝專案Web 部署專案會摘要在[*通用組態差異之間開發和生產*](common-configuration-differences-between-development-and-production-vb.md)教學課程。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-118">Web Setup Projects are not discussed in this tutorial series; Web Deployment Projects are summarized in the [*Common Configuration Differences Between Development and Production*](common-configuration-differences-between-development-and-production-vb.md) tutorial.</span></span>


## <a name="deploying-your-site-using-the-copy-web-site-tool"></a><span data-ttu-id="6a8d5-119">部署您的網站使用複製網站工具</span><span class="sxs-lookup"><span data-stu-id="6a8d5-119">Deploying Your Site Using the Copy Web Site Tool</span></span>

<span data-ttu-id="6a8d5-120">Visual Studio 複製網站工具是獨立的 FTP 用戶端類似的功能。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-120">Visual Studio's Copy Web Site tool is similar in functionality to a stand-alone FTP client.</span></span> <span data-ttu-id="6a8d5-121">簡而言之，複製網站工具可讓您連線到遠端的網站，透過 FTP 或 FrontPage Server Extensions。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-121">In a nutshell, the Copy Web Site tool allows you to connect to a remote web site through FTP or FrontPage Server Extensions.</span></span> <span data-ttu-id="6a8d5-122">類似於 FileZilla 的使用者介面，複製網站使用者介面包含兩個窗格： 左的窗格會列出本機檔案，而右窗格會列出目的地伺服器上的這些檔案。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-122">Similar to FileZilla's user interface, the Copy Web Site user interface consists of two panes: the left pane lists the local files while the right pane lists those files on the destination server.</span></span>

> [!NOTE]
> <span data-ttu-id="6a8d5-123">複製網站工具僅適用於網站專案。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-123">The Copy Web Site tool is only available for Web Site Projects.</span></span> <span data-ttu-id="6a8d5-124">當您使用 Web 應用程式專案與 visual Studio 的確有提供這項工具。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-124">Visual Studio does offer this tool when you are working with a Web Application Project.</span></span>


<span data-ttu-id="6a8d5-125">讓我們看看書籍檢閱應用程式發行至生產環境使用複製網站工具。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-125">Let's take a look at using the Copy Web Site tool to publish the Book Review application to production.</span></span> <span data-ttu-id="6a8d5-126">複製網站工具只能搭配使用的網站專案模型專案，因為我們只可以檢查與 BookReviewsWSP 專案中使用此工具。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-126">Because the Copy Web Site tool only works with projects that use the Web Site Project model we can only examine using this tool with the BookReviewsWSP project.</span></span> <span data-ttu-id="6a8d5-127">開啟該專案。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-127">Open that project.</span></span>

<span data-ttu-id="6a8d5-128">在 方案總管 （圖 1 中所會圈出此圖示）; 複製網站圖示，即可啟動複製網站工具專案或者，您也可以從 網站 功能表中選取複製網站選項。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-128">Launch the Copy Web Site tool project by clicking the Copy Web Site icon in the Solution Explorer (this icon is circled in Figure 1); alternatively, you can select the Copy Web Site option from the Website menu.</span></span> <span data-ttu-id="6a8d5-129">兩種方法啟動圖 1; 複製網站使用者介面因為我們尚未連線到遠端伺服器，就會擴展的左的窗格中圖 1。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-129">Either approach launches the Copy Web Site user interface shown in Figure 1; only the left pane in Figure 1 is populated because we have yet to connect to a remote server.</span></span>


<span data-ttu-id="6a8d5-130">[![複製網站工具使用者介面是分割成兩個窗格](deploying-your-site-using-visual-studio-vb/_static/image2.png)](deploying-your-site-using-visual-studio-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="6a8d5-130">[![The Copy Web Site Tool's User Interface is Divided Into Two Panes](deploying-your-site-using-visual-studio-vb/_static/image2.png)](deploying-your-site-using-visual-studio-vb/_static/image1.png)</span></span>

<span data-ttu-id="6a8d5-131">**圖 1**： 複製網站工具的使用者介面是分割成兩個窗格 ([按一下以檢視完整大小的影像](deploying-your-site-using-visual-studio-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="6a8d5-131">**Figure 1**: The Copy Web Site Tool's User Interface is Divided Into Two Panes ([Click to view full-size image](deploying-your-site-using-visual-studio-vb/_static/image3.png))</span></span>


<span data-ttu-id="6a8d5-132">若要部署 「 我們需要先連線到 web 主機提供者的網站。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-132">In order to deploy our site we need to first connect to the web host provider.</span></span> <span data-ttu-id="6a8d5-133">按一下 [連接] 按鈕複製網站使用者介面的頂端。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-133">Click the Connect button at the top of the Copy Web Site user interface.</span></span> <span data-ttu-id="6a8d5-134">這會顯示開啟網站對話方塊中，在圖 2 所示。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-134">This displays the Open Web Site dialog box shown in Figure 2.</span></span>

<span data-ttu-id="6a8d5-135">您可以連接至目的地網站，從左側選取四個選項的其中一個：</span><span class="sxs-lookup"><span data-stu-id="6a8d5-135">You can connect to the destination website by selecting one of the four options from the left:</span></span>

- <span data-ttu-id="6a8d5-136">**檔案系統**-選取此選項可從您的電腦，將您的網站部署到可存取的資料夾或網路共用。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-136">**File System** - select this to deploy your site to a folder or network share accessible from your computer.</span></span>
- <span data-ttu-id="6a8d5-137">**本機 IIS** -使用此選項可將網站部署至電腦上安裝 IIS web 伺服器。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-137">**Local IIS** - use this option to deploy the site to the IIS web server installed on your computer.</span></span>
- <span data-ttu-id="6a8d5-138">**FTP 站台**-連線到遠端網站上，使用 FTP。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-138">**FTP Site** - connect to a remote web site using FTP.</span></span>
- <span data-ttu-id="6a8d5-139">**遠端站台**-連線到遠端網站，使用 FrontPage Server Extensions。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-139">**Remote Site** - connect to a remote website using FrontPage Server Extensions.</span></span>

<span data-ttu-id="6a8d5-140">大部分 web 主機提供者支援 FTP，但更少提供的 FrontPage Server Extension 支援。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-140">Most web host providers support FTP, but fewer offer FrontPage Server Extension support.</span></span> <span data-ttu-id="6a8d5-141">因此，我選擇 FTP 站台選項並在圖 2 所示，然後輸入連接資訊。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-141">For that reason, I've selected the FTP Site option and then entered the connection information as shown in Figure 2.</span></span>


<span data-ttu-id="6a8d5-142">[![指定目的地網站](deploying-your-site-using-visual-studio-vb/_static/image5.png)](deploying-your-site-using-visual-studio-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="6a8d5-142">[![Specify the Destination Website](deploying-your-site-using-visual-studio-vb/_static/image5.png)](deploying-your-site-using-visual-studio-vb/_static/image4.png)</span></span>

<span data-ttu-id="6a8d5-143">**圖 2**： 指定目的地網站 ([按一下以檢視完整大小的影像](deploying-your-site-using-visual-studio-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="6a8d5-143">**Figure 2**: Specify the Destination Website ([Click to view full-size image](deploying-your-site-using-visual-studio-vb/_static/image6.png))</span></span>


<span data-ttu-id="6a8d5-144">您連接之後，複製網站工具載入在右窗格中的遠端站台的檔案，並指出每個檔案的狀態： 新增、 刪除、 已變更或未變更。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-144">After you connect, the Copy Web Site tool loads the files at the remote site in the right pane and indicates the status of each file: New, Deleted, Changed, or Unchanged.</span></span> <span data-ttu-id="6a8d5-145">您可以從本機站台檔案複製到遠端站台或相反的。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-145">You can copy a file from the local site to the remote site, or vice-a-versa.</span></span>

<span data-ttu-id="6a8d5-146">讓我們加入一個新頁面，即可 BookReviewsWSP 專案，然後加以部署，我們可以看到在動作中的複製網站工具。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-146">Let's add a new page to the BookReviewsWSP project and then deploy it so that we can see the Copy Web Site tool in action.</span></span> <span data-ttu-id="6a8d5-147">Visual Studio 中建立新的 ASP.NET 網頁，名為的根目錄中`Privacy.aspx`。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-147">Create a new ASP.NET page in Visual Studio in the root directory named `Privacy.aspx`.</span></span> <span data-ttu-id="6a8d5-148">已使用主版頁面的頁面`Site.master`並將站台的隱私權原則加入至這個頁面。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-148">Have the page use the master page `Site.master` and add your site's privacy policy to this page.</span></span> <span data-ttu-id="6a8d5-149">圖 3 顯示 Visual Studio，建立此頁面之後。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-149">Figure 3 shows Visual Studio after this page has been created.</span></span>


<span data-ttu-id="6a8d5-150">[![加入新的頁面名稱為&lt;程式碼&gt;Privacy.aspx&lt;/c o&gt;到網站的根資料夾](deploying-your-site-using-visual-studio-vb/_static/image8.png)](deploying-your-site-using-visual-studio-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="6a8d5-150">[![Add a New Page Named &lt;code&gt;Privacy.aspx&lt;/code&gt; to the Website's Root Folder](deploying-your-site-using-visual-studio-vb/_static/image8.png)](deploying-your-site-using-visual-studio-vb/_static/image7.png)</span></span>

<span data-ttu-id="6a8d5-151">**圖 3**： 加入新的頁面名稱為`Privacy.aspx`到網站的根資料夾 ([按一下以檢視完整大小的影像](deploying-your-site-using-visual-studio-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="6a8d5-151">**Figure 3**: Add a New Page Named `Privacy.aspx` to the Website's Root Folder ([Click to view full-size image](deploying-your-site-using-visual-studio-vb/_static/image9.png))</span></span>


<span data-ttu-id="6a8d5-152">接下來，返回複製網站使用者介面。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-152">Next, return to the Copy Web Site user interface.</span></span> <span data-ttu-id="6a8d5-153">如圖 4 所示，左的窗格現在會包含新的檔案-`Policy.aspx`和`Policy.aspx.vb`。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-153">As Figure 4 shows, the left pane now includes the new files - `Policy.aspx` and `Policy.aspx.vb`.</span></span> <span data-ttu-id="6a8d5-154">除此之外，這些檔案會以箭號圖示及標示狀態的新密碼，指出存在本機站台上，但不是能在遠端站台。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-154">What's more, these files are marked with an arrow icon and a Status of New, indicating that they exist on the local site but not on the remote site.</span></span>


<span data-ttu-id="6a8d5-155">[![複製網站工具包含 新增&lt;程式碼&gt;Privacy.aspx&lt;/c o&gt;其左窗格中的頁面](deploying-your-site-using-visual-studio-vb/_static/image11.png)](deploying-your-site-using-visual-studio-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="6a8d5-155">[![The Copy Web Site Tool Includes the New &lt;code&gt;Privacy.aspx&lt;/code&gt; Page in its Left Pane](deploying-your-site-using-visual-studio-vb/_static/image11.png)](deploying-your-site-using-visual-studio-vb/_static/image10.png)</span></span>

<span data-ttu-id="6a8d5-156">**圖 4**： 複製網站工具包含 新增`Privacy.aspx`其左窗格中的頁面 ([按一下以檢視完整大小的影像](deploying-your-site-using-visual-studio-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="6a8d5-156">**Figure 4**: The Copy Web Site Tool Includes the New `Privacy.aspx` Page in its Left Pane ([Click to view full-size image](deploying-your-site-using-visual-studio-vb/_static/image12.png))</span></span>


<span data-ttu-id="6a8d5-157">若要部署新的檔案選取它們，然後按一下 將它們傳送到遠端站台的箭號圖示。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-157">To deploy the new files select them and then click the arrow icon to transfer them to the remote site.</span></span> <span data-ttu-id="6a8d5-158">傳輸完成後`Policy.aspx`和`Policy.aspx.vb`狀態未變更本機和遠端網站上的檔案存在。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-158">After the transfer completes the `Policy.aspx` and `Policy.aspx.vb` files exist on both the local and remote sites with the status Unchanged.</span></span>

<span data-ttu-id="6a8d5-159">列出新的檔案，以及複製網站工具會反白顯示不同的本機和遠端站台之間的任何檔案。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-159">Along with listing new files, the Copy Web Site tool highlights any files that differ between the local and remote sites.</span></span> <span data-ttu-id="6a8d5-160">若要查看此作業如何，傳回到`Privacy.aspx`頁面上，並將幾個的多個字加入至隱私權原則。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-160">To see this in action, return to the `Privacy.aspx` page and add a few more words to the privacy policy.</span></span> <span data-ttu-id="6a8d5-161">儲存網頁，然後返回複製網站工具。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-161">Save the page and then return to the Copy Web Site tool.</span></span> <span data-ttu-id="6a8d5-162">如圖 5 所示，`Privacy.aspx`頁面的左窗格中具有的狀態已變更，指出它與遠端站台同步處理。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-162">As Figure 5 shows, the `Privacy.aspx` page in the left pane has a status of Changed indicating that it is out of sync with the remote site.</span></span>


<span data-ttu-id="6a8d5-163">[![複製網站工具表示&lt;程式碼&gt;Privacy.aspx&lt;/c o&gt;頁面已變更](deploying-your-site-using-visual-studio-vb/_static/image14.png)](deploying-your-site-using-visual-studio-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="6a8d5-163">[![The Copy Web Site Tool Indicates that the &lt;code&gt;Privacy.aspx&lt;/code&gt; Page has been Changed](deploying-your-site-using-visual-studio-vb/_static/image14.png)](deploying-your-site-using-visual-studio-vb/_static/image13.png)</span></span>

<span data-ttu-id="6a8d5-164">**圖 5**： 複製網站工具表示`Privacy.aspx`頁面已變更 ([按一下以檢視完整大小的影像](deploying-your-site-using-visual-studio-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="6a8d5-164">**Figure 5**: The Copy Web Site Tool Indicates that the `Privacy.aspx` Page has been Changed ([Click to view full-size image](deploying-your-site-using-visual-studio-vb/_static/image15.png))</span></span>


<span data-ttu-id="6a8d5-165">複製網站工具也會指出，是否檔案已刪除最後一個複製作業之後的位置。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-165">The Copy Web Site tool also indicates if a file has been deleted since the last copy operation.</span></span> <span data-ttu-id="6a8d5-166">刪除`Privacy.aspx`從本機專案和重新整理複製網站工具。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-166">Delete the `Privacy.aspx` from the local project and refresh the Copy Web Site tool.</span></span> <span data-ttu-id="6a8d5-167">`Privacy.aspx`和`Privacy.aspx.vb`檔案仍列出在左窗格中，但已刪除狀態，表示它們已在上次複製作業之後已經移除。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-167">The `Privacy.aspx` and `Privacy.aspx.vb` files remain listed in the left pane, but have a Deleted status indicating that they have been removed since the last copy operation.</span></span>

## <a name="publishing-a-web-application"></a><span data-ttu-id="6a8d5-168">發行 Web 應用程式</span><span class="sxs-lookup"><span data-stu-id="6a8d5-168">Publishing a Web Application</span></span>

<span data-ttu-id="6a8d5-169">部署 web 應用程式從 Visual Studio 中的另一種方式是使用 [發佈] 選項，可透過 [建置] 功能表存取。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-169">Another way to deploy your web application from within Visual Studio is to use the Publish option, which is accessible via the Build menu.</span></span> <span data-ttu-id="6a8d5-170">[發佈] 選項明確地編譯的應用程式，，然後將複製的所有必要的檔案到指定的遠端站台。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-170">The Publish option explicitly compiles the application and then copies all of the necessary files up to the specified remote site.</span></span> <span data-ttu-id="6a8d5-171">我們會看到，[發佈] 選項會比複製網站工具更遲鈍。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-171">As we'll see shortly, the Publish option is more blunt than the Copy Web Site tool.</span></span> <span data-ttu-id="6a8d5-172">複製網站工具可讓您檢查本機和遠端網站上的檔案，並允許您將上傳或下載個別的檔案，視需要而 [發佈] 選項會將整個 web 應用程式部署。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-172">Whereas the Copy Web Site tool lets you examine the files on the local and remote sites and permits you to upload or download individual files as needed, the Publish option deploys the entire web application.</span></span>


<span data-ttu-id="6a8d5-173">將所有必要的檔案複製到指定的遠端站台，除了 [發佈] 選項也會明確編譯應用程式。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-173">In addition to copying all of the needed files to the specified remote site, the Publish option also explicitly compiles the application.</span></span> <span data-ttu-id="6a8d5-174">假設 Web 應用程式專案需要明確編譯應該就不會對 [發佈] 選項僅適用於 Web 應用程式專案。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-174">Given that Web Application Projects need to be explicitly compiled it should come as no surprise that the Publish option is available for Web Application Projects.</span></span> <span data-ttu-id="6a8d5-175">可能有點令人意外是 [發佈] 選項也會提供適用於網站專案。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-175">What may be a bit surprising is that the Publish option is also available for Web Site Projects.</span></span> <span data-ttu-id="6a8d5-176">如中所述[*決定需要的檔案部署*](determining-what-files-need-to-be-deployed-vb.md)教學課程中，網站專案可以透過稱為程序明確編譯*先行編譯*。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-176">As noted in the [*Determining What Files Need to Be Deployed*](determining-what-files-need-to-be-deployed-vb.md) tutorial, Web Site Projects can be explicitly compiled through a process referred to as *pre-compilation*.</span></span> <span data-ttu-id="6a8d5-177">本教學課程著重於使用 [發佈] 選項與 Web 應用程式專案。未來的教學課程將探索先行編譯，此時，我們將傳回查看網站專案中使用 [發佈] 選項。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-177">This tutorial focuses on using the Publish option with Web Application Projects; a future tutorial will explore pre-compilation, at which point we'll return to look at using the Publish option with Web Site Projects.</span></span>

> [!NOTE]
> <span data-ttu-id="6a8d5-178">網站專案和 Web 應用程式專案的 Visual Studio 中提供 [發佈] 選項時，Visual Web Developer 只提供 Web 應用程式專案的 [發佈] 選項。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-178">While the Publish option is available in Visual Studio for both Web Site Projects and Web Application Projects, Visual Web Developer only offers the Publish option for Web Application Projects.</span></span>


<span data-ttu-id="6a8d5-179">讓我們看看部署活頁簿檢閱應用程式使用 [發佈] 選項。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-179">Let's look at deploying the Book Reviews application using the Publish option.</span></span> <span data-ttu-id="6a8d5-180">啟動 Visual Studio 中開啟 BookReviewsWAP （Web 應用程式專案）。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-180">Start by opening BookReviewsWAP (the Web Application Project) in Visual Studio.</span></span> <span data-ttu-id="6a8d5-181">從 發行 功能表選擇 建置 BookReviewsWAP 專案。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-181">From the Publish menu choose the Build BookReviewsWAP project.</span></span> <span data-ttu-id="6a8d5-182">這會顯示對話方塊提示輸入目標位置，（請參閱圖 6） 其他組態選項。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-182">This brings up a dialog box that prompts for the target location, among other configuration options (see Figure 6).</span></span> <span data-ttu-id="6a8d5-183">更像是複製網站工具與您可以輸入本機資料夾、 本機 IIS 網站、 支援 FrontPage Server Extensions 或 FTP 伺服器位址的遠端網站會指向的位置。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-183">Much like with the Copy Web Site tool you can enter a location that points to a local folder, a local website on IIS, a remote website that supports FrontPage Server Extensions, or an FTP server address.</span></span> <span data-ttu-id="6a8d5-184">您可以選擇是否已部署的檔案中取代遠端 web 伺服器上的檔案，或刪除所有的發行前位於遠端站台內容。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-184">You can choose whether to replace the files on the remote web server with the deployed files or to delete all of the content on the remote site before publishing.</span></span> <span data-ttu-id="6a8d5-185">您也可以指定是否要複製：</span><span class="sxs-lookup"><span data-stu-id="6a8d5-185">You can also specify whether to copy:</span></span>

- <span data-ttu-id="6a8d5-186">只有執行應用程式，會省略不必要的程式碼與專案相關的檔案所需的專案中檔案。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-186">Only the files in the project needed to run the application, which omits the unneeded source code and project-related files.</span></span>
- <span data-ttu-id="6a8d5-187">所有專案檔，其中包括原始程式碼檔和 Visual Studio 專案檔，都例如方案檔。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-187">All project files, which includes the source code files and Visual Studio project files like the Solution file.</span></span>
- <span data-ttu-id="6a8d5-188">來源專案資料夾，不論它們是否包含在專案中的來源專案資料夾中複製所有檔案中的所有檔案。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-188">All files in the source project folder, which copies all files in the source project folder regardless of whether they're included in the project.</span></span>

<span data-ttu-id="6a8d5-189">另外還有一個選項來上傳的內容`App_Data`資料夾。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-189">There's also an option to upload the contents of the `App_Data` folder.</span></span>


<span data-ttu-id="6a8d5-190">[![指定目的地網站](deploying-your-site-using-visual-studio-vb/_static/image17.png)](deploying-your-site-using-visual-studio-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="6a8d5-190">[![Specify the Destination Website](deploying-your-site-using-visual-studio-vb/_static/image17.png)](deploying-your-site-using-visual-studio-vb/_static/image16.png)</span></span>

<span data-ttu-id="6a8d5-191">**圖 6**： 指定目的地網站 ([按一下以檢視完整大小的影像](deploying-your-site-using-visual-studio-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="6a8d5-191">**Figure 6**: Specify the Destination Website ([Click to view full-size image](deploying-your-site-using-visual-studio-vb/_static/image18.png))</span></span>


<span data-ttu-id="6a8d5-192">活頁簿檢閱應用程式的遠端站台包含複製 BookReviewsWSP 專案透過複製網站工具時部署檔案。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-192">For the Book Review application the remote site contains the files deployed when copying the BookReviewsWSP project via the Copy Web Site tool.</span></span> <span data-ttu-id="6a8d5-193">因此，我們必須先刪除所有現有內容的 [發佈] 選項。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-193">Therefore, let's have the Publish option start by deleting all existing content.</span></span> <span data-ttu-id="6a8d5-194">此外，我們只複製必要的檔案，而不是使用不需要的原始程式碼和專案檔想堆在實際執行環境。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-194">Also, let's just copy the necessary files rather than cluttering the production environment with unneeded source code and project files.</span></span> <span data-ttu-id="6a8d5-195">指定這些選項後，按一下 [發行] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-195">After specifying these options, click the Publish button.</span></span> <span data-ttu-id="6a8d5-196">接下來的幾秒透過 Visual Studio 會將部署必要的檔案到目的地網站中，在 [輸出] 視窗中顯示其進度。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-196">Over the next several seconds Visual Studio will deploy the necessary files to the destination site, displaying its progress in the Output window.</span></span>

<span data-ttu-id="6a8d5-197">發行作業完成之後，圖 7 顯示 FTP 站台上的檔案。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-197">Figure 7 shows the files on the FTP site after the Publish operation has completed.</span></span> <span data-ttu-id="6a8d5-198">請注意，只有標記頁面和需要伺服器端和用戶端的支援檔案已上傳。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-198">Note that only the markup pages and the necessary sever- and client-side support files have been uploaded.</span></span>


<span data-ttu-id="6a8d5-199">[![只有所需的檔案發行到生產環境](deploying-your-site-using-visual-studio-vb/_static/image20.png)](deploying-your-site-using-visual-studio-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="6a8d5-199">[![Only the Needed Files Were Published to the Production Environment](deploying-your-site-using-visual-studio-vb/_static/image20.png)](deploying-your-site-using-visual-studio-vb/_static/image19.png)</span></span>

<span data-ttu-id="6a8d5-200">**圖 7**： 只需要檔案發行到實際執行環境 ([按一下以檢視完整大小的影像](deploying-your-site-using-visual-studio-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="6a8d5-200">**Figure 7**: Only the Needed Files Were Published to the Production Environment ([Click to view full-size image](deploying-your-site-using-visual-studio-vb/_static/image21.png))</span></span>


<span data-ttu-id="6a8d5-201">[發佈] 選項是比複製網站工具較不 nuanced 的工具。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-201">The Publish option is a less nuanced tool than the Copy Web Site tool.</span></span> <span data-ttu-id="6a8d5-202">複製網站工具可讓您檢查本機和遠端網站上的檔案，並查看有何不同，而 [發佈] 選項會提供任何這類介面。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-202">Whereas the Copy Web Site tool allows you to inspect the files on the local and remote sites and see how they differ, the Publish option provides no such interface.</span></span> <span data-ttu-id="6a8d5-203">此外，複製網站工具可讓您進行一次性變更上傳或刪除個別檔案。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-203">Moreover, the Copy Web Site tool enables you to make one-off changes, uploading or deleting individual files.</span></span> <span data-ttu-id="6a8d5-204">[發佈] 選項不允許這類更細微的控制。相反地，其所發行*整個*應用程式。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-204">The Publish option does not allow such fine-grained control; instead, it publishes the *entire* application.</span></span> <span data-ttu-id="6a8d5-205">這種行為有其優缺點。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-205">This behavior has its pros and cons.</span></span> <span data-ttu-id="6a8d5-206">在加上端中，您知道使用 [發佈] 選項不會忘了重要的檔案上傳時。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-206">On the plus side, you know when using the Publish option you won't be forgetting to upload an important file.</span></span> <span data-ttu-id="6a8d5-207">但是，是否小幅變更對非常大型的網站的 [發佈] 選項無法更新該頁面或兩個已修改，但改為必須等候時，Visual Studio 部署在整個站台，會發生什麼情況。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-207">But consider what happens if you have made a small change to a very large website - with the Publish option you cannot update that page or two that has been modified, but instead you must wait while Visual Studio deploys the entire site.</span></span>

<span data-ttu-id="6a8d5-208">是很常見，才會實際執行環境和開發環境不同內容的某些檔案的位置。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-208">It's not uncommon for there to be certain files whose content differs between the production and development environments.</span></span> <span data-ttu-id="6a8d5-209">索引鍵的範例是應用程式的組態檔， `Web.config`。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-209">A key example is the application's configuration file, `Web.config`.</span></span> <span data-ttu-id="6a8d5-210">[發佈] 選項盲目 web 應用程式會將檔案複製，因為它以覆寫實際執行環境的自訂的設定檔開發環境中的版本。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-210">Because the Publish option blindly copies the web application files it overwrites the production environment's customized configuration files with the version in the development environment.</span></span> <span data-ttu-id="6a8d5-211">後續的教學課程-本主題將進一步探索，並提供部署 web 應用程式，這類差異存在時的秘訣。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-211">The subsequent tutorial explores this topic further and offers tips for deploying a web application when such differences exist.</span></span>

## <a name="summary"></a><span data-ttu-id="6a8d5-212">總結</span><span class="sxs-lookup"><span data-stu-id="6a8d5-212">Summary</span></span>

<span data-ttu-id="6a8d5-213">部署網站時，需要從開發環境的必要檔案複製到實際執行環境。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-213">Deploying a website involves copying the necessary files from the development environment to the production environment.</span></span> <span data-ttu-id="6a8d5-214">上一個教學課程示範了如何使用像 FileZilla FTP 用戶端傳送檔案。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-214">The previous tutorial showed how to transfer files using an FTP client like FileZilla.</span></span> <span data-ttu-id="6a8d5-215">本教學課程中檢查兩個 Visual Studio 中的部署工具： 複製網站工具和 [發佈] 選項。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-215">This tutorial examined two deployment tools in Visual Studio: the Copy Web Site tool and the Publish option.</span></span> <span data-ttu-id="6a8d5-216">複製網站工具是類似於 FTP 用戶端有兩個 paned 介面，列出本機電腦和指定的遠端電腦，以簡化上傳或下載檔案，將兩台電腦上的檔案。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-216">The Copy Web Site tool is similar to an FTP client in that it has a two-paned interface listing the files on the local computer and a specified remote computer that makes it easy to upload or download files between the two computers.</span></span> <span data-ttu-id="6a8d5-217">[發佈] 選項是更遲鈍工具明確編譯專案，然後再部署到指定的目的地整個應用程式。</span><span class="sxs-lookup"><span data-stu-id="6a8d5-217">The Publish option is a more blunt tool that explicitly compiles the project and then deploys the entire application to the specified destination.</span></span>

<span data-ttu-id="6a8d5-218">祝您程式設計 ！</span><span class="sxs-lookup"><span data-stu-id="6a8d5-218">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="6a8d5-219">進一步閱讀</span><span class="sxs-lookup"><span data-stu-id="6a8d5-219">Further Reading</span></span>

<span data-ttu-id="6a8d5-220">如需有關在本教學課程所討論的主題的詳細資訊，請參閱下列資源：</span><span class="sxs-lookup"><span data-stu-id="6a8d5-220">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="6a8d5-221">複製網站複製網站工具</span><span class="sxs-lookup"><span data-stu-id="6a8d5-221">Copying Web Site with the Copy Web Site Tool</span></span>](https://msdn.microsoft.com/library/1cc82atw.aspx)
- <span data-ttu-id="6a8d5-222">[I： 如何部署網站使用複製網站工具](../../../videos/how-do-i/how-do-i-deploy-a-web-site-using-the-copy-web-site-tool.md)（影片）</span><span class="sxs-lookup"><span data-stu-id="6a8d5-222">[How Do I: Deploy a Web Site Using the Copy Web Site Tool](../../../videos/how-do-i/how-do-i-deploy-a-web-site-using-the-copy-web-site-tool.md) (Video)</span></span>
- [<span data-ttu-id="6a8d5-223">如何： 發行 Web 應用程式專案</span><span class="sxs-lookup"><span data-stu-id="6a8d5-223">How To: Publish Web Application Projects</span></span>](https://msdn.microsoft.com/library/aa983453.aspx)
- [<span data-ttu-id="6a8d5-224">如何： 發行網站</span><span class="sxs-lookup"><span data-stu-id="6a8d5-224">How To: Publish Web Sites</span></span>](https://msdn.microsoft.com/library/20yh9f1b.aspx)
- [<span data-ttu-id="6a8d5-225">安裝和部署專案，Visual Studio 中</span><span class="sxs-lookup"><span data-stu-id="6a8d5-225">Setup and Deployment Projects in Visual Studio</span></span>](https://msdn.microsoft.com/library/wx3b589t.aspx)

> [!div class="step-by-step"]
> <span data-ttu-id="6a8d5-226">[上一頁](deploying-your-site-using-an-ftp-client-vb.md)
> [下一頁](common-configuration-differences-between-development-and-production-vb.md)</span><span class="sxs-lookup"><span data-stu-id="6a8d5-226">[Previous](deploying-your-site-using-an-ftp-client-vb.md)
[Next](common-configuration-differences-between-development-and-production-vb.md)</span></span>
