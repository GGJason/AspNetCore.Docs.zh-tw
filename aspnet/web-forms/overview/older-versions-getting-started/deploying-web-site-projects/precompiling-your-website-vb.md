---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/precompiling-your-website-vb
title: 先行編譯您的網站 (VB) |Microsoft 文件
author: rick-anderson
description: Visual Studio 可 ASP.NET 開發人員提供兩種專案類型： Web 應用程式專案 (WAPs) 及網站專案 (WSPs)。 其中一個主要差異 betwe...
ms.author: aspnetcontent
manager: wpickett
ms.date: 06/09/2009
ms.topic: article
ms.assetid: c285dc6f-a1c6-46e6-ac03-3830947f57e3
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/precompiling-your-website-vb
msc.type: authoredcontent
ms.openlocfilehash: 7296808480fa48b4afd0b308cd27707378519747
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/06/2018
ms.locfileid: "30889952"
---
<a name="precompiling-your-website-vb"></a><span data-ttu-id="8fc48-104">先行編譯您的網站 (VB)</span><span class="sxs-lookup"><span data-stu-id="8fc48-104">Precompiling Your Website (VB)</span></span>
====================
<span data-ttu-id="8fc48-105">由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="8fc48-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="8fc48-106">[下載程式碼](http://download.microsoft.com/download/1/0/C/10CC829F-A808-4302-97D3-59989B8F9C01/ASPNET_Hosting_Tutorial_15_VB.zip)或[下載 PDF](http://download.microsoft.com/download/5/C/5/5C57DB8C-5DEA-4B3A-92CA-4405544D313B/aspnet_tutorial15_Precompiling_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="8fc48-106">[Download Code](http://download.microsoft.com/download/1/0/C/10CC829F-A808-4302-97D3-59989B8F9C01/ASPNET_Hosting_Tutorial_15_VB.zip) or [Download PDF](http://download.microsoft.com/download/5/C/5/5C57DB8C-5DEA-4B3A-92CA-4405544D313B/aspnet_tutorial15_Precompiling_vb.pdf)</span></span>

> <span data-ttu-id="8fc48-107">Visual Studio 可 ASP.NET 開發人員提供兩種專案類型： Web 應用程式專案 (WAPs) 及網站專案 (WSPs)。</span><span class="sxs-lookup"><span data-stu-id="8fc48-107">Visual Studio offers ASP.NET developers two types of projects: Web Application Projects (WAPs) and Web Site Projects (WSPs).</span></span> <span data-ttu-id="8fc48-108">其中的兩個專案類型之間的主要差異是 WAPs 必須明確地部署之前，先編譯而 WSP 中的程式碼可以在 web 伺服器上自動編譯的程式碼。</span><span class="sxs-lookup"><span data-stu-id="8fc48-108">One of the key differences between the two project types is that WAPs must have the code explicitly compiled prior to deployment whereas the code in a WSP can be automatically compiled on the web server.</span></span> <span data-ttu-id="8fc48-109">不過，很可能在部署之前的 WSP 先行編譯。</span><span class="sxs-lookup"><span data-stu-id="8fc48-109">However, it is possible to precompile a WSP prior to deployment.</span></span> <span data-ttu-id="8fc48-110">本教學課程探索先行編譯的優點，並示範如何先行編譯網站從 Visual Studio 內和從命令列。</span><span class="sxs-lookup"><span data-stu-id="8fc48-110">This tutorial explores the benefits of precompilation and shows how to precompile a website from within Visual Studio and from the command line.</span></span>


## <a name="introduction"></a><span data-ttu-id="8fc48-111">簡介</span><span class="sxs-lookup"><span data-stu-id="8fc48-111">Introduction</span></span>

<span data-ttu-id="8fc48-112">Visual Studio 提供的 ASP.NET 開發人員兩種不同的專案類型： Web 應用程式專案 (WAP) 和網站專案 (WSP)。</span><span class="sxs-lookup"><span data-stu-id="8fc48-112">Visual Studio offers ASP.NET developers two different project types: Web Application Projects (WAP) and Web Site Projects (WSP).</span></span> <span data-ttu-id="8fc48-113">其中一個這些專案類型之間的主要差異是 WAPs 需要*明確編譯*而 WSPs 使用*自動編譯*，根據預設。</span><span class="sxs-lookup"><span data-stu-id="8fc48-113">One of the key differences between these project types is that WAPs require *explicit compilation* whereas WSPs use *automatic compilation*, by default.</span></span> <span data-ttu-id="8fc48-114">WAPs，與您的 web 應用程式程式碼編譯成單一的組件，這是在網站的`Bin`資料夾。</span><span class="sxs-lookup"><span data-stu-id="8fc48-114">With WAPs, you compile the web application's code into a single assembly, which is created in the website's `Bin` folder.</span></span> <span data-ttu-id="8fc48-115">部署需要複製標記內容 ( `.aspx.ascx`，和`.master`檔案) 專案中的組件中`Bin`資料夾; 程式碼後置類別檔本身不需要部署。</span><span class="sxs-lookup"><span data-stu-id="8fc48-115">Deployment entails copying the markup content (the `.aspx.ascx`, and `.master` files) in the project, along with the assembly in the `Bin` folder; the code-behind class files themselves do not need to be deployed.</span></span> <span data-ttu-id="8fc48-116">相反地，您可以部署 WSPs 藉由複製到生產環境的標記頁面和其相對應的程式碼後置類別。</span><span class="sxs-lookup"><span data-stu-id="8fc48-116">On the other hand, you deploy WSPs by copying both the markup pages and their corresponding code-behind classes to the production environment.</span></span> <span data-ttu-id="8fc48-117">程式碼後置類別會在 web 伺服器上視需要進行編譯。</span><span class="sxs-lookup"><span data-stu-id="8fc48-117">The code-behind classes are compiled on demand on the web server.</span></span>

> [!NOTE]
> <span data-ttu-id="8fc48-118">中的 「 明確編譯與自動編譯 」 一節會回頭[*決定需要的檔案部署*教學課程](determining-what-files-need-to-be-deployed-vb.md)專案之間差異的詳細背景模型、 明確和自動編譯和編譯模型如何影響部署。</span><span class="sxs-lookup"><span data-stu-id="8fc48-118">Refer back to the "Explicit Compilation Versus Automatic Compilation" section in the [*Determining What Files Need to Be Deployed* tutorial](determining-what-files-need-to-be-deployed-vb.md) for more background on the differences between the project models, explicit and automatic compilation, and how the compilation model affects deployment.</span></span>


<span data-ttu-id="8fc48-119">自動編譯選項用法很簡單。</span><span class="sxs-lookup"><span data-stu-id="8fc48-119">The automatic compilation option is simple to use.</span></span> <span data-ttu-id="8fc48-120">並沒有明確編譯步驟是，只有檔案已修改需要供部署，而明確編譯需要部署已變更的標記頁面和只編譯的組件。</span><span class="sxs-lookup"><span data-stu-id="8fc48-120">There's no explicit compilation step and only the files that have been modified need to be deployed, whereas explicit compilation necessitates deploying the changed markup pages and the just-compiled assembly.</span></span> <span data-ttu-id="8fc48-121">不過，自動部署具有兩個缺點：</span><span class="sxs-lookup"><span data-stu-id="8fc48-121">However, automatic deployment has two potential drawbacks:</span></span>

- <span data-ttu-id="8fc48-122">當第一次瀏覽必須自動編譯網頁，因為可以有短暫但明顯的延遲在部署後第一次要求的 ASP.NET 網頁時。</span><span class="sxs-lookup"><span data-stu-id="8fc48-122">Because the pages must be automatically compiled when they are first visited, there can be a short but noticeable delay when an ASP.NET page is requested for the first time after being deployed.</span></span>
- <span data-ttu-id="8fc48-123">自動編譯需要這兩種宣告式標記和原始程式碼的程式碼會出現在 web 伺服器上。</span><span class="sxs-lookup"><span data-stu-id="8fc48-123">Automatic compilation requires that both the declarative markup and source code be present on the web server.</span></span> <span data-ttu-id="8fc48-124">如果您計劃銷售客戶將其 web 伺服器安裝 web 應用程式，這可以是不適當的選項。</span><span class="sxs-lookup"><span data-stu-id="8fc48-124">This can be an unattractive option if you plan on selling the web application to customers who will install it on their web servers.</span></span>

<span data-ttu-id="8fc48-125">如果是這兩個以上的缺點是處理詞工具，您可以切換至 WAP 模型或*先行編譯*部署之前，先 WSP。</span><span class="sxs-lookup"><span data-stu-id="8fc48-125">If either of the two above shortcomings are deal breakers, you can either switch to the WAP model or *precompile* the WSP prior to deployment.</span></span> <span data-ttu-id="8fc48-126">本教學課程會檢查先行編譯選項最適合用來託管網站，並逐步引導的先行編譯處理序和先行編譯網站的部署。</span><span class="sxs-lookup"><span data-stu-id="8fc48-126">This tutorial examines the precompilation options best suited for a hosted website and walks through the precompilation process and deployment of a precompiled website.</span></span>

## <a name="an-overview-of-aspnet-code-generation-and-compilation"></a><span data-ttu-id="8fc48-127">ASP.NET 程式碼產生和編譯的概觀</span><span class="sxs-lookup"><span data-stu-id="8fc48-127">An Overview of ASP.NET Code Generation and Compilation</span></span>

<span data-ttu-id="8fc48-128">我們看看可用的先行編譯選項之前，我們先討論的程式碼產生和編譯的 ASP.NET 網頁要求的第一次建立或上次更新之後，就會發生。</span><span class="sxs-lookup"><span data-stu-id="8fc48-128">Before we look at the available precompilation options, let's first talk about the code generation and compilation that occurs when an ASP.NET page is requested for the first time since it's been created or last updated.</span></span> <span data-ttu-id="8fc48-129">您知道，ASP.NET 網頁中則包含兩個部分： 在宣告式標記`.aspx`檔，以及原始碼部份，通常是在個別的程式碼後置類別檔 (`.aspx.vb`)。</span><span class="sxs-lookup"><span data-stu-id="8fc48-129">As you know, ASP.NET pages are composed of two portions: declarative markup in the `.aspx` file; and a source code portion, typically in a separate code-behind class file (`.aspx.vb`).</span></span> <span data-ttu-id="8fc48-130">要求的 ASP.NET 網頁時，執行階段所執行的步驟取決於應用程式的編譯模型。</span><span class="sxs-lookup"><span data-stu-id="8fc48-130">The steps performed by the runtime when an ASP.NET page is requested depends on the application's compilation model.</span></span>

<span data-ttu-id="8fc48-131">與 WAPs，網頁的原始碼必須明確編譯成單一的組件，才能部署。</span><span class="sxs-lookup"><span data-stu-id="8fc48-131">With WAPs, the pages' source code must be explicitly compiled into a single assembly before being deployed.</span></span> <span data-ttu-id="8fc48-132">在部署期間，這個組件和各種不同的標記頁面會複製到實際執行環境。</span><span class="sxs-lookup"><span data-stu-id="8fc48-132">During deployment, this assembly and the various markup pages are copied to the production environment.</span></span> <span data-ttu-id="8fc48-133">當要求到達 ASP.NET 網頁的網頁伺服器時，執行階段建立網頁的程式碼後置類別的執行個體，並叫用其`ProcessRequest`方法，這個方法會啟動頁面生命週期，且最終會產生頁面的內容，傳回給要求者。</span><span class="sxs-lookup"><span data-stu-id="8fc48-133">When a request arrives to the web server for an ASP.NET page, the runtime creates an instance of the page's code-behind class and invokes its `ProcessRequest` method, which starts the page lifecycle and, ultimately, generates the page's content, which is returned to the requestor.</span></span> <span data-ttu-id="8fc48-134">因為程式碼後置類別的已編譯的組件，在部署之前，執行階段可以使用 ASP.NET 網頁的程式碼後置類別。</span><span class="sxs-lookup"><span data-stu-id="8fc48-134">The runtime can work with the ASP.NET page's code-behind class because the code-behind class was already compiled into an assembly prior to deployment.</span></span>

<span data-ttu-id="8fc48-135">WSPs 和自動編譯，並沒有明確編譯步驟是在部署之前。</span><span class="sxs-lookup"><span data-stu-id="8fc48-135">With WSPs and automatic compilation, there is no explicit compilation step prior to deployment.</span></span> <span data-ttu-id="8fc48-136">相反地，如果部署涉及宣告式和來源的程式碼內容複製到實際執行環境。</span><span class="sxs-lookup"><span data-stu-id="8fc48-136">Instead, deployment involves copying both the declarative and the source code content to the production environment.</span></span> <span data-ttu-id="8fc48-137">要求到達時以 ASP.NET 網頁的網頁伺服器第一次已建立或上次更新頁面之後，執行階段必須先將程式碼後置類別編譯為組件。</span><span class="sxs-lookup"><span data-stu-id="8fc48-137">When a request arrives to the web server for an ASP.NET page for the first time since the page has been created or last updated, the runtime must first compile the code-behind class into an assembly.</span></span> <span data-ttu-id="8fc48-138">這個編譯的組件會儲存在資料夾`%WINDIR%\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files`，不過您可以透過自訂此資料夾的位置`<pages>`中的項目`Web.config`。</span><span class="sxs-lookup"><span data-stu-id="8fc48-138">This compiled assembly is saved in the folder `%WINDIR%\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files`, although the location of this folder can be customized via the `<pages>` element in `Web.config`.</span></span> <span data-ttu-id="8fc48-139">因為此組件儲存至磁碟，它不需要重新編譯的後續要求相同的頁面。</span><span class="sxs-lookup"><span data-stu-id="8fc48-139">Because the assembly is saved to disk, it does not need to be recompiled on subsequent requests to the same page.</span></span>

> [!NOTE]
> <span data-ttu-id="8fc48-140">如您所預期，時，會稍微延遲要求的站台，會編譯網頁的程式碼並儲存產生的組件，以伺服器時間，會使用自動編譯頁面第一次 （或第一次，因為它已被變更）磁碟。</span><span class="sxs-lookup"><span data-stu-id="8fc48-140">As you would expect, there is a slight delay when requesting a page for the first time (or for the first time since it's been changed) in a site that uses automatic compilation as it takes a moment for the server to compile the page's code and save the resulting assembly to disk.</span></span>


<span data-ttu-id="8fc48-141">簡單地說，使用明確編譯您必須編譯網站的原始程式碼，再進行部署，儲存的執行階段不需要執行該步驟。</span><span class="sxs-lookup"><span data-stu-id="8fc48-141">In short, with explicit compilation you are required to compile the website's source code before deployment, saving the runtime from having to perform that step.</span></span> <span data-ttu-id="8fc48-142">使用自動編譯執行階段會處理頁面第一次的編譯網頁的原始碼，但有些微的初始化成本，因為它已建立或上次更新日期。</span><span class="sxs-lookup"><span data-stu-id="8fc48-142">With automatic compilation the runtime handles the compilation of the pages' source code, but with a slight initialization cost for the first visit to the page since it was created or last updated.</span></span>

<span data-ttu-id="8fc48-143">但 ASP.NET 網頁的宣告式一部分的情況為何 (`.aspx`檔案)？</span><span class="sxs-lookup"><span data-stu-id="8fc48-143">But what about the declarative part of ASP.NET pages (the `.aspx` file)?</span></span> <span data-ttu-id="8fc48-144">明顯是之間的關聯性`.aspx`檔案和它們的程式碼後置類別，做為宣告式標記中定義的 Web 控制項中的程式碼都可以存取程式碼中。</span><span class="sxs-lookup"><span data-stu-id="8fc48-144">It's obvious that there's a relationship between the `.aspx` files and the code in their code-behind classes, as the Web controls defined in the declarative markup are accessible in the code.</span></span> <span data-ttu-id="8fc48-145">它也是很明顯，中的內容`.aspx`都會大大影響檔案產生頁面所呈現的標記。</span><span class="sxs-lookup"><span data-stu-id="8fc48-145">It's also obvious that the content in the `.aspx` files greatly influences the rendered markup generated by the page.</span></span> <span data-ttu-id="8fc48-146">如何在將執行階段運作以文字、 HTML、 和中的 Web 控制項語法定義`.aspx`檔案來產生要求的網頁的呈現的內容嗎？</span><span class="sxs-lookup"><span data-stu-id="8fc48-146">So how does the runtime work with the text, HTML, and Web control syntax defined in the `.aspx` file to generate the requested page's rendered content?</span></span>

<span data-ttu-id="8fc48-147">我不想取得太 sidetracked 的低層級的實作詳細資料，WAPs 和 WSPs 之間有所差異，但簡言之執行階段自動產生類別檔案，其中包含不同的 Web 控制項做為受保護的成員和方法。</span><span class="sxs-lookup"><span data-stu-id="8fc48-147">I don't want to get too sidetracked on the low-level implementation details, which vary between WAPs and WSPs, but in a nutshell the runtime automatically generates a class file that contains the various Web controls as protected members and methods.</span></span> <span data-ttu-id="8fc48-148">這個產生的檔案會實作為*部分類別*對應的程式碼後置類別。</span><span class="sxs-lookup"><span data-stu-id="8fc48-148">This generated file is implemented as a *partial class* to the corresponding code-behind class.</span></span> <span data-ttu-id="8fc48-149">([部分類別](http://www.dotnet-guide.com/partialclasses.html)分散到多個檔案可供單一類別的內容。)因此，將程式碼後置類別定義在兩個地方： 在`.aspx.vb`您建立和此自動產生的類別中執行階段建立的檔案。</span><span class="sxs-lookup"><span data-stu-id="8fc48-149">([Partial classes](http://www.dotnet-guide.com/partialclasses.html) allow for the contents of a single class to be spread across multiple files.) Therefore, the code-behind class is defined in two places: in the `.aspx.vb` file that you create, and in this auto-generated class created by the runtime.</span></span> <span data-ttu-id="8fc48-150">這個自動產生的類別會儲存在`%WINDIR%\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files`資料夾。</span><span class="sxs-lookup"><span data-stu-id="8fc48-150">This auto-generated class is stored in the `%WINDIR%\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files` folder.</span></span>

<span data-ttu-id="8fc48-151">重要拿掉以下是執行階段所要呈現 ASP.NET 網頁，這兩種及其宣告式和來源的程式碼部分必須編譯成組件。</span><span class="sxs-lookup"><span data-stu-id="8fc48-151">The important take away here is that for an ASP.NET page to be rendered by the runtime both its declarative and source code portions must be compiled into an assembly.</span></span> <span data-ttu-id="8fc48-152">WAPs，原始程式碼明確地編譯的組件，在部署之前，但宣告式標記仍會轉換成程式碼和 web 伺服器上的執行階段編譯。</span><span class="sxs-lookup"><span data-stu-id="8fc48-152">With WAPs, the source code is explicitly compiled into an assembly prior to deployment, but the declarative markup must still be converted into code and compiled by the runtime on the web server.</span></span> <span data-ttu-id="8fc48-153">使用自動編譯 WSPs，原始程式碼和宣告式標記需要 web 伺服器，來編譯。</span><span class="sxs-lookup"><span data-stu-id="8fc48-153">With WSPs using automatic compilation, both the source code and the declarative markup need to be compiled by the web server.</span></span>

<span data-ttu-id="8fc48-154">您可用於根據 WSP 模型使用明確編譯。</span><span class="sxs-lookup"><span data-stu-id="8fc48-154">It is possible to use explicit compilation with the WSP model.</span></span> <span data-ttu-id="8fc48-155">您可以明確地編譯原始碼部份中，像 WAP 模型。</span><span class="sxs-lookup"><span data-stu-id="8fc48-155">You can explicitly compile the source code portion, like with the WAP model.</span></span> <span data-ttu-id="8fc48-156">而且，您也可以編譯的宣告式標記。</span><span class="sxs-lookup"><span data-stu-id="8fc48-156">What's more, you can also compile the declarative markup.</span></span>

## <a name="precompilation-options"></a><span data-ttu-id="8fc48-157">先行編譯選項</span><span class="sxs-lookup"><span data-stu-id="8fc48-157">Precompilation Options</span></span>

<span data-ttu-id="8fc48-158">.NET Framework 隨附[ASP.NET 編譯工具 (`aspnet_compiler.exe`)](https://msdn.microsoft.com/library/ms229863.aspx) ，可讓您編譯的 ASP.NET 應用程式使用 WSP 模型所建置的原始程式碼 （和甚至內容）。</span><span class="sxs-lookup"><span data-stu-id="8fc48-158">The .NET Framework ships with an [ASP.NET compilation tool (`aspnet_compiler.exe`)](https://msdn.microsoft.com/library/ms229863.aspx) that enables you to compile the source code (and even the content) of an ASP.NET application built using the WSP model.</span></span> <span data-ttu-id="8fc48-159">此工具隨附於.NET Framework 2.0 版，且其位於`%WINDIR%\Microsoft.NET\Framework\v2.0.50727`資料夾; 可以從命令列或從 Visual Studio 中啟動透過 [建置] 功能表的 [發行網站] 選項。</span><span class="sxs-lookup"><span data-stu-id="8fc48-159">This tool was released with the .NET Framework version 2.0 and is located in the `%WINDIR%\Microsoft.NET\Framework\v2.0.50727` folder; it can be used from the command line or launched from within Visual Studio via the Build menu's Publish Web Site option.</span></span>

<span data-ttu-id="8fc48-160">編譯工具提供兩種一般的編譯形式： 就地先行編譯和部署的先行編譯。</span><span class="sxs-lookup"><span data-stu-id="8fc48-160">The compilation tool provides two general forms of compilation: in-place precompilation and precompilation for deployment.</span></span> <span data-ttu-id="8fc48-161">在您執行就地先行編譯`aspnet_compiler.exe`從命令列工具，並指定您的電腦上的虛擬目錄或網站所在的實體路徑的路徑。</span><span class="sxs-lookup"><span data-stu-id="8fc48-161">With in-place precompilation you run the `aspnet_compiler.exe` tool from the command-line and specify the path to the virtual directory or physical path of a website that resides on your computer.</span></span> <span data-ttu-id="8fc48-162">編譯工具然後編譯專案中，儲存在已編譯的版本中的每個 ASP.NET 網頁`%WINDIR%\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files`一樣如果頁面有每個已瀏覽第一次從瀏覽器的資料夾。</span><span class="sxs-lookup"><span data-stu-id="8fc48-162">The compilation tool then compiles each ASP.NET page in the project, storing the compiled version in the `%WINDIR%\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files` folder just like if the pages had each been visited for the first time from a browser.</span></span> <span data-ttu-id="8fc48-163">就地先行編譯可加速對您的網站上的新部署 ASP.NET 網頁，因為它可減輕就不需要執行此步驟的執行階段的第一個要求。</span><span class="sxs-lookup"><span data-stu-id="8fc48-163">In-place precompilation can speed up the first request made to newly deployed ASP.NET pages on your site because it alleviates the runtime from needing to perform this step.</span></span> <span data-ttu-id="8fc48-164">不過，就地先行編譯不適用於大部分的託管網站因為它需要，您都能執行程式，從 web 伺服器的命令列。</span><span class="sxs-lookup"><span data-stu-id="8fc48-164">However, in-place precompilation is not useful for the majority of hosted websites because it requires that you are able to run programs from the web server's command-line.</span></span> <span data-ttu-id="8fc48-165">在共用裝載環境中不允許此存取層級。</span><span class="sxs-lookup"><span data-stu-id="8fc48-165">In shared hosting environments this level of access is not permitted.</span></span>

> [!NOTE]
> <span data-ttu-id="8fc48-166">如需有關就地先行編譯的詳細資訊，請參閱[How To： 先行編譯的 ASP.NET Web Sites](https://msdn.microsoft.com/library/ms227972.aspx)和[先行編譯 ASP.NET 2.0 中的](http://www.odetocode.com/Articles/417.aspx)。</span><span class="sxs-lookup"><span data-stu-id="8fc48-166">For more information on in-place precompilation, check out [How To: Precompile ASP.NET Web Sites](https://msdn.microsoft.com/library/ms227972.aspx) and [Precompilation in ASP.NET 2.0](http://www.odetocode.com/Articles/417.aspx).</span></span>


<span data-ttu-id="8fc48-167">而不是編譯至網站中的網頁`Temporary ASP.NET Files`資料夾中，針對部署先行編譯會編譯要目錄您所選擇的格式，可以部署到生產環境中的頁面。</span><span class="sxs-lookup"><span data-stu-id="8fc48-167">Instead of compiling the pages in the website to the `Temporary ASP.NET Files` folder, precompilation for deployment compiles the pages to a directory of your choosing and in a format that can be deployed to the production environment.</span></span>

<span data-ttu-id="8fc48-168">有兩種部署，我們在此教學課程中，瀏覽的先行編譯： 使用可更新的使用者介面，先行編譯和先行編譯不可更新的使用者介面。</span><span class="sxs-lookup"><span data-stu-id="8fc48-168">There are two flavors of precompilation for deployment that we explore in this tutorial: precompilation with an updatable user interface, and precompilation with a non-updatable user interface.</span></span> <span data-ttu-id="8fc48-169">先行編譯的可更新的使用者介面會保留中的宣告式標記`.aspx`， `.ascx`，和`.master`檔案，因此允許進行檢視，並如有需要，修改實際執行伺服器上的宣告式標記為開發人員。</span><span class="sxs-lookup"><span data-stu-id="8fc48-169">Precompilation with an updatable user interface leaves the declarative markup in the `.aspx`, `.ascx`, and `.master` files, thereby allowing a developer to view and, if desired, modify the declarative markup on the production server.</span></span> <span data-ttu-id="8fc48-170">不可更新的使用者介面的先行編譯會產生`.aspx`頁面的任何內容，並移除 void`.ascx`和`.master`檔案，藉以隱藏的宣告式標記，並禁止變更它從開發人員生產環境。</span><span class="sxs-lookup"><span data-stu-id="8fc48-170">Precompilation with a non-updatable user interface generates `.aspx` pages that are void of any content and removes `.ascx` and `.master` files, thereby hiding the declarative markup and prohibiting a developer from changing it from the production environment.</span></span>

### <a name="precompiling-for-deployment-with-an-updatable-user-interface"></a><span data-ttu-id="8fc48-171">先行編譯的可更新的使用者介面的部署</span><span class="sxs-lookup"><span data-stu-id="8fc48-171">Precompiling for Deployment With an Updatable User Interface</span></span>

<span data-ttu-id="8fc48-172">若要了解部署的先行編譯，最好是在動作中的範例，請參閱。</span><span class="sxs-lookup"><span data-stu-id="8fc48-172">The best way to understand precompilation for deployment is to see an example in action.</span></span> <span data-ttu-id="8fc48-173">讓我們先行編譯書籍檢閱用於根據 WSP 部署使用可更新的使用者介面。</span><span class="sxs-lookup"><span data-stu-id="8fc48-173">Let's precompile the Book Reviews WSP for deployment using an updatable user interface.</span></span> <span data-ttu-id="8fc48-174">ASP.NET 編譯工具可以從 Visual Studio 的 [建置] 功能表，或從命令列叫用。</span><span class="sxs-lookup"><span data-stu-id="8fc48-174">The ASP.NET compilation tool can be invoked from Visual Studio's Build menu or from the command-line.</span></span> <span data-ttu-id="8fc48-175">本節會檢查使用工具在 Visual Studio;從命令列執行編譯器工具會查看 「 先行編譯從命令列 」 一節。</span><span class="sxs-lookup"><span data-stu-id="8fc48-175">This section examines using the tool from within Visual Studio; the "Precompiling from the Command Line" section looks at running the compiler tool from the command line.</span></span>

<span data-ttu-id="8fc48-176">Visual Studio 中開啟活頁簿檢閱 WSP、 移至 [建置] 功能表中，然後選取 [發行網站] 功能表選項。</span><span class="sxs-lookup"><span data-stu-id="8fc48-176">Open the Book Review WSP in Visual Studio, go to the Build menu, and select the Publish Web Site menu option.</span></span> <span data-ttu-id="8fc48-177">這會啟動 [發行網站] 對話方塊 (請參閱**圖 1**)，您可以在其中指定目標位置、 先行編譯的網站的使用者介面是否可更新的與其他編譯器工具選項。</span><span class="sxs-lookup"><span data-stu-id="8fc48-177">This launches the Publish Web Site dialog box (see **Figure 1**), where you can specify the target location, whether or not the precompiled site's user interface is updatable, and other compiler tool options.</span></span> <span data-ttu-id="8fc48-178">目標位置可以是遠端網頁伺服器或 FTP 伺服器，但現在，請選擇您的電腦硬碟上的資料夾。</span><span class="sxs-lookup"><span data-stu-id="8fc48-178">The target location can be a remote web server or FTP server, but for now choose a folder on your computer's hard drive.</span></span> <span data-ttu-id="8fc48-179">由於我們想要先行編譯的可更新的使用者介面與站台，將核取 [允許此先行編譯的網站成為可更新] 的核取方塊，然後按一下 [確定]。</span><span class="sxs-lookup"><span data-stu-id="8fc48-179">Because we want to precompile the site with an updatable user interface, leave the "Allow this precompiled site to be updatable" checkbox checked and click OK.</span></span>

[![](precompiling-your-website-vb/_static/image2.png)](precompiling-your-website-vb/_static/image1.png)

<span data-ttu-id="8fc48-180">**圖 1**: ASP.NET Compilation Tool 會先行編譯網站，以指定的目標位置</span><span class="sxs-lookup"><span data-stu-id="8fc48-180">**Figure 1**: The ASP.NET Compilation Tool Will Precompile Your Website to the Specified Target Location</span></span>  
 <span data-ttu-id="8fc48-181">([按一下以檢視完整大小的影像](precompiling-your-website-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="8fc48-181">([Click to view full-size image](precompiling-your-website-vb/_static/image3.png))</span></span>

> [!NOTE]
> <span data-ttu-id="8fc48-182">無法在 Visual Web Developer 中使用 [建置] 功能表中的 [發行網站] 選項。</span><span class="sxs-lookup"><span data-stu-id="8fc48-182">The Publish Web Site option in the Build menu is not available in Visual Web Developer.</span></span> <span data-ttu-id="8fc48-183">如果您使用 Visual Web Developer，您必須使用命令列版本的 ASP.NET 編譯工具，「 先行編譯從命令列 」 一節。</span><span class="sxs-lookup"><span data-stu-id="8fc48-183">If you are using Visual Web Developer you will need to use the command-line version of the ASP.NET compilation tool, which is covered in the "Precompiling from the Command Line" section.</span></span>


<span data-ttu-id="8fc48-184">之後先行編譯網站，瀏覽至您在 [發行網站] 對話方塊中輸入的目標位置。</span><span class="sxs-lookup"><span data-stu-id="8fc48-184">After precompiling the website, navigate to the target location you entered in the Publish Web Site dialog box.</span></span> <span data-ttu-id="8fc48-185">請花一點時間來比較您的網站內容與此資料夾的內容。</span><span class="sxs-lookup"><span data-stu-id="8fc48-185">Take a moment to compare the contents of this folder with the contents of your website.</span></span> <span data-ttu-id="8fc48-186">**圖 2**顯示書籍檢閱網站資料夾。</span><span class="sxs-lookup"><span data-stu-id="8fc48-186">**Figure 2** shows the Book Reviews website folder.</span></span> <span data-ttu-id="8fc48-187">請注意，它同時包含`.aspx`和`.aspx.cs`檔案。</span><span class="sxs-lookup"><span data-stu-id="8fc48-187">Note that it contains both `.aspx` and `.aspx.cs` files.</span></span> <span data-ttu-id="8fc48-188">另請注意，`Bin`目錄包含只有一個檔案， `Elmah.dll`，我們中加入[前述教學課程](logging-error-details-with-elmah-vb.md)</span><span class="sxs-lookup"><span data-stu-id="8fc48-188">Also, note that the `Bin` directory includes only one file, `Elmah.dll`, which we added in the [preceding tutorial](logging-error-details-with-elmah-vb.md)</span></span>

[![](precompiling-your-website-vb/_static/image5.png)](precompiling-your-website-vb/_static/image4.png)

<span data-ttu-id="8fc48-189">**圖 2**： 專案目錄中包含`.aspx`和`.aspx.cs`檔案;`Bin`資料夾只包含 `Elmah.dll`</span><span class="sxs-lookup"><span data-stu-id="8fc48-189">**Figure 2**: The Project Directory Contains `.aspx` and `.aspx.cs` Files; the `Bin` Folder Includes Just `Elmah.dll`</span></span>  
 <span data-ttu-id="8fc48-190">([按一下以檢視完整大小的影像](precompiling-your-website-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="8fc48-190">([Click to view full-size image](precompiling-your-website-vb/_static/image6.png))</span></span>

<span data-ttu-id="8fc48-191">**圖 3**顯示其內容所建立的 ASP.NET 編譯工具的目標位置資料夾。</span><span class="sxs-lookup"><span data-stu-id="8fc48-191">**Figure 3** shows the target location folder whose contents were created by the ASP.NET compilation tool.</span></span> <span data-ttu-id="8fc48-192">這個資料夾不包含任何程式碼後置檔案。</span><span class="sxs-lookup"><span data-stu-id="8fc48-192">This folder does not contain any code-behind files.</span></span> <span data-ttu-id="8fc48-193">此外，此資料夾`Bin`目錄都會包括數個組件和兩個`.compiled`檔案除了`Elmah.dll`組件。</span><span class="sxs-lookup"><span data-stu-id="8fc48-193">Moreover, this folder's `Bin` directory includes several assemblies and two `.compiled` files in addition to the `Elmah.dll` assembly.</span></span>

[![](precompiling-your-website-vb/_static/image8.png)](precompiling-your-website-vb/_static/image7.png)

<span data-ttu-id="8fc48-194">**圖 3**： 的目標位置的資料夾包含檔案，部署</span><span class="sxs-lookup"><span data-stu-id="8fc48-194">**Figure 3**: The Target Location Folder Includes the Files for Deployment</span></span>  
 <span data-ttu-id="8fc48-195">([按一下以檢視完整大小的影像](precompiling-your-website-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="8fc48-195">([Click to view full-size image](precompiling-your-website-vb/_static/image9.png))</span></span>

<span data-ttu-id="8fc48-196">不同於在 WAPs 明確編譯，先行編譯的部署程序不會建立一個組件的整個站台。</span><span class="sxs-lookup"><span data-stu-id="8fc48-196">Unlike explicit compilation in WAPs, the precompilation for deployment process does not create one assembly for the entire site.</span></span> <span data-ttu-id="8fc48-197">相反地，它會批次處理一起數個頁面到每個組件。</span><span class="sxs-lookup"><span data-stu-id="8fc48-197">Instead, it batches together several pages into each assembly.</span></span> <span data-ttu-id="8fc48-198">它也會編譯`Global.asax`到它自己組件，以及在任何類別檔案 （如果有的話）`App_Code`資料夾。</span><span class="sxs-lookup"><span data-stu-id="8fc48-198">It also compiles the `Global.asax` file (if present) into its own assembly, as well as any classes in the `App_Code` folder.</span></span> <span data-ttu-id="8fc48-199">保存適用於 ASP.NET 的宣告式標記檔案 web 網頁、 使用者控制項和主版頁面 (`.aspx`， `.ascx`，和`.master`分別檔案) 複製到做為-為目標位置的目錄。</span><span class="sxs-lookup"><span data-stu-id="8fc48-199">The files that hold the declarative markup for ASP.NET web pages, User Controls, and master pages (`.aspx`, `.ascx`, and `.master` files, respectively) are copied as-is to the target location directory.</span></span> <span data-ttu-id="8fc48-200">同樣地，`Web.config`檔案會直接透過複製以及任何靜態檔案，例如影像、 CSS 類別和 PDF 檔案。</span><span class="sxs-lookup"><span data-stu-id="8fc48-200">Likewise, the `Web.config` file is copied straight over, along with any static files, such as images, CSS classes, and PDF files.</span></span> <span data-ttu-id="8fc48-201">如需更正式的編譯工具如何處理各種說明檔案類型，請參閱[檔案處理期間 ASP.NET 先行編譯](https://msdn.microsoft.com/library/e22s60h9.aspx)。</span><span class="sxs-lookup"><span data-stu-id="8fc48-201">For a more formal description of how the compilation tool handles various file types, refer to [File Handling During ASP.NET Precompilation](https://msdn.microsoft.com/library/e22s60h9.aspx).</span></span>

> [!NOTE]
> <span data-ttu-id="8fc48-202">您可以指示編譯工具來建立 ASP.NET 頁面、 使用者控制項或主版頁面的每一個組件藉由檢查從發行網站對話方塊中的 「 使用固定命名和單一網頁組件 」 核取方塊。</span><span class="sxs-lookup"><span data-stu-id="8fc48-202">You can instruct the compilation tool to create one assembly per ASP.NET page, User Control, or master page by checking the "Used fixed naming and single page assemblies" checkbox from the Publish Web Site dialog box.</span></span> <span data-ttu-id="8fc48-203">每個 ASP.NET 網頁，編譯成自己的組件可讓部署更多更細緻的控制。</span><span class="sxs-lookup"><span data-stu-id="8fc48-203">Having each ASP.NET page compiled into its own assembly allows for more fine-grained control over deployment.</span></span> <span data-ttu-id="8fc48-204">例如，如果您更新單一 ASP.NET 網頁，並部署該變更時需要您需要只部署該頁面`.aspx`檔案和相關聯的組件到生產環境。</span><span class="sxs-lookup"><span data-stu-id="8fc48-204">For example, if you updated a single ASP.NET web page and needed to deploy that change, you need only deploy that page's `.aspx` file and associated assembly to the production environment.</span></span> <span data-ttu-id="8fc48-205">請參閱[How To： 使用 ASP.NET 編譯工具產生固定名稱](https://msdn.microsoft.com/library/ms228040.aspx)如需詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="8fc48-205">Consult [How To: Generate Fixed Names with the ASP.NET Compilation Tool](https://msdn.microsoft.com/library/ms228040.aspx) for more information.</span></span>


<span data-ttu-id="8fc48-206">目標位置的目錄也會包含不是一部分的先行編譯的 web 專案，也就是一個檔案`PrecompiledApp.config`。</span><span class="sxs-lookup"><span data-stu-id="8fc48-206">The target location directory also contains a file that was not part of the precompiled web project, namely `PrecompiledApp.config`.</span></span> <span data-ttu-id="8fc48-207">這個檔案會通知應用程式已先行編譯的 ASP.NET 執行階段和是否先行具有可更新或中午可更新的 UI。</span><span class="sxs-lookup"><span data-stu-id="8fc48-207">This file informs the ASP.NET runtime that the application was precompiled and whether it was precompiled with an updatable or noon-updatable UI.</span></span>

<span data-ttu-id="8fc48-208">最後，請花一點時間開啟其中一個`.aspx`目標位置，使用 Visual Studio 或您選擇的文字編輯器中的檔案。</span><span class="sxs-lookup"><span data-stu-id="8fc48-208">Finally, take a moment to open one of the `.aspx` files in the target location using Visual Studio or your text editor of choice.</span></span> <span data-ttu-id="8fc48-209">先行編譯的可更新的使用者介面的部署，當 ASP.NET 網頁的目標位置的目錄中包含之網站中的對應檔案完全相同的標記。</span><span class="sxs-lookup"><span data-stu-id="8fc48-209">When precompiling for deployment with an updatable user interface, the ASP.NET pages in the target location directory contain the exact same markup as the corresponding files in the website.</span></span>

### <a name="precompiling-for-deployment-with-a-non-updatable-user-interface"></a><span data-ttu-id="8fc48-210">針對部署的非可更新的使用者介面與先行編譯</span><span class="sxs-lookup"><span data-stu-id="8fc48-210">Precompiling for Deployment With a Non-Updatable User Interface</span></span>

<span data-ttu-id="8fc48-211">ASP.NET 編譯器工具也可用來部署的站台與非更新的 UI 先行編譯。</span><span class="sxs-lookup"><span data-stu-id="8fc48-211">The ASP.NET compiler tool can also be used to precompile a site for deployment with a non-updatable UI.</span></span> <span data-ttu-id="8fc48-212">先行編譯不可更新的 UI 與站台的作用很像先行編譯使用更新的 UI，主要差異在於 ASP.NET 網頁、 使用者控制項和主版頁面的目標目錄中會移除其標記。</span><span class="sxs-lookup"><span data-stu-id="8fc48-212">Precompiling the site with a non-updatable UI works much like precompiling with an updatable UI, the key difference being that the ASP.NET pages, User Controls, and master pages in the target directory are stripped of their markup.</span></span> <span data-ttu-id="8fc48-213">先行編譯網站，以取得部署具有非可更新的 UI，從 [建置] 功能表中，選擇 [發行網站] 選項，但是取消核取 [允許此先行編譯的網站成為可更新] 選項 (請參閱**圖 4**)。</span><span class="sxs-lookup"><span data-stu-id="8fc48-213">To precompile a website for deployment with a non-updatable UI, choose the Publish Web Site option from the Build menu, but uncheck the "Allow this precompiled site to be updatable" option (see **Figure 4**).</span></span>

[![](precompiling-your-website-vb/_static/image11.png)](precompiling-your-website-vb/_static/image10.png)

<span data-ttu-id="8fc48-214">**圖 4**： 取消核取 [允許此先行編譯的網站成為可更新] 選項來先行編譯與非更新的 UI</span><span class="sxs-lookup"><span data-stu-id="8fc48-214">**Figure 4**: Uncheck the "Allow this precompiled site to be updatable" Option To Precompile With a Non-Updatable UI</span></span>  
 <span data-ttu-id="8fc48-215">([按一下以檢視完整大小的影像](precompiling-your-website-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="8fc48-215">([Click to view full-size image](precompiling-your-website-vb/_static/image12.png))</span></span>

<span data-ttu-id="8fc48-216">**圖 5**顯示之後不可更新的使用者介面使用先行編譯的目標位置的資料夾。</span><span class="sxs-lookup"><span data-stu-id="8fc48-216">**Figure 5** shows the target location folder after precompiling with a non-updatable user interface.</span></span>

[![](precompiling-your-website-vb/_static/image14.png)](precompiling-your-website-vb/_static/image13.png)

<span data-ttu-id="8fc48-217">**圖 5**： 不可更新的 UI 與部署的目標位置資料夾</span><span class="sxs-lookup"><span data-stu-id="8fc48-217">**Figure 5**: The Target Location Folder for Deployment With a Non-Updatable UI</span></span>  
 <span data-ttu-id="8fc48-218">([按一下以檢視完整大小的影像](precompiling-your-website-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="8fc48-218">([Click to view full-size image](precompiling-your-website-vb/_static/image15.png))</span></span>

<span data-ttu-id="8fc48-219">比較**圖 3**至**圖 5**。</span><span class="sxs-lookup"><span data-stu-id="8fc48-219">Compare **Figure 3** to **Figure 5**.</span></span> <span data-ttu-id="8fc48-220">雖然看起來相同的兩個資料夾，請注意不可更新的 UI 資料夾缺少主版頁面`Site.master`。</span><span class="sxs-lookup"><span data-stu-id="8fc48-220">While the two folders may look identical, note that the non-updatable UI folder lacks the master page, `Site.master`.</span></span> <span data-ttu-id="8fc48-221">當**圖 5**包含各種不同的 ASP.NET 網頁中，如果您檢視了已移除其宣告式標記並取代預留位置文字，您會看到這些檔案的內容:"This is 所產生的標記檔案先行編譯工具，而且不會刪除 ！ 」</span><span class="sxs-lookup"><span data-stu-id="8fc48-221">And while **Figure 5** includes the various ASP.NET pages, if you view the contents of these files you'll see that they've been stripped of their declarative markup and replaced with the placeholder text: "This is a marker file generated by the precompilation tool, and should not be deleted!"</span></span>

[![](precompiling-your-website-vb/_static/image17.png)](precompiling-your-website-vb/_static/image16.png)

<span data-ttu-id="8fc48-222">**圖 5**： 宣告式標記已從 ASP.NET 網頁</span><span class="sxs-lookup"><span data-stu-id="8fc48-222">**Figure 5**: The Declarative Markup Has Been Removed from the ASP.NET Pages</span></span>

<span data-ttu-id="8fc48-223">`Bin`資料夾中的**數字 3**和**5**太多大的不同。</span><span class="sxs-lookup"><span data-stu-id="8fc48-223">The `Bin` folders in **Figures 3** and **5** differ more substantially.</span></span> <span data-ttu-id="8fc48-224">組件，除了`Bin`資料夾中的**圖 5**包含`.compiled`每個 ASP.NET 網頁、 使用者控制項和主版頁面檔案。</span><span class="sxs-lookup"><span data-stu-id="8fc48-224">In addition to the assemblies, the `Bin` folder in **Figure 5** includes a `.compiled` file for each ASP.NET page, User Control, and master page.</span></span>

<span data-ttu-id="8fc48-225">先行編譯的站台與非更新的 UI 中很有用，您不想要修改的個人或公司安裝或管理在生產環境網站的 ASP.NET 網頁的內容。</span><span class="sxs-lookup"><span data-stu-id="8fc48-225">Precompiling a site with a non-updatable UI is useful in situations where you do not want the ASP.NET pages' contents to be modified by the person or company who installs or manages the website in the production environment.</span></span> <span data-ttu-id="8fc48-226">如果您建立您賣給客戶，他們自己的 web 伺服器上安裝 ASP.NET web 應用程式，您可能想要確保，而不會修改您的站台的外觀及操作直接編輯`.aspx`將它們寄送的頁面。</span><span class="sxs-lookup"><span data-stu-id="8fc48-226">If you build an ASP.NET web application that you sell to customers to install on their own web servers, you may want to ensure that they do not modify the look and feel of your site by directly editing the `.aspx` pages you ship them.</span></span> <span data-ttu-id="8fc48-227">先行編譯您的網站與非更新的 UI，出貨預留位置`.aspx`安裝的一部分，因此可以防止您的客戶，檢查或修改其內容頁。</span><span class="sxs-lookup"><span data-stu-id="8fc48-227">By precompiling your website with a non-updatable UI, you ship the placeholder `.aspx` pages as part of the installation, thereby preventing your customers from examining or modifying their content.</span></span>

### <a name="precompiling-from-the-command-line"></a><span data-ttu-id="8fc48-228">從命令列先行編譯</span><span class="sxs-lookup"><span data-stu-id="8fc48-228">Precompiling from the Command Line</span></span>

<span data-ttu-id="8fc48-229">在幕後，Visual Studio 的 [發行網站] 對話方塊會叫用 ASP.NET 編譯工具 (`aspnet_compiler.exe`) 先行編譯網站。</span><span class="sxs-lookup"><span data-stu-id="8fc48-229">Behind the scenes, Visual Studio's Publish Web Site dialog box invokes the ASP.NET compilation tool (`aspnet_compiler.exe`) to precompile the website.</span></span> <span data-ttu-id="8fc48-230">或者，您可以叫用此工具從命令列。</span><span class="sxs-lookup"><span data-stu-id="8fc48-230">Alternatively, you can invoke this tool from the command line.</span></span> <span data-ttu-id="8fc48-231">事實上，如果您使用 Visual Web Developer 然後您必須執行編譯器工具從命令列，因為 Visual Web Developer 的 [建置] 功能表中不包含發行網站選項。</span><span class="sxs-lookup"><span data-stu-id="8fc48-231">In fact, if you use Visual Web Developer then you will need to run the compiler tool from the command line, as Visual Web Developer's Build menu does not include the Publish Web Site option.</span></span>

<span data-ttu-id="8fc48-232">若要使用編譯器工具，從命令列，啟動 命令列來卸除並巡覽至 framework 目錄中， `%WINDIR%\Microsoft.NET\Framework\v2.0.50727`。</span><span class="sxs-lookup"><span data-stu-id="8fc48-232">To use the compiler tool from the command line, start by dropping to the command line and navigating to the framework directory, `%WINDIR%\Microsoft.NET\Framework\v2.0.50727`.</span></span> <span data-ttu-id="8fc48-233">接下來，在命令列中輸入下列陳述式：</span><span class="sxs-lookup"><span data-stu-id="8fc48-233">Next, enter the following statement into the command line:</span></span>

`aspnet_compiler -p "physical_path_to_app" -v / -f -u "target_location_folder"`

<span data-ttu-id="8fc48-234">上述命令會啟動 ASP.NET 編譯器工具 (`aspnet_compiler.exe`) 及透過`-p`參數，指示它先行編譯網站根目錄*實體\_路徑\_至\_應用程式*;這個值會像`C:\MySites\BookReviews`，並應該以引號分隔。</span><span class="sxs-lookup"><span data-stu-id="8fc48-234">The above command launches the ASP.NET compiler tool (`aspnet_compiler.exe`) and, via the `-p` switch, instructs it to precompile the website rooted at *physical\_path\_to\_app*; this value will be something like `C:\MySites\BookReviews`, and should be delimited by quotation marks.</span></span>

<span data-ttu-id="8fc48-235">`-v`參數指定的站台的虛擬目錄。</span><span class="sxs-lookup"><span data-stu-id="8fc48-235">The `-v` switch specifies the virtual directory of the site.</span></span> <span data-ttu-id="8fc48-236">如果您的網站是否註冊為 IIS metabase 中的預設網站，則可以省略`-p`切換，並只需要指定虛擬目錄的應用程式。</span><span class="sxs-lookup"><span data-stu-id="8fc48-236">If your site is registered as the default website in the IIS metabase then you can omit the `-p` switch and just specify the virtual directory of the application.</span></span> <span data-ttu-id="8fc48-237">如果您使用`-p`切換、 值再繼續`-v`參數表示網站的根目錄，而用來解析應用程式根目錄的參考。</span><span class="sxs-lookup"><span data-stu-id="8fc48-237">If you use the `-p` switch, the value proceeding the `-v` switch indicates the root of the website, and is used to resolve application-root references.</span></span> <span data-ttu-id="8fc48-238">比方說，如果您指定的值`-v /MySite`然後應用程式中參考`~/path/file`會解析為`~/MySite/path/file`。</span><span class="sxs-lookup"><span data-stu-id="8fc48-238">For instance, if you specify a value of `-v /MySite` then references in the application to `~/path/file` will be resolved as `~/MySite/path/file`.</span></span> <span data-ttu-id="8fc48-239">因為活頁簿檢閱站台位於根目錄在我的 web 裝載公司我已經使用交換器`-v /`。</span><span class="sxs-lookup"><span data-stu-id="8fc48-239">Because the Book Reviews site is located at the root directory at my web hosting company I have used the switch `-v /`.</span></span>

<span data-ttu-id="8fc48-240">`-f`參數，如果有的話，會指示編譯工具，以覆寫*目標\_位置\_資料夾*目錄已經存在。</span><span class="sxs-lookup"><span data-stu-id="8fc48-240">The `-f` switch, if present, instructs the compilation tool to overwrite the *target\_location\_folder* directory if it already exists.</span></span> <span data-ttu-id="8fc48-241">如果您省略`-f`交換器和目標位置的資料夾已經存在，編譯工具將會結束，發生錯誤: 「 錯誤 ASPRUNTIME： 不是空的目標目錄。</span><span class="sxs-lookup"><span data-stu-id="8fc48-241">If you omit the `-f` switch and the target location folder already exists, the compilation tool will quit with the error: "error ASPRUNTIME: The target directory is not empty.</span></span> <span data-ttu-id="8fc48-242">請手動將它刪除或選擇不同的目標。 」</span><span class="sxs-lookup"><span data-stu-id="8fc48-242">Please delete it manually or choose a different target."</span></span>

<span data-ttu-id="8fc48-243">`-u`參數，如果有的話，會通知工具，以建立可更新的使用者介面。</span><span class="sxs-lookup"><span data-stu-id="8fc48-243">The `-u` switch, if present, informs the tool to create an updatable user interface.</span></span> <span data-ttu-id="8fc48-244">省略這個參數來先行編譯的站台與非可更新的使用者介面。</span><span class="sxs-lookup"><span data-stu-id="8fc48-244">Omit this switch to precompile the site with a non-updatable user interface.</span></span>

<span data-ttu-id="8fc48-245">最後，*目標\_位置\_資料夾*是目標位置的目錄; 的實體路徑這個值會像`C:\MySites\Output\BookReviews`，並應該以引號分隔。</span><span class="sxs-lookup"><span data-stu-id="8fc48-245">Lastly, the *target\_location\_folder* is the physical path to the target location directory; this value will be something like `C:\MySites\Output\BookReviews`, and should be delimited by quotation marks.</span></span>

## <a name="deploying-the-precompiled-website"></a><span data-ttu-id="8fc48-246">部署先行編譯的網站</span><span class="sxs-lookup"><span data-stu-id="8fc48-246">Deploying the Precompiled Website</span></span>

<span data-ttu-id="8fc48-247">現在我們已經看到如何使用 ASP.NET 編譯工具先行編譯網站，使用可更新而非可更新的使用者介面選項。</span><span class="sxs-lookup"><span data-stu-id="8fc48-247">At this point we have seen how to use the ASP.NET compilation tool to precompile a website using both the updatable and non-updatable user interface options.</span></span> <span data-ttu-id="8fc48-248">不過，我們的範例為止有先行編譯網站的本機資料夾，而非實際執行環境。</span><span class="sxs-lookup"><span data-stu-id="8fc48-248">However, our examples thus far have precompiled the website to a local folder, and not to the production environment.</span></span> <span data-ttu-id="8fc48-249">好消息是，部署先行編譯的網站是十分簡單，即可透過 Visual Studio 或其他一些檔案複製機制，例如從獨立的 FTP 用戶端。</span><span class="sxs-lookup"><span data-stu-id="8fc48-249">The good news is that deploying the precompiled website is a breeze and can be done through Visual Studio or through some other file copy mechanism, such as from a stand-alone FTP client.</span></span>

<span data-ttu-id="8fc48-250">[發行網站] 對話方塊 (在第一次顯示**圖 1**) 具有目標位置選項，指出先行編譯的網站檔案複製到其中。</span><span class="sxs-lookup"><span data-stu-id="8fc48-250">The Publish Web Site dialog box (first shown in **Figure 1**) has a target location option, which indicates where the precompiled website files are copied to.</span></span> <span data-ttu-id="8fc48-251">此位置可以是遠端網頁伺服器或 FTP 伺服器。</span><span class="sxs-lookup"><span data-stu-id="8fc48-251">This location can be a remote web server or FTP server.</span></span> <span data-ttu-id="8fc48-252">此文字方塊中輸入遠端伺服器時，會先行編譯，並將網站部署到在一個步驟中指定的伺服器。</span><span class="sxs-lookup"><span data-stu-id="8fc48-252">Entering a remote server into this textbox precompiles and deploys the website to the specified server in one step.</span></span> <span data-ttu-id="8fc48-253">或者，您可以先行編譯網站的本機資料夾，然後手動將該資料夾的內容複製到實際執行環境中透過 FTP 或某些其他方法。</span><span class="sxs-lookup"><span data-stu-id="8fc48-253">Alternatively, you can precompile the website to a local folder and then manually copy the contents of that folder to the production environment via FTP or some other approach.</span></span>

<span data-ttu-id="8fc48-254">需要透過 Visual Studio 的 [發行網站] 對話方塊會自動部署的先行編譯的網站很簡單的網站在有設定之間沒有差異開發和生產環境。</span><span class="sxs-lookup"><span data-stu-id="8fc48-254">Having the precompiled website automatically deployed via Visual Studio's Publish Web Site dialog box is helpful for simple sites where there are no configuration differences between the development and production environments.</span></span> <span data-ttu-id="8fc48-255">不過，如中所述[*通用組態差異之間開發和生產*教學課程](common-configuration-differences-between-development-and-production-vb.md)並不是罕見狀況存在這類差異。</span><span class="sxs-lookup"><span data-stu-id="8fc48-255">However, as noted in the [*Common Configuration Differences Between Development and Production* tutorial](common-configuration-differences-between-development-and-production-vb.md) it is not uncommon for such differences to exist.</span></span> <span data-ttu-id="8fc48-256">比方說，書籍檢閱 web 應用程式會在開發環境中比生產環境中使用不同的資料庫。</span><span class="sxs-lookup"><span data-stu-id="8fc48-256">For example, the Book Reviews web application uses a different database in the production environment than in the development environment.</span></span> <span data-ttu-id="8fc48-257">當 Visual Studio 會將網站發行到它盲目地複製設定檔資訊，在開發環境中的遠端伺服器。</span><span class="sxs-lookup"><span data-stu-id="8fc48-257">When Visual Studio publishes the website to a remote server it blindly copies up the configuration file information in the development environment.</span></span>

<span data-ttu-id="8fc48-258">設定開發和生產環境之間的差異站台可能是最佳先行編譯網站的本機目錄，複製的實際執行環境專屬的組態檔，然後將複製的先行編譯輸出內容生產環境。</span><span class="sxs-lookup"><span data-stu-id="8fc48-258">For sites with configuration differences between the development and production environments it may be best to precompile the site to a local directory, copy over the production-specific configuration files, and then copy the contents of the precompiled output to production.</span></span>

<span data-ttu-id="8fc48-259">如將檔案從開發環境複製到實際執行環境的重新整理程式，請參閱[*部署您使用 FTP 用戶端的網站*](deploying-your-site-using-an-ftp-client-vb.md)和[ *部署您的網站使用 Visual Studio* ](determining-what-files-need-to-be-deployed-vb.md)教學課程。</span><span class="sxs-lookup"><span data-stu-id="8fc48-259">For a refresher on copying files from the development environment to the production environment refer to the [*Deploying Your Website Using an FTP Client*](deploying-your-site-using-an-ftp-client-vb.md) and [*Deploying Your Website Using Visual Studio*](determining-what-files-need-to-be-deployed-vb.md) tutorials.</span></span>

## <a name="summary"></a><span data-ttu-id="8fc48-260">總結</span><span class="sxs-lookup"><span data-stu-id="8fc48-260">Summary</span></span>

<span data-ttu-id="8fc48-261">ASP.NET 支援兩種編譯模式： 自動與明確。</span><span class="sxs-lookup"><span data-stu-id="8fc48-261">ASP.NET supports two modes of compilation: automatic and explicit.</span></span> <span data-ttu-id="8fc48-262">如先前的教學課程所述，Web 應用程式專案 (WAPs) 會使用明確編譯，而預設的網站專案 (WSPs) 使用自動編譯、。</span><span class="sxs-lookup"><span data-stu-id="8fc48-262">As discussed in previous tutorials, Web Application Projects (WAPs) use explicit compilation whereas Web Site Projects (WSPs) use automatic compilation, by default.</span></span> <span data-ttu-id="8fc48-263">不過，它可能會明確編譯的 WSP 部署之前，先使用 ASP.NET 編譯工具。</span><span class="sxs-lookup"><span data-stu-id="8fc48-263">However, it is possible to explicitly compile a WSP prior to deployment by using the ASP.NET compilation tool.</span></span>

<span data-ttu-id="8fc48-264">本教學課程著重於部署支援的編譯工具先行編譯。</span><span class="sxs-lookup"><span data-stu-id="8fc48-264">This tutorial focused on the compilation tool's Precompilation for Deployment support.</span></span> <span data-ttu-id="8fc48-265">當先行編譯的部署，編譯工具建立的目標位置的資料夾、 編譯指定的 web 應用程式的原始程式碼，並將這些複製到目標位置資料夾編譯的組件和內容的檔案。</span><span class="sxs-lookup"><span data-stu-id="8fc48-265">When precompiling for deployment, the compilation tool creates a target location folder, compiles the specified web application's source code, and copies these compiled assemblies and the content files into the target location folder.</span></span> <span data-ttu-id="8fc48-266">編譯工具可以設定為建立可更新或非可更新的使用者介面。</span><span class="sxs-lookup"><span data-stu-id="8fc48-266">The compilation tool can be configured to create an updatable or non-updatable user interface.</span></span> <span data-ttu-id="8fc48-267">不可更新的使用者介面選項使用先行編譯，會移除在內容檔案中的宣告式標記。</span><span class="sxs-lookup"><span data-stu-id="8fc48-267">When precompiling with a non-updatable user interface option, the declarative markup in the content files is removed.</span></span> <span data-ttu-id="8fc48-268">簡而言之，先行編譯可讓您部署您的網站專案為基礎的應用程式，但不包含任何原始程式碼檔和以宣告式標記中移除，如有需要。</span><span class="sxs-lookup"><span data-stu-id="8fc48-268">In a nutshell, precompilation permits you to deploy your Web Site Project-based application without including any source code files and with the declarative markup removed, if desired.</span></span>

<span data-ttu-id="8fc48-269">祝您程式設計 ！</span><span class="sxs-lookup"><span data-stu-id="8fc48-269">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="8fc48-270">進一步閱讀</span><span class="sxs-lookup"><span data-stu-id="8fc48-270">Further Reading</span></span>

<span data-ttu-id="8fc48-271">如需有關在本教學課程所討論的主題的詳細資訊，請參閱下列資源：</span><span class="sxs-lookup"><span data-stu-id="8fc48-271">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="8fc48-272">ASP.NET 網站先行編譯</span><span class="sxs-lookup"><span data-stu-id="8fc48-272">ASP.NET Web Site Precompilation</span></span>](https://msdn.microsoft.com/library/ms228015.aspx)
- [<span data-ttu-id="8fc48-273">程式碼後置和 ASP.NET 2.0 中的編譯</span><span class="sxs-lookup"><span data-stu-id="8fc48-273">Codebehind and Compilation in ASP.NET 2.0</span></span>](https://msdn.microsoft.com/magazine/cc163675.aspx)
- [<span data-ttu-id="8fc48-274">在 ASP.NET 中的先行編譯</span><span class="sxs-lookup"><span data-stu-id="8fc48-274">Precompilation in ASP.NET</span></span>](http://www.odetocode.com/Articles/417.aspx)
- [<span data-ttu-id="8fc48-275">在 ASP.NET 中的 先行編譯的網站選項</span><span class="sxs-lookup"><span data-stu-id="8fc48-275">Precompiled Site Options in ASP.NET</span></span>](http://www.dotnetperls.com/precompiled)

> [!div class="step-by-step"]
> <span data-ttu-id="8fc48-276">[上一頁](logging-error-details-with-elmah-vb.md)
> [下一頁](users-and-roles-on-the-production-website-vb.md)</span><span class="sxs-lookup"><span data-stu-id="8fc48-276">[Previous](logging-error-details-with-elmah-vb.md)
[Next](users-and-roles-on-the-production-website-vb.md)</span></span>
