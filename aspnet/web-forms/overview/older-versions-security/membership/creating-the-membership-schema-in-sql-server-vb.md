---
uid: web-forms/overview/older-versions-security/membership/creating-the-membership-schema-in-sql-server-vb
title: 在 SQL Server (VB) 中建立成員資格結構描述 |Microsoft 文件
author: rick-anderson
description: 本教學課程一開始會檢查必要的結構描述加入資料庫，才能使用 SqlMembershipProvider 的技術。 接下來，我們 wi-fi...
ms.author: aspnetcontent
manager: wpickett
ms.date: 01/18/2008
ms.topic: article
ms.assetid: 112a674d-716f-41a6-99b8-4074d65a54c0
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-security/membership/creating-the-membership-schema-in-sql-server-vb
msc.type: authoredcontent
ms.openlocfilehash: 44458e8022f1f0d52cf136ad7fbaa5dd1f546632
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/10/2018
ms.locfileid: "30891753"
---
<a name="creating-the-membership-schema-in-sql-server-vb"></a><span data-ttu-id="4b720-104">在 SQL Server (VB) 中建立成員資格結構描述</span><span class="sxs-lookup"><span data-stu-id="4b720-104">Creating the Membership Schema in SQL Server (VB)</span></span>
====================
<span data-ttu-id="4b720-105">由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="4b720-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="4b720-106">[下載程式碼](http://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_04_VB.zip)或[下載 PDF](http://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial04_MembershipSetup_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="4b720-106">[Download Code](http://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_04_VB.zip) or [Download PDF](http://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial04_MembershipSetup_vb.pdf)</span></span>

> <span data-ttu-id="4b720-107">本教學課程一開始會檢查必要的結構描述加入資料庫，才能使用 SqlMembershipProvider 的技術。</span><span class="sxs-lookup"><span data-stu-id="4b720-107">This tutorial starts by examining techniques for adding the necessary schema to the database in order to use the SqlMembershipProvider.</span></span> <span data-ttu-id="4b720-108">接下來，我們會檢查結構描述中的索引鍵的資料表，並討論其用途和重要性。</span><span class="sxs-lookup"><span data-stu-id="4b720-108">Following that, we will examine the key tables in the schema and discuss their purpose and importance.</span></span> <span data-ttu-id="4b720-109">本教學課程結尾看看如何判斷 ASP.NET 應用程式成員資格架構應該使用哪一個提供者。</span><span class="sxs-lookup"><span data-stu-id="4b720-109">This tutorial ends with a look at how to tell an ASP.NET application which provider the Membership framework should use.</span></span>


## <a name="introduction"></a><span data-ttu-id="4b720-110">簡介</span><span class="sxs-lookup"><span data-stu-id="4b720-110">Introduction</span></span>

<span data-ttu-id="4b720-111">檢查使用表單驗證來識別網站訪客先前兩個教學課程。</span><span class="sxs-lookup"><span data-stu-id="4b720-111">The previous two tutorials examined using forms authentication to identify website visitors.</span></span> <span data-ttu-id="4b720-112">表單驗證架構可讓開發人員將使用者登入網站，並透過使用驗證票證的網頁瀏覽跨記得輕鬆。</span><span class="sxs-lookup"><span data-stu-id="4b720-112">The forms authentication framework makes it easy for developers to log a user into a website and to remember them across page visits through the use of authentication tickets.</span></span> <span data-ttu-id="4b720-113">`FormsAuthentication`類別包含產生票證，並將其加入訪客的 cookie 的方法。</span><span class="sxs-lookup"><span data-stu-id="4b720-113">The `FormsAuthentication` class includes methods for generating the ticket and adding it to the visitor's cookies.</span></span> <span data-ttu-id="4b720-114">`FormsAuthenticationModule`會檢查所有連入要求，對於具有有效的驗證票證，建立並將相關聯`GenericPrincipal`和`FormsIdentity`與目前要求的物件。</span><span class="sxs-lookup"><span data-stu-id="4b720-114">The `FormsAuthenticationModule` examines all incoming requests and, for those with a valid authentication ticket, creates and associates a `GenericPrincipal` and a `FormsIdentity` object with the current request.</span></span> <span data-ttu-id="4b720-115">表單驗證是只是一種機制訪客的驗證票證授與登入中，然後在後續要求中，剖析以判斷使用者的身分識別的票證時。</span><span class="sxs-lookup"><span data-stu-id="4b720-115">Forms authentication is merely a mechanism for granting an authentication ticket to a visitor when logging in and, on subsequent requests, parsing that ticket to determine the user's identity.</span></span> <span data-ttu-id="4b720-116">若要支援使用者帳戶是 web 應用程式，我們仍需要實作使用者存放區，並將功能加入至驗證認證，註冊新的使用者和其他使用者帳戶相關工作的相關。</span><span class="sxs-lookup"><span data-stu-id="4b720-116">For a web application to support user accounts, we still need to implement a user store and add functionality to validate credentials, register new users, and the myriad of other user account-related tasks.</span></span>

<span data-ttu-id="4b720-117">之前 ASP.NET 2.0 中，開發人員所實作的所有這些使用者帳戶相關工作的勾點上。</span><span class="sxs-lookup"><span data-stu-id="4b720-117">Prior to ASP.NET 2.0, developers were on the hook for implementing all of these user account-related tasks.</span></span> <span data-ttu-id="4b720-118">幸運的是 ASP.NET 團隊辨識此缺點，並導入的成員資格架構與 ASP.NET 2.0。</span><span class="sxs-lookup"><span data-stu-id="4b720-118">Fortunately the ASP.NET team recognized this shortcoming and introduced the Membership framework with ASP.NET 2.0.</span></span> <span data-ttu-id="4b720-119">成員資格架構是一組.NET Framework 中提供完成核心使用者帳戶相關工作的程式設計介面的類別。</span><span class="sxs-lookup"><span data-stu-id="4b720-119">The Membership framework is a set of classes in the .NET Framework that provide a programmatic interface for accomplishing core user account-related tasks.</span></span> <span data-ttu-id="4b720-120">此架構建置在之上[提供者模型](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx)，可讓開發人員的自訂的實作插入標準化的 API。</span><span class="sxs-lookup"><span data-stu-id="4b720-120">This framework is built atop the [provider model](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx), which allows developers to plug a customized implementation into a standardized API.</span></span>

<span data-ttu-id="4b720-121">中所述<a id="Tutorial1"> </a> [*安全性基本概念和 ASP.NET 支援*](../introduction/security-basics-and-asp-net-support-vb.md)教學課程中，.NET Framework 隨附兩個內建的成員資格提供者： [ `ActiveDirectoryMembershipProvider` ](https://msdn.microsoft.com/library/system.web.security.activedirectorymembershipprovider.aspx)和[ `SqlMembershipProvider` ](https://msdn.microsoft.com/library/system.web.security.sqlmembershipprovider.aspx)。</span><span class="sxs-lookup"><span data-stu-id="4b720-121">As discussed in the <a id="Tutorial1"></a>[*Security Basics and ASP.NET Support*](../introduction/security-basics-and-asp-net-support-vb.md) tutorial, the .NET Framework ships with two built-in Membership providers: [`ActiveDirectoryMembershipProvider`](https://msdn.microsoft.com/library/system.web.security.activedirectorymembershipprovider.aspx) and [`SqlMembershipProvider`](https://msdn.microsoft.com/library/system.web.security.sqlmembershipprovider.aspx).</span></span> <span data-ttu-id="4b720-122">正如其名，`SqlMembershipProvider`做為使用者存放區會使用 Microsoft SQL Server 資料庫。</span><span class="sxs-lookup"><span data-stu-id="4b720-122">As its name implies, the `SqlMembershipProvider` uses a Microsoft SQL Server database as the user store.</span></span> <span data-ttu-id="4b720-123">若要使用此提供者應用程式中，我們需要通知哪些資料庫做為存放區提供者。</span><span class="sxs-lookup"><span data-stu-id="4b720-123">In order to use this provider in an application, we need to tell the provider what database to use as the store.</span></span> <span data-ttu-id="4b720-124">您可以想像，`SqlMembershipProvider`預期要有特定的資料庫資料表、 檢視和預存程序的使用者存放區資料庫。</span><span class="sxs-lookup"><span data-stu-id="4b720-124">As you might imagine, the `SqlMembershipProvider` expects the user store database to have certain database tables, views, and stored procedures.</span></span> <span data-ttu-id="4b720-125">我們需要將這個預期的結構描述加入至選取的資料庫。</span><span class="sxs-lookup"><span data-stu-id="4b720-125">We need to add this expected schema to the selected database.</span></span>

<span data-ttu-id="4b720-126">本教學課程一開始會檢查必要的結構描述加入資料庫，若要使用的技術`SqlMembershipProvider`。</span><span class="sxs-lookup"><span data-stu-id="4b720-126">This tutorial starts by examining techniques for adding the necessary schema to the database in order to use the `SqlMembershipProvider`.</span></span> <span data-ttu-id="4b720-127">接下來，我們會檢查結構描述中的索引鍵的資料表，並討論其用途和重要性。</span><span class="sxs-lookup"><span data-stu-id="4b720-127">Following that, we will examine the key tables in the schema and discuss their purpose and importance.</span></span> <span data-ttu-id="4b720-128">本教學課程結尾看看如何判斷 ASP.NET 應用程式成員資格架構應該使用哪一個提供者。</span><span class="sxs-lookup"><span data-stu-id="4b720-128">This tutorial ends with a look at how to tell an ASP.NET application which provider the Membership framework should use.</span></span>

<span data-ttu-id="4b720-129">讓我們開始吧 ！</span><span class="sxs-lookup"><span data-stu-id="4b720-129">Let's get started!</span></span>

## <a name="step-1-deciding-where-to-place-the-user-store"></a><span data-ttu-id="4b720-130">步驟 1： 決定放置在使用者存放區位置</span><span class="sxs-lookup"><span data-stu-id="4b720-130">Step 1: Deciding Where to Place the User Store</span></span>

<span data-ttu-id="4b720-131">ASP.NET 應用程式的資料通常儲存在資料庫中的資料表數目。</span><span class="sxs-lookup"><span data-stu-id="4b720-131">An ASP.NET application's data is commonly stored in a number of tables in a database.</span></span> <span data-ttu-id="4b720-132">當實作`SqlMembershipProvider`我們必須決定是否要將成員資格結構描述放在相同的應用程式資料的資料庫或替代資料庫的資料庫結構描述。</span><span class="sxs-lookup"><span data-stu-id="4b720-132">When implementing the `SqlMembershipProvider` database schema we must decide whether to place the Membership schema in the same database as the application data or in an alternate database.</span></span>

<span data-ttu-id="4b720-133">我建議您為應用程式資料在相同資料庫中尋找的成員資格結構描述，原因如下：</span><span class="sxs-lookup"><span data-stu-id="4b720-133">I recommend locating the Membership schema in the same database as the application data for the following reasons:</span></span>

- <span data-ttu-id="4b720-134">**維護性**其資料會封裝在一個資料庫的應用程式是容易了解、 維護和部署於應用程式有兩個不同的資料庫。</span><span class="sxs-lookup"><span data-stu-id="4b720-134">**Maintainability** � an application whose data is encapsulated in one database is easier to understand, maintain, and deploy than an application that has two separate databases.</span></span>
- <span data-ttu-id="4b720-135">**關聯式完整性**尋找相同資料庫中的成員資格相關的資料表，為應用程式資料表它仍可建立[foreign key 條件約束](http://en.wikipedia.org/wiki/Foreign_key)之間的主索引鍵成員資格相關的資料表和相關的應用程式資料表。</span><span class="sxs-lookup"><span data-stu-id="4b720-135">**Relational Integrity** � by locating the Membership-related tables in the same database as the application tables it is possible to establish [foreign key constraints](http://en.wikipedia.org/wiki/Foreign_key) between the primary keys in the Membership-related tables and related application tables.</span></span>

<span data-ttu-id="4b720-136">使用者存放區和應用程式資料分離到不同的資料庫才有意義如果您有多個應用程式，每個使用不同的資料庫，但需要共用一般的使用者存放區。</span><span class="sxs-lookup"><span data-stu-id="4b720-136">Decoupling the user store and application data into separate databases only makes sense if you have multiple applications that each use separate databases, but need to share a common user store.</span></span>

### <a name="creating-a-database"></a><span data-ttu-id="4b720-137">建立資料庫</span><span class="sxs-lookup"><span data-stu-id="4b720-137">Creating a Database</span></span>

<span data-ttu-id="4b720-138">我們已自第二個教學課程建置的應用程式尚未不需要資料庫。</span><span class="sxs-lookup"><span data-stu-id="4b720-138">The application we have been building since the second tutorial has not yet needed a database.</span></span> <span data-ttu-id="4b720-139">我們需要一個現在，不過，在使用者存放區。</span><span class="sxs-lookup"><span data-stu-id="4b720-139">We need one now, however, for the user store.</span></span> <span data-ttu-id="4b720-140">讓我們建立一個，然後為其新增所需的結構描述`SqlMembershipProvider`提供者 （請參閱步驟 2）。</span><span class="sxs-lookup"><span data-stu-id="4b720-140">Let's create one and then add to it the schema required by the `SqlMembershipProvider` provider (see Step 2).</span></span>

> [!NOTE]
> <span data-ttu-id="4b720-141">在此教學課程系列，我們將使用[Microsoft SQL Server 2005 Express 的 Edition](https://msdn.microsoft.com/sql/Aa336346.aspx)資料庫來儲存應用程式資料表和`SqlMembershipProvider`結構描述。</span><span class="sxs-lookup"><span data-stu-id="4b720-141">Throughout this tutorial series we will be using a [Microsoft SQL Server 2005 Express Edition](https://msdn.microsoft.com/sql/Aa336346.aspx) database to store our application tables and the `SqlMembershipProvider` schema.</span></span> <span data-ttu-id="4b720-142">此決策的原因有二： 第一次，因為它的成本-免費的 Express Edition 是最 readably 存取版本的 SQL Server 2005;第二，SQL Server 2005 Express Edition 資料庫可以置於直接 web 應用程式的`App_Data`資料夾，讓您封裝資料庫和 web 應用程式一起在一個 ZIP 檔案，並沒有任何特殊的安裝指示來重新部署它很簡單或組態選項。</span><span class="sxs-lookup"><span data-stu-id="4b720-142">This decision was made for two reasons: first, due to its cost - free - the Express Edition is the most readably accessible version of SQL Server 2005; second, SQL Server 2005 Express Edition databases can be placed directly in the web application's `App_Data` folder, making it a cinch to package the database and web application together in one ZIP file and to redeploy it without any special setup instructions or configuration options.</span></span> <span data-ttu-id="4b720-143">如果您想要跟著做使用非-Express Edition 的 SQL Server 版本，則可以自由。</span><span class="sxs-lookup"><span data-stu-id="4b720-143">If you'd prefer to follow along using a non-Express Edition version of SQL Server, feel free.</span></span> <span data-ttu-id="4b720-144">會幾乎完全相同的步驟。</span><span class="sxs-lookup"><span data-stu-id="4b720-144">The steps are virtually identical.</span></span> <span data-ttu-id="4b720-145">`SqlMembershipProvider`結構描述會使用任何版本的 Microsoft SQL Server 2000 及最多。</span><span class="sxs-lookup"><span data-stu-id="4b720-145">The `SqlMembershipProvider` schema will work with any version of Microsoft SQL Server 2000 and up.</span></span>

<span data-ttu-id="4b720-146">從 方案總管 中，以滑鼠右鍵按一下`App_Data`資料夾，然後選擇 加入新項目。</span><span class="sxs-lookup"><span data-stu-id="4b720-146">From the Solution Explorer, right-click on the `App_Data` folder and choose to Add New Item.</span></span> <span data-ttu-id="4b720-147">(如果您沒有看到`App_Data`資料夾在專案中，以滑鼠右鍵按一下方案總管] 中的專案上，選取加入 ASP.NET 資料夾，然後挑選`App_Data`。)從 [加入新項目] 對話方塊中，選擇 [加入新的 SQL 資料庫名為`SecurityTutorials.mdf`。</span><span class="sxs-lookup"><span data-stu-id="4b720-147">(If you do not see an `App_Data` folder in your project, right-click on the project in Solution Explorer, select Add ASP.NET Folder, and pick `App_Data`.) From the Add New Item dialog box, choose to add a new SQL Database named `SecurityTutorials.mdf`.</span></span> <span data-ttu-id="4b720-148">在本教學課程中我們將`SqlMembershipProvider`至此資料庫，則在後續教學課程中我們將建立其他的結構描述來擷取應用程式資料的資料表。</span><span class="sxs-lookup"><span data-stu-id="4b720-148">In this tutorial we will add the `SqlMembershipProvider` schema to this database; in subsequent tutorials we will create additional tables to capture our application data.</span></span>


<span data-ttu-id="4b720-149">[![加入新的 SQL 資料庫名為 [App_Data] 資料夾 SecurityTutorials.mdf 資料庫](creating-the-membership-schema-in-sql-server-vb/_static/image2.png)](creating-the-membership-schema-in-sql-server-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="4b720-149">[![Add a New SQL Database Named SecurityTutorials.mdf Database to the App_Data Folder](creating-the-membership-schema-in-sql-server-vb/_static/image2.png)](creating-the-membership-schema-in-sql-server-vb/_static/image1.png)</span></span>

<span data-ttu-id="4b720-150">**圖 1**： 加入新的 SQL 資料庫 Named`SecurityTutorials.mdf`資料庫`App_Data`資料夾 ([按一下以檢視完整大小的影像](creating-the-membership-schema-in-sql-server-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="4b720-150">**Figure 1**: Add a New SQL Database Named `SecurityTutorials.mdf` Database to the `App_Data` Folder ([Click to view full-size image](creating-the-membership-schema-in-sql-server-vb/_static/image3.png))</span></span>


<span data-ttu-id="4b720-151">加入至資料庫`App_Data`資料夾會自動包含它在 [資料庫總管] 檢視中。</span><span class="sxs-lookup"><span data-stu-id="4b720-151">Adding a database to the `App_Data` folder automatically includes it in the Database Explorer view.</span></span> <span data-ttu-id="4b720-152">（在非-Express Edition 版本的 Visual Studio 中，[資料庫總管] 中稱為 [伺服器總管] 中。）移至 [資料庫總管] 並展開剛加入`SecurityTutorials`資料庫。</span><span class="sxs-lookup"><span data-stu-id="4b720-152">(In the non-Express Edition version of Visual Studio, the Database Explorer is called the Server Explorer.) Go to the Database Explorer and expand the just-added `SecurityTutorials` database.</span></span> <span data-ttu-id="4b720-153">如果您看不 [資料庫總管] 畫面上，移至 [檢視] 功能表並選擇 [資料庫總管] 中，或按 Ctrl + Alt + S。</span><span class="sxs-lookup"><span data-stu-id="4b720-153">If you do not see the Database Explorer on screen, go to the View menu and choose Database Explorer, or hit Ctrl+Alt+S.</span></span> <span data-ttu-id="4b720-154">如圖 2 所示，`SecurityTutorials`資料庫是空的-它包含沒有任何資料表、 檢視和任何預存程序。</span><span class="sxs-lookup"><span data-stu-id="4b720-154">As Figure 2 shows, the `SecurityTutorials` database is empty - it contains no tables, no views, and no stored procedures.</span></span>


<span data-ttu-id="4b720-155">[![SecurityTutorials 資料庫目前是空的](creating-the-membership-schema-in-sql-server-vb/_static/image5.png)](creating-the-membership-schema-in-sql-server-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="4b720-155">[![The SecurityTutorials Database is Currently Empty](creating-the-membership-schema-in-sql-server-vb/_static/image5.png)](creating-the-membership-schema-in-sql-server-vb/_static/image4.png)</span></span>

<span data-ttu-id="4b720-156">**圖 2**:`SecurityTutorials`資料庫目前是空的 ([按一下以檢視完整大小的影像](creating-the-membership-schema-in-sql-server-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="4b720-156">**Figure 2**: The `SecurityTutorials` Database is Currently Empty ([Click to view full-size image](creating-the-membership-schema-in-sql-server-vb/_static/image6.png))</span></span>


## <a name="step-2-adding-thesqlmembershipproviderschema-to-the-database"></a><span data-ttu-id="4b720-157">步驟 2： 加入`SqlMembershipProvider`資料庫結構描述</span><span class="sxs-lookup"><span data-stu-id="4b720-157">Step 2: Adding the`SqlMembershipProvider`Schema to the Database</span></span>

<span data-ttu-id="4b720-158">`SqlMembershipProvider`需要一組特定的資料表、 檢視和預存程序來安裝在使用者存放區資料庫中。</span><span class="sxs-lookup"><span data-stu-id="4b720-158">The `SqlMembershipProvider` requires a particular set of tables, views, and stored procedures to be installed in the user store database.</span></span> <span data-ttu-id="4b720-159">這些必要的資料庫物件可以使用加入[`aspnet_regsql.exe`工具](https://msdn.microsoft.com/library/ms229862.aspx)。</span><span class="sxs-lookup"><span data-stu-id="4b720-159">These requisite database objects can be added using the [`aspnet_regsql.exe` tool](https://msdn.microsoft.com/library/ms229862.aspx).</span></span> <span data-ttu-id="4b720-160">此檔案位於`%WINDIR%\Microsoft.Net\Framework\v2.0.50727\`資料夾。</span><span class="sxs-lookup"><span data-stu-id="4b720-160">This file is located in the `%WINDIR%\Microsoft.Net\Framework\v2.0.50727\` folder.</span></span>

> [!NOTE]
> <span data-ttu-id="4b720-161">`aspnet_regsql.exe`工具提供圖形化使用者介面和命令列功能。</span><span class="sxs-lookup"><span data-stu-id="4b720-161">The `aspnet_regsql.exe` tool offers both command line functionality and a graphical user interface.</span></span> <span data-ttu-id="4b720-162">是易記的多個使用者，我們將在本教學課程檢視圖形化介面。</span><span class="sxs-lookup"><span data-stu-id="4b720-162">The graphical interface is more user friendly and is what we will examine in this tutorial.</span></span> <span data-ttu-id="4b720-163">命令列介面狀況中很有用的加法`SqlMembershipProvider`結構描述必須為自動化，例如組建指令碼或自動化測試案例。</span><span class="sxs-lookup"><span data-stu-id="4b720-163">The command line interface is useful when the addition of the `SqlMembershipProvider` schema needs to be automated, such as in build scripts or automated testing scenarios.</span></span>

<span data-ttu-id="4b720-164">`aspnet_regsql.exe`工具可用來新增或移除*ASP.NET 應用程式服務*到指定的 SQL Server 資料庫。</span><span class="sxs-lookup"><span data-stu-id="4b720-164">The `aspnet_regsql.exe` tool is used to add or remove *ASP.NET application services* to a specified SQL Server database.</span></span> <span data-ttu-id="4b720-165">ASP.NET 應用程式服務包含的結構描述`SqlMembershipProvider`和`SqlRoleProvider`，以及其他 ASP.NET 2.0 架構的 SQL 為基礎提供者的結構描述。</span><span class="sxs-lookup"><span data-stu-id="4b720-165">The ASP.NET application services encompass the schemas for the `SqlMembershipProvider` and `SqlRoleProvider`, along with the schemas for the SQL-based providers for other ASP.NET 2.0 frameworks.</span></span> <span data-ttu-id="4b720-166">我們需要提供資訊的兩個位元`aspnet_regsql.exe`工具：</span><span class="sxs-lookup"><span data-stu-id="4b720-166">We need to provide two bits of information to the `aspnet_regsql.exe` tool:</span></span>

- <span data-ttu-id="4b720-167">是否要加入或移除應用程式服務和</span><span class="sxs-lookup"><span data-stu-id="4b720-167">Whether we want to add or remove application services, and</span></span>
- <span data-ttu-id="4b720-168">要加入或移除應用程式服務結構描述資料庫</span><span class="sxs-lookup"><span data-stu-id="4b720-168">The database from which to add or remove the application services schema</span></span>

<span data-ttu-id="4b720-169">在資料庫使用時，提示您輸入`aspnet_regsql.exe`工具會詢問一些我們提供的安全性認證，連接到資料庫的資料庫所在的伺服器名稱和資料庫名稱。</span><span class="sxs-lookup"><span data-stu-id="4b720-169">In prompting for the database to use, the `aspnet_regsql.exe` tool asks us to provide the name of the server the database resides on, the security credentials for connecting to the database, and the database name.</span></span> <span data-ttu-id="4b720-170">如果您使用非 Express Edition 的 SQL Server，您應該已經知道這項資訊，因為它是使用透過 ASP.NET 網頁上的資料庫時，您必須提供連接字串透過相同的資訊。</span><span class="sxs-lookup"><span data-stu-id="4b720-170">If you are using the non-Express Edition of SQL Server, you should already know this information, as it is the same information you must provide through a connection string when working with the database through an ASP.NET web page.</span></span> <span data-ttu-id="4b720-171">使用中的 SQL Server 2005 Express Edition 資料庫時，判斷伺服器和資料庫名稱`App_Data`資料夾中，不過，會稍微更為複雜。</span><span class="sxs-lookup"><span data-stu-id="4b720-171">Determining the server and database name when using a SQL Server 2005 Express Edition database in the `App_Data` folder, however, is a bit more involved.</span></span>

<span data-ttu-id="4b720-172">下一節會檢查指定的伺服器和資料庫名稱中的 SQL Server 2005 Express Edition 資料庫最直接的方式`App_Data`資料夾。</span><span class="sxs-lookup"><span data-stu-id="4b720-172">The following section examines a straightforward way for specifying the server and database name for a SQL Server 2005 Express Edition database in the `App_Data` folder.</span></span> <span data-ttu-id="4b720-173">如果您不想要使用 SQL Server 2005 Express Edition 可自由安裝，請直接前往 [應用程式服務] 區段。</span><span class="sxs-lookup"><span data-stu-id="4b720-173">If you are not using SQL Server 2005 Express Edition feel free to skip ahead to the Installing the Application Services section.</span></span>

### <a name="determining-the-server-and-database-name-for-a-sql-server-2005-express-edition-database-in-theappdatafolder"></a><span data-ttu-id="4b720-174">判斷伺服器和資料庫名稱中的 SQL Server 2005 Express Edition 資料庫`App_Data`資料夾</span><span class="sxs-lookup"><span data-stu-id="4b720-174">Determining the Server and Database Name for a SQL Server 2005 Express Edition Database in the`App_Data`Folder</span></span>

<span data-ttu-id="4b720-175">若要使用`aspnet_regsql.exe`我們需要知道的伺服器和資料庫名稱的工具。</span><span class="sxs-lookup"><span data-stu-id="4b720-175">In order to use the `aspnet_regsql.exe` tool we need to know the server and database names.</span></span> <span data-ttu-id="4b720-176">伺服器名稱是`localhost\InstanceName`。</span><span class="sxs-lookup"><span data-stu-id="4b720-176">The server name is `localhost\InstanceName`.</span></span> <span data-ttu-id="4b720-177">最有可能*InstanceName*是`SQLExpress`。</span><span class="sxs-lookup"><span data-stu-id="4b720-177">Most likely, the *InstanceName* is `SQLExpress`.</span></span> <span data-ttu-id="4b720-178">不過，如果您手動安裝 SQL Server 2005 Express Edition （也就是您未安裝它自動安裝 Visual Studio 時），則很可能您選取不同的執行個體名稱。</span><span class="sxs-lookup"><span data-stu-id="4b720-178">However, if you installed SQL Server 2005 Express Edition manually (that is, you did not install it automatically while installing Visual Studio), then it is possible that you selected a different instance name.</span></span>

<span data-ttu-id="4b720-179">資料庫名稱是以判斷需要一點的技巧。</span><span class="sxs-lookup"><span data-stu-id="4b720-179">The database name is a bit trickier to determine.</span></span> <span data-ttu-id="4b720-180">中的資料庫`App_Data`資料夾通常會有一個包含的資料庫名稱[全域唯一識別碼](http://en.wikipedia.org/wiki/Globally_Unique_Identifier)以及資料庫檔案的路徑。</span><span class="sxs-lookup"><span data-stu-id="4b720-180">Databases in the `App_Data` folder typically have a database name that includes a [globally unique identifier](http://en.wikipedia.org/wiki/Globally_Unique_Identifier) along with the path to the database file.</span></span> <span data-ttu-id="4b720-181">我們需要決定此資料庫名稱以加入應用程式服務結構描述，透過`aspnet_regsql.exe`。</span><span class="sxs-lookup"><span data-stu-id="4b720-181">We need to determine this database name in order to add the application services schema through `aspnet_regsql.exe`.</span></span>

<span data-ttu-id="4b720-182">確定資料庫名稱的最簡單方式是檢查透過 SQL Server Management Studio。</span><span class="sxs-lookup"><span data-stu-id="4b720-182">The easiest way to ascertain the database name is to examine it through SQL Server Management Studio.</span></span> <span data-ttu-id="4b720-183">SQL Server Management Studio 提供圖形化介面，以管理 SQL Server 2005 資料庫，但它並未隨附 Express Edition 的 SQL Server 2005。</span><span class="sxs-lookup"><span data-stu-id="4b720-183">SQL Server Management Studio provides a graphical interface for managing SQL Server 2005 databases, but it does not ship with the Express Edition of SQL Server 2005.</span></span> <span data-ttu-id="4b720-184">好消息是[可以下載](https://www.microsoft.com/downloads/details.aspx?FamilyId=C243A5AE-4BD1-4E3D-94B8-5A0F62BF7796&amp;displaylang=en)免費 Express Edition 的 SQL Server Management Studio。</span><span class="sxs-lookup"><span data-stu-id="4b720-184">The good news is that [you can download](https://www.microsoft.com/downloads/details.aspx?FamilyId=C243A5AE-4BD1-4E3D-94B8-5A0F62BF7796&amp;displaylang=en) the free Express Edition of SQL Server Management Studio.</span></span>

> [!NOTE]
> <span data-ttu-id="4b720-185">如果您也可以安裝在桌面上，則可能已安裝 Management Studio 的完整版本的 SQL Server 2005 的非-Express Edition 版本。</span><span class="sxs-lookup"><span data-stu-id="4b720-185">If you also have a non-Express Edition version of SQL Server 2005 installed on your desktop then the full version of Management Studio is likely installed.</span></span> <span data-ttu-id="4b720-186">若要判斷資料庫名稱，遵循相同的步驟，如下所述的 Express Edition，您可以使用完整版。</span><span class="sxs-lookup"><span data-stu-id="4b720-186">You can use the full version to determine the database name, following the same steps as outlined below for the Express Edition.</span></span>

<span data-ttu-id="4b720-187">開始關閉 Visual Studio 以確定資料庫檔案上的 Visual Studio 所加諸任何鎖定，會關閉。</span><span class="sxs-lookup"><span data-stu-id="4b720-187">Start by closing Visual Studio to ensure that any locks imposed by Visual Studio on the database file are closed.</span></span> <span data-ttu-id="4b720-188">接下來，啟動 SQL Server Management Studio 並連接到`localhost\InstanceName`適用於 SQL Server 2005 Express Edition 資料庫。</span><span class="sxs-lookup"><span data-stu-id="4b720-188">Next, launch SQL Server Management Studio and connect to the `localhost\InstanceName` database for SQL Server 2005 Express Edition.</span></span> <span data-ttu-id="4b720-189">如前文所述，機率是執行個體名稱是`SQLExpress`。</span><span class="sxs-lookup"><span data-stu-id="4b720-189">As noted earlier, chances are the instance name is `SQLExpress`.</span></span> <span data-ttu-id="4b720-190">針對 [驗證] 選項中，選取 Windows 驗證。</span><span class="sxs-lookup"><span data-stu-id="4b720-190">For the Authentication option, select Windows Authentication.</span></span>


<span data-ttu-id="4b720-191">[![連接到 SQL Server 2005 Express Edition 執行個體](creating-the-membership-schema-in-sql-server-vb/_static/image8.png)](creating-the-membership-schema-in-sql-server-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="4b720-191">[![Connect to the SQL Server 2005 Express Edition Instance](creating-the-membership-schema-in-sql-server-vb/_static/image8.png)](creating-the-membership-schema-in-sql-server-vb/_static/image7.png)</span></span>

<span data-ttu-id="4b720-192">**圖 3**： 連接到 SQL Server 2005 Express Edition 執行個體 ([按一下以檢視完整大小的影像](creating-the-membership-schema-in-sql-server-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="4b720-192">**Figure 3**: Connect to the SQL Server 2005 Express Edition Instance ([Click to view full-size image](creating-the-membership-schema-in-sql-server-vb/_static/image9.png))</span></span>


<span data-ttu-id="4b720-193">連接到 SQL Server 2005 Express Edition 執行個體之後，Management Studio 會顯示資料庫、 安全性設定、 伺服器物件和等等的資料夾。</span><span class="sxs-lookup"><span data-stu-id="4b720-193">After connecting to the SQL Server 2005 Express Edition instance, Management Studio displays folders for the Databases, the Security settings, the Server Objects, and so on.</span></span> <span data-ttu-id="4b720-194">如果您展開 [資料庫] 索引標籤您會看到`SecurityTutorials.mdf`資料庫是*不*登錄的資料庫執行個體-我們需要將資料庫附加到第一次。</span><span class="sxs-lookup"><span data-stu-id="4b720-194">If you expand the Databases tab you will see that the `SecurityTutorials.mdf` database is *not* registered in the database instance - we need to attach the database first.</span></span>

<span data-ttu-id="4b720-195">以滑鼠右鍵按一下 資料庫 資料夾，並從內容功能表中選擇 附加。</span><span class="sxs-lookup"><span data-stu-id="4b720-195">Right-click on the Databases folder and choose Attach from the context menu.</span></span> <span data-ttu-id="4b720-196">這會顯示 [附加資料庫] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="4b720-196">This will display the Attach Databases dialog box.</span></span> <span data-ttu-id="4b720-197">從這裡開始，請按一下 [新增] 按鈕，瀏覽至`SecurityTutorials.mdf`資料庫，然後按一下 [確定]。</span><span class="sxs-lookup"><span data-stu-id="4b720-197">From here, click the Add button, browse to the `SecurityTutorials.mdf` database, and click OK.</span></span> <span data-ttu-id="4b720-198">圖 4 顯示在 [附加資料庫] 對話方塊中之後,`SecurityTutorials.mdf`選取資料庫。</span><span class="sxs-lookup"><span data-stu-id="4b720-198">Figure 4 shows the Attach Databases dialog box after the `SecurityTutorials.mdf` database has been selected.</span></span> <span data-ttu-id="4b720-199">圖 5 顯示 Management Studio 物件總管 中，成功地附加資料庫之後。</span><span class="sxs-lookup"><span data-stu-id="4b720-199">Figure 5 shows Management Studio's Object Explorer after the database has been successfully attached.</span></span>


<span data-ttu-id="4b720-200">[![附加 SecurityTutorials.mdf 資料庫](creating-the-membership-schema-in-sql-server-vb/_static/image11.png)](creating-the-membership-schema-in-sql-server-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="4b720-200">[![Attach the SecurityTutorials.mdf Database](creating-the-membership-schema-in-sql-server-vb/_static/image11.png)](creating-the-membership-schema-in-sql-server-vb/_static/image10.png)</span></span>

<span data-ttu-id="4b720-201">**圖 4**： 附加`SecurityTutorials.mdf`資料庫 ([按一下以檢視完整大小的影像](creating-the-membership-schema-in-sql-server-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="4b720-201">**Figure 4**: Attach the `SecurityTutorials.mdf` Database ([Click to view full-size image](creating-the-membership-schema-in-sql-server-vb/_static/image12.png))</span></span>


<span data-ttu-id="4b720-202">[![SecurityTutorials.mdf 資料庫會出現在 [資料庫] 資料夾](creating-the-membership-schema-in-sql-server-vb/_static/image14.png)](creating-the-membership-schema-in-sql-server-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="4b720-202">[![The SecurityTutorials.mdf Database Appears in the Databases Folder](creating-the-membership-schema-in-sql-server-vb/_static/image14.png)](creating-the-membership-schema-in-sql-server-vb/_static/image13.png)</span></span>

<span data-ttu-id="4b720-203">**圖 5**:`SecurityTutorials.mdf`資料庫出現在 [資料庫] 資料夾中 ([按一下以檢視完整大小的影像](creating-the-membership-schema-in-sql-server-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="4b720-203">**Figure 5**: The `SecurityTutorials.mdf` Database Appears in the Databases Folder ([Click to view full-size image](creating-the-membership-schema-in-sql-server-vb/_static/image15.png))</span></span>


<span data-ttu-id="4b720-204">如圖 5 所示，`SecurityTutorials.mdf`資料庫有而 abstruse 的名稱。</span><span class="sxs-lookup"><span data-stu-id="4b720-204">As Figure 5 shows, the `SecurityTutorials.mdf` database has a rather abstruse name.</span></span> <span data-ttu-id="4b720-205">以更好記 （和比較好輸入） 讓我們來變更名稱。</span><span class="sxs-lookup"><span data-stu-id="4b720-205">Let's change it to a more memorable (and easier to type) name.</span></span> <span data-ttu-id="4b720-206">以滑鼠右鍵按一下資料庫、 從內容功能表中，選擇 重新命名和重新命名`SecurityTutorialsDatabase`。</span><span class="sxs-lookup"><span data-stu-id="4b720-206">Right-click on the database, choose Rename from the context menu, and rename it `SecurityTutorialsDatabase`.</span></span> <span data-ttu-id="4b720-207">這不會變更檔案名稱，只是名稱的資料庫使用的 SQL server 識別。</span><span class="sxs-lookup"><span data-stu-id="4b720-207">This does not change the filename, just the name the database uses to identify itself to SQL Server.</span></span>


<span data-ttu-id="4b720-208">[![將資料庫重新命名為 SecurityTutorialsDatabase](creating-the-membership-schema-in-sql-server-vb/_static/image17.png)](creating-the-membership-schema-in-sql-server-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="4b720-208">[![Rename the Database to SecurityTutorialsDatabase](creating-the-membership-schema-in-sql-server-vb/_static/image17.png)](creating-the-membership-schema-in-sql-server-vb/_static/image16.png)</span></span>

<span data-ttu-id="4b720-209">**圖 6**： 資料庫重新命名為`SecurityTutorialsDatabase`([按一下以檢視完整大小的影像](creating-the-membership-schema-in-sql-server-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="4b720-209">**Figure 6**: Rename the Database to `SecurityTutorialsDatabase`([Click to view full-size image](creating-the-membership-schema-in-sql-server-vb/_static/image18.png))</span></span>


<span data-ttu-id="4b720-210">此時我們知道的伺服器和資料庫名稱`SecurityTutorials.mdf`資料庫檔案：`localhost\InstanceName`和`SecurityTutorialsDatabase`分別。</span><span class="sxs-lookup"><span data-stu-id="4b720-210">At this point we know the server and database names for the `SecurityTutorials.mdf` database file: `localhost\InstanceName` and `SecurityTutorialsDatabase`, respectively.</span></span> <span data-ttu-id="4b720-211">我們現在已經準備好安裝應用程式服務，透過`aspnet_regsql.exe`工具。</span><span class="sxs-lookup"><span data-stu-id="4b720-211">We are now ready to install the application services through the `aspnet_regsql.exe` tool.</span></span>

### <a name="installing-the-application-services"></a><span data-ttu-id="4b720-212">安裝應用程式服務</span><span class="sxs-lookup"><span data-stu-id="4b720-212">Installing the Application Services</span></span>

<span data-ttu-id="4b720-213">若要啟動`aspnet_regsql.exe`工具，請移至 [開始] 功能表，並選擇 [執行]。</span><span class="sxs-lookup"><span data-stu-id="4b720-213">To launch the `aspnet_regsql.exe` tool, go to the start menu and choose Run.</span></span> <span data-ttu-id="4b720-214">輸入`%WINDIR%\Microsoft.Net\Framework\v2.0.50727\aspnet_regsql.exe` 文字方塊中按一下 確定。</span><span class="sxs-lookup"><span data-stu-id="4b720-214">Enter `%WINDIR%\Microsoft.Net\Framework\v2.0.50727\aspnet_regsql.exe` into the textbox and click OK.</span></span> <span data-ttu-id="4b720-215">或者，您可以使用 Windows 檔案總管 向下鑽研至適當的資料夾，然後按兩下`aspnet_regsql.exe`檔案。</span><span class="sxs-lookup"><span data-stu-id="4b720-215">Alternatively, you can use Windows Explorer to drill down to the appropriate folder and double-click the `aspnet_regsql.exe` file.</span></span> <span data-ttu-id="4b720-216">兩種方法將 net 相同的結果。</span><span class="sxs-lookup"><span data-stu-id="4b720-216">Either approach will net the same results.</span></span>

<span data-ttu-id="4b720-217">執行`aspnet_regsql.exe`工具沒有任何命令列引數會啟動 ASP.NET SQL Server 安裝精靈圖形化使用者介面。</span><span class="sxs-lookup"><span data-stu-id="4b720-217">Running the `aspnet_regsql.exe` tool without any command line arguments launches the ASP.NET SQL Server Setup Wizard graphical user interface.</span></span> <span data-ttu-id="4b720-218">精靈可讓您輕鬆地新增或移除指定的資料庫上的 ASP.NET 應用程式服務。</span><span class="sxs-lookup"><span data-stu-id="4b720-218">The wizard makes it easy to add or remove the ASP.NET application services on a specified database.</span></span> <span data-ttu-id="4b720-219">圖 7 所示在精靈的第一個畫面會描述工具的用途。</span><span class="sxs-lookup"><span data-stu-id="4b720-219">The first screen of the wizard, shown in Figure 7, describes the purpose of the tool.</span></span>


<span data-ttu-id="4b720-220">[![若要加入的成員資格結構描述中使用 ASP.NET SQL Server 安裝精靈可使](creating-the-membership-schema-in-sql-server-vb/_static/image20.png)](creating-the-membership-schema-in-sql-server-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="4b720-220">[![Use the ASP.NET SQL Server Setup Wizard Makes to Add the Membership Schema](creating-the-membership-schema-in-sql-server-vb/_static/image20.png)](creating-the-membership-schema-in-sql-server-vb/_static/image19.png)</span></span>

<span data-ttu-id="4b720-221">**圖 7**： 使用 ASP.NET SQL Server 安裝精靈就會加入成員資格結構描述 ([按一下以檢視完整大小的影像](creating-the-membership-schema-in-sql-server-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="4b720-221">**Figure 7**: Use the ASP.NET SQL Server Setup Wizard Makes to Add the Membership Schema ([Click to view full-size image](creating-the-membership-schema-in-sql-server-vb/_static/image21.png))</span></span>


<span data-ttu-id="4b720-222">精靈中的第二個步驟會詢問我們是否我們要加入應用程式服務，或將它們移除。</span><span class="sxs-lookup"><span data-stu-id="4b720-222">The second step in the wizard asks us whether we want to add the application services or remove them.</span></span> <span data-ttu-id="4b720-223">因為我們想要加入資料表、 檢視和預存程序所需的`SqlMembershipProvider`，選擇 [設定 SQL Server 的應用程式服務] 選項。</span><span class="sxs-lookup"><span data-stu-id="4b720-223">Since we want to add the tables, views, and stored procedures necessary for the `SqlMembershipProvider`, choose the Configure SQL Server for application services option.</span></span> <span data-ttu-id="4b720-224">稍後，如果您想要從資料庫中移除這個結構描述，重新執行此精靈中，但改為從現有的資料庫選項中選擇 移除應用程式服務資訊。</span><span class="sxs-lookup"><span data-stu-id="4b720-224">Later, if you want to remove this schema from your database, re-run this wizard, but instead choose the Remove application services information from an existing database option.</span></span>


<span data-ttu-id="4b720-225">[![選擇應用程式服務選項設定 SQL Server](creating-the-membership-schema-in-sql-server-vb/_static/image23.png)](creating-the-membership-schema-in-sql-server-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="4b720-225">[![Choose the Configure SQL Server for Application Services Option](creating-the-membership-schema-in-sql-server-vb/_static/image23.png)](creating-the-membership-schema-in-sql-server-vb/_static/image22.png)</span></span>

<span data-ttu-id="4b720-226">**圖 8**： 為應用程式服務] 選項中選擇 [設定 SQL Server ([按一下以檢視完整大小的影像](creating-the-membership-schema-in-sql-server-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="4b720-226">**Figure 8**: Choose the Configure SQL Server for Application Services Option ([Click to view full-size image](creating-the-membership-schema-in-sql-server-vb/_static/image24.png))</span></span>


<span data-ttu-id="4b720-227">第三個步驟提示的資料庫資訊： 伺服器名稱、 驗證資訊，以及資料庫名稱。</span><span class="sxs-lookup"><span data-stu-id="4b720-227">The third step prompts for the database information: the server name, authentication information, and the database name.</span></span> <span data-ttu-id="4b720-228">如果您已將其遵循本教學課程，並已加入`SecurityTutorials.mdf`資料庫`App_Data`，附加至`localhost\InstanceName`，和它重新命名為`SecurityTutorialsDatabase`，然後使用下列值：</span><span class="sxs-lookup"><span data-stu-id="4b720-228">If you have been following along with this tutorial and have added the `SecurityTutorials.mdf` database to `App_Data`, attached it to `localhost\InstanceName`, and renamed it to `SecurityTutorialsDatabase`, then use the following values:</span></span>

- <span data-ttu-id="4b720-229">伺服器： `localhost\InstanceName`</span><span class="sxs-lookup"><span data-stu-id="4b720-229">Server: `localhost\InstanceName`</span></span>
- <span data-ttu-id="4b720-230">Windows 驗證</span><span class="sxs-lookup"><span data-stu-id="4b720-230">Windows authentication</span></span>
- <span data-ttu-id="4b720-231">資料庫： `SecurityTutorialsDatabase`</span><span class="sxs-lookup"><span data-stu-id="4b720-231">Database: `SecurityTutorialsDatabase`</span></span>


<span data-ttu-id="4b720-232">[![輸入資料庫的資訊](creating-the-membership-schema-in-sql-server-vb/_static/image26.png)](creating-the-membership-schema-in-sql-server-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="4b720-232">[![Enter the Database Information](creating-the-membership-schema-in-sql-server-vb/_static/image26.png)](creating-the-membership-schema-in-sql-server-vb/_static/image25.png)</span></span>

<span data-ttu-id="4b720-233">**圖 9**： 輸入資料庫的資訊 ([按一下以檢視完整大小的影像](creating-the-membership-schema-in-sql-server-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="4b720-233">**Figure 9**: Enter the Database Information ([Click to view full-size image](creating-the-membership-schema-in-sql-server-vb/_static/image27.png))</span></span>


<span data-ttu-id="4b720-234">輸入資料庫資訊後，按 下一步。</span><span class="sxs-lookup"><span data-stu-id="4b720-234">After entering the database information, click Next.</span></span> <span data-ttu-id="4b720-235">最後一個步驟摘要說明將採取的步驟。</span><span class="sxs-lookup"><span data-stu-id="4b720-235">The final step summarizes the steps that will be taken.</span></span> <span data-ttu-id="4b720-236">若要安裝的應用程式服務，然後在完成精靈，請按下一步。</span><span class="sxs-lookup"><span data-stu-id="4b720-236">Click Next to install the application services and then Finish to complete the wizard.</span></span>

> [!NOTE]
> <span data-ttu-id="4b720-237">如果您使用 Management Studio 來附加資料庫，並重新命名資料庫檔案時，務必卸離資料庫，然後關閉再重新開啟 Visual Studio 的 Management Studio。</span><span class="sxs-lookup"><span data-stu-id="4b720-237">If you used Management Studio to attach the database and rename the database file, be sure to detach the database and close Management Studio before reopening Visual Studio.</span></span> <span data-ttu-id="4b720-238">若要卸離`SecurityTutorialsDatabase`資料庫、 以滑鼠右鍵按一下資料庫名稱，從 工作 功能表中，選擇 卸離。</span><span class="sxs-lookup"><span data-stu-id="4b720-238">To detach the `SecurityTutorialsDatabase` database, right-click on the database name and, from the Tasks menu, choose Detach.</span></span>

<span data-ttu-id="4b720-239">完成精靈的詳細資訊，返回 Visual Studio 和瀏覽至 [資料庫總管] 中。</span><span class="sxs-lookup"><span data-stu-id="4b720-239">Upon completion of the wizard, return to Visual Studio and navigate to the Database Explorer.</span></span> <span data-ttu-id="4b720-240">展開 [資料表] 資料夾。</span><span class="sxs-lookup"><span data-stu-id="4b720-240">Expand the Tables folder.</span></span> <span data-ttu-id="4b720-241">您應該會看到一系列的資料表名稱開頭為前置詞`aspnet_`。</span><span class="sxs-lookup"><span data-stu-id="4b720-241">You should see a series of tables whose names start with the prefix `aspnet_`.</span></span> <span data-ttu-id="4b720-242">同樣地，可以檢視和預存程序資料夾下找到各種不同的檢視和預存程序。</span><span class="sxs-lookup"><span data-stu-id="4b720-242">Likewise, a variety of views and stored procedures can be found under the Views and Stored Procedures folders.</span></span> <span data-ttu-id="4b720-243">這些資料庫物件組成的應用程式服務結構描述。</span><span class="sxs-lookup"><span data-stu-id="4b720-243">These database objects make up the application services schema.</span></span> <span data-ttu-id="4b720-244">我們會檢查在步驟 3 中的成員資格和角色特定資料庫物件。</span><span class="sxs-lookup"><span data-stu-id="4b720-244">We will examine the membership- and role-specific database objects in Step 3.</span></span>


<span data-ttu-id="4b720-245">[![資料庫已加入各種不同的資料表、 檢視和預存程序](creating-the-membership-schema-in-sql-server-vb/_static/image29.png)](creating-the-membership-schema-in-sql-server-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="4b720-245">[![A Variety of Tables, Views, and Stored Procedures Have Been Added to the Database](creating-the-membership-schema-in-sql-server-vb/_static/image29.png)](creating-the-membership-schema-in-sql-server-vb/_static/image28.png)</span></span>

<span data-ttu-id="4b720-246">**圖 10**: 各種不同的資料表、 檢視和預存程序已新增至資料庫 ([按一下以檢視完整大小的影像](creating-the-membership-schema-in-sql-server-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="4b720-246">**Figure 10**: A Variety of Tables, Views, and Stored Procedures Have Been Added to the Database ([Click to view full-size image](creating-the-membership-schema-in-sql-server-vb/_static/image30.png))</span></span>


> [!NOTE]
> <span data-ttu-id="4b720-247">`aspnet_regsql.exe`工具的圖形化使用者介面安裝整個應用程式服務結構描述。</span><span class="sxs-lookup"><span data-stu-id="4b720-247">The `aspnet_regsql.exe` tool's graphical user interface installs the entire application services schema.</span></span> <span data-ttu-id="4b720-248">執行時，但`aspnet_regsql.exe`從命令列您可以指定哪些特定的應用程式服務元件安裝 （或移除）。</span><span class="sxs-lookup"><span data-stu-id="4b720-248">But when executing `aspnet_regsql.exe` from the command-line you can specify what particular application services components to install (or remove).</span></span> <span data-ttu-id="4b720-249">因此，如果您想要加入只在資料表、 檢視，和預存程序所需的`SqlMembershipProvider`和`SqlRoleProvider`提供者，執行`aspnet_regsql.exe`從命令列。</span><span class="sxs-lookup"><span data-stu-id="4b720-249">Therefore, if you want to add just the tables, views, and stored procedures necessary for the `SqlMembershipProvider` and `SqlRoleProvider` providers, run `aspnet_regsql.exe` from the command-line.</span></span> <span data-ttu-id="4b720-250">或者，您可以手動執行適當的 T-SQL 子集建立所使用的指令碼`aspnet_regsql.exe`。</span><span class="sxs-lookup"><span data-stu-id="4b720-250">Alternatively, you can manually run the appropriate subset of T-SQL create scripts used by `aspnet_regsql.exe`.</span></span> <span data-ttu-id="4b720-251">這些指令碼位於`WINDIR%\Microsoft.Net\Framework\v2.0.50727\`資料夾的名稱可能類似`InstallCommon.sql`， `InstallMembership.sql`， `InstallRoles.sql`， `InstallProfile.sql`， `InstallSqlState.sql`，依此類推。</span><span class="sxs-lookup"><span data-stu-id="4b720-251">These scripts are located in the `WINDIR%\Microsoft.Net\Framework\v2.0.50727\` folder with names like `InstallCommon.sql`, `InstallMembership.sql`, `InstallRoles.sql`, `InstallProfile.sql`, `InstallSqlState.sql`, and so on.</span></span>

<span data-ttu-id="4b720-252">此時，我們也可以建立所需的資料庫物件`SqlMembershipProvider`。</span><span class="sxs-lookup"><span data-stu-id="4b720-252">At this point we have created the database objects needed by the `SqlMembershipProvider`.</span></span> <span data-ttu-id="4b720-253">不過，我們還是需要以指示應該使用的成員資格 framework `SqlMembershipProvider` (versus、 說， `ActiveDirectoryMembershipProvider`) 而且`SqlMembershipProvider`應該使用`SecurityTutorials`資料庫。</span><span class="sxs-lookup"><span data-stu-id="4b720-253">However, we still need to instruct the Membership framework that it should use the `SqlMembershipProvider` (versus, say, the `ActiveDirectoryMembershipProvider`) and that the `SqlMembershipProvider` should use the `SecurityTutorials` database.</span></span> <span data-ttu-id="4b720-254">我們會探討如何指定要使用何種提供者，以及如何自訂在步驟 4 中選取的提供者設定。</span><span class="sxs-lookup"><span data-stu-id="4b720-254">We'll look at how to specify what provider to use and how to customize the selected provider's settings in Step 4.</span></span> <span data-ttu-id="4b720-255">但首先，我們深入探討剛才所建立的資料庫物件。</span><span class="sxs-lookup"><span data-stu-id="4b720-255">But first, let's take a deeper look at the database objects that were just created.</span></span>

## <a name="step-3-a-look-at-the-schemas-core-tables"></a><span data-ttu-id="4b720-256">步驟 3： 在結構描述的核心資料表查詢</span><span class="sxs-lookup"><span data-stu-id="4b720-256">Step 3: A Look at the Schema's Core Tables</span></span>

<span data-ttu-id="4b720-257">當使用 ASP.NET 應用程式中的成員資格和角色架構，提供者所封裝的實作詳細資料。</span><span class="sxs-lookup"><span data-stu-id="4b720-257">When working with the Membership and Roles frameworks in an ASP.NET application, the implementation details are encapsulated by the provider.</span></span> <span data-ttu-id="4b720-258">在未來我們將這些透過.NET Framework 架構與互動的教學課程`Membership`和`Roles`類別。</span><span class="sxs-lookup"><span data-stu-id="4b720-258">In future tutorials we will interface with these frameworks via the .NET Framework's `Membership` and `Roles` classes.</span></span> <span data-ttu-id="4b720-259">使用這些高層級 Api 時我們不需要考量自己有低層級的詳細資料，例如何種查詢執行或修改資料表`SqlMembershipProvider`和`SqlRoleProvider`。</span><span class="sxs-lookup"><span data-stu-id="4b720-259">When using these high-level APIs we do not need to concern ourselves with the low-level details, like what queries are executed or what tables are modified by the `SqlMembershipProvider` and `SqlRoleProvider`.</span></span>

<span data-ttu-id="4b720-260">根據這點，我們可以很輕易地使用成員資格和角色架構而不需要瀏覽步驟 2 中建立的資料庫結構描述。</span><span class="sxs-lookup"><span data-stu-id="4b720-260">Given this, we could confidently use the Membership and Roles frameworks without having explored the database schema created in Step 2.</span></span> <span data-ttu-id="4b720-261">不過，建立要儲存應用程式資料的資料表時我們可能需要建立與使用者或角色相關聯的實體。</span><span class="sxs-lookup"><span data-stu-id="4b720-261">However, when creating the tables to store application data we may need to create entities that relate to users or roles.</span></span> <span data-ttu-id="4b720-262">它可幫助您熟悉`SqlMembershipProvider`和`SqlRoleProvider`結構描述時建立外部索引鍵之間的應用程式資料的資料表和步驟 2 中建立這些資料表的條件約束。</span><span class="sxs-lookup"><span data-stu-id="4b720-262">It helps to have a familiarity with the `SqlMembershipProvider` and `SqlRoleProvider` schemas when establishing foreign key constraints between the application data tables and those tables created in Step 2.</span></span> <span data-ttu-id="4b720-263">此外，在某些罕見的情況下，我們可能需要與使用者介面，並將直接在資料庫層級的角色 (而不是透過`Membership`或`Roles`類別)。</span><span class="sxs-lookup"><span data-stu-id="4b720-263">Moreover, in certain rare circumstances we may need to interface with the user and role stores directly at the database level (instead of through the `Membership` or `Roles` classes).</span></span>

### <a name="partitioning-the-user-store-into-applications"></a><span data-ttu-id="4b720-264">分割應用程式的使用者存放區</span><span class="sxs-lookup"><span data-stu-id="4b720-264">Partitioning the User Store Into Applications</span></span>

<span data-ttu-id="4b720-265">成員資格和角色架構的設計，可在許多不同的應用程式之間共用單一的使用者和角色存放區。</span><span class="sxs-lookup"><span data-stu-id="4b720-265">The Membership and Roles frameworks are designed such that a single user and role store can be shared among many different applications.</span></span> <span data-ttu-id="4b720-266">使用成員資格或角色架構的 ASP.NET 應用程式必須指定要使用哪一個應用程式磁碟分割。</span><span class="sxs-lookup"><span data-stu-id="4b720-266">An ASP.NET application that uses the Membership or Roles frameworks must specify what application partition to use.</span></span> <span data-ttu-id="4b720-267">簡單地說，多個 web 應用程式可以使用相同的使用者和角色存放區。</span><span class="sxs-lookup"><span data-stu-id="4b720-267">In short, multiple web applications can use the same user and role stores.</span></span> <span data-ttu-id="4b720-268">圖 11 顯示使用者和角色會分割成三個應用程式的存放區： HRSite、 CustomerSite 和 SalesSite。</span><span class="sxs-lookup"><span data-stu-id="4b720-268">Figure 11 depicts user and role stores that are partitioned into three applications: HRSite, CustomerSite, and SalesSite.</span></span> <span data-ttu-id="4b720-269">這些三個 web 應用程式每個有自己的唯一使用者和角色，但它們都在相同的資料庫資料表中，實際儲存其使用者帳戶和角色資訊。</span><span class="sxs-lookup"><span data-stu-id="4b720-269">These three web applications each have their own unique users and roles, yet they all physically store their user account and role information in the same database tables.</span></span>


<span data-ttu-id="4b720-270">[![使用者帳戶，可能跨多個應用程式磁碟分割](creating-the-membership-schema-in-sql-server-vb/_static/image32.png)](creating-the-membership-schema-in-sql-server-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="4b720-270">[![User Accounts May Be Partitioned Across Multiple Applications](creating-the-membership-schema-in-sql-server-vb/_static/image32.png)](creating-the-membership-schema-in-sql-server-vb/_static/image31.png)</span></span>

<span data-ttu-id="4b720-271">**圖 11**： 使用者帳戶可能是分割區跨多個應用程式 ([按一下以檢視完整大小的影像](creating-the-membership-schema-in-sql-server-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="4b720-271">**Figure 11**: User Accounts May Be Partitioned Across Multiple Applications ([Click to view full-size image](creating-the-membership-schema-in-sql-server-vb/_static/image33.png))</span></span>


<span data-ttu-id="4b720-272">`aspnet_Applications`資料表是如何定義這些資料分割。</span><span class="sxs-lookup"><span data-stu-id="4b720-272">The `aspnet_Applications` table is what defines these partitions.</span></span> <span data-ttu-id="4b720-273">此資料表中的資料列會以每個使用資料庫來儲存使用者帳戶資訊的應用程式。</span><span class="sxs-lookup"><span data-stu-id="4b720-273">Each application that uses the database to store user account information is represented by a row in this table.</span></span> <span data-ttu-id="4b720-274">`aspnet_Applications`資料表有四個資料行： `ApplicationId`， `ApplicationName`， `LoweredApplicationName`，和`Description`。`ApplicationId`</span><span class="sxs-lookup"><span data-stu-id="4b720-274">The `aspnet_Applications` table has four columns: `ApplicationId`, `ApplicationName`, `LoweredApplicationName`, and `Description`.`ApplicationId`</span></span> <span data-ttu-id="4b720-275">型別[ `uniqueidentifier` ](https://msdn.microsoft.com/library/ms187942.aspx)和資料表的主索引鍵。`ApplicationName`提供每個應用程式的唯一人們易記名稱。</span><span class="sxs-lookup"><span data-stu-id="4b720-275">is of type [`uniqueidentifier`](https://msdn.microsoft.com/library/ms187942.aspx) and is the table's primary key; `ApplicationName` provides a unique human-friendly name for each application.</span></span>

<span data-ttu-id="4b720-276">其他成員資格和角色相關的資料表連結至`ApplicationId`欄位`aspnet_Applications`。</span><span class="sxs-lookup"><span data-stu-id="4b720-276">The other Membership- and Role-related tables link back to the `ApplicationId` field in `aspnet_Applications`.</span></span> <span data-ttu-id="4b720-277">例如，`aspnet_Users`資料表，其中包含每個使用者帳戶的記錄，具有`ApplicationId`外部索引鍵欄位，如 ditto`aspnet_Roles`資料表。</span><span class="sxs-lookup"><span data-stu-id="4b720-277">For example, the `aspnet_Users` table, which contains a record for each user account, has an `ApplicationId` foreign key field; ditto for the `aspnet_Roles` table.</span></span> <span data-ttu-id="4b720-278">`ApplicationId`這些資料表中的欄位指定的應用程式磁碟分割的使用者帳戶，或所屬角色。</span><span class="sxs-lookup"><span data-stu-id="4b720-278">The `ApplicationId` field in these tables specifies the application partition the user account or role belongs to.</span></span>

### <a name="storing-user-account-information"></a><span data-ttu-id="4b720-279">儲存使用者帳戶資訊</span><span class="sxs-lookup"><span data-stu-id="4b720-279">Storing User Account Information</span></span>

<span data-ttu-id="4b720-280">使用者帳戶資訊儲存在兩個資料表：`aspnet_Users`和`aspnet_Membership`。</span><span class="sxs-lookup"><span data-stu-id="4b720-280">User account information is housed in two tables: `aspnet_Users` and `aspnet_Membership`.</span></span> <span data-ttu-id="4b720-281">`aspnet_Users`資料表包含保存必要的使用者帳戶資訊的欄位。</span><span class="sxs-lookup"><span data-stu-id="4b720-281">The `aspnet_Users` table contains fields that hold the essential user account information.</span></span> <span data-ttu-id="4b720-282">三個最相關的資料行如下：</span><span class="sxs-lookup"><span data-stu-id="4b720-282">The three most pertinent columns are:</span></span>

- `UserId`
- `UserName`
- `ApplicationId`

<span data-ttu-id="4b720-283">`UserId` 主索引鍵 (且屬於型別`uniqueidentifier`)。</span><span class="sxs-lookup"><span data-stu-id="4b720-283">`UserId` is the primary key (and of type `uniqueidentifier`).</span></span> <span data-ttu-id="4b720-284">`UserName` 型別`nvarchar(256)`和密碼，以及構成使用者的認證。</span><span class="sxs-lookup"><span data-stu-id="4b720-284">`UserName` is of type `nvarchar(256)` and, along with the password, makes up the user's credentials.</span></span> <span data-ttu-id="4b720-285">(使用者的密碼儲存在`aspnet_Membership`資料表。)`ApplicationId`連結中的特定應用程式的使用者帳戶`aspnet_Applications`。</span><span class="sxs-lookup"><span data-stu-id="4b720-285">(A user's password is stored in the `aspnet_Membership` table.) `ApplicationId` links the user account to a particular application in `aspnet_Applications`.</span></span> <span data-ttu-id="4b720-286">沒有複合[`UNIQUE`條件約束](https://msdn.microsoft.com/library/ms191166.aspx)上`UserName`和`ApplicationId`資料行。</span><span class="sxs-lookup"><span data-stu-id="4b720-286">There is a composite [`UNIQUE` constraint](https://msdn.microsoft.com/library/ms191166.aspx) on the `UserName` and `ApplicationId` columns.</span></span> <span data-ttu-id="4b720-287">這可確保在給定的應用程式中是唯一的每個使用者名稱，但它可讓具有相同`UserName`以用於不同的應用程式。</span><span class="sxs-lookup"><span data-stu-id="4b720-287">This ensures that in a given application each UserName is unique, yet it allows for the same `UserName` to be used in different applications.</span></span>

<span data-ttu-id="4b720-288">`aspnet_Membership`資料表包含額外的使用者帳戶資訊，例如使用者的密碼、 電子郵件地址、 上次登入日期及時間，以及其他等等。</span><span class="sxs-lookup"><span data-stu-id="4b720-288">The `aspnet_Membership` table includes additional user account information, like the user's password, email address, the last login date and time, and so forth.</span></span> <span data-ttu-id="4b720-289">在記錄之間沒有一對一的對應關係`aspnet_Users`和`aspnet_Membership`資料表。</span><span class="sxs-lookup"><span data-stu-id="4b720-289">There is a one-to-one correspondence between records in the `aspnet_Users` and `aspnet_Membership` tables.</span></span> <span data-ttu-id="4b720-290">此關聯性保證的`UserId`欄位`aspnet_Membership`，做為資料表的主索引鍵。</span><span class="sxs-lookup"><span data-stu-id="4b720-290">This relationship is ensured by the `UserId` field in `aspnet_Membership`, which serves as the table's primary key.</span></span> <span data-ttu-id="4b720-291">像`aspnet_Users`資料表`aspnet_Membership`包含`ApplicationId`繫結合作對這項資訊至特定應用程式磁碟分割的欄位。</span><span class="sxs-lookup"><span data-stu-id="4b720-291">Like the `aspnet_Users` table, `aspnet_Membership` includes an `ApplicationId` field that ties this information to a particular application partition.</span></span>

### <a name="securing-passwords"></a><span data-ttu-id="4b720-292">保護密碼</span><span class="sxs-lookup"><span data-stu-id="4b720-292">Securing Passwords</span></span>

<span data-ttu-id="4b720-293">密碼資訊儲存在`aspnet_Membership`資料表。</span><span class="sxs-lookup"><span data-stu-id="4b720-293">Password information is stored in the `aspnet_Membership` table.</span></span> <span data-ttu-id="4b720-294">`SqlMembershipProvider`允許密碼儲存在資料庫中使用下列三種的技術之一：</span><span class="sxs-lookup"><span data-stu-id="4b720-294">The `SqlMembershipProvider` allows for passwords to be stored in the database using one of the following three techniques:</span></span>

- <span data-ttu-id="4b720-295">**清除**-密碼儲存在資料庫中以純文字。</span><span class="sxs-lookup"><span data-stu-id="4b720-295">**Clear** - the password is stored in the database as plain-text.</span></span> <span data-ttu-id="4b720-296">我強烈不鼓勵使用此選項。</span><span class="sxs-lookup"><span data-stu-id="4b720-296">I strongly discourage using this option.</span></span> <span data-ttu-id="4b720-297">如果資料庫遭到入侵-由駭客人員尋找後門或某位的員工具有資料庫存取權的每個單一使用者的認證有對於製作。</span><span class="sxs-lookup"><span data-stu-id="4b720-297">If the database is compromised - be it by a hacker who finds a back door or a disgruntled employee who has database access - every single user's credentials are there for the taking.</span></span>
- <span data-ttu-id="4b720-298">**雜湊**-密碼已雜湊使用單向雜湊演算法和隨機產生的 salt 值。</span><span class="sxs-lookup"><span data-stu-id="4b720-298">**Hashed** - passwords are hashed using a one-way hash algorithm and a randomly generated salt value.</span></span> <span data-ttu-id="4b720-299">此雜湊的值 （以及 salt) 儲存在資料庫中。</span><span class="sxs-lookup"><span data-stu-id="4b720-299">This hashed value (along with the salt) is stored in the database.</span></span>
- <span data-ttu-id="4b720-300">**加密**-密碼的加密的版本會儲存在資料庫中。</span><span class="sxs-lookup"><span data-stu-id="4b720-300">**Encrypted** - an encrypted version of the password is stored in the database.</span></span>

<span data-ttu-id="4b720-301">取決於所使用的密碼儲存體技巧`SqlMembershipProvider`設定中指定`Web.config`。</span><span class="sxs-lookup"><span data-stu-id="4b720-301">The password storage technique used depends on the `SqlMembershipProvider` settings specified in `Web.config`.</span></span> <span data-ttu-id="4b720-302">我們將探討自訂`SqlMembershipProvider`步驟 4 中的設定。</span><span class="sxs-lookup"><span data-stu-id="4b720-302">We will look at customizing the `SqlMembershipProvider` settings in Step 4.</span></span> <span data-ttu-id="4b720-303">預設行為是儲存密碼雜湊。</span><span class="sxs-lookup"><span data-stu-id="4b720-303">The default behavior is to store the hash of the password.</span></span>

<span data-ttu-id="4b720-304">負責將密碼儲存的資料行是`Password`， `PasswordFormat`，和`PasswordSalt`。</span><span class="sxs-lookup"><span data-stu-id="4b720-304">The columns responsible for storing the password are `Password`, `PasswordFormat`, and `PasswordSalt`.</span></span> <span data-ttu-id="4b720-305">`PasswordFormat` 為類型的欄位`int`其值會指出用來儲存密碼的技巧： 清除為 0; 1 代表 Hashed 2 加密。</span><span class="sxs-lookup"><span data-stu-id="4b720-305">`PasswordFormat` is a field of type `int` whose value indicates the technique used for storing the password: 0 for Clear; 1 for Hashed; 2 for Encrypted.</span></span> <span data-ttu-id="4b720-306">`PasswordSalt` 會指派隨機產生的字串，不論使用的密碼儲存體技術值`PasswordSalt`時計算的雜湊的密碼，才使用。</span><span class="sxs-lookup"><span data-stu-id="4b720-306">`PasswordSalt` is assigned a randomly generated string regardless of the password storage technique used; the value of `PasswordSalt` is only used when computing the hash of the password.</span></span> <span data-ttu-id="4b720-307">最後，`Password`資料行包含實際的密碼資料，可能是純文字密碼的雜湊的密碼或已加密的密碼。</span><span class="sxs-lookup"><span data-stu-id="4b720-307">Finally, the `Password` column contains the actual password data, be it the plain-text password, the hash of the password, or the encrypted password.</span></span>

<span data-ttu-id="4b720-308">表 1 說明這些三個資料行可能如下的各種不同的儲存體技術儲存 MySecret 的密碼時 ！</span><span class="sxs-lookup"><span data-stu-id="4b720-308">Table 1 illustrates what these three columns might look like for the various storage techniques when storing the password MySecret!</span></span> <span data-ttu-id="4b720-309">。</span><span class="sxs-lookup"><span data-stu-id="4b720-309">.</span></span>

| <span data-ttu-id="4b720-310">**儲存體技術&lt;\_o3a\_p /&gt;**</span><span class="sxs-lookup"><span data-stu-id="4b720-310">**Storage Technique&lt;\_o3a\_p /&gt;**</span></span> | <span data-ttu-id="4b720-311">**Password&lt;\_o3a\_p /&gt;**</span><span class="sxs-lookup"><span data-stu-id="4b720-311">**Password&lt;\_o3a\_p /&gt;**</span></span> | <span data-ttu-id="4b720-312">**PasswordFormat&lt;\_o3a\_p /&gt;**</span><span class="sxs-lookup"><span data-stu-id="4b720-312">**PasswordFormat&lt;\_o3a\_p /&gt;**</span></span> | <span data-ttu-id="4b720-313">**PasswordSalt&lt;\_o3a\_p /&gt;**</span><span class="sxs-lookup"><span data-stu-id="4b720-313">**PasswordSalt&lt;\_o3a\_p /&gt;**</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="4b720-314">清除</span><span class="sxs-lookup"><span data-stu-id="4b720-314">Clear</span></span> | <span data-ttu-id="4b720-315">MySecret ！</span><span class="sxs-lookup"><span data-stu-id="4b720-315">MySecret!</span></span> | <span data-ttu-id="4b720-316">0</span><span class="sxs-lookup"><span data-stu-id="4b720-316">0</span></span> | <span data-ttu-id="4b720-317">tTnkPlesqissc2y2SMEygA==</span><span class="sxs-lookup"><span data-stu-id="4b720-317">tTnkPlesqissc2y2SMEygA==</span></span> |
| <span data-ttu-id="4b720-318">雜湊</span><span class="sxs-lookup"><span data-stu-id="4b720-318">Hashed</span></span> | <span data-ttu-id="4b720-319">2oXm6sZHWbTHFgjgkGQsc2Ec9ZM=</span><span class="sxs-lookup"><span data-stu-id="4b720-319">2oXm6sZHWbTHFgjgkGQsc2Ec9ZM=</span></span> | <span data-ttu-id="4b720-320">1</span><span class="sxs-lookup"><span data-stu-id="4b720-320">1</span></span> | <span data-ttu-id="4b720-321">wFgjUfhdUFOCKQiI61vtiQ==</span><span class="sxs-lookup"><span data-stu-id="4b720-321">wFgjUfhdUFOCKQiI61vtiQ==</span></span> |
| <span data-ttu-id="4b720-322">加密</span><span class="sxs-lookup"><span data-stu-id="4b720-322">Encrypted</span></span> | <span data-ttu-id="4b720-323">62RZgDvhxykkqsMchZ0Yly7HS6onhpaoCYaRxV8g0F4CW56OXUU3e7Inza9j9BKp</span><span class="sxs-lookup"><span data-stu-id="4b720-323">62RZgDvhxykkqsMchZ0Yly7HS6onhpaoCYaRxV8g0F4CW56OXUU3e7Inza9j9BKp</span></span> | <span data-ttu-id="4b720-324">2</span><span class="sxs-lookup"><span data-stu-id="4b720-324">2</span></span> | <span data-ttu-id="4b720-325">LSRzhGS/aa/oqAXGLHJNBw==</span><span class="sxs-lookup"><span data-stu-id="4b720-325">LSRzhGS/aa/oqAXGLHJNBw==</span></span> |

<span data-ttu-id="4b720-326">**表 1**： 儲存密碼 MySecret 的密碼相關欄位的範例值 ！</span><span class="sxs-lookup"><span data-stu-id="4b720-326">**Table 1**: Example Values for the Password-Related Fields When Storing the Password MySecret!</span></span>

> [!NOTE]
> <span data-ttu-id="4b720-327">特定的加密或使用雜湊演算法`SqlMembershipProvider`中的設定由`<machineKey>`項目。</span><span class="sxs-lookup"><span data-stu-id="4b720-327">The particular encryption or hashing algorithm used by the `SqlMembershipProvider` is determined by the settings in the `<machineKey>` element.</span></span> <span data-ttu-id="4b720-328">我們將討論在步驟 3 中的這個組態項目<a id="Tutorial3"> </a> [*表單驗證設定和進階主題*](../introduction/forms-authentication-configuration-and-advanced-topics-vb.md)教學課程。</span><span class="sxs-lookup"><span data-stu-id="4b720-328">We discussed this configuration element in Step 3 of the <a id="Tutorial3"></a>[*Forms Authentication Configuration and Advanced Topics*](../introduction/forms-authentication-configuration-and-advanced-topics-vb.md) tutorial.</span></span>

### <a name="storing-roles-and-role-associations"></a><span data-ttu-id="4b720-329">儲存的角色與角色關聯</span><span class="sxs-lookup"><span data-stu-id="4b720-329">Storing Roles and Role Associations</span></span>

<span data-ttu-id="4b720-330">角色架構可讓開發人員定義一組角色，並指定哪些使用者屬於哪些角色。</span><span class="sxs-lookup"><span data-stu-id="4b720-330">The Roles framework allows developers to define a set of roles and specify what users belong to what roles.</span></span> <span data-ttu-id="4b720-331">透過兩個資料表的資料庫中擷取這項資訊：`aspnet_Roles`和`aspnet_UsersInRoles`。</span><span class="sxs-lookup"><span data-stu-id="4b720-331">This information is captured in the database through two tables: `aspnet_Roles` and `aspnet_UsersInRoles`.</span></span> <span data-ttu-id="4b720-332">在每一筆記錄`aspnet_Roles`資料表代表特定的應用程式的角色。</span><span class="sxs-lookup"><span data-stu-id="4b720-332">Each record in the `aspnet_Roles` table represents a role for a particular application.</span></span> <span data-ttu-id="4b720-333">就像是`aspnet_Users`資料表`aspnet_Roles`資料表有三個資料行的相關討論：</span><span class="sxs-lookup"><span data-stu-id="4b720-333">Much like the `aspnet_Users` table, the `aspnet_Roles` table has three columns pertinent to our discussion:</span></span>

- `RoleId`
- `RoleName`
- `ApplicationId`

<span data-ttu-id="4b720-334">`RoleId` 主索引鍵 (且屬於型別`uniqueidentifier`)。</span><span class="sxs-lookup"><span data-stu-id="4b720-334">`RoleId` is the primary key (and of type `uniqueidentifier`).</span></span> <span data-ttu-id="4b720-335">`RoleName` 是 `nvarchar(256)` 類型。</span><span class="sxs-lookup"><span data-stu-id="4b720-335">`RoleName` is of type `nvarchar(256)`.</span></span> <span data-ttu-id="4b720-336">和`ApplicationId`連結中的特定應用程式的使用者帳戶`aspnet_Applications`。</span><span class="sxs-lookup"><span data-stu-id="4b720-336">And `ApplicationId` links the user account to a particular application in `aspnet_Applications`.</span></span> <span data-ttu-id="4b720-337">沒有複合`UNIQUE`條件約束`RoleName`和`ApplicationId`資料行，確保在給定的應用程式中的每個角色名稱唯一。</span><span class="sxs-lookup"><span data-stu-id="4b720-337">There is a composite `UNIQUE` constraint on the `RoleName` and `ApplicationId` columns, ensuring that in a given application each role name is unique.</span></span>

<span data-ttu-id="4b720-338">`aspnet_UsersInRoles`資料表做為使用者和角色之間的對應。</span><span class="sxs-lookup"><span data-stu-id="4b720-338">The `aspnet_UsersInRoles` table serves as a mapping between users and roles.</span></span> <span data-ttu-id="4b720-339">只有兩個資料行-`UserId`和`RoleId`-，它們共同組成複合主索引鍵。</span><span class="sxs-lookup"><span data-stu-id="4b720-339">There are only two columns - `UserId` and `RoleId` - and together they make up a composite primary key.</span></span>

## <a name="step-4-specifying-the-provider-and-customizing-its-settings"></a><span data-ttu-id="4b720-340">步驟 4： 指定提供者，以及自訂它的設定</span><span class="sxs-lookup"><span data-stu-id="4b720-340">Step 4: Specifying the Provider and Customizing Its Settings</span></span>

<span data-ttu-id="4b720-341">所有元件之架構的支援提供者模型，例如成員資格和角色架構-沒有自己的實作詳細資料，並改為來委派該項責任的提供者類別。</span><span class="sxs-lookup"><span data-stu-id="4b720-341">All of the frameworks that support the provider model - such as the Membership and Roles frameworks - lack implementation details themselves and instead delegate that responsibility to a provider class.</span></span> <span data-ttu-id="4b720-342">在 成員資格架構，`Membership`類別定義的 API 管理使用者帳戶，但它不會直接與任何使用者存放區互動。</span><span class="sxs-lookup"><span data-stu-id="4b720-342">In the case of the Membership framework, the `Membership` class defines the API for managing user accounts, but it does not interact directly with any user store.</span></span> <span data-ttu-id="4b720-343">相反地，`Membership`類別的方法遞交到設定的提供者的要求，我們將使用`SqlMembershipProvider`。</span><span class="sxs-lookup"><span data-stu-id="4b720-343">Rather, the `Membership` class's methods hand off the request to the configured provider - we will be using the `SqlMembershipProvider`.</span></span> <span data-ttu-id="4b720-344">當我們叫用之方法的其中一個`Membership`類別如何成員資格架構知道委派呼叫`SqlMembershipProvider`？</span><span class="sxs-lookup"><span data-stu-id="4b720-344">When we invoke one of the methods in the `Membership` class, how does the Membership framework know to delegate the call to the `SqlMembershipProvider`?</span></span>

<span data-ttu-id="4b720-345">`Membership`類別具有[`Providers`屬性](https://msdn.microsoft.com/library/system.web.security.membership.providers.aspx)成員資格 framework 所包含的所有已註冊的提供者類別可供使用的參考。</span><span class="sxs-lookup"><span data-stu-id="4b720-345">The `Membership` class has a [`Providers` property](https://msdn.microsoft.com/library/system.web.security.membership.providers.aspx) that contains a reference to all of the registered provider classes available for use by the Membership framework.</span></span> <span data-ttu-id="4b720-346">每個已註冊的提供者有相關聯的名稱和型別。</span><span class="sxs-lookup"><span data-stu-id="4b720-346">Each registered provider has an associated name and type.</span></span> <span data-ttu-id="4b720-347">名稱提供人類看得方便的方式來參考中的特定提供者`Providers`集合，而型別會識別提供者類別。</span><span class="sxs-lookup"><span data-stu-id="4b720-347">The name offers a human-friendly way to reference a particular provider in the `Providers` collection, while the type identifies the provider class.</span></span> <span data-ttu-id="4b720-348">此外，每個已註冊的提供者可能會包含組態設定。</span><span class="sxs-lookup"><span data-stu-id="4b720-348">Moreover, each registered provider may include configuration settings.</span></span> <span data-ttu-id="4b720-349">成員資格 framework 的組態設定包括`PasswordFormat`和`requiresUniqueEmail`，還有許多其他。</span><span class="sxs-lookup"><span data-stu-id="4b720-349">Configuration settings for the Membership framework include `PasswordFormat` and `requiresUniqueEmail`, among many others.</span></span> <span data-ttu-id="4b720-350">所使用的組態設定的完整清單，請參閱表 2 `SqlMembershipProvider`。</span><span class="sxs-lookup"><span data-stu-id="4b720-350">See Table 2 for a complete list of configuration settings used by the `SqlMembershipProvider`.</span></span>

<span data-ttu-id="4b720-351">`Providers`屬性的內容透過 web 應用程式的組態設定所指定。</span><span class="sxs-lookup"><span data-stu-id="4b720-351">The `Providers` property's contents are specified through the web application's configuration settings.</span></span> <span data-ttu-id="4b720-352">根據預設，所有的 web 應用程式具有名為提供者`AspNetSqlMembershipProvider`型別的`SqlMembershipProvider`。</span><span class="sxs-lookup"><span data-stu-id="4b720-352">By default, all web applications have a provider named `AspNetSqlMembershipProvider` of type `SqlMembershipProvider`.</span></span> <span data-ttu-id="4b720-353">此預設成員資格提供者會在中註冊`machine.config`(位於`%WINDIR%\Microsoft.Net\Framework\v2.0.50727\CONFIG`):</span><span class="sxs-lookup"><span data-stu-id="4b720-353">This default Membership provider is registered in `machine.config` (located at `%WINDIR%\Microsoft.Net\Framework\v2.0.50727\CONFIG`):</span></span>

[!code-xml[Main](creating-the-membership-schema-in-sql-server-vb/samples/sample1.xml)]

<span data-ttu-id="4b720-354">為上方所示，標記[`<membership>`元素](https://msdn.microsoft.com/library/1b9hw62f.aspx)定義成員資格架構時的組態設定[`<providers>`子項目](https://msdn.microsoft.com/library/6d4936ht.aspx)指定已註冊提供者。</span><span class="sxs-lookup"><span data-stu-id="4b720-354">As the markup above shows, the [`<membership>` element](https://msdn.microsoft.com/library/1b9hw62f.aspx) defines the configuration settings for the Membership framework while the [`<providers>` child element](https://msdn.microsoft.com/library/6d4936ht.aspx) specifies the registered providers.</span></span> <span data-ttu-id="4b720-355">提供者可能會加入或移除使用[ `<add>` ](https://msdn.microsoft.com/library/whae3t94.aspx)或[ `<remove>` ](https://msdn.microsoft.com/library/aykw9a6d.aspx)項目; 請改用[ `<clear>` ](https://msdn.microsoft.com/library/t062y6yc.aspx)移除所有目前的項目已註冊的提供者。</span><span class="sxs-lookup"><span data-stu-id="4b720-355">Providers may be added or removed using the [`<add>`](https://msdn.microsoft.com/library/whae3t94.aspx) or [`<remove>`](https://msdn.microsoft.com/library/aykw9a6d.aspx) elements; use the [`<clear>`](https://msdn.microsoft.com/library/t062y6yc.aspx) element to remove all currently registered providers.</span></span> <span data-ttu-id="4b720-356">為上方所示，標記`machine.config`會加入名為提供者`AspNetSqlMembershipProvider`型別的`SqlMembershipProvider`。</span><span class="sxs-lookup"><span data-stu-id="4b720-356">As the markup above shows, `machine.config` adds a provider named `AspNetSqlMembershipProvider` of type `SqlMembershipProvider`.</span></span>

<span data-ttu-id="4b720-357">除了`name`和`type`屬性`<add>`元素包含定義的各種設定的設定值的屬性。</span><span class="sxs-lookup"><span data-stu-id="4b720-357">In addition to the `name` and `type` attributes, the `<add>` element contains attributes that define the values for various configuring settings.</span></span> <span data-ttu-id="4b720-358">表 2 列出可用`SqlMembershipProvider`-特定的組態設定，以及每個說明。</span><span class="sxs-lookup"><span data-stu-id="4b720-358">Table 2 lists the available `SqlMembershipProvider`-specific configuration settings, along with a description of each.</span></span>

> [!NOTE]
> <span data-ttu-id="4b720-359">表 2 中記下任何預設值參考中定義的預設值`SqlMembershipProvider`類別。</span><span class="sxs-lookup"><span data-stu-id="4b720-359">Any default values noted in Table 2 refer to the default values defined in the `SqlMembershipProvider` class.</span></span> <span data-ttu-id="4b720-360">請注意，並非所有的組態設定`AspNetSqlMembershipProvider`對應的預設值到`SqlMembershipProvider`類別。</span><span class="sxs-lookup"><span data-stu-id="4b720-360">Note that not all of the configuration settings in `AspNetSqlMembershipProvider` correspond to the default values of the `SqlMembershipProvider` class.</span></span> <span data-ttu-id="4b720-361">例如，如果未指定成員資格提供者中`requiresUniqueEmail`設定預設值為 true。</span><span class="sxs-lookup"><span data-stu-id="4b720-361">For example, if not specified in a Membership provider, the `requiresUniqueEmail` setting defaults to true.</span></span> <span data-ttu-id="4b720-362">不過，`AspNetSqlMembershipProvider`藉由明確指定的值，這個預設值會覆寫`false`。</span><span class="sxs-lookup"><span data-stu-id="4b720-362">However, the `AspNetSqlMembershipProvider` overrides this default value by explicitly specifying a value of `false`.</span></span>

| <span data-ttu-id="4b720-363">**Setting&lt;\_o3a\_p /&gt;**</span><span class="sxs-lookup"><span data-stu-id="4b720-363">**Setting&lt;\_o3a\_p /&gt;**</span></span> | <span data-ttu-id="4b720-364">**Description&lt;\_o3a\_p /&gt;**</span><span class="sxs-lookup"><span data-stu-id="4b720-364">**Description&lt;\_o3a\_p /&gt;**</span></span> |
| --- | --- |
| `ApplicationName` | <span data-ttu-id="4b720-365">前文提過成員資格架構可讓分割到多個應用程式的單一使用者存放區。</span><span class="sxs-lookup"><span data-stu-id="4b720-365">Recall that the Membership framework allows for a single user store to be partitioned across multiple applications.</span></span> <span data-ttu-id="4b720-366">此設定表示成員資格提供者所使用的應用程式磁碟分割的名稱。</span><span class="sxs-lookup"><span data-stu-id="4b720-366">This setting indicates the name of the application partition used by the Membership provider.</span></span> <span data-ttu-id="4b720-367">如果此值未明確指定，它設定為，在執行階段，應用程式的虛擬根路徑的值。</span><span class="sxs-lookup"><span data-stu-id="4b720-367">If this value is not explicitly specified, it is set, at runtime, to the value of the application's virtual root path.</span></span> |
| `commandTimeout` | <span data-ttu-id="4b720-368">指定的 SQL 命令逾時值 （以秒為單位）。</span><span class="sxs-lookup"><span data-stu-id="4b720-368">Specifies the SQL command timeout value (in seconds).</span></span> <span data-ttu-id="4b720-369">預設值為 30。</span><span class="sxs-lookup"><span data-stu-id="4b720-369">The default value is 30.</span></span> |
| `connectionStringName` | <span data-ttu-id="4b720-370">中的連接字串名稱`<connectionStrings>`用來連接至使用者存放區資料庫的項目。</span><span class="sxs-lookup"><span data-stu-id="4b720-370">The name of the connection string in the `<connectionStrings>` element to use to connect to the user store database.</span></span> <span data-ttu-id="4b720-371">這是必要值。</span><span class="sxs-lookup"><span data-stu-id="4b720-371">This value is required.</span></span> |
| `description` | <span data-ttu-id="4b720-372">提供已註冊的提供者的人們易記描述。</span><span class="sxs-lookup"><span data-stu-id="4b720-372">Provides a human-friendly description of the registered provider.</span></span> |
| `enablePasswordRetrieval` | <span data-ttu-id="4b720-373">指定使用者是否可以擷取忘記的密碼。</span><span class="sxs-lookup"><span data-stu-id="4b720-373">Specifies whether users may retrieve their forgotten password.</span></span> <span data-ttu-id="4b720-374">預設值是 `false`。</span><span class="sxs-lookup"><span data-stu-id="4b720-374">The default value is `false`.</span></span> |
| `enablePasswordReset` | <span data-ttu-id="4b720-375">指出是否允許使用者重設其密碼。</span><span class="sxs-lookup"><span data-stu-id="4b720-375">Indicates whether users are allowed to reset their password.</span></span> <span data-ttu-id="4b720-376">預設值為 `true`。</span><span class="sxs-lookup"><span data-stu-id="4b720-376">Defaults to `true`.</span></span> |
| `maxInvalidPasswordAttempts` | <span data-ttu-id="4b720-377">嘗試不成功的登入期間指定針對指定的使用者可能發生的最大數目`passwordAttemptWindow`使用者遭到鎖定之前。預設值為 5。</span><span class="sxs-lookup"><span data-stu-id="4b720-377">The maximum number of unsuccessful login attempts that may occur for a given user during the specified `passwordAttemptWindow` before the user is locked out. The default value is 5.</span></span> |
| `minRequiredNonalphanumericCharacters` | <span data-ttu-id="4b720-378">必須出現在使用者的密碼中的非英數字元數目下限。</span><span class="sxs-lookup"><span data-stu-id="4b720-378">The minimum number of non-alphanumeric characters that must appear in a user's password.</span></span> <span data-ttu-id="4b720-379">此值必須介於 0 到 128;預設值為 1。</span><span class="sxs-lookup"><span data-stu-id="4b720-379">This value must be between 0 and 128; the default is 1.</span></span> |
| `minRequiredPasswordLength` | <span data-ttu-id="4b720-380">密碼所需的字元數目下限。</span><span class="sxs-lookup"><span data-stu-id="4b720-380">The minimum number of characters required in a password.</span></span> <span data-ttu-id="4b720-381">此值必須介於 0 到 128;預設為 7。</span><span class="sxs-lookup"><span data-stu-id="4b720-381">This value must be between 0 and 128; the default is 7.</span></span> |
| `name` | <span data-ttu-id="4b720-382">已註冊的提供者的名稱。</span><span class="sxs-lookup"><span data-stu-id="4b720-382">The name of the registered provider.</span></span> <span data-ttu-id="4b720-383">這是必要值。</span><span class="sxs-lookup"><span data-stu-id="4b720-383">This value is required.</span></span> |
| `passwordAttemptWindow` | <span data-ttu-id="4b720-384">追蹤嘗試的登入失敗時的分鐘數。</span><span class="sxs-lookup"><span data-stu-id="4b720-384">The number of minutes during which failed login attempts are tracked.</span></span> <span data-ttu-id="4b720-385">如果使用者提供了無效的登入認證`maxInvalidPasswordAttempts`指定視窗內的時間、 遭到鎖定。預設值為 10。</span><span class="sxs-lookup"><span data-stu-id="4b720-385">If a user supplies invalid login credentials `maxInvalidPasswordAttempts` times within this specified window, they are locked out. The default value is 10.</span></span> |
| `PasswordFormat` | <span data-ttu-id="4b720-386">密碼儲存格式： `Clear`， `Hashed`，或`Encrypted`。</span><span class="sxs-lookup"><span data-stu-id="4b720-386">The password storage format: `Clear`, `Hashed`, or `Encrypted`.</span></span> <span data-ttu-id="4b720-387">預設值為 `Hashed`。</span><span class="sxs-lookup"><span data-stu-id="4b720-387">The default is `Hashed`.</span></span> |
| `passwordStrengthRegularExpression` | <span data-ttu-id="4b720-388">如果提供，這個規則運算式是評估強度的所選使用者的密碼時建立新的帳戶，或變更其密碼時使用。</span><span class="sxs-lookup"><span data-stu-id="4b720-388">If provided, this regular expression is used to evaluate the strength of the user's selected password when creating a new account or when changing their password.</span></span> <span data-ttu-id="4b720-389">預設值為空字串。</span><span class="sxs-lookup"><span data-stu-id="4b720-389">The default value is an empty string.</span></span> |
| `requiresQuestionAndAnswer` | <span data-ttu-id="4b720-390">指定使用者是否必須回答其安全性問題，在擷取或重設其密碼。</span><span class="sxs-lookup"><span data-stu-id="4b720-390">Specifies whether a user must answer his security question when retrieving or resetting his password.</span></span> <span data-ttu-id="4b720-391">預設值是 `true`。</span><span class="sxs-lookup"><span data-stu-id="4b720-391">The default value is `true`.</span></span> |
| `requiresUniqueEmail` | <span data-ttu-id="4b720-392">指出是否在指定的應用程式磁碟分割中的所有使用者帳戶必須都具有唯一的電子郵件地址。</span><span class="sxs-lookup"><span data-stu-id="4b720-392">Indicates whether all user accounts in a given application partition must have a unique email address.</span></span> <span data-ttu-id="4b720-393">預設值是 `true`。</span><span class="sxs-lookup"><span data-stu-id="4b720-393">The default value is `true`.</span></span> |
| `type` | <span data-ttu-id="4b720-394">指定的提供者的類型。</span><span class="sxs-lookup"><span data-stu-id="4b720-394">Specifies the type of the provider.</span></span> <span data-ttu-id="4b720-395">這是必要值。</span><span class="sxs-lookup"><span data-stu-id="4b720-395">This value is required.</span></span> |

<span data-ttu-id="4b720-396">**表 2**： 成員資格和`SqlMembershipProvider`組態設定</span><span class="sxs-lookup"><span data-stu-id="4b720-396">**Table 2**: Membership and `SqlMembershipProvider` Configuration Settings</span></span>

<span data-ttu-id="4b720-397">除了`AspNetSqlMembershipProvider`，其他成員資格提供者可能藉由新增類似的標記，以註冊應用程式的應用程式為基礎`Web.config`檔案。</span><span class="sxs-lookup"><span data-stu-id="4b720-397">In addition to `AspNetSqlMembershipProvider`, other Membership providers may be registered on an application-by-application basis by adding similar markup to the `Web.config` file.</span></span>

> [!NOTE]
> <span data-ttu-id="4b720-398">角色架構的運作方式大致相同的方式： 沒有預設的已註冊的角色提供者中`machine.config`和可自訂的已註冊的提供者，在應用程式的應用程式為基礎`Web.config`。</span><span class="sxs-lookup"><span data-stu-id="4b720-398">The Roles framework works in much the same way: there is a default registered role provider in `machine.config` and the registered providers may be customized on an application-by-application basis in `Web.config`.</span></span> <span data-ttu-id="4b720-399">在未來的教學課程中，我們會檢查角色架構和其組態中的標記詳細資料。</span><span class="sxs-lookup"><span data-stu-id="4b720-399">We will examine the Roles framework and its configuration markup in detail in a future tutorial.</span></span>

### <a name="customizing-thesqlmembershipprovidersettings"></a><span data-ttu-id="4b720-400">自訂`SqlMembershipProvider`設定</span><span class="sxs-lookup"><span data-stu-id="4b720-400">Customizing the`SqlMembershipProvider`Settings</span></span>

<span data-ttu-id="4b720-401">預設值`SqlMembershipProvider`(`AspNetSqlMembershipProvider`) 具有其`connectionStringName`屬性設為`LocalSqlServer`。</span><span class="sxs-lookup"><span data-stu-id="4b720-401">The default `SqlMembershipProvider` (`AspNetSqlMembershipProvider`) has its `connectionStringName` attribute set to `LocalSqlServer`.</span></span> <span data-ttu-id="4b720-402">像`AspNetSqlMembershipProvider`提供者，連接字串名稱`LocalSqlServer`中定義`machine.config`。</span><span class="sxs-lookup"><span data-stu-id="4b720-402">Like the `AspNetSqlMembershipProvider` provider, the connection string name `LocalSqlServer` is defined in `machine.config`.</span></span>

[!code-xml[Main](creating-the-membership-schema-in-sql-server-vb/samples/sample2.xml)]

<span data-ttu-id="4b720-403">如您所見，此連接字串會定義資料庫位於 SQL 2005 Express Edition |DataDirectory|aspnetdb.mdf。</span><span class="sxs-lookup"><span data-stu-id="4b720-403">As you can see, this connection string defines a SQL 2005 Express Edition database located at |DataDirectory|aspnetdb.mdf.</span></span> <span data-ttu-id="4b720-404">字串 |DataDirectory |轉譯在執行階段，以指向`~/App_Data/`目錄，所以資料庫路徑 |DataDirectory|aspnetdb.mdf 會轉譯為`~/App_Data` / `aspnet.mdf`。</span><span class="sxs-lookup"><span data-stu-id="4b720-404">The string |DataDirectory| is translated at runtime to point to the `~/App_Data/` directory, so the database path |DataDirectory|aspnetdb.mdf translates to `~/App_Data`/`aspnet.mdf`.</span></span>

<span data-ttu-id="4b720-405">如果我們並未指定任何成員資格提供者資訊在我們的應用程式中`Web.config`檔案，應用程式使用已註冊的預設成員資格提供者， `AspNetSqlMembershipProvider`。</span><span class="sxs-lookup"><span data-stu-id="4b720-405">If we did not specify any Membership provider information in our application's `Web.config` file, the application uses the default registered Membership provider, `AspNetSqlMembershipProvider`.</span></span> <span data-ttu-id="4b720-406">如果`~/App_Data/aspnet.mdf`資料庫不存在，ASP.NET 執行階段會自動建立它，並新增應用程式服務結構描述。</span><span class="sxs-lookup"><span data-stu-id="4b720-406">If the `~/App_Data/aspnet.mdf` database does not exist, the ASP.NET runtime will automatically create it and add the application services schema.</span></span> <span data-ttu-id="4b720-407">不過，我們不想使用`aspnet.mdf`資料庫; 相反地，我們想要使用`SecurityTutorials.mdf`我們在步驟 2 中建立的資料庫。</span><span class="sxs-lookup"><span data-stu-id="4b720-407">However, we don't want to use the `aspnet.mdf` database; rather, we want to use the `SecurityTutorials.mdf` database we created in Step 2.</span></span> <span data-ttu-id="4b720-408">其中一種方式可以完成這項修改：</span><span class="sxs-lookup"><span data-stu-id="4b720-408">This modification can be accomplished in one of two ways:</span></span>

- <span data-ttu-id="4b720-409"><strong>指定的值</strong><strong>`LocalSqlServer`</strong><strong>中的連接字串名稱</strong><strong>`Web.config`</strong><strong>。</strong></span><span class="sxs-lookup"><span data-stu-id="4b720-409"><strong>Specify a value for the</strong><strong>`LocalSqlServer`</strong><strong>connection string name in</strong><strong>`Web.config`</strong><strong>.</strong></span></span> <span data-ttu-id="4b720-410">藉由覆寫`LocalSqlServer`中的連接字串名稱值`Web.config`，我們可以使用已註冊的預設成員資格提供者 (`AspNetSqlMembershipProvider`)，並讓它正確使用`SecurityTutorials.mdf`資料庫。</span><span class="sxs-lookup"><span data-stu-id="4b720-410">By overwriting the `LocalSqlServer` connection string name value in `Web.config`, we can use the default registered Membership provider (`AspNetSqlMembershipProvider`) and have it correctly work with the `SecurityTutorials.mdf` database.</span></span> <span data-ttu-id="4b720-411">如果您是內容所指定的組態設定，不過沒有關係，這個方法是`AspNetSqlMembershipProvider`。</span><span class="sxs-lookup"><span data-stu-id="4b720-411">This approach is fine if you are content with the configuration settings specified by `AspNetSqlMembershipProvider`.</span></span> <span data-ttu-id="4b720-412">如需有關這項技術的詳細資訊，請參閱[Scott Guthrie](https://weblogs.asp.net/scottgu/)的部落格文章：[設定 ASP.NET 2.0 應用程式服務設定為使用 SQL Server 2000 或 SQL Server 2005](https://weblogs.asp.net/scottgu/archive/2005/08/25/423703.aspx)。</span><span class="sxs-lookup"><span data-stu-id="4b720-412">For more information on this technique, see [Scott Guthrie](https://weblogs.asp.net/scottgu/)'s blog post, [Configuring ASP.NET 2.0 Application Services to Use SQL Server 2000 or SQL Server 2005](https://weblogs.asp.net/scottgu/archive/2005/08/25/423703.aspx).</span></span>
- <span data-ttu-id="4b720-413"><strong>新增已註冊的型別提供者</strong><strong>`SqlMembershipProvider`</strong><strong>並設定其</strong><strong>`connectionStringName`</strong><strong>設定為指向</strong><strong>`SecurityTutorials.mdf`</strong><strong>資料庫。</strong></span><span class="sxs-lookup"><span data-stu-id="4b720-413"><strong>Add a new registered provider of type</strong><strong>`SqlMembershipProvider`</strong><strong>and configure its</strong><strong>`connectionStringName`</strong><strong>setting to point to the</strong><strong>`SecurityTutorials.mdf`</strong><strong>database.</strong></span></span> <span data-ttu-id="4b720-414">這個方法是在您要自訂其他的組態內容，以及資料庫連接字串的情況下很有用。</span><span class="sxs-lookup"><span data-stu-id="4b720-414">This approach is useful in scenarios where you want to customize other configuration properties in addition to the database connection string.</span></span> <span data-ttu-id="4b720-415">我自己的專案中我一律使用這個方法因為它的彈性和可讀性。</span><span class="sxs-lookup"><span data-stu-id="4b720-415">In my own projects I always use this approach because of its flexibility and readability.</span></span>

<span data-ttu-id="4b720-416">我們可以加入新的已註冊提供者參考之前`SecurityTutorials.mdf`資料庫中，我們必須先將適當的連接字串值中加入`<connectionStrings>`一節中`Web.config`。</span><span class="sxs-lookup"><span data-stu-id="4b720-416">Before we can add a new registered provider that references the `SecurityTutorials.mdf` database, we first need to add an appropriate connection string value in the `<connectionStrings>` section in `Web.config`.</span></span> <span data-ttu-id="4b720-417">下列標記加入新的連接字串，名為`SecurityTutorialsConnectionString`參考 SQL Server 2005 Express Edition`SecurityTutorials.mdf`資料庫`App_Data`資料夾。</span><span class="sxs-lookup"><span data-stu-id="4b720-417">The following markup adds a new connection string named `SecurityTutorialsConnectionString` that references the SQL Server 2005 Express Edition `SecurityTutorials.mdf` database in the `App_Data` folder.</span></span>

[!code-xml[Main](creating-the-membership-schema-in-sql-server-vb/samples/sample3.xml)]

> [!NOTE]
> <span data-ttu-id="4b720-418">如果您使用替代的資料庫檔案，請視需要更新連接字串。</span><span class="sxs-lookup"><span data-stu-id="4b720-418">If you are using an alternate database file, update the connection string as needed.</span></span> <span data-ttu-id="4b720-419">如需有關如何建立正確的連接字串的詳細資訊，請參閱[ConnectionStrings.com](http://www.connectionstrings.com/)。</span><span class="sxs-lookup"><span data-stu-id="4b720-419">For more information on forming the correct connection string, refer to [ConnectionStrings.com](http://www.connectionstrings.com/).</span></span>

<span data-ttu-id="4b720-420">接下來，加入下列成員資格設定標記以`Web.config`檔案。</span><span class="sxs-lookup"><span data-stu-id="4b720-420">Next, add the following Membership configuration markup to the `Web.config` file.</span></span> <span data-ttu-id="4b720-421">這個標記會註冊新的提供者，名為`SecurityTutorialsSqlMembershipProvider`。</span><span class="sxs-lookup"><span data-stu-id="4b720-421">This markup registers a new provider named `SecurityTutorialsSqlMembershipProvider`.</span></span>

[!code-xml[Main](creating-the-membership-schema-in-sql-server-vb/samples/sample4.xml)]

<span data-ttu-id="4b720-422">除了註冊`SecurityTutorialsSqlMembershipProvider`提供者，上述的標記定義`SecurityTutorialsSqlMembershipProvider`做為預設提供者 (透過`defaultProvider`屬性`<membership>`項目)。</span><span class="sxs-lookup"><span data-stu-id="4b720-422">In addition to registering the `SecurityTutorialsSqlMembershipProvider` provider, the above markup defines the `SecurityTutorialsSqlMembershipProvider` as the default provider (via the `defaultProvider` attribute in the `<membership>` element).</span></span> <span data-ttu-id="4b720-423">前文提過成員資格 framework 可以有多個已註冊的提供者。</span><span class="sxs-lookup"><span data-stu-id="4b720-423">Recall that the Membership framework can have multiple registered providers.</span></span> <span data-ttu-id="4b720-424">因為`AspNetSqlMembershipProvider`登錄中的第一個提供者為`machine.config`，除非另外我們它做為預設提供者。</span><span class="sxs-lookup"><span data-stu-id="4b720-424">Since `AspNetSqlMembershipProvider` is registered as the first provider in `machine.config`, it serves as the default provider unless we indicate otherwise.</span></span>

<span data-ttu-id="4b720-425">目前，我們的應用程式具有兩個已註冊的提供者：`AspNetSqlMembershipProvider`和`SecurityTutorialsSqlMembershipProvider`。</span><span class="sxs-lookup"><span data-stu-id="4b720-425">Currently, our application has two registered providers: `AspNetSqlMembershipProvider` and `SecurityTutorialsSqlMembershipProvider`.</span></span> <span data-ttu-id="4b720-426">不過，再註冊`SecurityTutorialsSqlMembershipProvider`我們可能會清除所有先前的提供者註冊提供者藉由新增[`<clear />`元素](https://msdn.microsoft.com/library/t062y6yc.aspx)之前我們`<add>`項目。</span><span class="sxs-lookup"><span data-stu-id="4b720-426">However, before registering the `SecurityTutorialsSqlMembershipProvider` provider we could have cleared out all previously registered providers by adding a [`<clear />` element](https://msdn.microsoft.com/library/t062y6yc.aspx) immediately before our `<add>` element.</span></span> <span data-ttu-id="4b720-427">這會清除`AspNetSqlMembershipProvider`從已註冊的提供者清單，表示`SecurityTutorialsSqlMembershipProvider`會是唯一的已註冊的成員資格提供者。</span><span class="sxs-lookup"><span data-stu-id="4b720-427">This would clear out the `AspNetSqlMembershipProvider` from the list of registered providers, meaning that the `SecurityTutorialsSqlMembershipProvider` would be the only registered Membership provider.</span></span> <span data-ttu-id="4b720-428">如果我們使用這種方式，則我們不需要標記`SecurityTutorialsSqlMembershipProvider`為預設的提供者，因為它會是只有已註冊的成員資格提供者。</span><span class="sxs-lookup"><span data-stu-id="4b720-428">If we used this approach, then we would not need to mark the `SecurityTutorialsSqlMembershipProvider` as the default provider, since it would be the only registered Membership provider.</span></span> <span data-ttu-id="4b720-429">如需有關使用`<clear />`，請參閱[使用`<clear />`時新增提供者](https://weblogs.asp.net/scottgu/archive/2006/11/20/common-gotcha-don-t-forget-to-clear-when-adding-providers.aspx)。</span><span class="sxs-lookup"><span data-stu-id="4b720-429">For more information on using `<clear />`, see [Using `<clear />` When Adding providers](https://weblogs.asp.net/scottgu/archive/2006/11/20/common-gotcha-don-t-forget-to-clear-when-adding-providers.aspx).</span></span>

<span data-ttu-id="4b720-430">請注意，`SecurityTutorialsSqlMembershipProvider`的`connectionStringName`設定參考剛加入`SecurityTutorialsConnectionString`連接字串名稱，且其`applicationName`已設定為 SecurityTutorials 的值。</span><span class="sxs-lookup"><span data-stu-id="4b720-430">Note that the `SecurityTutorialsSqlMembershipProvider`'s `connectionStringName` setting references the just-added `SecurityTutorialsConnectionString` connection string name, and that its `applicationName` setting has been set to a value of SecurityTutorials.</span></span> <span data-ttu-id="4b720-431">此外，`requiresUniqueEmail`設定已設為`true`。</span><span class="sxs-lookup"><span data-stu-id="4b720-431">Additionally, the `requiresUniqueEmail` setting has been set to `true`.</span></span> <span data-ttu-id="4b720-432">所有其他設定選項是中的值相同`AspNetSqlMembershipProvider`。</span><span class="sxs-lookup"><span data-stu-id="4b720-432">All other configuration options are identical to the values in `AspNetSqlMembershipProvider`.</span></span> <span data-ttu-id="4b720-433">請放心地進行任何組態修改，如果您想。</span><span class="sxs-lookup"><span data-stu-id="4b720-433">Feel free to make any configuration modifications here, if you wish.</span></span> <span data-ttu-id="4b720-434">例如，您可以加強密碼強度，藉由要求兩個非英數字元，而不是其中一個，或增加而不是七個八個字元的密碼長度。</span><span class="sxs-lookup"><span data-stu-id="4b720-434">For example, you could tighten the password strength by requiring two non-alphanumeric characters instead of one, or by increasing the password length to eight characters instead of seven.</span></span>

> [!NOTE]
> <span data-ttu-id="4b720-435">前文提過成員資格架構可讓分割到多個應用程式的單一使用者存放區。</span><span class="sxs-lookup"><span data-stu-id="4b720-435">Recall that the Membership framework allows for a single user store to be partitioned across multiple applications.</span></span> <span data-ttu-id="4b720-436">成員資格提供者的`applicationName`設定指出提供者在使用者存放區使用時所使用之應用程式。</span><span class="sxs-lookup"><span data-stu-id="4b720-436">The Membership provider's `applicationName` setting indicates what application the provider uses when working with the user store.</span></span> <span data-ttu-id="4b720-437">請務必明確設定的值`applicationName`組態設定，因為如果`applicationName`未明確設定，將它指派給在執行階段的 web 應用程式的虛擬根路徑。</span><span class="sxs-lookup"><span data-stu-id="4b720-437">It is important that you explicitly set a value for the `applicationName` configuration setting because if the `applicationName` is not explicitly set, it is assigned to the web application's virtual root path at runtime.</span></span> <span data-ttu-id="4b720-438">這可正常運作，只要應用程式的虛擬根路徑不會變更，但是，如果您移動到不同的路徑，應用程式`applicationName`設定也會變更。</span><span class="sxs-lookup"><span data-stu-id="4b720-438">This works fine as long as the application's virtual root path doesn't change, but if you move the application to a different path, the `applicationName` setting will change too.</span></span> <span data-ttu-id="4b720-439">在這種情況下，成員資格提供者會開始使用不同的應用程式磁碟分割與先前未使用。</span><span class="sxs-lookup"><span data-stu-id="4b720-439">When this happens, the Membership provider will start working with a different application partition than was previously used.</span></span> <span data-ttu-id="4b720-440">在移動之前建立的使用者帳戶都位於不同的應用程式磁碟分割中，這些使用者將不再能夠登入網站。</span><span class="sxs-lookup"><span data-stu-id="4b720-440">User accounts created prior to the move will reside in a different application partition and those users will no longer be able to log into the site.</span></span> <span data-ttu-id="4b720-441">此主題的更深入討論，請參閱[一定會設定`applicationName`屬性時設定 ASP.NET 2.0 的成員資格以及其他提供者](https://weblogs.asp.net/scottgu/443634)。</span><span class="sxs-lookup"><span data-stu-id="4b720-441">For a more in-depth discussion on this matter, see [Always Set the `applicationName` Property When Configuring ASP.NET 2.0 Membership and Other providers](https://weblogs.asp.net/scottgu/443634).</span></span>

## <a name="summary"></a><span data-ttu-id="4b720-442">總結</span><span class="sxs-lookup"><span data-stu-id="4b720-442">Summary</span></span>

<span data-ttu-id="4b720-443">我們現在有設定的應用程式服務的資料庫 (`SecurityTutorials.mdf`)，而且已經設定我們的 web 應用程式，使其使用的成員資格 framework`SecurityTutorialsSqlMembershipProvider`剛登錄的提供者。</span><span class="sxs-lookup"><span data-stu-id="4b720-443">At this point we have a database with the configured application services (`SecurityTutorials.mdf`) and have configured our web application so that the Membership framework uses the `SecurityTutorialsSqlMembershipProvider` provider we just registered.</span></span> <span data-ttu-id="4b720-444">這個已註冊的提供者是型別`SqlMembershipProvider`，且其`connectionStringName`設為適當的連接字串 (`SecurityTutorialsConnectionString`) 及其`applicationName`明確設定的值。</span><span class="sxs-lookup"><span data-stu-id="4b720-444">This registered provider is of type `SqlMembershipProvider` and has its `connectionStringName` set to the appropriate connection string (`SecurityTutorialsConnectionString`) and its `applicationName` value explicitly set.</span></span>

<span data-ttu-id="4b720-445">我們現在已準備好使用成員資格架構從我們的應用程式。</span><span class="sxs-lookup"><span data-stu-id="4b720-445">We are now ready to use the Membership framework from our application.</span></span> <span data-ttu-id="4b720-446">在下一個教學課程中，我們將檢查如何建立新的使用者帳戶。</span><span class="sxs-lookup"><span data-stu-id="4b720-446">In the next tutorial we will examine how to create new user accounts.</span></span> <span data-ttu-id="4b720-447">之後，我們將探討驗證使用者，執行以使用者為基礎的授權，並儲存在資料庫中的其他使用者的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="4b720-447">Following that we will explore authenticating users, performing user-based authorization, and storing additional user-related information in the database.</span></span>

<span data-ttu-id="4b720-448">祝您程式設計 ！</span><span class="sxs-lookup"><span data-stu-id="4b720-448">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="4b720-449">進一步閱讀</span><span class="sxs-lookup"><span data-stu-id="4b720-449">Further Reading</span></span>

<span data-ttu-id="4b720-450">如需有關在本教學課程所討論的主題的詳細資訊，請參閱下列資源：</span><span class="sxs-lookup"><span data-stu-id="4b720-450">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="4b720-451">一定會設定`applicationName`屬性時設定 ASP.NET 2.0 的成員資格以及其他提供者</span><span class="sxs-lookup"><span data-stu-id="4b720-451">Always Set the `applicationName` Property When Configuring ASP.NET 2.0 Membership and Other providers</span></span>](https://weblogs.asp.net/scottgu/443634)
- [<span data-ttu-id="4b720-452">若要使用 SQL Server 2000 或 SQL Server 2005 設定 ASP.NET 2.0 應用程式服務</span><span class="sxs-lookup"><span data-stu-id="4b720-452">Configuring ASP.NET 2.0 Application Services to Use SQL Server 2000 or SQL Server 2005</span></span>](https://weblogs.asp.net/scottgu/archive/2005/08/25/423703.aspx)
- [<span data-ttu-id="4b720-453">下載 SQL Server Management Studio Express Edition</span><span class="sxs-lookup"><span data-stu-id="4b720-453">Download SQL Server Management Studio Express Edition</span></span>](https://www.microsoft.com/downloads/details.aspx?FamilyId=C243A5AE-4BD1-4E3D-94B8-5A0F62BF7796&amp;displaylang=en)
- [<span data-ttu-id="4b720-454">檢查 ASP.NET 2.0 s 成員資格、 角色和設定檔</span><span class="sxs-lookup"><span data-stu-id="4b720-454">Examining ASP.NET 2.0�s Membership, Roles, and Profile</span></span>](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
- [<span data-ttu-id="4b720-455">`<add>`成員資格提供者的項目</span><span class="sxs-lookup"><span data-stu-id="4b720-455">The `<add>` Element for providers for Membership</span></span>](https://msdn.microsoft.com/library/whae3t94.aspx)
- [<span data-ttu-id="4b720-456">`<membership>`項目</span><span class="sxs-lookup"><span data-stu-id="4b720-456">The `<membership>` Element</span></span>](https://msdn.microsoft.com/library/1b9hw62f.aspx)
- [<span data-ttu-id="4b720-457">`<providers>`成員資格的項目</span><span class="sxs-lookup"><span data-stu-id="4b720-457">The `<providers>` Element for Membership</span></span>](https://msdn.microsoft.com/library/6d4936ht.aspx)
- [<span data-ttu-id="4b720-458">使用`<clear />`時新增提供者</span><span class="sxs-lookup"><span data-stu-id="4b720-458">Using `<clear />` When Adding providers</span></span>](https://weblogs.asp.net/scottgu/archive/2006/11/20/common-gotcha-don-t-forget-to-clear-when-adding-providers.aspx)
- [<span data-ttu-id="4b720-459">直接使用 `SqlMembershipProvider`</span><span class="sxs-lookup"><span data-stu-id="4b720-459">Working Directly with the `SqlMembershipProvider`</span></span>](http://aspnet.4guysfromrolla.com/articles/091207-1.aspx)

### <a name="video-training-on-topics-contained-in-this-tutorial"></a><span data-ttu-id="4b720-460">在本教學課程所包含的主題訓練影片</span><span class="sxs-lookup"><span data-stu-id="4b720-460">Video Training on Topics Contained in this Tutorial</span></span>

- [<span data-ttu-id="4b720-461">了解 ASP.NET 成員資格</span><span class="sxs-lookup"><span data-stu-id="4b720-461">Understanding ASP.NET Memberships</span></span>](../../../videos/authentication/understanding-aspnet-memberships.md)
- [<span data-ttu-id="4b720-462">設定 SQL 使用成員資格結構描述</span><span class="sxs-lookup"><span data-stu-id="4b720-462">Configuring SQL To Work with Membership Schemas</span></span>](../../../videos/authentication/configuring-sql-to-work-with-membership-schemas.md)
- [<span data-ttu-id="4b720-463">變更預設成員資格結構描述中的成員資格設定</span><span class="sxs-lookup"><span data-stu-id="4b720-463">Changing Membership Settings in the Default Membership Schema</span></span>](../../../videos/authentication/changing-membership-settings-in-the-default-membership-schema.md)

### <a name="about-the-author"></a><span data-ttu-id="4b720-464">關於作者</span><span class="sxs-lookup"><span data-stu-id="4b720-464">About the Author</span></span>

<span data-ttu-id="4b720-465">Scott Mitchell，多個 ASP/ASP.NET 書籍的作者和創辦的 4GuysFromRolla.com，具有已經使用 Microsoft Web 技術從 1998 年。</span><span class="sxs-lookup"><span data-stu-id="4b720-465">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="4b720-466">Scott 可做為獨立顧問、 訓練和寫入器。</span><span class="sxs-lookup"><span data-stu-id="4b720-466">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="4b720-467">他最新的活頁簿 *[Sam 教導您自己 ASP.NET 2.0 24 小時內](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*。</span><span class="sxs-lookup"><span data-stu-id="4b720-467">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="4b720-468">在可到達 Scott [ mitchell@4guysfromrolla.com ](mailto:mitchell@4guysfromrolla.com)或透過在他的部落格[ http://ScottOnWriting.NET ](http://scottonwriting.net/)。</span><span class="sxs-lookup"><span data-stu-id="4b720-468">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="4b720-469">特別感謝</span><span class="sxs-lookup"><span data-stu-id="4b720-469">Special Thanks To</span></span>

<span data-ttu-id="4b720-470">許多有用的檢閱者已檢閱本教學課程系列。</span><span class="sxs-lookup"><span data-stu-id="4b720-470">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="4b720-471">在此教學課程的前導檢閱者已 Alicja Maziarz。</span><span class="sxs-lookup"><span data-stu-id="4b720-471">Lead reviewer for this tutorial was Alicja Maziarz.</span></span> <span data-ttu-id="4b720-472">檢閱我即將推出的 MSDN 文件有興趣嗎？</span><span class="sxs-lookup"><span data-stu-id="4b720-472">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="4b720-473">如果是這樣，卸除我一行[ mitchell@4GuysFromRolla.com ](mailto:mitchell@4GuysFromRolla.com)。</span><span class="sxs-lookup"><span data-stu-id="4b720-473">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="4b720-474">[上一頁](storing-additional-user-information-cs.md)
> [下一頁](creating-user-accounts-vb.md)</span><span class="sxs-lookup"><span data-stu-id="4b720-474">[Previous](storing-additional-user-information-cs.md)
[Next](creating-user-accounts-vb.md)</span></span>
