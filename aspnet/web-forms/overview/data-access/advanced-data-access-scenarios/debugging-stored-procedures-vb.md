---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/debugging-stored-procedures-vb
title: 偵錯預存程序 (VB) |Microsoft 文件
author: rick-anderson
description: Visual Studio Professional 和 Team System 的版本可讓您設定中斷點，然後逐步執行至 SQL Server 中的預存程序進行偵錯預存...
ms.author: aspnetcontent
manager: wpickett
ms.date: 08/03/2007
ms.topic: article
ms.assetid: 9ed8ccb5-5f31-4eb4-976d-cabf4b45ca09
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/debugging-stored-procedures-vb
msc.type: authoredcontent
ms.openlocfilehash: 3391a78eaeb0add46e75048069a614ba00628f67
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/06/2018
ms.locfileid: "30876445"
---
<a name="debugging-stored-procedures-vb"></a><span data-ttu-id="9b58e-103">偵錯預存程序 (VB)</span><span class="sxs-lookup"><span data-stu-id="9b58e-103">Debugging Stored Procedures (VB)</span></span>
====================
<span data-ttu-id="9b58e-104">由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="9b58e-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="9b58e-105">[下載程式碼](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_74_VB.zip)或[下載 PDF](debugging-stored-procedures-vb/_static/datatutorial74vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="9b58e-105">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_74_VB.zip) or [Download PDF](debugging-stored-procedures-vb/_static/datatutorial74vb1.pdf)</span></span>

> <span data-ttu-id="9b58e-106">Visual Studio Professional 和 Team System 的版本可讓您設定中斷點，然後逐步執行至 SQL Server 中的預存程序進行偵錯預存程序，只要偵錯應用程式程式碼。</span><span class="sxs-lookup"><span data-stu-id="9b58e-106">Visual Studio Professional and Team System editions allow you to set breakpoints and step in to stored procedures within SQL Server, making debugging stored procedures as easy as debugging application code.</span></span> <span data-ttu-id="9b58e-107">本教學課程會示範直接資料庫偵錯，以及應用程式偵錯預存程序。</span><span class="sxs-lookup"><span data-stu-id="9b58e-107">This tutorial demonstrates direct database debugging and application debugging of stored procedures.</span></span>


## <a name="introduction"></a><span data-ttu-id="9b58e-108">簡介</span><span class="sxs-lookup"><span data-stu-id="9b58e-108">Introduction</span></span>

<span data-ttu-id="9b58e-109">Visual Studio 提供豐富的偵錯經驗。</span><span class="sxs-lookup"><span data-stu-id="9b58e-109">Visual Studio provides a rich debugging experience.</span></span> <span data-ttu-id="9b58e-110">有幾個按鍵或按下滑鼠，它可以將中斷點停止執行程式並檢查其狀態和控制流程 s。</span><span class="sxs-lookup"><span data-stu-id="9b58e-110">With a few keystrokes or clicks of the mouse, it s possible to use breakpoints to stop execution of a program and examine its state and control flow.</span></span> <span data-ttu-id="9b58e-111">偵錯應用程式程式碼，以及 Visual Studio 會提供支援 SQL Server 中的從預存程序，偵錯。</span><span class="sxs-lookup"><span data-stu-id="9b58e-111">Along with debugging application code, Visual Studio offers support for debugging stored procedures from within SQL Server.</span></span> <span data-ttu-id="9b58e-112">就像可以在 ASP.NET 程式碼後置類別或商務邏輯層類別的程式碼中設定中斷點以便太它們可放置在預存程序內。</span><span class="sxs-lookup"><span data-stu-id="9b58e-112">Just like breakpoints can be set within the code of an ASP.NET code-behind class or Business Logic Layer class, so too can they be placed within stored procedures.</span></span>

<span data-ttu-id="9b58e-113">在本教學課程，我們將探討逐步執行預存程序從 Visual Studio 中的 [伺服器總管] 以及如何設定中斷點會叫用預存程序呼叫時從執行的 ASP.NET 應用程式。</span><span class="sxs-lookup"><span data-stu-id="9b58e-113">In this tutorial we will look at stepping into stored procedures from the Server Explorer within Visual Studio as well as how to set breakpoints that are hit when the stored procedure is called from the running ASP.NET application.</span></span>

> [!NOTE]
> <span data-ttu-id="9b58e-114">不幸的是，預存程序只能是逐步執行和偵錯透過 Visual Studio 的專業人員和小組的系統版本。</span><span class="sxs-lookup"><span data-stu-id="9b58e-114">Unfortunately, stored procedures can only be stepped into and debugged through the Professional and Team Systems versions of Visual Studio.</span></span> <span data-ttu-id="9b58e-115">如果您使用 Visual Web Developer 或 standard 版本的 Visual Studio，您可以隨意地讀取沿著我們逐步偵錯預存程序所需的步驟，但您無法將複寫您的電腦上的這些步驟。</span><span class="sxs-lookup"><span data-stu-id="9b58e-115">If you are using Visual Web Developer or the standard version of Visual Studio, you are welcome to read along as we walk through the steps necessary to debug stored procedures, but you will not be able to replicate these steps on your machine.</span></span>


## <a name="sql-server-debugging-concepts"></a><span data-ttu-id="9b58e-116">SQL Server 偵錯概念</span><span class="sxs-lookup"><span data-stu-id="9b58e-116">SQL Server Debugging Concepts</span></span>

<span data-ttu-id="9b58e-117">Microsoft SQL Server 2005 設計來提供與整合[Common Language Runtime (CLR)](https://msdn.microsoft.com/netframework/aa497266.aspx)，也就是所有的.NET 組件所使用的執行階段。</span><span class="sxs-lookup"><span data-stu-id="9b58e-117">Microsoft SQL Server 2005 was designed to provide integration with the [Common Language Runtime (CLR)](https://msdn.microsoft.com/netframework/aa497266.aspx), which is the runtime used by all .NET assemblies.</span></span> <span data-ttu-id="9b58e-118">因此，SQL Server 2005 支援 managed 的資料庫物件。</span><span class="sxs-lookup"><span data-stu-id="9b58e-118">Consequently, SQL Server 2005 supports managed database objects.</span></span> <span data-ttu-id="9b58e-119">也就是說，您可以建立資料庫物件，例如預存程序和使用者定義函數 (Udf) 為 Visual Basic 類別中的方法。</span><span class="sxs-lookup"><span data-stu-id="9b58e-119">That is, you can create database objects like stored procedures and User-Defined Functions (UDFs) as methods in a Visual Basic class.</span></span> <span data-ttu-id="9b58e-120">這可讓這些預存程序和 Udf 利用.NET Framework 中，以及您自己自訂的類別的功能。</span><span class="sxs-lookup"><span data-stu-id="9b58e-120">This enables these stored procedures and UDFs to utilize functionality in the .NET Framework and from your own custom classes.</span></span> <span data-ttu-id="9b58e-121">當然，SQL Server 2005 也會提供支援的 T-SQL 和資料庫物件。</span><span class="sxs-lookup"><span data-stu-id="9b58e-121">Of course, SQL Server 2005 also provides support for T-SQL database objects.</span></span>

<span data-ttu-id="9b58e-122">SQL Server 2005 提供 T-SQL 和 managed 的資料庫物件偵錯的支援。</span><span class="sxs-lookup"><span data-stu-id="9b58e-122">SQL Server 2005 offers debugging support for both T-SQL and managed database objects.</span></span> <span data-ttu-id="9b58e-123">不過，這些物件只可透過 Visual Studio 2005 Professional 和小組的系統版本偵錯。</span><span class="sxs-lookup"><span data-stu-id="9b58e-123">However, these objects can only be debugged through Visual Studio 2005 Professional and Team Systems editions.</span></span> <span data-ttu-id="9b58e-124">在本教學課程中，我們將檢查偵錯的 T-SQL 和資料庫物件。</span><span class="sxs-lookup"><span data-stu-id="9b58e-124">In this tutorial we will examine debugging T-SQL database objects.</span></span> <span data-ttu-id="9b58e-125">後續的教學課程會查看偵錯 managed 的資料庫物件。</span><span class="sxs-lookup"><span data-stu-id="9b58e-125">The subsequent tutorial looks at debugging managed database objects.</span></span>

<span data-ttu-id="9b58e-126">[概觀的 T-SQL 和 CLR 偵錯 SQL Server 2005 中](https://blogs.msdn.com/sqlclr/archive/2006/06/29/651644.aspx)部落格文章： 從[SQL Server 2005 CLR 整合小組](https://blogs.msdn.com/sqlclr/default.aspx)會反白顯示偵錯 Visual Studio 中的 SQL Server 2005 物件的三種方式：</span><span class="sxs-lookup"><span data-stu-id="9b58e-126">The [Overview of T-SQL and CLR Debugging in SQL Server 2005](https://blogs.msdn.com/sqlclr/archive/2006/06/29/651644.aspx) blog entry from the [SQL Server 2005 CLR Integration team](https://blogs.msdn.com/sqlclr/default.aspx) highlights the three ways to debug SQL Server 2005 objects from Visual Studio:</span></span>

- <span data-ttu-id="9b58e-127">**指示資料庫偵錯 (DDD)** -從伺服器總管，我們可以逐步執行任何 T-SQL 的資料庫物件，例如預存程序和 Udf。</span><span class="sxs-lookup"><span data-stu-id="9b58e-127">**Direct Database Debugging (DDD)** - from Server Explorer we can step into any T-SQL database object, such as stored procedures and UDFs.</span></span> <span data-ttu-id="9b58e-128">我們將檢驗 DDD 在步驟 1 中。</span><span class="sxs-lookup"><span data-stu-id="9b58e-128">We will examine DDD in Step 1.</span></span>
- <span data-ttu-id="9b58e-129">**應用程式偵錯**-我們可以將資料庫物件中的中斷點，然後再執行 我們的 ASP.NET 應用程式。</span><span class="sxs-lookup"><span data-stu-id="9b58e-129">**Application Debugging** - we can set breakpoints within a database object and then run our ASP.NET application.</span></span> <span data-ttu-id="9b58e-130">當執行資料庫物件時，會叫用中斷點，控制偵錯工具。</span><span class="sxs-lookup"><span data-stu-id="9b58e-130">When the database object is executed, the breakpoint will be hit and control turned over to the debugger.</span></span> <span data-ttu-id="9b58e-131">請注意，應用程式偵錯我們無法逐步執行的資料庫物件從應用程式程式碼。</span><span class="sxs-lookup"><span data-stu-id="9b58e-131">Note that with application debugging we cannot step into a database object from application code.</span></span> <span data-ttu-id="9b58e-132">我們必須明確地設定中斷點這些預存程序或 Udf 我們想要停止偵錯工具。</span><span class="sxs-lookup"><span data-stu-id="9b58e-132">We must explicitly set breakpoints in those stored procedures or UDFs where we want the debugger to stop.</span></span> <span data-ttu-id="9b58e-133">偵錯應用程式會檢查在步驟 2 中啟動。</span><span class="sxs-lookup"><span data-stu-id="9b58e-133">Application debugging is examined starting in Step 2.</span></span>
- <span data-ttu-id="9b58e-134">**從 SQL Server 專案，偵錯**-Visual Studio Professional 和小組的系統版本包括通常用來建立 managed 的資料庫物件的 SQL Server 專案類型。</span><span class="sxs-lookup"><span data-stu-id="9b58e-134">**Debugging from a SQL Server Project** - Visual Studio Professional and Team Systems editions include a SQL Server Project type that is commonly used to create managed database objects.</span></span> <span data-ttu-id="9b58e-135">我們將使用 SQL Server 專案來檢視和下一個教學課程中的偵錯其內容。</span><span class="sxs-lookup"><span data-stu-id="9b58e-135">We will examine using SQL Server Projects and debugging their contents in the next tutorial.</span></span>

<span data-ttu-id="9b58e-136">Visual Studio 可以偵錯在本機和遠端的 SQL Server 執行個體上的預存程序。</span><span class="sxs-lookup"><span data-stu-id="9b58e-136">Visual Studio can debug stored procedures on local and remote SQL Server instances.</span></span> <span data-ttu-id="9b58e-137">本機的 SQL Server 執行個體是安裝在與 Visual Studio 在同一部電腦上。</span><span class="sxs-lookup"><span data-stu-id="9b58e-137">A local SQL Server instance is one that is installed on the same machine as Visual Studio.</span></span> <span data-ttu-id="9b58e-138">如果在開發電腦上找不到您使用的 SQL Server 資料庫，則它會被視為遠端執行個體。</span><span class="sxs-lookup"><span data-stu-id="9b58e-138">If the SQL Server database you are using is not located on your development machine, then it is considered a remote instance.</span></span> <span data-ttu-id="9b58e-139">如需這些教學課程我們已在使用本機 SQL Server 執行個體。</span><span class="sxs-lookup"><span data-stu-id="9b58e-139">For these tutorials we have been using local SQL Server instances.</span></span> <span data-ttu-id="9b58e-140">偵錯在遠端的 SQL server 執行個體上的預存程序需要更多的組態步驟，比當偵錯在本機執行個體上的預存程序。</span><span class="sxs-lookup"><span data-stu-id="9b58e-140">Debugging stored procedures on a remote SQL server instance requires more configuration steps than when debugging stored procedures on a local instance.</span></span>

<span data-ttu-id="9b58e-141">如果您使用本機的 SQL Server 執行個體，您可以從步驟 1 開始，逐步進行本教學課程結尾。</span><span class="sxs-lookup"><span data-stu-id="9b58e-141">If you are using a local SQL Server instance, you can start with Step 1 and work through this tutorial to the end.</span></span> <span data-ttu-id="9b58e-142">如果您使用遠端 SQL Server 執行個體，不過，您將必須先確定當您偵錯會記錄到遠端執行個體上有 SQL Server 登入的 Windows 使用者帳戶在開發電腦。</span><span class="sxs-lookup"><span data-stu-id="9b58e-142">If you are using a remote SQL Server instance, however, you will first need to ensure that when debugging you are logged to your development machine with a Windows user account that has a SQL Server login on the remote instance.</span></span> <span data-ttu-id="9b58e-143">Moveover，此資料庫登入，用於從執行的 ASP.NET 應用程式連接到資料庫的資料庫登入必須是成員的`sysadmin`角色。</span><span class="sxs-lookup"><span data-stu-id="9b58e-143">Moveover, both this database login and the database login used to connect to the database from the running ASP.NET application must be members of the `sysadmin` role.</span></span> <span data-ttu-id="9b58e-144">如需有關設定 Visual Studio 和 SQL Server 遠端執行個體進行偵錯本教學課程結尾處中查看上遠端執行個體 > 一節 T-SQL 偵錯資料庫物件。</span><span class="sxs-lookup"><span data-stu-id="9b58e-144">See the Debugging T-SQL Database Objects on Remote Instances section at the end of this tutorial for more information on configuring Visual Studio and SQL Server to debug a remote instance.</span></span>

<span data-ttu-id="9b58e-145">最後，了解偵錯支援 T-SQL 的資料庫物件不為做為偵錯的.NET 應用程式支援豐富的功能。</span><span class="sxs-lookup"><span data-stu-id="9b58e-145">Finally, understand that debugging support for T-SQL database objects is not as feature rich as debugging support for .NET applications.</span></span> <span data-ttu-id="9b58e-146">例如，中斷點條件和篩選條件不支援，偵錯視窗的子集只可以使用，您無法使用 [編輯後繼續]、 即時運算視窗呈現毫無用處，等等。</span><span class="sxs-lookup"><span data-stu-id="9b58e-146">For example, breakpoint conditions and filters are not supported, only a subset of the debugging windows are available, you cannot use Edit and Continue, the Immediate window is rendered useless, and so forth.</span></span> <span data-ttu-id="9b58e-147">請參閱[偵錯工具命令和功能的限制](https://msdn.microsoft.com/library/ms165035(VS.80).aspx)如需詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="9b58e-147">See [Limitations on Debugger Commands and Features](https://msdn.microsoft.com/library/ms165035(VS.80).aspx) for more information.</span></span>

## <a name="step-1-directly-stepping-into-a-stored-procedure"></a><span data-ttu-id="9b58e-148">步驟 1： 直接逐步執行預存程序</span><span class="sxs-lookup"><span data-stu-id="9b58e-148">Step 1: Directly Stepping Into a Stored Procedure</span></span>

<span data-ttu-id="9b58e-149">Visual Studio 輕鬆地直接偵錯資料庫物件。</span><span class="sxs-lookup"><span data-stu-id="9b58e-149">Visual Studio makes it easy to directly debug a database object.</span></span> <span data-ttu-id="9b58e-150">將 s 看看如何使用直接資料庫偵錯 (DDD) 功能來逐步執行`Products_SelectByCategoryID`Northwind 資料庫中預存程序。</span><span class="sxs-lookup"><span data-stu-id="9b58e-150">Let s look at how to use the Direct Database Debugging (DDD) feature to step into the `Products_SelectByCategoryID` stored procedure in the Northwind database.</span></span> <span data-ttu-id="9b58e-151">正如其名，`Products_SelectByCategoryID`傳回產品資訊的特定某類; 中建立[使用現有預存程序型別資料集 s Tableadapter](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)教學課程。</span><span class="sxs-lookup"><span data-stu-id="9b58e-151">As its name implies, `Products_SelectByCategoryID` returns product information for a particular category; it was created in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span> <span data-ttu-id="9b58e-152">首先移至 [伺服器總管]，然後展開 Northwind 資料庫節點。</span><span class="sxs-lookup"><span data-stu-id="9b58e-152">Start by going to the Server Explorer and expand the Northwind database node.</span></span> <span data-ttu-id="9b58e-153">接下來，向下鑽研至預存程序資料夾、 以滑鼠右鍵按一下`Products_SelectByCategoryID`預存程序，並從內容功能表中選擇 逐步執行預存程序選項。</span><span class="sxs-lookup"><span data-stu-id="9b58e-153">Next, drill down into the Stored Procedures folder, right-click on the `Products_SelectByCategoryID` stored procedure, and choose the Step Into Stored Procedure option from the context menu.</span></span> <span data-ttu-id="9b58e-154">這會啟動偵錯工具。</span><span class="sxs-lookup"><span data-stu-id="9b58e-154">This will start the debugger.</span></span>

<span data-ttu-id="9b58e-155">因為`Products_SelectByCategoryID`預存程序必須有`@CategoryID`輸入的參數，我們會要求您提供此值。</span><span class="sxs-lookup"><span data-stu-id="9b58e-155">Since the `Products_SelectByCategoryID` stored procedure expects a `@CategoryID` input parameter, we are asked to provide this value.</span></span> <span data-ttu-id="9b58e-156">輸入 1，將會傳回飲料的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="9b58e-156">Enter 1, which will return information about the beverages.</span></span>


![使用的值 1@CategoryID參數](debugging-stored-procedures-vb/_static/image1.png)

<span data-ttu-id="9b58e-158">**圖 1**： 使用的值 1`@CategoryID`參數</span><span class="sxs-lookup"><span data-stu-id="9b58e-158">**Figure 1**: Use the Value 1 for the `@CategoryID` Parameter</span></span>


<span data-ttu-id="9b58e-159">在提供的值之後`@CategoryID`參數，預存程序時執行。</span><span class="sxs-lookup"><span data-stu-id="9b58e-159">After supplying the value for the `@CategoryID` parameter, the stored procedure is executed.</span></span> <span data-ttu-id="9b58e-160">不過，而不是執行到完成為止，偵錯工具暫停執行的第一個陳述式。</span><span class="sxs-lookup"><span data-stu-id="9b58e-160">Rather than running to completion, though, the debugger halts execution on the first statement.</span></span> <span data-ttu-id="9b58e-161">請注意界黃色箭頭，指出預存程序中的目前位置。</span><span class="sxs-lookup"><span data-stu-id="9b58e-161">Note the yellow arrow in the margin, indicating the current location in the stored procedure.</span></span> <span data-ttu-id="9b58e-162">您可以檢視和編輯參數值透過監看式視窗或將滑鼠停留在預存程序的參數名稱。</span><span class="sxs-lookup"><span data-stu-id="9b58e-162">You can view and edit parameter values through the Watch window or by hovering over the parameter name in the stored procedure.</span></span>


<span data-ttu-id="9b58e-163">[![偵錯工具已停止執行的預存程序的第一個陳述式上](debugging-stored-procedures-vb/_static/image3.png)](debugging-stored-procedures-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="9b58e-163">[![The Debugger has Halted on the First Statement of the Stored Procedure](debugging-stored-procedures-vb/_static/image3.png)](debugging-stored-procedures-vb/_static/image2.png)</span></span>

<span data-ttu-id="9b58e-164">**圖 2**： 偵錯工具已停止執行預存程序的第一個陳述式 ([按一下以檢視完整大小的影像](debugging-stored-procedures-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="9b58e-164">**Figure 2**: The Debugger has Halted on the First Statement of the Stored Procedure ([Click to view full-size image](debugging-stored-procedures-vb/_static/image4.png))</span></span>


<span data-ttu-id="9b58e-165">若要逐步執行預存程序一個陳述式一次，請按一下工具列中的 [不進入函數] 按鈕或按 F10 鍵。</span><span class="sxs-lookup"><span data-stu-id="9b58e-165">To step through the stored procedure one statement at a time, click the Step Over button in the Toolbar or hit the F10 key.</span></span> <span data-ttu-id="9b58e-166">`Products_SelectByCategoryID`預存程序包含單一`SELECT`陳述式，因此按下 F10 會在單一陳述式中逐步完成預存程序執行。</span><span class="sxs-lookup"><span data-stu-id="9b58e-166">The `Products_SelectByCategoryID` stored procedure contains a single `SELECT` statement, so hitting F10 will step over the single statement and complete the execution of the stored procedure.</span></span> <span data-ttu-id="9b58e-167">預存程序完成之後，它的輸出會出現在 [輸出] 視窗和偵錯工具將會終止。</span><span class="sxs-lookup"><span data-stu-id="9b58e-167">After the stored procedure has completed, its output will appear in the Output window and the debugger will terminate.</span></span>

> [!NOTE]
> <span data-ttu-id="9b58e-168">T-SQL 偵錯，就會發生在陳述式層級;您無法逐步執行`SELECT`陳述式。</span><span class="sxs-lookup"><span data-stu-id="9b58e-168">T-SQL debugging occurs at the statement level; you cannot step into a `SELECT` statement.</span></span>


## <a name="step-2-configuring-the-website-for-application-debugging"></a><span data-ttu-id="9b58e-169">步驟 2： 設定應用程式偵錯的網站</span><span class="sxs-lookup"><span data-stu-id="9b58e-169">Step 2: Configuring the Website for Application Debugging</span></span>

<span data-ttu-id="9b58e-170">偵錯直接從 [伺服器總管] 中的預存程序是很方便，在許多情況下很多想要呼叫從我們的 ASP.NET 應用程式時，偵錯預存程序。</span><span class="sxs-lookup"><span data-stu-id="9b58e-170">While debugging a stored procedure directly from the Server Explorer is handy, in many scenarios we are more interested in debugging the stored procedure when it is called from our ASP.NET application.</span></span> <span data-ttu-id="9b58e-171">我們可以將中斷點加入至 Visual Studio 中的預存程序，然後開始偵錯 ASP.NET 應用程式。</span><span class="sxs-lookup"><span data-stu-id="9b58e-171">We can add breakpoints to a stored procedure from within Visual Studio and then start debugging the ASP.NET application.</span></span> <span data-ttu-id="9b58e-172">從應用程式叫用具有中斷點的預存程序時，執行將會在中斷點暫止，我們可以檢視和變更預存程序的參數值並逐步執行陳述式中，，如同我們在步驟 1。</span><span class="sxs-lookup"><span data-stu-id="9b58e-172">When a stored procedure with breakpoints is invoked from the application, execution will halt at the breakpoint and we can view and change the stored procedure s parameter values and step through its statements, just like we did in Step 1.</span></span>

<span data-ttu-id="9b58e-173">我們可以開始偵錯應用程式從呼叫的預存程序之前，我們需要 ASP.NET web 應用程式與 SQL Server 偵錯工具整合的指示。</span><span class="sxs-lookup"><span data-stu-id="9b58e-173">Before we can start debugging stored procedures called from the application, we need to instruct the ASP.NET web application to integrate with the SQL Server debugger.</span></span> <span data-ttu-id="9b58e-174">以滑鼠右鍵按一下方案總管 中的網站名稱開始 (`ASPNET_Data_Tutorial_74_VB`)。</span><span class="sxs-lookup"><span data-stu-id="9b58e-174">Start by right-clicking on the website name in the Solution Explorer (`ASPNET_Data_Tutorial_74_VB`).</span></span> <span data-ttu-id="9b58e-175">從內容功能表中選擇 [屬性頁] 選項選取左邊的啟動選項項目，請檢查 SQL Server 中的核取 [偵錯工具] 區段 （請參閱圖 3）。</span><span class="sxs-lookup"><span data-stu-id="9b58e-175">Choose the Property Pages option from the context menu, select the Start Options item on the left, and check the SQL Server checkbox in the Debuggers section (see Figure 3).</span></span>


<span data-ttu-id="9b58e-176">[![檢查應用程式的屬性頁面中的 SQL Server 核取方塊](debugging-stored-procedures-vb/_static/image6.png)](debugging-stored-procedures-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="9b58e-176">[![Check the SQL Server Checkbox in the Application s Property Pages](debugging-stored-procedures-vb/_static/image6.png)](debugging-stored-procedures-vb/_static/image5.png)</span></span>

<span data-ttu-id="9b58e-177">**圖 3**： 選取 SQL 伺服器核取方塊，在應用程式屬性頁 ([按一下以檢視完整大小的影像](debugging-stored-procedures-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="9b58e-177">**Figure 3**: Check the SQL Server Checkbox in the Application s Property Pages ([Click to view full-size image](debugging-stored-procedures-vb/_static/image7.png))</span></span>


<span data-ttu-id="9b58e-178">此外，我們需要更新資料庫連接字串，由應用程式使用，因此已停用連線共用。</span><span class="sxs-lookup"><span data-stu-id="9b58e-178">Additionally, we need to update the database connection string used by the application so that connection pooling is disabled.</span></span> <span data-ttu-id="9b58e-179">資料庫的連接關閉時，對應`SqlConnection`物件會放置在可用的連接集區。</span><span class="sxs-lookup"><span data-stu-id="9b58e-179">When a connection to a database is closed, the corresponding `SqlConnection` object is placed in a pool of available connections.</span></span> <span data-ttu-id="9b58e-180">在建立資料庫的連接時，可用的連接物件可以擷取此集區中而不需要重新建立，並建立新的連接。</span><span class="sxs-lookup"><span data-stu-id="9b58e-180">When establishing a connection to a database, an available connection object can be retrieved from this pool rather than having to create and establish a new connection.</span></span> <span data-ttu-id="9b58e-181">這種共用的連線物件是效能增強功能，並預設會啟用。</span><span class="sxs-lookup"><span data-stu-id="9b58e-181">This pooling of connection objects is a performance enhancement and is enabled by default.</span></span> <span data-ttu-id="9b58e-182">不過，當偵錯我們想要關閉連接共用，因為偵錯基礎結構會不正確地重新建立時使用取自集區的連接。</span><span class="sxs-lookup"><span data-stu-id="9b58e-182">However, when debugging we want to turn off connection pooling because the debugging infrastructure is not correctly reestablished when working with a connection that was taken from the pool.</span></span>

<span data-ttu-id="9b58e-183">若要停用的連線集區，更新`NORTHWNDConnectionString`中`Web.config`，使其包含設定`Pooling=false`。</span><span class="sxs-lookup"><span data-stu-id="9b58e-183">To disabled connection pooling, update the `NORTHWNDConnectionString` in `Web.config` so that it includes the setting `Pooling=false` .</span></span>


[!code-xml[Main](debugging-stored-procedures-vb/samples/sample1.xml)]

> [!NOTE]
> <span data-ttu-id="9b58e-184">當您完成後，透過 ASP.NET 應用程式偵錯 SQL Server 務必要重新啟用連接共用，藉由移除`Pooling`從連接字串設定 (或將它設定為`Pooling=true`)。</span><span class="sxs-lookup"><span data-stu-id="9b58e-184">Once you have finished debugging SQL Server through the ASP.NET application be sure to reinstate connection pooling by removing the `Pooling` setting from the connection string (or by setting it to `Pooling=true` ).</span></span>


<span data-ttu-id="9b58e-185">此時 ASP.NET 應用程式已設定為允許 Visual Studio 偵錯 web 應用程式透過叫用時，SQL Server 資料庫物件。</span><span class="sxs-lookup"><span data-stu-id="9b58e-185">At this point the ASP.NET application has been configured to allow Visual Studio to debug SQL Server database objects when invoked through the web application.</span></span> <span data-ttu-id="9b58e-186">現在只剩是將中斷點加入至預存程序，並開始偵錯 ！</span><span class="sxs-lookup"><span data-stu-id="9b58e-186">All that remains now is to add a breakpoint to a stored procedure and start debugging!</span></span>

## <a name="step-3-adding-a-breakpoint-and-debugging"></a><span data-ttu-id="9b58e-187">步驟 3： 新增中斷點和偵錯</span><span class="sxs-lookup"><span data-stu-id="9b58e-187">Step 3: Adding a Breakpoint and Debugging</span></span>

<span data-ttu-id="9b58e-188">開啟`Products_SelectByCategoryID`預存程序，並設定中斷點的開頭`SELECT`陳述式的適當位置界中按一下，或將游標放在開頭`SELECT`陳述式，並按 f9 鍵。</span><span class="sxs-lookup"><span data-stu-id="9b58e-188">Open the `Products_SelectByCategoryID` stored procedure and set a breakpoint at the start of the `SELECT` statement by clicking in the margin at the appropriate place or by placing your cursor at the start of the `SELECT` statement and hitting F9.</span></span> <span data-ttu-id="9b58e-189">如圖 4 所示，中斷點會顯示為邊界中的紅色圓圈。</span><span class="sxs-lookup"><span data-stu-id="9b58e-189">As Figure 4 illustrates, the breakpoint appears as a red circle in the margin.</span></span>


<span data-ttu-id="9b58e-190">[![Products_SelectByCategoryID 中設定中斷點預存程序](debugging-stored-procedures-vb/_static/image9.png)](debugging-stored-procedures-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="9b58e-190">[![Set a Breakpoint in the Products_SelectByCategoryID Stored Procedure](debugging-stored-procedures-vb/_static/image9.png)](debugging-stored-procedures-vb/_static/image8.png)</span></span>

<span data-ttu-id="9b58e-191">**圖 4**： 中設定中斷點`Products_SelectByCategoryID`預存程序 ([按一下以檢視完整大小的影像](debugging-stored-procedures-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="9b58e-191">**Figure 4**: Set a Breakpoint in the `Products_SelectByCategoryID` Stored Procedure ([Click to view full-size image](debugging-stored-procedures-vb/_static/image10.png))</span></span>


<span data-ttu-id="9b58e-192">為了要透過用戶端應用程式進行偵錯 SQL 資料庫物件，請務必為設定資料庫，以支援應用程式偵錯。</span><span class="sxs-lookup"><span data-stu-id="9b58e-192">In order for a SQL database object to be debugged through a client application, it is imperative that the database be configured to support application debugging.</span></span> <span data-ttu-id="9b58e-193">當您第一次設定中斷點時，這項設定應該自動電源已開啟，但請仔細檢查審慎的作法是。</span><span class="sxs-lookup"><span data-stu-id="9b58e-193">When you first set a breakpoint, this setting should automatically be switched on, but it is prudent to double-check.</span></span> <span data-ttu-id="9b58e-194">以滑鼠右鍵按一下`NORTHWND.MDF`伺服器總管中的節點。</span><span class="sxs-lookup"><span data-stu-id="9b58e-194">Right-click on the `NORTHWND.MDF` node in the Server Explorer.</span></span> <span data-ttu-id="9b58e-195">操作功能表應該包含核取的功能表項目命名為應用程式偵錯。</span><span class="sxs-lookup"><span data-stu-id="9b58e-195">The context menu should include a checked menu item named Application Debugging .</span></span>


![請確定已啟用應用程式偵錯選項](debugging-stored-procedures-vb/_static/image11.png)

<span data-ttu-id="9b58e-197">**圖 5**： 請確定已啟用應用程式偵錯選項</span><span class="sxs-lookup"><span data-stu-id="9b58e-197">**Figure 5**: Ensure that the Application Debugging Option is Enabled</span></span>


<span data-ttu-id="9b58e-198">中斷點設定和已啟用的應用程式偵錯選項，我們就可以開始偵錯預存程序從 ASP.NET 應用程式呼叫時項目。</span><span class="sxs-lookup"><span data-stu-id="9b58e-198">With the breakpoint set and the Application Debugging option enabled, we are ready to debug the stored procedure when called from the ASP.NET application.</span></span> <span data-ttu-id="9b58e-199">啟動偵錯工具移至 [偵錯] 功能表並選擇開始偵錯，請按 F5，或按一下綠色播放工具列中的圖示。</span><span class="sxs-lookup"><span data-stu-id="9b58e-199">Start the debugger by going to the Debug menu and choosing Start Debugging, by hitting F5, or by clicking the green play icon in the Toolbar.</span></span> <span data-ttu-id="9b58e-200">這將會啟動偵錯工具，並啟動網站。</span><span class="sxs-lookup"><span data-stu-id="9b58e-200">This will start the debugger and launch the website.</span></span>

<span data-ttu-id="9b58e-201">`Products_SelectByCategoryID`預存程序中建立[使用現有預存程序型別資料集 s Tableadapter](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)教學課程。</span><span class="sxs-lookup"><span data-stu-id="9b58e-201">The `Products_SelectByCategoryID` stored procedure was created in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial.</span></span> <span data-ttu-id="9b58e-202">其對應的網頁 (`~/AdvancedDAL/ExistingSprocs.aspx`) 包含的 GridView 會顯示此預存程序所傳回的結果。</span><span class="sxs-lookup"><span data-stu-id="9b58e-202">Its corresponding web page (`~/AdvancedDAL/ExistingSprocs.aspx`) contains a GridView that displays the results returned by this stored procedure.</span></span> <span data-ttu-id="9b58e-203">請瀏覽此頁面，透過瀏覽器。</span><span class="sxs-lookup"><span data-stu-id="9b58e-203">Visit this page through the browser.</span></span> <span data-ttu-id="9b58e-204">當到達 頁面上，在中斷點`Products_SelectByCategoryID`會被叫用預存程序和控制傳回到 Visual Studio。</span><span class="sxs-lookup"><span data-stu-id="9b58e-204">Upon reaching the page, the breakpoint in the `Products_SelectByCategoryID` stored procedure will be hit and control returned to Visual Studio.</span></span> <span data-ttu-id="9b58e-205">就像在步驟 1 中，您可以逐步執行的預存程序 s 陳述式和檢視和修改參數值。</span><span class="sxs-lookup"><span data-stu-id="9b58e-205">Just like in Step 1, you can step through the stored procedure s statements and view and modify the parameter values.</span></span>


<span data-ttu-id="9b58e-206">[![ExistingSprocs.aspx 頁面一開始會顯示飲料](debugging-stored-procedures-vb/_static/image13.png)](debugging-stored-procedures-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="9b58e-206">[![The ExistingSprocs.aspx Page Initially Displays the Beverages](debugging-stored-procedures-vb/_static/image13.png)](debugging-stored-procedures-vb/_static/image12.png)</span></span>

<span data-ttu-id="9b58e-207">**圖 6**:`ExistingSprocs.aspx`頁面一開始會顯示飲料 ([按一下以檢視完整大小的影像](debugging-stored-procedures-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="9b58e-207">**Figure 6**: The `ExistingSprocs.aspx` Page Initially Displays the Beverages ([Click to view full-size image](debugging-stored-procedures-vb/_static/image14.png))</span></span>


<span data-ttu-id="9b58e-208">[![預存程序 s 已到達中斷點](debugging-stored-procedures-vb/_static/image16.png)](debugging-stored-procedures-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="9b58e-208">[![The Stored Procedure s Breakpoint has been Reached](debugging-stored-procedures-vb/_static/image16.png)](debugging-stored-procedures-vb/_static/image15.png)</span></span>

<span data-ttu-id="9b58e-209">**圖 7**： 已到達中斷點的預存程序 s ([按一下以檢視完整大小的影像](debugging-stored-procedures-vb/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="9b58e-209">**Figure 7**: The Stored Procedure s Breakpoint has been Reached ([Click to view full-size image](debugging-stored-procedures-vb/_static/image17.png))</span></span>


<span data-ttu-id="9b58e-210">圖 7 所示的值中的 [監看式] 視窗`@CategoryID`參數是 1。</span><span class="sxs-lookup"><span data-stu-id="9b58e-210">As the Watch window in Figure 7 shows, the value of the `@CategoryID` parameter is 1.</span></span> <span data-ttu-id="9b58e-211">這是因為`ExistingSprocs.aspx`頁面一開始會顯示產品中具有 「 飲料 」 分類`CategoryID`值為 1。</span><span class="sxs-lookup"><span data-stu-id="9b58e-211">This is because the `ExistingSprocs.aspx` page initially displays products in the beverages category, which has a `CategoryID` value of 1.</span></span> <span data-ttu-id="9b58e-212">從下拉式清單中選擇不同的類別。</span><span class="sxs-lookup"><span data-stu-id="9b58e-212">Choose a different category from the drop-down list.</span></span> <span data-ttu-id="9b58e-213">這樣會導致回傳，並重新執行`Products_SelectByCategoryID`預存程序。</span><span class="sxs-lookup"><span data-stu-id="9b58e-213">Doing so causes a postback and re-executes the `Products_SelectByCategoryID` stored procedure.</span></span> <span data-ttu-id="9b58e-214">叫用中斷點時一次，但這次`@CategoryID`參數 s 的值會反映下拉式清單中選取項目的`CategoryID`。</span><span class="sxs-lookup"><span data-stu-id="9b58e-214">The breakpoint is hit again, but this time the `@CategoryID` parameter s value reflects the selected drop-down list item s `CategoryID`.</span></span>


<span data-ttu-id="9b58e-215">[![從下拉式清單中選擇不同的類別](debugging-stored-procedures-vb/_static/image19.png)](debugging-stored-procedures-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="9b58e-215">[![Choose a Different Category from the Drop-Down List](debugging-stored-procedures-vb/_static/image19.png)](debugging-stored-procedures-vb/_static/image18.png)</span></span>

<span data-ttu-id="9b58e-216">**圖 8**： 從下拉式清單中選擇不同的分類 ([按一下以檢視完整大小的影像](debugging-stored-procedures-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="9b58e-216">**Figure 8**: Choose a Different Category from the Drop-Down List ([Click to view full-size image](debugging-stored-procedures-vb/_static/image20.png))</span></span>


<span data-ttu-id="9b58e-217">[![@CategoryID參數會反映從網頁上所選取的類別](debugging-stored-procedures-vb/_static/image22.png)](debugging-stored-procedures-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="9b58e-217">[![The @CategoryID Parameter Reflects the Category Selected from the Web Page](debugging-stored-procedures-vb/_static/image22.png)](debugging-stored-procedures-vb/_static/image21.png)</span></span>

<span data-ttu-id="9b58e-218">**圖 9**:`@CategoryID`參數會反映從網頁上的類別目錄選取 ([按一下以檢視完整大小的影像](debugging-stored-procedures-vb/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="9b58e-218">**Figure 9**: The `@CategoryID` Parameter Reflects the Category Selected from the Web Page ([Click to view full-size image](debugging-stored-procedures-vb/_static/image23.png))</span></span>


> [!NOTE]
> <span data-ttu-id="9b58e-219">如果在中斷點`Products_SelectByCategoryID`預存程序不叫用造訪時`ExistingSprocs.aspx`頁面上，請確定 SQL Server 核取方塊已核取 ASP.NET 應用程式的屬性頁面 偵錯工具 部分中，已經過連接共用已停用，而且已啟用資料庫 s 應用程式偵錯選項。</span><span class="sxs-lookup"><span data-stu-id="9b58e-219">If the breakpoint in the `Products_SelectByCategoryID` stored procedure is not hit when visiting the `ExistingSprocs.aspx` page, make sure that the SQL Server checkbox has been checked in the Debuggers section of the ASP.NET application s Properties Page, that connection pooling has been disabled, and that the database s Application Debugging option is enabled.</span></span> <span data-ttu-id="9b58e-220">如果您重新仍然發生問題，重新啟動 Visual Studio 並再試一次。</span><span class="sxs-lookup"><span data-stu-id="9b58e-220">If you re still having problems, restart Visual Studio and try again.</span></span>


## <a name="debugging-t-sql-database-objects-on-remote-instances"></a><span data-ttu-id="9b58e-221">偵錯遠端執行個體上的 T-SQL 和資料庫物件</span><span class="sxs-lookup"><span data-stu-id="9b58e-221">Debugging T-SQL Database Objects on Remote Instances</span></span>

<span data-ttu-id="9b58e-222">在 Visual Studio 的同一部機器上的 SQL Server 資料庫執行個體時，偵錯資料庫物件，透過 Visual Studio 就相當簡單。</span><span class="sxs-lookup"><span data-stu-id="9b58e-222">Debugging database objects through Visual Studio is fairly straightforward when the SQL Server database instance is on the same machine as Visual Studio.</span></span> <span data-ttu-id="9b58e-223">不過，如果 SQL Server 和 Visual Studio 位於不同機器上某些周密的組態設定則需要取得項目的正常運作。</span><span class="sxs-lookup"><span data-stu-id="9b58e-223">However, if SQL Server and Visual Studio reside on different machines then some careful configuration is required to get everything working properly.</span></span> <span data-ttu-id="9b58e-224">有兩個核心工作，我們正面臨著：</span><span class="sxs-lookup"><span data-stu-id="9b58e-224">There are two core tasks we are faced with:</span></span>

- <span data-ttu-id="9b58e-225">確認用來透過 ADO.NET 資料庫連接的登入屬於`sysadmin`角色。</span><span class="sxs-lookup"><span data-stu-id="9b58e-225">Ensure that the login used to connect to the database via ADO.NET belongs to the `sysadmin` role.</span></span>
- <span data-ttu-id="9b58e-226">請確定 Visual Studio 用來開發電腦上的 Windows 使用者帳戶是有效的 SQL Server 登入帳戶屬於`sysadmin`角色。</span><span class="sxs-lookup"><span data-stu-id="9b58e-226">Ensure that the Windows user account used by Visual Studio on the development machine is a valid SQL Server login account that belongs to the `sysadmin` role.</span></span>

<span data-ttu-id="9b58e-227">第一個步驟是相當直接。</span><span class="sxs-lookup"><span data-stu-id="9b58e-227">The first step is relatively straightforward.</span></span> <span data-ttu-id="9b58e-228">首先，識別用來從 ASP.NET 應用程式連接到資料庫，然後，從 SQL Server Management Studio，加入至該登入帳戶的使用者帳戶`sysadmin`角色。</span><span class="sxs-lookup"><span data-stu-id="9b58e-228">First, identify the user account used to connect to the database from the ASP.NET application and then, from SQL Server Management Studio, add that login account to the `sysadmin` role.</span></span>

<span data-ttu-id="9b58e-229">第二項工作需要您使用偵錯應用程式的 Windows 使用者帳戶是有效的登入遠端資料庫上。</span><span class="sxs-lookup"><span data-stu-id="9b58e-229">The second task requires that the Windows user account you use to debug the application be a valid login on the remote database.</span></span> <span data-ttu-id="9b58e-230">但是，機率是您登入您的工作站使用的 Windows 帳戶不是有效的登入 SQL Server 上。</span><span class="sxs-lookup"><span data-stu-id="9b58e-230">However, chances are the Windows account you logged on to your workstation with is not a valid login on SQL Server.</span></span> <span data-ttu-id="9b58e-231">而不是將您的特定登入帳戶加入至 SQL Server，就是比較好的選擇將某些 Windows 使用者帳戶指定為 SQL Server 偵錯帳戶。</span><span class="sxs-lookup"><span data-stu-id="9b58e-231">Rather than adding your particular login account to SQL Server, a better choice would be to designate some Windows user account as the SQL Server debugging account.</span></span> <span data-ttu-id="9b58e-232">然後，若要偵錯的遠端 SQL Server 執行個體的資料庫物件，您會執行 Visual Studio 中使用該 Windows 登入帳戶的認證。</span><span class="sxs-lookup"><span data-stu-id="9b58e-232">Then, to debug the database objects of a remote SQL Server instance, you would run Visual Studio using that Windows login account s credentials.</span></span>

<span data-ttu-id="9b58e-233">範例應該有助於釐清項目。</span><span class="sxs-lookup"><span data-stu-id="9b58e-233">An example should help clarify things.</span></span> <span data-ttu-id="9b58e-234">假設是名為的 Windows 帳戶`SQLDebug`Windows 網域內。</span><span class="sxs-lookup"><span data-stu-id="9b58e-234">Imagine that there is a Windows account named `SQLDebug` within the Windows domain.</span></span> <span data-ttu-id="9b58e-235">此帳戶會想要新增至遠端 SQL Server 執行個體做為有效的登入，且成員的身分`sysadmin`角色。</span><span class="sxs-lookup"><span data-stu-id="9b58e-235">This account would need to be added to the remote SQL Server instance as a valid login and as a member of the `sysadmin` role.</span></span> <span data-ttu-id="9b58e-236">然後偵錯遠端 SQL Server 執行個體，從 Visual Studio，我們將需要執行 Visual Studio，做為`SQLDebug`使用者。</span><span class="sxs-lookup"><span data-stu-id="9b58e-236">Then, to debug the remote SQL Server instance from Visual Studio, we would need to run Visual Studio as the `SQLDebug` user.</span></span> <span data-ttu-id="9b58e-237">無法做到這超出我們工作站上，記錄中記錄為`SQLDebug`，，然後啟動 Visual Studio 中，但更簡單的方法會是我們工作站使用自己的認證來登入，然後使用`runas.exe`啟動 Visual Studio，做為`SQLDebug`使用者。</span><span class="sxs-lookup"><span data-stu-id="9b58e-237">This could be done by logging out of our workstation, logging back in as `SQLDebug`, and then launching Visual Studio, but a simpler approach would be to login to our workstation using our own credentials and then use `runas.exe` to launch Visual Studio as the `SQLDebug` user.</span></span> <span data-ttu-id="9b58e-238">`runas.exe` 可讓執行不同的使用者帳戶冒充特定應用程式。</span><span class="sxs-lookup"><span data-stu-id="9b58e-238">`runas.exe` allows a particular application to be executed under the guise of a different user account.</span></span> <span data-ttu-id="9b58e-239">若要啟動 Visual Studio，做為`SQLDebug`，您可以輸入下列陳述式，在命令列：</span><span class="sxs-lookup"><span data-stu-id="9b58e-239">To launch Visual Studio as `SQLDebug`, you could enter the following statement at the command line:</span></span>


[!code-console[Main](debugging-stored-procedures-vb/samples/sample2.cmd)]

<span data-ttu-id="9b58e-240">如需這個程序的更詳細說明，請參閱[William R Vaughn](http://betav.com/BLOG/billva/) s *（英文) s Visual Studio 和 SQL Server，第七個 Edition 指引*以及[How To： 設定 SQL Server 權限偵錯](https://msdn.microsoft.com/library/w1bhybwz(VS.80).aspx)。</span><span class="sxs-lookup"><span data-stu-id="9b58e-240">For a more detailed explanation on this process, see [William R. Vaughn](http://betav.com/BLOG/billva/) s *Hitchhiker s Guide to Visual Studio and SQL Server, Seventh Edition* as well as [How To: Set SQL Server Permissions for Debugging](https://msdn.microsoft.com/library/w1bhybwz(VS.80).aspx).</span></span>

> [!NOTE]
> <span data-ttu-id="9b58e-241">如果您在開發電腦正在執行 Windows XP Service Pack 2，您必須設定網際網路連線防火牆，允許遠端偵錯。</span><span class="sxs-lookup"><span data-stu-id="9b58e-241">If your development machine is running Windows XP Service Pack 2 you will need to configure the Internet Connection Firewall to allow remote debugging.</span></span> <span data-ttu-id="9b58e-242">[如何以： 啟用 SQL Server 2005 偵錯](https://msdn.microsoft.com/library/s0fk6z6e(VS.80).aspx)文章附註這牽涉到兩個步驟: （a） 在 Visual Studio 主機電腦上，您必須加入`Devenv.exe`例外狀況清單並開啟 TCP 135 通訊埠，且 （b） 上遠端 (SQL) 電腦中，您必須開啟TCP 135 通訊埠及新增`sqlservr.exe`至例外清單。</span><span class="sxs-lookup"><span data-stu-id="9b58e-242">[The How To: Enable SQL Server 2005 Debugging](https://msdn.microsoft.com/library/s0fk6z6e(VS.80).aspx) article notes that this involves two steps: (a) On the Visual Studio host machine, you must add `Devenv.exe` to the Exceptions list and open the TCP 135 port; and (b) On the remote (SQL) machine, you must open the TCP 135 port and add `sqlservr.exe` to the Exceptions list.</span></span> <span data-ttu-id="9b58e-243">如果您的網域原則要求透過 IPSec 完成網路通訊，您必須開啟 UDP 4500 和 UDP 500 的連接埠。</span><span class="sxs-lookup"><span data-stu-id="9b58e-243">If your domain policy requires network communication to be done through IPSec, you must open the UDP 4500 and UDP 500 ports.</span></span>


## <a name="summary"></a><span data-ttu-id="9b58e-244">總結</span><span class="sxs-lookup"><span data-stu-id="9b58e-244">Summary</span></span>

<span data-ttu-id="9b58e-245">除了提供.NET 應用程式程式碼偵錯支援，Visual Studio 也會提供各種不同的 SQL Server 2005 的偵錯選項。</span><span class="sxs-lookup"><span data-stu-id="9b58e-245">In addition to providing debugging support for .NET application code, Visual Studio also provides a variety of debugging options for SQL Server 2005.</span></span> <span data-ttu-id="9b58e-246">本教學課程中我們探討兩種： 直接資料庫偵錯和應用程式偵錯。</span><span class="sxs-lookup"><span data-stu-id="9b58e-246">In this tutorial we looked at two of those options: Direct Database Debugging and application debugging.</span></span> <span data-ttu-id="9b58e-247">直接偵錯的 T-SQL 和資料庫物件，找出透過 伺服器總管 中的物件，然後在其上以滑鼠右鍵按一下並選擇 逐步執行。</span><span class="sxs-lookup"><span data-stu-id="9b58e-247">To directly debug a T-SQL database object, locate the object through the Server Explorer then right-click on it and choose Step Into.</span></span> <span data-ttu-id="9b58e-248">這樣會啟動偵錯工具，並在資料庫物件，此時，您可以逐步執行的物件 s 陳述式與檢視和修改參數值的第一個陳述式時，中止。</span><span class="sxs-lookup"><span data-stu-id="9b58e-248">This starts the debugger and halts on the first statement in the database object, at which point you can step through the object s statements and view and modify parameter values.</span></span> <span data-ttu-id="9b58e-249">在步驟 1 中使用這種方法來逐步執行`Products_SelectByCategoryID`預存程序。</span><span class="sxs-lookup"><span data-stu-id="9b58e-249">In Step 1 we used this approach to step into the `Products_SelectByCategoryID` stored procedure.</span></span>

<span data-ttu-id="9b58e-250">應用程式偵錯允許直接在資料庫物件內設定中斷點。</span><span class="sxs-lookup"><span data-stu-id="9b58e-250">Application debugging allows breakpoints to be set directly within the database objects.</span></span> <span data-ttu-id="9b58e-251">從用戶端應用程式 （例如 ASP.NET web 應用程式） 叫用中斷點的資料庫物件時，程式會中止時偵錯工具會接管。</span><span class="sxs-lookup"><span data-stu-id="9b58e-251">When a database object with breakpoints is invoked from a client application (such as an ASP.NET web application), the program halts as the debugger takes over.</span></span> <span data-ttu-id="9b58e-252">應用程式偵錯是很有用，因為它會更清楚地顯示應用程式的動作會導致叫用特定資料庫物件。</span><span class="sxs-lookup"><span data-stu-id="9b58e-252">Application debugging is useful because it more clearly shows what application action causes a particular database object to be invoked.</span></span> <span data-ttu-id="9b58e-253">不過，它需要更多的組態與比直接資料庫偵錯的設定。</span><span class="sxs-lookup"><span data-stu-id="9b58e-253">However, it requires a bit more configuration and setup than Direct Database Debugging.</span></span>

<span data-ttu-id="9b58e-254">也可透過 SQL Server 專案偵錯資料庫物件。</span><span class="sxs-lookup"><span data-stu-id="9b58e-254">Database objects can also be debugged through SQL Server Projects.</span></span> <span data-ttu-id="9b58e-255">我們將探討使用 SQL Server 專案，以及如何使用它們來建立及偵錯 managed 資料庫物件中下一個教學課程。</span><span class="sxs-lookup"><span data-stu-id="9b58e-255">We will look at using SQL Server Projects and how to use them to create and debug managed database objects in the next tutorial.</span></span>

<span data-ttu-id="9b58e-256">祝您程式設計 ！</span><span class="sxs-lookup"><span data-stu-id="9b58e-256">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="9b58e-257">關於作者</span><span class="sxs-lookup"><span data-stu-id="9b58e-257">About the Author</span></span>

<span data-ttu-id="9b58e-258">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，作者的七個 ASP/ASP.NET 書籍和的創辦[4GuysFromRolla.com](http://www.4guysfromrolla.com)，已從 1998 年使用 Microsoft Web 技術。</span><span class="sxs-lookup"><span data-stu-id="9b58e-258">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="9b58e-259">Scott 可做為獨立顧問、 訓練和寫入器。</span><span class="sxs-lookup"><span data-stu-id="9b58e-259">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="9b58e-260">他最新的活頁簿[ *Sam 教導您自己 ASP.NET 2.0 24 小時內*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="9b58e-260">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="9b58e-261">他可以在達到[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)或透過他的部落格，這可以在找到[ http://ScottOnWriting.NET ](http://ScottOnWriting.NET)。</span><span class="sxs-lookup"><span data-stu-id="9b58e-261">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="9b58e-262">[上一頁](protecting-connection-strings-and-other-configuration-information-vb.md)
> [下一頁](creating-stored-procedures-and-user-defined-functions-with-managed-code-vb.md)</span><span class="sxs-lookup"><span data-stu-id="9b58e-262">[Previous](protecting-connection-strings-and-other-configuration-information-vb.md)
[Next](creating-stored-procedures-and-user-defined-functions-with-managed-code-vb.md)</span></span>
