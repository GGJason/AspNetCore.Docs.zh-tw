---
uid: web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/inserting-updating-and-deleting-data-with-the-sqldatasource-vb
title: 插入、 更新和刪除資料與 SqlDataSource (VB) |Microsoft 文件
author: rick-anderson
description: 在先前的教學課程中我們學到如何 ObjectDataSource 控制項允許的插入、 更新和刪除的資料。 SqlDataSource 控制項支援 t...
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/20/2007
ms.topic: article
ms.assetid: 9673bef3-892c-45ba-a7d8-0da3d6f48ec5
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/accessing-the-database-directly-from-an-aspnet-page/inserting-updating-and-deleting-data-with-the-sqldatasource-vb
msc.type: authoredcontent
ms.openlocfilehash: 92d195c3e1e349cd82e0625cf9a6c5a82644b5db
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/06/2018
ms.locfileid: "30877940"
---
<a name="inserting-updating-and-deleting-data-with-the-sqldatasource-vb"></a><span data-ttu-id="0c39a-104">插入、 更新和刪除資料與 SqlDataSource (VB)</span><span class="sxs-lookup"><span data-stu-id="0c39a-104">Inserting, Updating, and Deleting Data with the SqlDataSource (VB)</span></span>
====================
<span data-ttu-id="0c39a-105">由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="0c39a-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="0c39a-106">[下載範例應用程式](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_49_VB.exe)或[下載 PDF](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/datatutorial49vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="0c39a-106">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_49_VB.exe) or [Download PDF](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/datatutorial49vb1.pdf)</span></span>

> <span data-ttu-id="0c39a-107">在先前的教學課程中我們學到如何 ObjectDataSource 控制項允許的插入、 更新和刪除的資料。</span><span class="sxs-lookup"><span data-stu-id="0c39a-107">In previous tutorials we learned how the ObjectDataSource control allowed for inserting, updating, and deleting of data.</span></span> <span data-ttu-id="0c39a-108">SqlDataSource 控制項支援相同的作業，方法是不同，但本教學課程示範如何設定 SqlDataSource 插入、 更新和刪除資料。</span><span class="sxs-lookup"><span data-stu-id="0c39a-108">The SqlDataSource control supports the same operations, but the approach is different, and this tutorial shows how to configure the SqlDataSource to insert, update, and delete data.</span></span>


## <a name="introduction"></a><span data-ttu-id="0c39a-109">簡介</span><span class="sxs-lookup"><span data-stu-id="0c39a-109">Introduction</span></span>

<span data-ttu-id="0c39a-110">中所述[概觀的插入、 更新和刪除](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md)GridView 控制項提供內建的更新和刪除功能的 DetailsView 和 FormView 控制項包含插入時支援連同編輯和刪除功能。</span><span class="sxs-lookup"><span data-stu-id="0c39a-110">As discussed in [An Overview of Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md), the GridView control provides built-in updating and deleting capabilities, while the DetailsView and FormView controls include inserting support along with editing and deleting functionality.</span></span> <span data-ttu-id="0c39a-111">這些資料修改功能直接插入資料來源控制項，而不需要撰寫程式碼行。</span><span class="sxs-lookup"><span data-stu-id="0c39a-111">These data modification capabilities can be plugged directly into a data source control without a line of code needing to be written.</span></span> <span data-ttu-id="0c39a-112">[概觀的插入、 更新和刪除](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md)檢查使用 ObjectDataSource 以利於進行插入、 更新和刪除使用 GridView、 DetailsView 和在 FormView 的控制項。</span><span class="sxs-lookup"><span data-stu-id="0c39a-112">[An Overview of Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) examined using the ObjectDataSource to facilitate inserting, updating, and deleting with the GridView, DetailsView, and FormView controls.</span></span> <span data-ttu-id="0c39a-113">或者，您可以使用 SqlDataSource ObjectDataSource 取代。</span><span class="sxs-lookup"><span data-stu-id="0c39a-113">Alternatively, the SqlDataSource can be used in place of the ObjectDataSource.</span></span>

<span data-ttu-id="0c39a-114">請記得，以支援插入、 更新和刪除與 ObjectDataSource 我們需要指定物件層方法，來叫用執行插入、 更新或刪除動作。</span><span class="sxs-lookup"><span data-stu-id="0c39a-114">Recall that to support inserting, updating, and deleting, with the ObjectDataSource we needed to specify the object layer methods to invoke to perform the insert, update, or delete action.</span></span> <span data-ttu-id="0c39a-115">使用 SqlDataSource，我們需要提供`INSERT`， `UPDATE`，和`DELETE`SQL 陳述式 （或預存程序） 執行。</span><span class="sxs-lookup"><span data-stu-id="0c39a-115">With the SqlDataSource, we need to provide `INSERT`, `UPDATE`, and `DELETE` SQL statements (or stored procedures) to execute.</span></span> <span data-ttu-id="0c39a-116">我們會看到此教學課程中，可以手動建立這些陳述式，或可以自動產生 SqlDataSource s 設定資料來源精靈。</span><span class="sxs-lookup"><span data-stu-id="0c39a-116">As we'll see in this tutorial, these statements can be created manually or can be automatically generated by the SqlDataSource s Configure Data Source wizard.</span></span>

> [!NOTE]
> <span data-ttu-id="0c39a-117">因為我們已討論過插入、 編輯和刪除功能的 GridView 中 DetailsView，並控制 FormView，本教學課程著重於設定成支援這些作業的 SqlDataSource 控制項。</span><span class="sxs-lookup"><span data-stu-id="0c39a-117">Since we ve already discussed the inserting, editing, and deleting capabilities of the GridView, DetailsView, and FormView controls, this tutorial will focus on configuring the SqlDataSource control to support these operations.</span></span> <span data-ttu-id="0c39a-118">如果您需要複習實作 GridView、 DetailsView 和 FormView，回復成編輯、 插入和刪除資料的教學課程中的這些功能，從[概觀的插入、 更新和刪除](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md)。</span><span class="sxs-lookup"><span data-stu-id="0c39a-118">If you need to brush up on implementing these features within the GridView, DetailsView, and FormView, return to the Editing, Inserting, and Deleting Data tutorials, starting with [An Overview of Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md).</span></span>


## <a name="step-1-specifyinginsertupdate-anddeletestatements"></a><span data-ttu-id="0c39a-119">步驟 1： 指定`INSERT`，`UPDATE`，和`DELETE`陳述式</span><span class="sxs-lookup"><span data-stu-id="0c39a-119">Step 1: Specifying`INSERT`,`UPDATE`, and`DELETE`Statements</span></span>

<span data-ttu-id="0c39a-120">當我們從 SqlDataSource 控制項，我們需要擷取資料所示過去兩個教學課程，我們設定兩個屬性：</span><span class="sxs-lookup"><span data-stu-id="0c39a-120">As we ve seen in the past two tutorials, to retrieve data from a SqlDataSource control we need to set two properties:</span></span>

1. <span data-ttu-id="0c39a-121">`ConnectionString`指定哪些資料庫要傳送的查詢和</span><span class="sxs-lookup"><span data-stu-id="0c39a-121">`ConnectionString`, which specifies what database to send the query to, and</span></span>
2. <span data-ttu-id="0c39a-122">`SelectCommand`指定的特定 SQL 陳述式或預存程序傳回結果時所執行的名稱。</span><span class="sxs-lookup"><span data-stu-id="0c39a-122">`SelectCommand`, which specifies the ad-hoc SQL statement or stored procedure name to execute to return the results.</span></span>

<span data-ttu-id="0c39a-123">如`SelectCommand`具有參數的值、 參數值會指定透過 SqlDataSource 的`SelectParameters`集合並且可包含硬式編碼值，一般參數的來源值 (querystring 欄位、 工作階段變數 Web 控制項的值，並等等），或以程式設計的方式指派。</span><span class="sxs-lookup"><span data-stu-id="0c39a-123">For `SelectCommand` values with parameters, the parameter values are specified via the SqlDataSource s `SelectParameters` collection and can include hard-coded values, common parameter source values (querystring fields, session variables, Web control values, and so on), or can be programmatically assigned.</span></span> <span data-ttu-id="0c39a-124">當 SqlDataSource 控制項 s`Select()`叫用方法以程式設計方式或自動資料 Web 控制項中的資料。 在建立資料庫的連接、 參數值指派給查詢和命令會關閉傳送至資料庫。</span><span class="sxs-lookup"><span data-stu-id="0c39a-124">When the SqlDataSource control s `Select()` method is invoked either programmatically or automatically from a data Web control a connection to the database is established, the parameter values are assigned to the query, and the command is shuttled off to the database.</span></span> <span data-ttu-id="0c39a-125">然後傳回結果為資料集或 DataReader，控制項 s 的值而定`DataSourceMode`屬性。</span><span class="sxs-lookup"><span data-stu-id="0c39a-125">The results are then returned as either a DataSet or DataReader, depending on the value of the control s `DataSourceMode` property.</span></span>

<span data-ttu-id="0c39a-126">選取的資料，以及 SqlDataSource 控制項可用來插入、 更新和刪除資料，藉由提供`INSERT`， `UPDATE`，和`DELETE`SQL 陳述式中相同的方式。</span><span class="sxs-lookup"><span data-stu-id="0c39a-126">Along with selecting data, the SqlDataSource control can be used to insert, update, and delete data by supplying `INSERT`, `UPDATE`, and `DELETE` SQL statements in much the same way.</span></span> <span data-ttu-id="0c39a-127">只需指派`InsertCommand`， `UpdateCommand`，和`DeleteCommand`屬性`INSERT`， `UPDATE`，和`DELETE`来執行的 SQL 陳述式。</span><span class="sxs-lookup"><span data-stu-id="0c39a-127">Simply assign the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties the `INSERT`, `UPDATE`, and `DELETE` SQL statements to execute.</span></span> <span data-ttu-id="0c39a-128">如果陳述式具有參數 （如他們最一定會），將其併入`InsertParameters`， `UpdateParameters`，和`DeleteParameters`集合。</span><span class="sxs-lookup"><span data-stu-id="0c39a-128">If the statements have parameters (as they most always will), include them in the `InsertParameters`, `UpdateParameters`, and `DeleteParameters` collections.</span></span>

<span data-ttu-id="0c39a-129">一次`InsertCommand`， `UpdateCommand`，或`DeleteCommand`已經指定的值，對應資料 Web 控制項 s 智慧標籤中的啟用插入、 啟用編輯，或啟用刪除選項將會變成可用。</span><span class="sxs-lookup"><span data-stu-id="0c39a-129">Once an `InsertCommand`, `UpdateCommand`, or `DeleteCommand` value has been specified, the Enable Inserting, Enable Editing, or Enable Deleting option in the corresponding data Web control s smart tag will become available.</span></span> <span data-ttu-id="0c39a-130">為了說明這點，讓 s 舉例從`Querying.aspx`頁面中建立[查詢資料與 SqlDataSource 控制項](querying-data-with-the-sqldatasource-control-vb.md)教學課程和它包含刪除功能強化。</span><span class="sxs-lookup"><span data-stu-id="0c39a-130">To illustrate this, let s take an example from the `Querying.aspx` page we created in the [Querying Data with the SqlDataSource Control](querying-data-with-the-sqldatasource-control-vb.md) tutorial and augment it to include delete capabilities.</span></span>

<span data-ttu-id="0c39a-131">先開啟`InsertUpdateDelete.aspx`和`Querying.aspx`頁面`SqlDataSource`資料夾。</span><span class="sxs-lookup"><span data-stu-id="0c39a-131">Start by opening the `InsertUpdateDelete.aspx` and `Querying.aspx` pages from the `SqlDataSource` folder.</span></span> <span data-ttu-id="0c39a-132">從設計工具上`Querying.aspx`頁面上，選取第一個範例的 SqlDataSource 和 GridView (`ProductsDataSource`和`GridView1`控制項)。</span><span class="sxs-lookup"><span data-stu-id="0c39a-132">From the Designer on the `Querying.aspx` page, select the SqlDataSource and GridView from the first example (the `ProductsDataSource` and `GridView1` controls).</span></span> <span data-ttu-id="0c39a-133">選取後兩個控制項，移至 [編輯] 功能表並選擇 [複製] （或只按 Ctrl + C）。</span><span class="sxs-lookup"><span data-stu-id="0c39a-133">After selecting the two controls, go to the Edit menu and choose Copy (or just hit Ctrl+C).</span></span> <span data-ttu-id="0c39a-134">接下來，請移至活動設計工具的`InsertUpdateDelete.aspx`並貼上的控制項中。</span><span class="sxs-lookup"><span data-stu-id="0c39a-134">Next, go to the Designer of `InsertUpdateDelete.aspx` and paste in the controls.</span></span> <span data-ttu-id="0c39a-135">您已在兩個控制項轉換成之後`InsertUpdateDelete.aspx`，測試出瀏覽器中。</span><span class="sxs-lookup"><span data-stu-id="0c39a-135">After you have moved the two controls over to `InsertUpdateDelete.aspx`, test out the page in a browser.</span></span> <span data-ttu-id="0c39a-136">您應該會看到的值`ProductID`， `ProductName`，和`UnitPrice`中記錄的所有資料行`Products`資料庫資料表。</span><span class="sxs-lookup"><span data-stu-id="0c39a-136">You should see the values of the `ProductID`, `ProductName`, and `UnitPrice` columns for all of the records in the `Products` database table.</span></span>


<span data-ttu-id="0c39a-137">[![所有的產品未列出，請依產品識別碼](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image1.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="0c39a-137">[![All of the Products are Listed, Ordered by ProductID](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image1.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image1.png)</span></span>

<span data-ttu-id="0c39a-138">**圖 1**： 所有產品未列出，請依`ProductID`([按一下以檢視完整大小的影像](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="0c39a-138">**Figure 1**: All of the Products are Listed, Ordered by `ProductID` ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image2.png))</span></span>


## <a name="adding-the-sqldatasource-sdeletecommandanddeleteparametersproperties"></a><span data-ttu-id="0c39a-139">新增 SqlDataSource s`DeleteCommand`和`DeleteParameters`屬性</span><span class="sxs-lookup"><span data-stu-id="0c39a-139">Adding the SqlDataSource s`DeleteCommand`and`DeleteParameters`Properties</span></span>

<span data-ttu-id="0c39a-140">現在我們有只會傳回所有記錄的 SqlDataSource`Products`資料表並將此資料呈現的 GridView。</span><span class="sxs-lookup"><span data-stu-id="0c39a-140">At this point we have a SqlDataSource that simply returns all of the records from the `Products` table and a GridView that renders this data.</span></span> <span data-ttu-id="0c39a-141">我們的目標是要延伸此範例，以允許使用者刪除產品，透過 GridView。</span><span class="sxs-lookup"><span data-stu-id="0c39a-141">Our goal is to extend this example to allow for the user to delete products via the GridView.</span></span> <span data-ttu-id="0c39a-142">若要完成此我們需要指定值的 SqlDataSource 控制項 s`DeleteCommand`和`DeleteParameters`屬性，然後設定支援刪除 GridView。</span><span class="sxs-lookup"><span data-stu-id="0c39a-142">To accomplish this we need to specify values for the SqlDataSource control s `DeleteCommand` and `DeleteParameters` properties and then configure the GridView to support deleting.</span></span>

<span data-ttu-id="0c39a-143">`DeleteCommand`和`DeleteParameters`數種方式可以指定的屬性：</span><span class="sxs-lookup"><span data-stu-id="0c39a-143">The `DeleteCommand` and `DeleteParameters` properties can be specified in a number of ways:</span></span>

- <span data-ttu-id="0c39a-144">透過宣告式語法</span><span class="sxs-lookup"><span data-stu-id="0c39a-144">Through the declarative syntax</span></span>
- <span data-ttu-id="0c39a-145">從設計工具中的 [屬性] 視窗</span><span class="sxs-lookup"><span data-stu-id="0c39a-145">From the Properties window in the Designer</span></span>
- <span data-ttu-id="0c39a-146">從指定自訂的 SQL 陳述式或預存程序在設定資料來源精靈畫面</span><span class="sxs-lookup"><span data-stu-id="0c39a-146">From the Specify a custom SQL statement or stored procedure screen in the Configure Data Source wizard</span></span>
- <span data-ttu-id="0c39a-147">透過指定資料行的資料表中的 [檢視] 畫面中設定資料來源精靈中 [進階] 按鈕，它會實際自動產生`DELETE`中使用的 SQL 陳述式和參數集合`DeleteCommand`和`DeleteParameters`屬性</span><span class="sxs-lookup"><span data-stu-id="0c39a-147">Via the Advanced button in the Specify columns from a table of view screen in the Configure Data Source wizard, which will actually automatically generate the `DELETE` SQL statement and parameter collection used in the `DeleteCommand` and `DeleteParameters` properties</span></span>

<span data-ttu-id="0c39a-148">我們將檢驗如何以自動`DELETE`步驟 2 中建立的陳述式。</span><span class="sxs-lookup"><span data-stu-id="0c39a-148">We'll examine how to automatically have the `DELETE` statement created in Step 2.</span></span> <span data-ttu-id="0c39a-149">現在，讓 s 使用設計工具中，在 [屬性] 視窗，雖然 「 設定資料來源精靈 」 或 「 宣告式語法選項一樣運作。</span><span class="sxs-lookup"><span data-stu-id="0c39a-149">For now, let s use the Properties window in the Designer, although the Configure Data Source wizard or declarative syntax option would work just as well.</span></span>

<span data-ttu-id="0c39a-150">從設計工具中`InsertUpdateDelete.aspx`，按一下`ProductsDataSource`SqlDataSource 然後開啟 [屬性] 視窗 （從 [檢視] 功能表中，選擇 [屬性] 視窗中，或只要點按 F4）。</span><span class="sxs-lookup"><span data-stu-id="0c39a-150">From the Designer in `InsertUpdateDelete.aspx`, click on the `ProductsDataSource` SqlDataSource and then bring up the Properties window (from the View menu, choose Properties window, or simply hit F4).</span></span> <span data-ttu-id="0c39a-151">選取 DeleteQuery 屬性，將會出現一組的省略符號。</span><span class="sxs-lookup"><span data-stu-id="0c39a-151">Select the DeleteQuery property, which will bring up a set of ellipses.</span></span>


![從 [屬性] 視窗中選取 DeleteQuery 屬性](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image2.gif)

<span data-ttu-id="0c39a-153">**圖 2**： 從 [屬性] 視窗中選取 DeleteQuery 屬性</span><span class="sxs-lookup"><span data-stu-id="0c39a-153">**Figure 2**: Select the DeleteQuery Property from the Properties Window</span></span>


> [!NOTE]
> <span data-ttu-id="0c39a-154">SqlDataSource 規定 t 具有 DeleteQuery 屬性。</span><span class="sxs-lookup"><span data-stu-id="0c39a-154">The SqlDataSource doesn t have a DeleteQuery property.</span></span> <span data-ttu-id="0c39a-155">相反地，DeleteQuery 是組合`DeleteCommand`和`DeleteParameters`屬性和時才會列出在 [屬性] 視窗中檢視透過設計工具視窗。</span><span class="sxs-lookup"><span data-stu-id="0c39a-155">Rather, DeleteQuery is a combination of the `DeleteCommand` and `DeleteParameters` properties and is only listed in the Properties window when viewing the window through the Designer.</span></span> <span data-ttu-id="0c39a-156">如果您正在查看來源檢視中的 [屬性] 視窗，您會看到`DeleteCommand`屬性改為。</span><span class="sxs-lookup"><span data-stu-id="0c39a-156">If you are looking at the Properties window in the Source view, you'll find the `DeleteCommand` property instead.</span></span>


<span data-ttu-id="0c39a-157">按一下省略符號，以顯示命令及參數編輯器對話方塊 DeleteQuery 屬性方塊 （請參閱圖 3）。</span><span class="sxs-lookup"><span data-stu-id="0c39a-157">Click the ellipses in the DeleteQuery property to bring up the Command and Parameter Editor dialog box (see Figure 3).</span></span> <span data-ttu-id="0c39a-158">您可以從這個對話方塊中指定`DELETE`SQL 陳述式指定的參數。</span><span class="sxs-lookup"><span data-stu-id="0c39a-158">From this dialog box you can specify the `DELETE` SQL statement and specify the parameters.</span></span> <span data-ttu-id="0c39a-159">輸入下列查詢`DELETE`命令文字方塊中 (請以手動方式或使用查詢產生器中，如果您想要的話):</span><span class="sxs-lookup"><span data-stu-id="0c39a-159">Enter the following query into the `DELETE` command textbox (either manually or using the Query Builder, if you prefer):</span></span>

[!code-sql[Main](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/samples/sample1.sql)]

<span data-ttu-id="0c39a-160">接下來，按一下 [重新整理參數] 按鈕以加入`@ProductID`參數至以下參數的清單。</span><span class="sxs-lookup"><span data-stu-id="0c39a-160">Next, click the Refresh Parameters button to add the `@ProductID` parameter to the list of parameters below.</span></span>


<span data-ttu-id="0c39a-161">[![從 [屬性] 視窗中選取 DeleteQuery 屬性](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image3.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="0c39a-161">[![Select the DeleteQuery Property from the Properties Window](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image3.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image3.png)</span></span>

<span data-ttu-id="0c39a-162">**圖 3**： 從 [屬性] 視窗中選取 DeleteQuery 屬性 ([按一下以檢視完整大小的影像](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="0c39a-162">**Figure 3**: Select the DeleteQuery Property from the Properties Window ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image4.png))</span></span>


<span data-ttu-id="0c39a-163">請勿*不*提供這個參數 （將保留在 [無] 來源其參數） 的值。</span><span class="sxs-lookup"><span data-stu-id="0c39a-163">Do *not* provide a value for this parameter (leave its Parameter source at None ).</span></span> <span data-ttu-id="0c39a-164">一旦我們將刪除的支援至 GridView，GridView 會自動提供這個參數值，使用的值及其`DataKeys`其 [刪除] 按鈕已按下的資料列的集合。</span><span class="sxs-lookup"><span data-stu-id="0c39a-164">Once we add deleting support to the GridView, the GridView will automatically supply this parameter value, using the value of its `DataKeys` collection for the row whose Delete button was clicked.</span></span>

> [!NOTE]
> <span data-ttu-id="0c39a-165">中使用的參數名稱`DELETE`查詢*必須*的名稱與相同`DataKeyNames`GridView、 DetailsView 或在 FormView 中的值。</span><span class="sxs-lookup"><span data-stu-id="0c39a-165">The parameter name used in the `DELETE` query *must* be the same as the name of the `DataKeyNames` value in the GridView, DetailsView, or FormView.</span></span> <span data-ttu-id="0c39a-166">也就是中的參數`DELETE`陳述式故意名為`@ProductID`(而不是，例如， `@ID`)，因為 Products 資料表 （以及在 GridView 的 DataKeyNames 值） 中的主索引鍵資料行名稱是`ProductID`。</span><span class="sxs-lookup"><span data-stu-id="0c39a-166">That is, the parameter in the `DELETE` statement is purposefully named `@ProductID` (instead of, say, `@ID`), because the primary key column name in the Products table (and therefore the DataKeyNames value in the GridView) is `ProductID`.</span></span>


<span data-ttu-id="0c39a-167">如果參數名稱和`DataKeyNames`值並不相符，GridView 無法自動將參數值從`DataKeys`集合。</span><span class="sxs-lookup"><span data-stu-id="0c39a-167">If the parameter name and `DataKeyNames` value doesn t match, the GridView cannot automatically assign the parameter the value from the `DataKeys` collection.</span></span>

<span data-ttu-id="0c39a-168">在命令及參數編輯器對話方塊中輸入的刪除相關的資訊之後按一下 [確定]，並移至來源檢視，以檢查產生的宣告式標記：</span><span class="sxs-lookup"><span data-stu-id="0c39a-168">After entering the delete-related information into the Command and Parameter Editor dialog box click OK and go to the Source view to examine the resulting declarative markup:</span></span>

[!code-aspx[Main](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/samples/sample2.aspx)]

<span data-ttu-id="0c39a-169">請注意新增`DeleteCommand`屬性以及`<DeleteParameters>`區段和名為的參數物件`productID`。</span><span class="sxs-lookup"><span data-stu-id="0c39a-169">Note the addition of the `DeleteCommand` property as well as the `<DeleteParameters>` section and the Parameter object named `productID`.</span></span>

## <a name="configuring-the-gridview-for-deleting"></a><span data-ttu-id="0c39a-170">設定 刪除的 GridView</span><span class="sxs-lookup"><span data-stu-id="0c39a-170">Configuring the GridView for Deleting</span></span>

<span data-ttu-id="0c39a-171">與`DeleteCommand`加入屬性，GridView s 智慧標籤現在會包含啟用刪除的選項。</span><span class="sxs-lookup"><span data-stu-id="0c39a-171">With the `DeleteCommand` property added, the GridView s smart tag now contains the Enable Deleting option.</span></span> <span data-ttu-id="0c39a-172">請繼續並選取此核取方塊。</span><span class="sxs-lookup"><span data-stu-id="0c39a-172">Go ahead and check this checkbox.</span></span> <span data-ttu-id="0c39a-173">中所述[概觀的插入、 更新和刪除](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md)，這會導致將與 CommandField GridView 其`ShowDeleteButton`屬性設定為`True`。</span><span class="sxs-lookup"><span data-stu-id="0c39a-173">As discussed in [An Overview of Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md), this causes the GridView to add a CommandField with its `ShowDeleteButton` property set to `True`.</span></span> <span data-ttu-id="0c39a-174">如圖 4 所示，當透過瀏覽器瀏覽頁面時包含 [刪除] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="0c39a-174">As Figure 4 shows, when the page is visited through a browser a Delete button is included.</span></span> <span data-ttu-id="0c39a-175">刪除某些產品中，測試出此頁面。</span><span class="sxs-lookup"><span data-stu-id="0c39a-175">Test this page out by deleting some products.</span></span>


<span data-ttu-id="0c39a-176">[![每個 GridView 資料列現在包含刪除按鈕](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image4.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="0c39a-176">[![Each GridView Row Now Includes a Delete Button](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image4.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image5.png)</span></span>

<span data-ttu-id="0c39a-177">**圖 4**： 現在包含每個 GridView 資料列的 [刪除] 按鈕 ([按一下以檢視完整大小的影像](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="0c39a-177">**Figure 4**: Each GridView Row Now Includes a Delete Button ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image6.png))</span></span>


<span data-ttu-id="0c39a-178">按一下 [刪除] 按鈕後, 回傳，就會發生 GridView 指派`ProductID`參數值的`DataKeys`集合值的資料列的 [刪除] 按鈕已按下，並叫用 SqlDataSource 的`Delete()`方法。</span><span class="sxs-lookup"><span data-stu-id="0c39a-178">Upon clicking a Delete button, a postback occurs, the GridView assigns the `ProductID` parameter the value of the `DataKeys` collection value for the row whose Delete button was clicked, and invokes the SqlDataSource s `Delete()` method.</span></span> <span data-ttu-id="0c39a-179">SqlDataSource 控制項連接至資料庫，然後執行`DELETE`陳述式。</span><span class="sxs-lookup"><span data-stu-id="0c39a-179">The SqlDataSource control then connects to the database and executes the `DELETE` statement.</span></span> <span data-ttu-id="0c39a-180">在 GridView 然後重新繫結至 SqlDataSource 取回並顯示目前的產品集 （其中不包含只刪除記錄）。</span><span class="sxs-lookup"><span data-stu-id="0c39a-180">The GridView then rebinds to the SqlDataSource, getting back and displaying the current set of products (which no longer includes the just-deleted record).</span></span>

> [!NOTE]
> <span data-ttu-id="0c39a-181">因為 GridView 會使用其`DataKeys`集合來填入 SqlDataSource 參數，它 s 重要的 GridView s`DataKeyNames`屬性設定為的資料行組成的主索引鍵，SqlDataSource 的`SelectCommand`傳回這些資料行。</span><span class="sxs-lookup"><span data-stu-id="0c39a-181">Since the GridView uses its `DataKeys` collection to populate the SqlDataSource parameters, it s vital that the GridView s `DataKeyNames` property be set to the column(s) that constitute the primary key and that the SqlDataSource s `SelectCommand` returns these columns.</span></span> <span data-ttu-id="0c39a-182">此外，它很重要的參數名稱在 SqlDataSource s s`DeleteCommand`設`@ProductID`。</span><span class="sxs-lookup"><span data-stu-id="0c39a-182">Moreover, it s important that the parameter name in the SqlDataSource s `DeleteCommand` is set to `@ProductID`.</span></span> <span data-ttu-id="0c39a-183">如果`DataKeyNames`屬性未設定或參數的名稱不是`@ProductsID`，按一下 [刪除] 按鈕將會導致回傳，但是獲利的 t 實際上會刪除任何記錄。</span><span class="sxs-lookup"><span data-stu-id="0c39a-183">If the `DataKeyNames` property is not set or the parameter is not named `@ProductsID`, clicking the Delete button will cause a postback, but won t actually delete any record.</span></span>


<span data-ttu-id="0c39a-184">圖 5 以圖形方式描繪此互動。</span><span class="sxs-lookup"><span data-stu-id="0c39a-184">Figure 5 depicts this interaction graphically.</span></span> <span data-ttu-id="0c39a-185">回頭參考[檢查插入、 更新和刪除與事件相關聯](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb.md)教學課程的插入、 更新和刪除資料的 Web 控制項相關聯的事件鏈結的更詳細討論。</span><span class="sxs-lookup"><span data-stu-id="0c39a-185">Refer back to the [Examining the Events Associated with Inserting, Updating, and Deleting](../editing-inserting-and-deleting-data/examining-the-events-associated-with-inserting-updating-and-deleting-vb.md) tutorial for a more detailed discussion on the chain of events associated with inserting, updating, and deleting from a data Web control.</span></span>


![按一下 [刪除] 按鈕，在 GridView 中的叫用 SqlDataSource s delete （） 方法](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image5.gif)

<span data-ttu-id="0c39a-187">**圖 5**： 按一下 [刪除] 按鈕，在 GridView 中的叫用 SqlDataSource 的`Delete()`方法</span><span class="sxs-lookup"><span data-stu-id="0c39a-187">**Figure 5**: Clicking the Delete Button in the GridView Invokes the SqlDataSource s `Delete()` Method</span></span>


## <a name="step-2-automatically-generating-theinsertupdate-anddeletestatements"></a><span data-ttu-id="0c39a-188">步驟 2： 自動產生`INSERT`，`UPDATE`，和`DELETE`陳述式</span><span class="sxs-lookup"><span data-stu-id="0c39a-188">Step 2: Automatically Generating the`INSERT`,`UPDATE`, and`DELETE`Statements</span></span>

<span data-ttu-id="0c39a-189">步驟 1 檢查，為`INSERT`， `UPDATE`，和`DELETE`可以透過 [屬性] 視窗或控制項 s 宣告式語法指定 SQL 陳述式。</span><span class="sxs-lookup"><span data-stu-id="0c39a-189">As Step 1 examined, `INSERT`, `UPDATE`, and `DELETE` SQL statements can be specified through the Properties window or the control s declarative syntax.</span></span> <span data-ttu-id="0c39a-190">不過，這個方法會要求，我們以手動方式寫出的 SQL 陳述式以手動方式，它可以是 monotonous 而且容易產生錯誤。</span><span class="sxs-lookup"><span data-stu-id="0c39a-190">However, this approach requires that we manually write out the SQL statements by hand, which can be monotonous and error-prone.</span></span> <span data-ttu-id="0c39a-191">幸運的是，設定資料來源精靈會提供此選項可讓`INSERT`， `UPDATE`，和`DELETE`時使用的資料表中的 [檢視] 畫面上的指定資料行自動產生的陳述式。</span><span class="sxs-lookup"><span data-stu-id="0c39a-191">Fortunately, the Configure Data Source wizard provides an option to have the `INSERT`, `UPDATE`, and `DELETE` statements automatically generated when using the Specify columns from a table of view screen.</span></span>

<span data-ttu-id="0c39a-192">可讓 s 瀏覽這個自動產生選項。</span><span class="sxs-lookup"><span data-stu-id="0c39a-192">Let s explore this automatic generation option.</span></span> <span data-ttu-id="0c39a-193">在 DetailsView 加入設計師中`InsertUpdateDelete.aspx`並設定其`ID`屬性`ManageProducts`。</span><span class="sxs-lookup"><span data-stu-id="0c39a-193">Add a DetailsView to the Designer in `InsertUpdateDelete.aspx` and set its `ID` property to `ManageProducts`.</span></span> <span data-ttu-id="0c39a-194">接下來，從 DetailsView s 智慧標籤，選擇 建立新的資料來源並建立名為 SqlDataSource `ManageProductsDataSource`。</span><span class="sxs-lookup"><span data-stu-id="0c39a-194">Next, from the DetailsView s smart tag, choose to create a new data source and create a SqlDataSource named `ManageProductsDataSource`.</span></span>


<span data-ttu-id="0c39a-195">[![建立名為 ManageProductsDataSource 新 SqlDataSource](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image6.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="0c39a-195">[![Create a New SqlDataSource Named ManageProductsDataSource](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image6.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image7.png)</span></span>

<span data-ttu-id="0c39a-196">**圖 6**： 建立新的 SqlDataSource 具名`ManageProductsDataSource`([按一下以檢視完整大小的影像](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="0c39a-196">**Figure 6**: Create a New SqlDataSource Named `ManageProductsDataSource` ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image8.png))</span></span>


<span data-ttu-id="0c39a-197">在設定資料來源精靈中，選擇使用`NORTHWINDConnectionString`連接字串，然後按一下 [下一步]。</span><span class="sxs-lookup"><span data-stu-id="0c39a-197">From the Configure Data Source wizard, opt to use the `NORTHWINDConnectionString` connection string and click Next.</span></span> <span data-ttu-id="0c39a-198">從 設定 Select 陳述式畫面中，將指定的資料行從選取資料表或檢視表選項按鈕，並挑選`Products`下拉式清單中的資料表。</span><span class="sxs-lookup"><span data-stu-id="0c39a-198">From the Configure the Select Statement screen, leave the Specify columns from a table or view radio button selected and pick the `Products` table from the drop-down list.</span></span> <span data-ttu-id="0c39a-199">選取`ProductID`， `ProductName`， `UnitPrice`，和`Discontinued`核取方塊清單中的資料行。</span><span class="sxs-lookup"><span data-stu-id="0c39a-199">Select the `ProductID`, `ProductName`, `UnitPrice`, and `Discontinued` columns from the checkbox list.</span></span>


<span data-ttu-id="0c39a-200">[![使用 [產品] 資料表，傳回 ProductID、 ProductName、 UnitPrice 和已停止的資料行](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image7.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="0c39a-200">[![Using the Products Table, Return the ProductID, ProductName, UnitPrice, and Discontinued Columns](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image7.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image9.png)</span></span>

<span data-ttu-id="0c39a-201">**圖 7**： 使用`Products`資料表中，傳回`ProductID`， `ProductName`， `UnitPrice`，和`Discontinued`資料行 ([按一下以檢視完整大小的影像](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="0c39a-201">**Figure 7**: Using the `Products` Table, Return the `ProductID`, `ProductName`, `UnitPrice`, and `Discontinued` Columns ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image10.png))</span></span>


<span data-ttu-id="0c39a-202">若要自動產生`INSERT`， `UPDATE`，和`DELETE`陳述式，根據選取的資料表和資料行，按一下 [進階] 按鈕，並檢查產生`INSERT`， `UPDATE`，和`DELETE`陳述式的核取方塊。</span><span class="sxs-lookup"><span data-stu-id="0c39a-202">To automatically generate `INSERT`, `UPDATE`, and `DELETE` statements based on the selected table and columns, click the Advanced button and check the Generate `INSERT`, `UPDATE`, and `DELETE` statements checkbox.</span></span>


![檢查產生 INSERT、 UPDATE 和 DELETE 陳述式核取方塊](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image8.gif)

<span data-ttu-id="0c39a-204">**圖 8**： 請檢查 產生`INSERT`， `UPDATE`，和`DELETE`陳述式核取方塊</span><span class="sxs-lookup"><span data-stu-id="0c39a-204">**Figure 8**: Check the Generate `INSERT`, `UPDATE`, and `DELETE` statements Checkbox</span></span>


<span data-ttu-id="0c39a-205">產生`INSERT`， `UPDATE`，和`DELETE`只能可以核取陳述式的核取方塊，如果選取的資料表有主索引鍵，且主索引鍵資料行 （或） 資料行未包含在傳回的資料行清單中。</span><span class="sxs-lookup"><span data-stu-id="0c39a-205">The Generate `INSERT`, `UPDATE`, and `DELETE` statements checkbox will only be checkable if the table selected has a primary key and the primary key column (or columns) are included in the list of returned columns.</span></span> <span data-ttu-id="0c39a-206">使用開放式並行存取核取方塊，它會變成可選取一次 產生`INSERT`， `UPDATE`，和`DELETE`陳述式的核取方塊已核取，將會增加`WHERE`子句在產生`UPDATE`和`DELETE`陳述式，以提供開放式並行存取控制。</span><span class="sxs-lookup"><span data-stu-id="0c39a-206">The Use optimistic concurrency checkbox, which becomes selectable once the Generate `INSERT`, `UPDATE`, and `DELETE` statements checkbox has been checked, will augment the `WHERE` clauses in the resulting `UPDATE` and `DELETE` statements to provide optimistic concurrency control.</span></span> <span data-ttu-id="0c39a-207">現在，請保留此核取方塊未選取;在下一個教學課程中，我們將檢驗與 SqlDataSource 控制項的開放式並行存取。</span><span class="sxs-lookup"><span data-stu-id="0c39a-207">For now, leave this checkbox unchecked; we'll examine optimistic concurrency with the SqlDataSource control in the next tutorial.</span></span>

<span data-ttu-id="0c39a-208">檢查 產生後`INSERT`， `UPDATE`，和`DELETE`陳述式的核取方塊，按一下 確定 以回到 設定 Select 陳述式 畫面中，然後按一下 下一步，，然後在完成，以完成設定資料來源精靈。</span><span class="sxs-lookup"><span data-stu-id="0c39a-208">After checking the Generate `INSERT`, `UPDATE`, and `DELETE` statements checkbox, click OK to return to the Configure Select Statement screen, then click Next, and then Finish, to complete the Configure Data Source wizard.</span></span> <span data-ttu-id="0c39a-209">正在完成精靈，在 Visual Studio 將會加入 BoundFields 的 DetailsView `ProductID`， `ProductName`，和`UnitPrice`資料行與針對 CheckBoxField`Discontinued`資料行。</span><span class="sxs-lookup"><span data-stu-id="0c39a-209">Upon completing the wizard, Visual Studio will add BoundFields to the DetailsView for the `ProductID`, `ProductName`, and `UnitPrice` columns and a CheckBoxField for the `Discontinued` column.</span></span> <span data-ttu-id="0c39a-210">從 DetailsView s 智慧標籤，檢查啟用分頁 選項，以便使用者瀏覽此頁面可以逐步執行的產品。</span><span class="sxs-lookup"><span data-stu-id="0c39a-210">From the DetailsView s smart tag, check the Enable Paging option so that the user visiting this page can step through the products.</span></span> <span data-ttu-id="0c39a-211">在 DetailsView s 也清除`Width`和`Height`屬性。</span><span class="sxs-lookup"><span data-stu-id="0c39a-211">Also clear out the DetailsView s `Width` and `Height` properties.</span></span>

<span data-ttu-id="0c39a-212">請注意智慧標籤已啟用插入、 啟用編輯和刪除啟用可用的選項。</span><span class="sxs-lookup"><span data-stu-id="0c39a-212">Notice that the smart tag has the Enable Inserting, Enable Editing, and Enable Deleting options available.</span></span> <span data-ttu-id="0c39a-213">這是因為 SqlDataSource 包含的值及其`InsertCommand`， `UpdateCommand`，和`DeleteCommand`，如下列宣告式語法所示：</span><span class="sxs-lookup"><span data-stu-id="0c39a-213">This is because the SqlDataSource contains values for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand`, as the following declarative syntax shows:</span></span>

[!code-aspx[Main](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/samples/sample3.aspx)]

<span data-ttu-id="0c39a-214">請注意如何 SqlDataSource 控制項已自動設定的值及其`InsertCommand`， `UpdateCommand`，和`DeleteCommand`屬性。</span><span class="sxs-lookup"><span data-stu-id="0c39a-214">Note how the SqlDataSource control has had values automatically set for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span> <span data-ttu-id="0c39a-215">中所參考的資料行集中`InsertCommand`和`UpdateCommand`屬性根據那些在`SELECT`陳述式。</span><span class="sxs-lookup"><span data-stu-id="0c39a-215">The set of columns referenced in the `InsertCommand` and `UpdateCommand` properties are based on those in the `SELECT` statement.</span></span> <span data-ttu-id="0c39a-216">也就是說，而不是讓*每個*產品中的資料行`InsertCommand`和`UpdateCommand`，有中指定這些資料行`SelectCommand`(較少`ProductID`，這省略，因為它 s [`IDENTITY`資料行](http://www.sqlteam.com/item.asp?ItemID=102)編輯時，就無法變更其值，這會自動指派插入時)。</span><span class="sxs-lookup"><span data-stu-id="0c39a-216">That is, rather than having *every* Products column in the `InsertCommand` and `UpdateCommand`, there are only those columns specified in the `SelectCommand` (less `ProductID`, which is omitted because it s an [`IDENTITY` column](http://www.sqlteam.com/item.asp?ItemID=102), whose value cannot be changed when edited and which is automatically assigned when inserting).</span></span> <span data-ttu-id="0c39a-217">此外，每個參數中`InsertCommand`， `UpdateCommand`，和`DeleteCommand`屬性中的對應參數`InsertParameters`， `UpdateParameters`，和`DeleteParameters`集合。</span><span class="sxs-lookup"><span data-stu-id="0c39a-217">Moreover, for each parameter in the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties there are corresponding parameters in the `InsertParameters`, `UpdateParameters`, and `DeleteParameters` collections.</span></span>

<span data-ttu-id="0c39a-218">若要開啟 DetailsView 的資料修改功能，請檢查啟用插入、 啟用編輯和啟用刪除其智慧標籤選項。</span><span class="sxs-lookup"><span data-stu-id="0c39a-218">To turn on the DetailsView s data modification features, check the Enable Inserting, Enable Editing, and Enable Deleting options in its smart tag.</span></span> <span data-ttu-id="0c39a-219">這會將與 CommandField 其`ShowInsertButton`， `ShowEditButton`，和`ShowDeleteButton`屬性設定為`True`。</span><span class="sxs-lookup"><span data-stu-id="0c39a-219">This adds a CommandField with its `ShowInsertButton`, `ShowEditButton`, and `ShowDeleteButton` properties set to `True`.</span></span>

<span data-ttu-id="0c39a-220">請在瀏覽器中的瀏覽並記下編輯、 刪除和 DetailsView 中包含的新按鈕。</span><span class="sxs-lookup"><span data-stu-id="0c39a-220">Visit the page in a browser and note the Edit, Delete, and New buttons included in the DetailsView.</span></span> <span data-ttu-id="0c39a-221">按一下 [編輯] 按鈕變成編輯模式，它會顯示每個 BoundField DetailsView 其`ReadOnly`屬性設定為`False`（預設值） 做為文字方塊中，並將 CheckBoxField 為核取方塊。</span><span class="sxs-lookup"><span data-stu-id="0c39a-221">Clicking the Edit button turns the DetailsView into edit mode, which displays each BoundField whose `ReadOnly` property is set to `False` (the default) as a TextBox, and the CheckBoxField as a checkbox.</span></span>


<span data-ttu-id="0c39a-222">[![在 DetailsView s 預設編輯介面](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image9.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="0c39a-222">[![The DetailsView s Default Editing Interface](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image9.gif)](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image11.png)</span></span>

<span data-ttu-id="0c39a-223">**圖 9**: DetailsView s 預設編輯介面 ([按一下以檢視完整大小的影像](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="0c39a-223">**Figure 9**: The DetailsView s Default Editing Interface ([Click to view full-size image](inserting-updating-and-deleting-data-with-the-sqldatasource-vb/_static/image12.png))</span></span>


<span data-ttu-id="0c39a-224">同樣地，您可以刪除目前選取的產品，或將新的產品加入系統。</span><span class="sxs-lookup"><span data-stu-id="0c39a-224">Similarly, you can delete the currently selected product or add a new product to the system.</span></span> <span data-ttu-id="0c39a-225">因為`InsertCommand`陳述式只能搭配`ProductName`， `UnitPrice`，和`Discontinued`資料行，其他資料行具有其中一個`NULL`或其指派於 insert 資料庫的預設值。</span><span class="sxs-lookup"><span data-stu-id="0c39a-225">Since the `InsertCommand` statement only works with the `ProductName`, `UnitPrice`, and `Discontinued` columns, the other columns have either `NULL` or their default value assigned by the database upon insert.</span></span> <span data-ttu-id="0c39a-226">就像使用 ObjectDataSource，如果`InsertCommand`遺漏資料行不允許任何資料庫資料表`NULL`s 和不要有預設值，就會發生 SQL 錯誤時嘗試執行`INSERT`陳述式。</span><span class="sxs-lookup"><span data-stu-id="0c39a-226">Just like with the ObjectDataSource, if the `InsertCommand` is missing any database table columns that don t allow `NULL` s and don t have a default value, a SQL error will occur when attempting to execute the `INSERT` statement.</span></span>

> [!NOTE]
> <span data-ttu-id="0c39a-227">在 DetailsView s 插入和編輯介面缺少任何類型的自訂或驗證。</span><span class="sxs-lookup"><span data-stu-id="0c39a-227">The DetailsView s inserting and editing interfaces lack any sort of customization or validation.</span></span> <span data-ttu-id="0c39a-228">若要加入驗證控制項或自訂介面，您需要將 BoundFields 轉換成 TemplateFields。</span><span class="sxs-lookup"><span data-stu-id="0c39a-228">To add validation controls or to customize the interfaces, you need to convert the BoundFields to TemplateFields.</span></span> <span data-ttu-id="0c39a-229">請參閱[新增驗證控制項的編輯和插入介面](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md)和[自訂的資料修改介面](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md)教學課程，如需詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="0c39a-229">Refer to the [Adding Validation Controls to the Editing and Inserting Interfaces](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md) and [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorials for more information.</span></span>


<span data-ttu-id="0c39a-230">此外，請記住，用於更新和刪除，DetailsView 會使用目前的產品 s`DataKey`值時才存在`DataKeyNames`屬性設定。</span><span class="sxs-lookup"><span data-stu-id="0c39a-230">Also, keep in mind that for updating and deleting, the DetailsView uses the current product s `DataKey` value, which is only present if the `DataKeyNames` property is configured.</span></span> <span data-ttu-id="0c39a-231">如果編輯或刪除似乎沒有作用，請確認`DataKeyNames`屬性設定。</span><span class="sxs-lookup"><span data-stu-id="0c39a-231">If editing or deleting appears to have no effect, ensure that the `DataKeyNames` property is set.</span></span>

## <a name="limitations-of-automatically-generating-sql-statements"></a><span data-ttu-id="0c39a-232">自動產生 SQL 陳述式的限制</span><span class="sxs-lookup"><span data-stu-id="0c39a-232">Limitations of Automatically Generating SQL Statements</span></span>

<span data-ttu-id="0c39a-233">產生自`INSERT`， `UPDATE`，和`DELETE`挑選資料行從資料表中，針對較複雜查詢，您就必須自行撰寫時，才可用陳述式選項`INSERT`， `UPDATE`，和`DELETE`像我們在步驟 1 中的陳述式。</span><span class="sxs-lookup"><span data-stu-id="0c39a-233">Since the Generate `INSERT`, `UPDATE`, and `DELETE` statements option is only available when picking columns from a table, for more complex queries you will have to write your own `INSERT`, `UPDATE`, and `DELETE` statements like we did in Step 1.</span></span> <span data-ttu-id="0c39a-234">常見的是，SQL`SELECT`陳述式使用`JOIN`s 以回復的一或多個查閱資料表中的資料顯示用途 (例如將回`Categories`資料表的`CategoryName`欄位顯示產品資訊時)。</span><span class="sxs-lookup"><span data-stu-id="0c39a-234">Commonly, SQL `SELECT` statements use `JOIN` s to bring back data from one or more lookup tables for display purposes (such as bringing back the `Categories` table s `CategoryName` field when displaying product information).</span></span> <span data-ttu-id="0c39a-235">同時，我們可能會想要允許使用者編輯、 更新或插入資料至核心資料表 (`Products`，在此情況下)。</span><span class="sxs-lookup"><span data-stu-id="0c39a-235">At the same time, we might want to allow the user to edit, update, or insert data into the core table (`Products`, in this case).</span></span>

<span data-ttu-id="0c39a-236">雖然`INSERT`， `UPDATE`，和`DELETE`陳述式可以手動輸入，請考慮下列節省時間的秘訣。</span><span class="sxs-lookup"><span data-stu-id="0c39a-236">While the `INSERT`, `UPDATE`, and `DELETE` statements can be entered manually, consider the following time-saving tip.</span></span> <span data-ttu-id="0c39a-237">使它回到只會從提取資料一開始安裝 SqlDataSource`Products`資料表。</span><span class="sxs-lookup"><span data-stu-id="0c39a-237">Initially setup the SqlDataSource so that it pulls back data just from the `Products` table.</span></span> <span data-ttu-id="0c39a-238">使用設定資料來源精靈的指定的資料行從資料表或檢視螢幕，以便您可以自動產生`INSERT`， `UPDATE`，和`DELETE`陳述式。</span><span class="sxs-lookup"><span data-stu-id="0c39a-238">Use the Configure Data Source wizard s Specify columns from a table or view screen so that you can automatically generate the `INSERT`, `UPDATE`, and `DELETE` statements.</span></span> <span data-ttu-id="0c39a-239">完成精靈之後，然後選擇 設定從 屬性 視窗 SelectQuery （或者，或者，請回到設定資料來源精靈，但使用 指定自訂的 SQL 陳述式或預存程序選項）。</span><span class="sxs-lookup"><span data-stu-id="0c39a-239">Then, after completing the wizard, choose to configure the SelectQuery from the Properties window (or, alternatively, go back to the Configure Data Source wizard, but use the Specify a custom SQL statement or stored procedure option).</span></span> <span data-ttu-id="0c39a-240">然後更新`SELECT`陳述式包含`JOIN`語法。</span><span class="sxs-lookup"><span data-stu-id="0c39a-240">Then update the `SELECT` statement to include the `JOIN` syntax.</span></span> <span data-ttu-id="0c39a-241">這項技術的節省時間的優點，自動產生的 SQL 陳述式，而且允許更多自訂`SELECT`陳述式。</span><span class="sxs-lookup"><span data-stu-id="0c39a-241">This technique offers the time-saving benefits of the automatically generated SQL statements and allows for a more customized `SELECT` statement.</span></span>

<span data-ttu-id="0c39a-242">自動產生的另一項限制`INSERT`， `UPDATE`，和`DELETE`陳述式是中的資料行`INSERT`和`UPDATE`陳述式會根據所傳回的資料行`SELECT`陳述式。</span><span class="sxs-lookup"><span data-stu-id="0c39a-242">Another limitation of automatically generating the `INSERT`, `UPDATE`, and `DELETE` statements is that the columns in the `INSERT` and `UPDATE` statements are based on the columns returned by the `SELECT` statement.</span></span> <span data-ttu-id="0c39a-243">我們可能需要更新或插入更多或較少的欄位，不過。</span><span class="sxs-lookup"><span data-stu-id="0c39a-243">We may need to update or insert more or fewer fields, however.</span></span> <span data-ttu-id="0c39a-244">比方說，在範例中步驟 2 中，可能要有`UnitPrice`BoundField 處於唯讀模式。</span><span class="sxs-lookup"><span data-stu-id="0c39a-244">For example, in the example from Step 2, maybe we want to have the `UnitPrice` BoundField be read-only.</span></span> <span data-ttu-id="0c39a-245">在此情況下，它應該不 t 會出現在`UpdateCommand`。</span><span class="sxs-lookup"><span data-stu-id="0c39a-245">In that case, it shouldn t appear in the `UpdateCommand`.</span></span> <span data-ttu-id="0c39a-246">或者我們可能會想要在 GridView 中設定不會出現資料表欄位的值。</span><span class="sxs-lookup"><span data-stu-id="0c39a-246">Or we may want to set the value of a table field that does not appear in the GridView.</span></span> <span data-ttu-id="0c39a-247">例如，當加入新資料錄我們可能會想`QuantityPerUnit`值設定為 TODO。</span><span class="sxs-lookup"><span data-stu-id="0c39a-247">For example, when adding a new record we may want the `QuantityPerUnit` value set to TODO .</span></span>

<span data-ttu-id="0c39a-248">如果需要這類自訂項目，您需要以手動方式，讓它們，透過 [屬性] 視窗中，指定自訂的 SQL 陳述式或預存程序選項，在精靈中，或透過宣告式語法。</span><span class="sxs-lookup"><span data-stu-id="0c39a-248">If such customizations are required, you need to make them manually, either through the Properties window, the Specify a custom SQL statement or stored procedure option in the wizard, or via the declarative syntax.</span></span>

> [!NOTE]
> <span data-ttu-id="0c39a-249">當沒有資料中的對應欄位將參數加入 Web 控制項時，請記住，需要以某種方式的值指派給這些參數值。</span><span class="sxs-lookup"><span data-stu-id="0c39a-249">When adding parameters that do not have corresponding fields in the data Web control, keep in mind that these parameters values will need to be assigned values in some manner.</span></span> <span data-ttu-id="0c39a-250">這些值可以是： 硬式編碼中直接`InsertCommand`或`UpdateCommand`; 可來自於 querystring 中，工作階段狀態 （Web 控制項在頁面上，依此類推）; 某些預先定義的來源，或可以指派以程式設計的方式，如前述教學課程中我們了解。</span><span class="sxs-lookup"><span data-stu-id="0c39a-250">These values can be: hard-coded directly in the `InsertCommand` or `UpdateCommand`; can come from some pre-defined source (the querystring, session state, Web controls on the page, and so on); or can be assigned programmatically, as we saw in the preceding tutorial.</span></span>


## <a name="summary"></a><span data-ttu-id="0c39a-251">總結</span><span class="sxs-lookup"><span data-stu-id="0c39a-251">Summary</span></span>

<span data-ttu-id="0c39a-252">為了讓資料可以將其插入的內建、 編輯和刪除功能的 Web 控制項，它們會繫結至資料來源控制項必須提供這類功能。</span><span class="sxs-lookup"><span data-stu-id="0c39a-252">In order for the data Web controls to utilize their built-in inserting, editing, and deleting capabilities, the data source control they are bound to must offer such functionality.</span></span> <span data-ttu-id="0c39a-253">這表示，如 SqlDataSource `INSERT`， `UPDATE`，和`DELETE`SQL 陳述式都必須指派給`InsertCommand`， `UpdateCommand`，和`DeleteCommand`屬性。</span><span class="sxs-lookup"><span data-stu-id="0c39a-253">For the SqlDataSource, this means that `INSERT`, `UPDATE`, and `DELETE` SQL statements must be assigned to the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span> <span data-ttu-id="0c39a-254">這些屬性和對應的參數集合，可以手動加入或透過設定資料來源精靈 來自動產生。</span><span class="sxs-lookup"><span data-stu-id="0c39a-254">These properties, and the corresponding parameters collections, can be added manually or generated automatically through the Configure Data Source wizard.</span></span> <span data-ttu-id="0c39a-255">在本教學課程，我們會檢查這兩種技術。</span><span class="sxs-lookup"><span data-stu-id="0c39a-255">In this tutorial we examined both techniques.</span></span>

<span data-ttu-id="0c39a-256">我們會檢查使用開放式並行存取，以在 ObjectDataSource[實作開放式並行存取](../editing-inserting-and-deleting-data/implementing-optimistic-concurrency-vb.md)教學課程。</span><span class="sxs-lookup"><span data-stu-id="0c39a-256">We examined using optimistic concurrency with the ObjectDataSource in the [Implementing Optimistic Concurrency](../editing-inserting-and-deleting-data/implementing-optimistic-concurrency-vb.md) tutorial.</span></span> <span data-ttu-id="0c39a-257">SqlDataSource 控制項也支援開放式並行存取。</span><span class="sxs-lookup"><span data-stu-id="0c39a-257">The SqlDataSource control also provides optimistic concurrency support.</span></span> <span data-ttu-id="0c39a-258">因為自動產生時，在步驟 2 中記下`INSERT`， `UPDATE`，和`DELETE`陳述式，精靈會提供使用開放式並行存取選項。</span><span class="sxs-lookup"><span data-stu-id="0c39a-258">As noted in Step 2, when automatically generating the `INSERT`, `UPDATE`, and `DELETE` statements, the wizard offers a Use optimistic concurrency option.</span></span> <span data-ttu-id="0c39a-259">我們會看到下一個教學課程中，會使用開放式並行存取與 SqlDataSource 修改`WHERE`子句中的`UPDATE`和`DELETE`陳述式，以確保其他資料行的值不變更自上次資料 t頁面上顯示。</span><span class="sxs-lookup"><span data-stu-id="0c39a-259">As we'll see in the next tutorial, using optimistic concurrency with the SqlDataSource modifies the `WHERE` clauses in the `UPDATE` and `DELETE` statements to ensure that the values for the other columns haven t changed since the data was last displayed on the page.</span></span>

<span data-ttu-id="0c39a-260">祝您程式設計 ！</span><span class="sxs-lookup"><span data-stu-id="0c39a-260">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="0c39a-261">關於作者</span><span class="sxs-lookup"><span data-stu-id="0c39a-261">About the Author</span></span>

<span data-ttu-id="0c39a-262">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，作者的七個 ASP/ASP.NET 書籍和的創辦[4GuysFromRolla.com](http://www.4guysfromrolla.com)，已從 1998 年使用 Microsoft Web 技術。</span><span class="sxs-lookup"><span data-stu-id="0c39a-262">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="0c39a-263">Scott 可做為獨立顧問、 訓練和寫入器。</span><span class="sxs-lookup"><span data-stu-id="0c39a-263">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="0c39a-264">他最新的活頁簿[ *Sam 教導您自己 ASP.NET 2.0 24 小時內*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="0c39a-264">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="0c39a-265">他可以在達到[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)或透過他的部落格，這可以在找到[ http://ScottOnWriting.NET ](http://ScottOnWriting.NET)。</span><span class="sxs-lookup"><span data-stu-id="0c39a-265">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="0c39a-266">[上一頁](using-parameterized-queries-with-the-sqldatasource-vb.md)
> [下一頁](implementing-optimistic-concurrency-with-the-sqldatasource-vb.md)</span><span class="sxs-lookup"><span data-stu-id="0c39a-266">[Previous](using-parameterized-queries-with-the-sqldatasource-vb.md)
[Next](implementing-optimistic-concurrency-with-the-sqldatasource-vb.md)</span></span>
