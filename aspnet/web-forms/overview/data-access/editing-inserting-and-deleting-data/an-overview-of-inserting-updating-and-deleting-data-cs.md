---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs
title: 插入、 更新和刪除資料 (C#) 的概觀 |Microsoft 文件
author: rick-anderson
description: 在本教學課程中，我們會看到如何將對應 ObjectDataSource insert、 update （)，和 BLL 方法 delete （） 方法的類別，以及如何使用組態...
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/17/2006
ms.topic: article
ms.assetid: b651dc58-93c7-4f83-a74e-3b99f6d60848
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs
msc.type: authoredcontent
ms.openlocfilehash: dbd111f79eda6006cb9aed59d8fd0b0342415833
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/06/2018
ms.locfileid: "30891226"
---
<a name="an-overview-of-inserting-updating-and-deleting-data-c"></a><span data-ttu-id="40c0a-103">插入、 更新和刪除資料 (C#) 的概觀</span><span class="sxs-lookup"><span data-stu-id="40c0a-103">An Overview of Inserting, Updating, and Deleting Data (C#)</span></span>
====================
<span data-ttu-id="40c0a-104">由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="40c0a-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="40c0a-105">[下載範例應用程式](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_16_CS.exe)或[下載 PDF](an-overview-of-inserting-updating-and-deleting-data-cs/_static/datatutorial16cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="40c0a-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_16_CS.exe) or [Download PDF](an-overview-of-inserting-updating-and-deleting-data-cs/_static/datatutorial16cs1.pdf)</span></span>

> <span data-ttu-id="40c0a-106">在此教學課程中我們會看到如何將對應 ObjectDataSource insert、 update （)，和 BLL 方法 delete （） 方法的類別，以及如何設定以提供資料修改功能的 GridView、 DetailsView 和 FormView 控制項。</span><span class="sxs-lookup"><span data-stu-id="40c0a-106">In this tutorial we'll see how to map an ObjectDataSource's Insert(), Update(), and Delete() methods to the methods of BLL classes, as well as how to configure the GridView, DetailsView, and FormView controls to provide data modification capabilities.</span></span>


## <a name="introduction"></a><span data-ttu-id="40c0a-107">簡介</span><span class="sxs-lookup"><span data-stu-id="40c0a-107">Introduction</span></span>

<span data-ttu-id="40c0a-108">在過去幾個教學課程中，我們已經檢查過如何使用 GridView、 DetailsView 和 FormView 控制項之 ASP.NET 網頁中顯示資料。</span><span class="sxs-lookup"><span data-stu-id="40c0a-108">Over the past several tutorials we've examined how to display data in an ASP.NET page using the GridView, DetailsView, and FormView controls.</span></span> <span data-ttu-id="40c0a-109">這些控制項只會使用提供給它們的資料。</span><span class="sxs-lookup"><span data-stu-id="40c0a-109">These controls simply work with data supplied to them.</span></span> <span data-ttu-id="40c0a-110">通常，這些控制項存取透過資料來源控制項，例如 ObjectDataSource 使用的資料。</span><span class="sxs-lookup"><span data-stu-id="40c0a-110">Commonly, these controls access data through the use of a data source control, such as the ObjectDataSource.</span></span> <span data-ttu-id="40c0a-111">我們已看到如何 ObjectDataSource 做為 ASP.NET 網頁與基礎資料之間的 proxy。</span><span class="sxs-lookup"><span data-stu-id="40c0a-111">We've seen how the ObjectDataSource acts as a proxy between the ASP.NET page and the underlying data.</span></span> <span data-ttu-id="40c0a-112">GridView 需要時顯示的資料，它會叫用其 ObjectDataSource`Select()`方法，它會接著叫用的方法從我們商務邏輯層 (BLL)，會呼叫的方法中適當資料存取圖層 (DAL) 的 TableAdapter，繼而再傳送`SELECT` Northwind 資料庫的查詢。</span><span class="sxs-lookup"><span data-stu-id="40c0a-112">When a GridView needs to display data, it invokes its ObjectDataSource's `Select()` method, which in turn invokes a method from our Business Logic Layer (BLL), which calls a method in the appropriate Data Access Layer's (DAL) TableAdapter, which in turn sends a `SELECT` query to the Northwind database.</span></span>

<span data-ttu-id="40c0a-113">當我們建立 Tableadapter 中 DAL 中時，請記得，[我們第一個教學課程](../introduction/creating-a-data-access-layer-cs.md)、 Visual Studio 自動加入方法來插入、 更新和刪除的資料從基礎資料庫資料表。</span><span class="sxs-lookup"><span data-stu-id="40c0a-113">Recall that when we created the TableAdapters in the DAL in [our first tutorial](../introduction/creating-a-data-access-layer-cs.md), Visual Studio automatically added methods for inserting, updating, and deleting data from the underlying database table.</span></span> <span data-ttu-id="40c0a-114">此外，在[建立商務邏輯層](../introduction/creating-a-business-logic-layer-cs.md)我們在這些資料修改 DAL 方法設計中向下呼叫 BLL 方法。</span><span class="sxs-lookup"><span data-stu-id="40c0a-114">Moreover, in [Creating a Business Logic Layer](../introduction/creating-a-business-logic-layer-cs.md) we designed methods in the BLL that called down into these data modification DAL methods.</span></span>

<span data-ttu-id="40c0a-115">除了其`Select()`方法，也有 ObjectDataSource `Insert()`， `Update()`，和`Delete()`方法。</span><span class="sxs-lookup"><span data-stu-id="40c0a-115">In addition to its `Select()` method, the ObjectDataSource also has `Insert()`, `Update()`, and `Delete()` methods.</span></span> <span data-ttu-id="40c0a-116">像`Select()`方法，這三個方法可以對應至基礎物件中的方法。</span><span class="sxs-lookup"><span data-stu-id="40c0a-116">Like the `Select()` method, these three methods can be mapped to methods in an underlying object.</span></span> <span data-ttu-id="40c0a-117">當設定為插入、 更新或刪除資料，GridView、 DetailsView 和 FormView 控制項提供使用者介面修改基礎資料。</span><span class="sxs-lookup"><span data-stu-id="40c0a-117">When configured to insert, update, or delete data, the GridView, DetailsView, and FormView controls provide a user interface for modifying the underlying data.</span></span> <span data-ttu-id="40c0a-118">此使用者介面呼叫`Insert()`， `Update()`，和`Delete()`ObjectDataSource，方法就會再叫用基礎物件的關聯 （請參閱圖 1） 的方法。</span><span class="sxs-lookup"><span data-stu-id="40c0a-118">This user interface calls the `Insert()`, `Update()`, and `Delete()` methods of the ObjectDataSource, which then invoke the underlying object's associated methods (see Figure 1).</span></span>


<span data-ttu-id="40c0a-119">[![ObjectDataSource insert、 update （） 和 delete （） 方法做為 Proxy BLL 到](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image2.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="40c0a-119">[![The ObjectDataSource's Insert(), Update(), and Delete() Methods Serve as a Proxy into the BLL](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image2.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image1.png)</span></span>

<span data-ttu-id="40c0a-120">**圖 1**: ObjectDataSource `Insert()`， `Update()`，和`Delete()`方法做為 BLL 到 Proxy ([按一下以檢視完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="40c0a-120">**Figure 1**: The ObjectDataSource's `Insert()`, `Update()`, and `Delete()` Methods Serve as a Proxy into the BLL ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image3.png))</span></span>


<span data-ttu-id="40c0a-121">在本教學課程中，我們會看到如何將對應 ObjectDataSource `Insert()`， `Update()`，和`Delete()`BLL，以及如何設定來提供資料修改的 GridView、 DetailsView 和 FormView 控制項中類別方法的方法功能。</span><span class="sxs-lookup"><span data-stu-id="40c0a-121">In this tutorial we'll see how to map the ObjectDataSource's `Insert()`, `Update()`, and `Delete()` methods to methods of classes in the BLL, as well as how to configure the GridView, DetailsView, and FormView controls to provide data modification capabilities.</span></span>

## <a name="step-1-creating-the-insert-update-and-delete-tutorials-web-pages"></a><span data-ttu-id="40c0a-122">步驟 1： 建立 Insert、 Update 和 Delete 教學課程 Web 網頁</span><span class="sxs-lookup"><span data-stu-id="40c0a-122">Step 1: Creating the Insert, Update, and Delete Tutorials Web Pages</span></span>

<span data-ttu-id="40c0a-123">我們可以開始探索如何插入、 更新和刪除資料之前，讓我們先花一點時間在我們的網站專案，我們需要本教學課程和下一步的數個項目中建立 ASP.NET 網頁。</span><span class="sxs-lookup"><span data-stu-id="40c0a-123">Before we start exploring how to insert, update, and delete data, let's first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next several ones.</span></span> <span data-ttu-id="40c0a-124">加入新的資料夾，名為啟動`EditInsertDelete`。</span><span class="sxs-lookup"><span data-stu-id="40c0a-124">Start by adding a new folder named `EditInsertDelete`.</span></span> <span data-ttu-id="40c0a-125">接下來，將下列 ASP.NET 網頁新增至該資料夾中，務必要建立關聯的每一頁`Site.master`主版頁面：</span><span class="sxs-lookup"><span data-stu-id="40c0a-125">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `Basics.aspx`
- `DataModificationEvents.aspx`
- `ErrorHandling.aspx`
- `UIValidation.aspx`
- `CustomizedUI.aspx`
- `OptimisticConcurrency.aspx`
- `ConfirmationOnDelete.aspx`
- `UserLevelAccess.aspx`


![加入 ASP.NET 網頁，針對資料修改相關教學課程](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image4.png)

<span data-ttu-id="40c0a-127">**圖 2**： 加入 ASP.NET 網頁，針對資料修改相關教學課程</span><span class="sxs-lookup"><span data-stu-id="40c0a-127">**Figure 2**: Add the ASP.NET Pages for the Data Modification-Related Tutorials</span></span>


<span data-ttu-id="40c0a-128">如同在其他資料夾，`Default.aspx`中`EditInsertDelete`資料夾會列出這些教學課程 > 一節中。</span><span class="sxs-lookup"><span data-stu-id="40c0a-128">Like in the other folders, `Default.aspx` in the `EditInsertDelete` folder will list the tutorials in its section.</span></span> <span data-ttu-id="40c0a-129">請記得，`SectionLevelTutorialListing.ascx`使用者控制項提供這項功能。</span><span class="sxs-lookup"><span data-stu-id="40c0a-129">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="40c0a-130">因此，新增此使用者控制項加入`Default.aspx`拖曳到頁面的 [設計] 檢視 [方案總管] 中。</span><span class="sxs-lookup"><span data-stu-id="40c0a-130">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page's Design view.</span></span>


<span data-ttu-id="40c0a-131">[![將 SectionLevelTutorialListing.ascx 使用者控制項加入至 Default.aspx](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image6.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="40c0a-131">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image6.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image5.png)</span></span>

<span data-ttu-id="40c0a-132">**圖 3**： 新增`SectionLevelTutorialListing.ascx`使用者控制項加入`Default.aspx`([按一下以檢視完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="40c0a-132">**Figure 3**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image7.png))</span></span>


<span data-ttu-id="40c0a-133">最後，將頁面加入做為項目至`Web.sitemap`檔案。</span><span class="sxs-lookup"><span data-stu-id="40c0a-133">Lastly, add the pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="40c0a-134">具體而言，在自訂格式化之後加入下列標記`<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="40c0a-134">Specifically, add the following markup after the Customized Formatting `<siteMapNode>`:</span></span>


[!code-xml[Main](an-overview-of-inserting-updating-and-deleting-data-cs/samples/sample1.xml)]

<span data-ttu-id="40c0a-135">在更新之後， `Web.sitemap`，花一點時間來檢視此教學課程網站，透過瀏覽器。</span><span class="sxs-lookup"><span data-stu-id="40c0a-135">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="40c0a-136">在左側功能表現在包含編輯、 插入和刪除教學課程的項目。</span><span class="sxs-lookup"><span data-stu-id="40c0a-136">The menu on the left now includes items for the editing, inserting, and deleting tutorials.</span></span>


![編輯、 插入和刪除教學課程的站台地圖現在包含的項目](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image8.png)

<span data-ttu-id="40c0a-138">**圖 4**： 網站導覽現在包含項目編輯、 插入和刪除教學課程</span><span class="sxs-lookup"><span data-stu-id="40c0a-138">**Figure 4**: The Site Map Now Includes Entries for the Editing, Inserting, and Deleting Tutorials</span></span>


## <a name="step-2-adding-and-configuring-the-objectdatasource-control"></a><span data-ttu-id="40c0a-139">步驟 2： 加入和設定 ObjectDataSource 控制項</span><span class="sxs-lookup"><span data-stu-id="40c0a-139">Step 2: Adding and Configuring the ObjectDataSource Control</span></span>

<span data-ttu-id="40c0a-140">之後的 GridView、 DetailsView 和 FormView 每個不同資料修改功能和版面配置中，讓我們來討論每個個別。</span><span class="sxs-lookup"><span data-stu-id="40c0a-140">Since the GridView, DetailsView, and FormView each differ in their data modification capabilities and layout, let's examine each one individually.</span></span> <span data-ttu-id="40c0a-141">而不是有使用它自己 ObjectDataSource 每個控制項，不過，我們已建立所有的三個控制項範例可以共用單一 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="40c0a-141">Rather than have each control using its own ObjectDataSource, however, let's just create a single ObjectDataSource that all three control examples can share.</span></span>

<span data-ttu-id="40c0a-142">開啟`Basics.aspx`頁面上，從 工具箱 拖曳至設計工具中，拖曳 ObjectDataSource，按一下 設定資料來源連結，從其智慧標籤。</span><span class="sxs-lookup"><span data-stu-id="40c0a-142">Open the `Basics.aspx` page, drag an ObjectDataSource from the Toolbox onto the Designer, and click the Configure Data Source link from its smart tag.</span></span> <span data-ttu-id="40c0a-143">因為`ProductsBLL`是編輯、 插入和刪除的方法，設定要使用這個類別 ObjectDataSource 所提供的唯一 BLL 類別。</span><span class="sxs-lookup"><span data-stu-id="40c0a-143">Since the `ProductsBLL` is the only BLL class that provides editing, inserting, and deleting methods, configure the ObjectDataSource to use this class.</span></span>


<span data-ttu-id="40c0a-144">[![設定使用 ProductsBLL 類別 ObjectDataSource](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image10.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="40c0a-144">[![Configure the ObjectDataSource to Use the ProductsBLL Class](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image10.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image9.png)</span></span>

<span data-ttu-id="40c0a-145">**圖 5**： 設定要使用 ObjectDataSource`ProductsBLL`類別 ([按一下以檢視完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="40c0a-145">**Figure 5**: Configure the ObjectDataSource to Use the `ProductsBLL` Class ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image11.png))</span></span>


<span data-ttu-id="40c0a-146">在下一個畫面中，我們可以指定哪些方法的`ProductsBLL`類別會對應到 ObjectDataSource `Select()`， `Insert()`， `Update()`，和`Delete()`選取適當的索引標籤，然後從下拉式清單中選擇的方法。</span><span class="sxs-lookup"><span data-stu-id="40c0a-146">In the next screen we can specify what methods of the `ProductsBLL` class are mapped to the ObjectDataSource's `Select()`, `Insert()`, `Update()`, and `Delete()` by selecting the appropriate tab and choosing the method from the drop-down list.</span></span> <span data-ttu-id="40c0a-147">圖 6，這應該看起來很熟悉到目前為止，對應 ObjectDataSource`Select()`方法`ProductsBLL`類別的`GetProducts()`方法。</span><span class="sxs-lookup"><span data-stu-id="40c0a-147">Figure 6, which should look familiar by now, maps the ObjectDataSource's `Select()` method to the `ProductsBLL` class's `GetProducts()` method.</span></span> <span data-ttu-id="40c0a-148">`Insert()`， `Update()`，和`Delete()`可以設定方法，沿著上方清單中選取適當的索引標籤。</span><span class="sxs-lookup"><span data-stu-id="40c0a-148">The `Insert()`, `Update()`, and `Delete()` methods can be configured by selecting the appropriate tab from the list along the top.</span></span>


<span data-ttu-id="40c0a-149">[![ObjectDataSource 已傳回所有產品](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image13.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="40c0a-149">[![Have the ObjectDataSource Return All of the Products](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image13.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image12.png)</span></span>

<span data-ttu-id="40c0a-150">**圖 6**： 有 ObjectDataSource 傳回所有產品的 ([按一下以檢視完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="40c0a-150">**Figure 6**: Have the ObjectDataSource Return All of the Products ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image14.png))</span></span>


<span data-ttu-id="40c0a-151">圖 7、 8 和 9 ObjectDataSource UPDATE、 INSERT 和 DELETE 的顯示索引標籤。</span><span class="sxs-lookup"><span data-stu-id="40c0a-151">Figures 7, 8, and 9 show the ObjectDataSource's UPDATE, INSERT, and DELETE tabs.</span></span> <span data-ttu-id="40c0a-152">設定這些索引標籤，讓`Insert()`， `Update()`，和`Delete()`方法叫用`ProductsBLL`類別的`UpdateProduct`， `AddProduct`，和`DeleteProduct`方法，分別。</span><span class="sxs-lookup"><span data-stu-id="40c0a-152">Configure these tabs so that the `Insert()`, `Update()`, and `Delete()` methods invoke the `ProductsBLL` class's `UpdateProduct`, `AddProduct`, and `DeleteProduct` methods, respectively.</span></span>


<span data-ttu-id="40c0a-153">[![ObjectDataSource update （） 方法對應至 ProductBLL 類別 UpdateProduct 方法](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image16.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="40c0a-153">[![Map the ObjectDataSource's Update() Method to the ProductBLL Class's UpdateProduct Method](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image16.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image15.png)</span></span>

<span data-ttu-id="40c0a-154">**圖 7**： 對應 ObjectDataSource`Update()`方法`ProductBLL`類別的`UpdateProduct`方法 ([按一下以檢視完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="40c0a-154">**Figure 7**: Map the ObjectDataSource's `Update()` Method to the `ProductBLL` Class's `UpdateProduct` Method ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image17.png))</span></span>


<span data-ttu-id="40c0a-155">[![ObjectDataSource insert （） 方法對應至 ProductBLL 類別 AddProduct 方法](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image19.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="40c0a-155">[![Map the ObjectDataSource's Insert() Method to the ProductBLL Class's AddProduct Method](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image19.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image18.png)</span></span>

<span data-ttu-id="40c0a-156">**圖 8**： 對應 ObjectDataSource`Insert()`方法`ProductBLL`類別的新增`Product`方法 ([按一下以檢視完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="40c0a-156">**Figure 8**: Map the ObjectDataSource's `Insert()` Method to the `ProductBLL` Class's Add `Product` Method ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image20.png))</span></span>


<span data-ttu-id="40c0a-157">[![ObjectDataSource delete （） 方法對應至 ProductBLL 類別 DeleteProduct 方法](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image22.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="40c0a-157">[![Map the ObjectDataSource's Delete() Method to the ProductBLL Class's DeleteProduct Method](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image22.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image21.png)</span></span>

<span data-ttu-id="40c0a-158">**圖 9**： 對應 ObjectDataSource`Delete()`方法`ProductBLL`類別的`DeleteProduct`方法 ([按一下以檢視完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="40c0a-158">**Figure 9**: Map the ObjectDataSource's `Delete()` Method to the `ProductBLL` Class's `DeleteProduct` Method ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image23.png))</span></span>


<span data-ttu-id="40c0a-159">您可能已注意到下拉式清單，在 INSERT、 UPDATE 和 DELETE 的索引標籤中已經有選取這些方法。</span><span class="sxs-lookup"><span data-stu-id="40c0a-159">You may have noticed that the drop-down lists in the UPDATE, INSERT, and DELETE tabs already had these methods selected.</span></span> <span data-ttu-id="40c0a-160">這是由於我們使用`DataObjectMethodAttribute`裝飾的方法`ProducstBLL`。</span><span class="sxs-lookup"><span data-stu-id="40c0a-160">This is thanks to our use of the `DataObjectMethodAttribute` that decorates the methods of `ProducstBLL`.</span></span> <span data-ttu-id="40c0a-161">例如，DeleteProduct 方法具有下列簽章：</span><span class="sxs-lookup"><span data-stu-id="40c0a-161">For example, the DeleteProduct method has the following signature:</span></span>


[!code-csharp[Main](an-overview-of-inserting-updating-and-deleting-data-cs/samples/sample2.cs)]

<span data-ttu-id="40c0a-162">`DataObjectMethodAttribute`屬性會指出每個方法的目的，它是適用於選取、 插入、 更新或刪除及它是否不是預設值。</span><span class="sxs-lookup"><span data-stu-id="40c0a-162">The `DataObjectMethodAttribute` attribute indicates the purpose of each method whether it is for selecting, inserting, updating, or deleting and whether or not it's the default value.</span></span> <span data-ttu-id="40c0a-163">如果建立 BLL 類別時，您可以省略這些屬性，您將需要手動更新中，選取方法插入和刪除索引標籤。</span><span class="sxs-lookup"><span data-stu-id="40c0a-163">If you omitted these attributes when creating your BLL classes, you'll need to manually select the methods from the UPDATE, INSERT, and DELETE tabs.</span></span>

<span data-ttu-id="40c0a-164">在確定適當`ProductsBLL`方法對應到 ObjectDataSource `Insert()`， `Update()`，和`Delete()`方法中，按一下 [完成] 以完成精靈。</span><span class="sxs-lookup"><span data-stu-id="40c0a-164">After ensuring that the appropriate `ProductsBLL` methods are mapped to the ObjectDataSource's `Insert()`, `Update()`, and `Delete()` methods, click Finish to complete the wizard.</span></span>

## <a name="examining-the-objectdatasources-markup"></a><span data-ttu-id="40c0a-165">檢查 ObjectDataSource 標記</span><span class="sxs-lookup"><span data-stu-id="40c0a-165">Examining the ObjectDataSource's Markup</span></span>

<span data-ttu-id="40c0a-166">設定之後透過其精靈 ObjectDataSource，移至來源檢視來檢查產生的宣告式標記。</span><span class="sxs-lookup"><span data-stu-id="40c0a-166">After configuring the ObjectDataSource through its wizard, go to the Source view to examine the generated declarative markup.</span></span> <span data-ttu-id="40c0a-167">`<asp:ObjectDataSource>`標記指定的基礎物件和叫用的方法。</span><span class="sxs-lookup"><span data-stu-id="40c0a-167">The `<asp:ObjectDataSource>` tag specifies the underlying object and the methods to invoke.</span></span> <span data-ttu-id="40c0a-168">此外，還有`DeleteParameters`， `UpdateParameters`，和`InsertParameters`會對應到輸入參數`ProductsBLL`類別的`AddProduct`， `UpdateProduct`，和`DeleteProduct`方法：</span><span class="sxs-lookup"><span data-stu-id="40c0a-168">Additionally, there are `DeleteParameters`, `UpdateParameters`, and `InsertParameters` that map to the input parameters for the `ProductsBLL` class's `AddProduct`, `UpdateProduct`, and `DeleteProduct` methods:</span></span>


[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-cs/samples/sample3.aspx)]

<span data-ttu-id="40c0a-169">ObjectDataSource 包含參數的每個輸入參數為其相關聯的方法，就像一份`SelectParameter`s 時的存在 ObjectDataSource 呼叫選取的方法需要輸入的參數的設定時 (例如`GetProductsByCategoryID(categoryID)`).</span><span class="sxs-lookup"><span data-stu-id="40c0a-169">The ObjectDataSource includes a parameter for each of the input parameters for its associated methods, just like a list of `SelectParameter` s is present when the ObjectDataSource is configured to call a select method that expects an input parameter (such as `GetProductsByCategoryID(categoryID)`).</span></span> <span data-ttu-id="40c0a-170">我們稍後將會看到這些值`DeleteParameters`， `UpdateParameters`，和`InsertParameters`會自動設定的 GridView、 DetailsView 和 FormView 再叫用 ObjectDataSource `Insert()`， `Update()`，或`Delete()`方法。</span><span class="sxs-lookup"><span data-stu-id="40c0a-170">As we'll see shortly, values for these `DeleteParameters`, `UpdateParameters`, and `InsertParameters` are set automatically by the GridView, DetailsView, and FormView prior to invoking the ObjectDataSource's `Insert()`, `Update()`, or `Delete()` method.</span></span> <span data-ttu-id="40c0a-171">這些值也可以設定以程式設計的方式如有需要因為在未來的教學課程中，我們將討論。</span><span class="sxs-lookup"><span data-stu-id="40c0a-171">These values can also be set programmatically as needed, as we'll discuss in a future tutorial.</span></span>

<span data-ttu-id="40c0a-172">它的一個副作用使用精靈來設定 ObjectDataSource 是 Visual Studio 設定[Where 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.oldvaluesparameterformatstring(VS.80).aspx)至`original_{0}`。</span><span class="sxs-lookup"><span data-stu-id="40c0a-172">One side effect of using the wizard to configure to ObjectDataSource is that Visual Studio sets the [OldValuesParameterFormatString property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.oldvaluesparameterformatstring(VS.80).aspx) to `original_{0}`.</span></span> <span data-ttu-id="40c0a-173">這個屬性值用於包含正在編輯之資料的原始值，並在兩個案例中很有用：</span><span class="sxs-lookup"><span data-stu-id="40c0a-173">This property value is used to include the original values of the data being edited and is useful in two scenarios:</span></span>

- <span data-ttu-id="40c0a-174">如果編輯記錄，使用者就可以變更主索引鍵值。</span><span class="sxs-lookup"><span data-stu-id="40c0a-174">If, when editing a record, users are able to change the primary key value.</span></span> <span data-ttu-id="40c0a-175">在此情況下，新的主要金鑰值和原始主索引鍵值必須提供使原始的主索引鍵值的記錄可以找到並據以更新其值。</span><span class="sxs-lookup"><span data-stu-id="40c0a-175">In this case, both the new primary key value and the original primary key value must be provided so that the record with the original primary key value can be found and have its value updated accordingly.</span></span>
- <span data-ttu-id="40c0a-176">當使用開放式並行存取。</span><span class="sxs-lookup"><span data-stu-id="40c0a-176">When using optimistic concurrency.</span></span> <span data-ttu-id="40c0a-177">開放式並行存取是一種技術，確定兩個同時連接的使用者不會覆寫彼此的變更，以及主題未來教學課程。</span><span class="sxs-lookup"><span data-stu-id="40c0a-177">Optimistic concurrency is a technique to ensure that two simultaneous users don't overwrite one another's changes, and is the topic for a future tutorial.</span></span>

<span data-ttu-id="40c0a-178">`OldValuesParameterFormatString`屬性指示基礎物件的更新和刪除的原始值的方法中輸入參數的名稱。</span><span class="sxs-lookup"><span data-stu-id="40c0a-178">The `OldValuesParameterFormatString` property indicates the name of the input parameters in the underlying object's update and delete methods for the original values.</span></span> <span data-ttu-id="40c0a-179">我們將討論這個屬性，而且它的目的更詳細地探討開放式並行存取時。</span><span class="sxs-lookup"><span data-stu-id="40c0a-179">We'll discuss this property and its purpose in greater detail when we explore optimistic concurrency.</span></span> <span data-ttu-id="40c0a-180">我啟動它，不過，因為我們 BLL 方法不會預期的原始值，因此是很重要，我們會移除這個屬性。</span><span class="sxs-lookup"><span data-stu-id="40c0a-180">I bring it up now, however, because our BLL's methods do not expect the original values and therefore it's important that we remove this property.</span></span> <span data-ttu-id="40c0a-181">離開`OldValuesParameterFormatString`屬性設定為預設值以外的任何項目 (`{0}`) 會造成錯誤，當資料 Web 控制項嘗試叫用 ObjectDataSource`Update()`或`Delete()`方法 ObjectDataSource 會因為嘗試在傳入`UpdateParameters`或`DeleteParameters`以及原始值參數所指定。</span><span class="sxs-lookup"><span data-stu-id="40c0a-181">Leaving the `OldValuesParameterFormatString` property set to anything other than the default (`{0}`) will cause an error when a data Web control attempts to invoke the ObjectDataSource's `Update()` or `Delete()` methods because the ObjectDataSource will attempt to pass in both the `UpdateParameters` or `DeleteParameters` specified as well as original value parameters.</span></span>

<span data-ttu-id="40c0a-182">如果這不是那麼清楚在此時，別擔心，我們將檢驗這個屬性，而且其公用程式，在未來的教學課程。</span><span class="sxs-lookup"><span data-stu-id="40c0a-182">If this isn't terribly clear at this juncture, don't worry, we'll examine this property and its utility in a future tutorial.</span></span> <span data-ttu-id="40c0a-183">現在，只是某些宣告式語法中完全移除這個屬性宣告，或將值設定為預設值 （{0}）。</span><span class="sxs-lookup"><span data-stu-id="40c0a-183">For now, just be certain to either remove this property declaration entirely from the declarative syntax or set the value to the default value ({0}).</span></span>

> [!NOTE]
> <span data-ttu-id="40c0a-184">如果您只要清除`OldValuesParameterFormatString`屬性值從 [屬性] 視窗，在設計檢視中，屬性仍會存在於宣告式語法，但被設定為空字串。</span><span class="sxs-lookup"><span data-stu-id="40c0a-184">If you simply clear out the `OldValuesParameterFormatString` property value from the Properties window in the Design view, the property will still exist in the declarative syntax, but be set to an empty string.</span></span> <span data-ttu-id="40c0a-185">這樣一來，不幸的是，仍會相同上面所討論的問題。</span><span class="sxs-lookup"><span data-stu-id="40c0a-185">This, unfortunately, will still result in the same problem discussed above.</span></span> <span data-ttu-id="40c0a-186">因此，移除屬性完全宣告式語法，或從 [屬性] 視窗中，將值設定為預設值， `{0}`。</span><span class="sxs-lookup"><span data-stu-id="40c0a-186">Therefore, either remove the property altogether from the declarative syntax or, from the Properties window, set the value to the default, `{0}`.</span></span>


## <a name="step-3-adding-a-data-web-control-and-configuring-it-for-data-modification"></a><span data-ttu-id="40c0a-187">步驟 3： 加入資料 Web 控制項，並設定用於資料修改</span><span class="sxs-lookup"><span data-stu-id="40c0a-187">Step 3: Adding a Data Web Control and Configuring It for Data Modification</span></span>

<span data-ttu-id="40c0a-188">一旦 ObjectDataSource 已加入至頁面，並設定，我們準備資料的 Web 控制項加入頁面，即可同時顯示的資料，並提供使用者才能修改它的方法。</span><span class="sxs-lookup"><span data-stu-id="40c0a-188">Once the ObjectDataSource has been added to the page and configured, we're ready to add data Web controls to the page to both display the data and provide a means for the end user to modify it.</span></span> <span data-ttu-id="40c0a-189">我們會探討 GridView、 DetailsView 和 FormView 分開，因為其資料修改功能和組態中的 Web 控制項的這些資料不同。</span><span class="sxs-lookup"><span data-stu-id="40c0a-189">We'll look at the GridView, DetailsView, and FormView separately, as these data Web controls differ in their data modification capabilities and configuration.</span></span>

<span data-ttu-id="40c0a-190">我們會看到此篇文章的其餘部分將非常基本的編輯、 插入和刪除的 GridView DetailsView，透過支援以及 FormView 控制是真的越簡單越檢查幾個核取方塊。</span><span class="sxs-lookup"><span data-stu-id="40c0a-190">As we'll see in the remainder of this article, adding very basic editing, inserting, and deleting support through the GridView, DetailsView, and FormView controls is really as simple as checking a couple of checkboxes.</span></span> <span data-ttu-id="40c0a-191">有許多微妙和真實世界中的邊緣案例，請提供更為複雜，只要點，然後按一下比這類功能。</span><span class="sxs-lookup"><span data-stu-id="40c0a-191">There are many subtleties and edge cases in the real-world that make providing such functionality more involved than just point and click.</span></span> <span data-ttu-id="40c0a-192">本教學課程中，不過，完全著重證明最簡單的資料修改功能。</span><span class="sxs-lookup"><span data-stu-id="40c0a-192">This tutorial, however, focuses solely on proving simplistic data modification capabilities.</span></span> <span data-ttu-id="40c0a-193">未來的教學課程會檢查毋庸置疑地，在真實世界設定將會發生的問題。</span><span class="sxs-lookup"><span data-stu-id="40c0a-193">Future tutorials will examine concerns that will undoubtedly arise in a real-world setting.</span></span>

## <a name="deleting-data-from-the-gridview"></a><span data-ttu-id="40c0a-194">在 GridView 中刪除資料</span><span class="sxs-lookup"><span data-stu-id="40c0a-194">Deleting Data from the GridView</span></span>

<span data-ttu-id="40c0a-195">開始從工具箱拖曳至設計工具拖曳 GridView。</span><span class="sxs-lookup"><span data-stu-id="40c0a-195">Start by dragging a GridView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="40c0a-196">接下來，將繫結 ObjectDataSource 至 GridView 從 GridView 的智慧標籤在下拉式清單中選取它。</span><span class="sxs-lookup"><span data-stu-id="40c0a-196">Next, bind the ObjectDataSource to the GridView by selecting it from the drop-down list in the GridView's smart tag.</span></span> <span data-ttu-id="40c0a-197">此時會是 GridView 的宣告式標記：</span><span class="sxs-lookup"><span data-stu-id="40c0a-197">At this point the GridView's declarative markup will be:</span></span>


[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-cs/samples/sample4.aspx)]

<span data-ttu-id="40c0a-198">繫結至其智慧標籤透過 ObjectDataSource 的 GridView 有兩個好處：</span><span class="sxs-lookup"><span data-stu-id="40c0a-198">Binding the GridView to the ObjectDataSource through its smart tag has two benefits:</span></span>

- <span data-ttu-id="40c0a-199">BoundFields 和 CheckBoxFields 會自動建立每個 ObjectDataSource 所傳回的欄位。</span><span class="sxs-lookup"><span data-stu-id="40c0a-199">BoundFields and CheckBoxFields are automatically created for each of the fields returned by the ObjectDataSource.</span></span> <span data-ttu-id="40c0a-200">此外，BoundField 和 CheckBoxField 的屬性會根據設定的基礎欄位中繼資料。</span><span class="sxs-lookup"><span data-stu-id="40c0a-200">Moreover, the BoundField and CheckBoxField's properties are set based on the underlying field's metadata.</span></span> <span data-ttu-id="40c0a-201">例如， `ProductID`， `CategoryName`，和`SupplierName`欄位標示為以唯讀狀態中`ProductsDataTable`，因此不應該是可更新編輯時。</span><span class="sxs-lookup"><span data-stu-id="40c0a-201">For example, the `ProductID`, `CategoryName`, and `SupplierName` fields are marked as read-only in the `ProductsDataTable` and therefore shouldn't be updatable when editing.</span></span> <span data-ttu-id="40c0a-202">若要配合此，這些 BoundFields' [ReadOnly 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.boundfield.readonly(VS.80).aspx)設為`true`。</span><span class="sxs-lookup"><span data-stu-id="40c0a-202">To accommodate this, these BoundFields' [ReadOnly properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.boundfield.readonly(VS.80).aspx) are set to `true`.</span></span>
- <span data-ttu-id="40c0a-203">[DataKeyNames 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.datakeynames(VS.80).aspx)指派給基礎物件的主索引鍵欄位。</span><span class="sxs-lookup"><span data-stu-id="40c0a-203">The [DataKeyNames property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.datakeynames(VS.80).aspx) is assigned to the primary key field(s) of the underlying object.</span></span> <span data-ttu-id="40c0a-204">這是必要時使用 GridView 編輯或刪除資料，因為在進行這個屬性會指出欄位 （或一組欄位），唯一識別每一筆記錄。</span><span class="sxs-lookup"><span data-stu-id="40c0a-204">This is essential when using the GridView for editing or deleting data, as this property indicates the field (or set of fields) that unique identifies each record.</span></span> <span data-ttu-id="40c0a-205">如需有關`DataKeyNames`屬性，會回頭[主要/詳細說明可選取的主要 GridView 使用詳細資料 DetailView](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md)教學課程。</span><span class="sxs-lookup"><span data-stu-id="40c0a-205">For more information on the `DataKeyNames` property, refer back to the [Master/Detail Using a Selectable Master GridView with a Details DetailView](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md) tutorial.</span></span>

<span data-ttu-id="40c0a-206">雖然 GridView 可透過 [屬性] 視窗或宣告式語法 ObjectDataSource 繫結，這樣需要您手動加入適當的 BoundField 和`DataKeyNames`標記。</span><span class="sxs-lookup"><span data-stu-id="40c0a-206">While the GridView can be bound to the ObjectDataSource through the Properties window or declarative syntax, doing so requires you to manually add the appropriate BoundField and `DataKeyNames` markup.</span></span>

<span data-ttu-id="40c0a-207">GridView 控制項提供資料列層級編輯和刪除的內建支援。</span><span class="sxs-lookup"><span data-stu-id="40c0a-207">The GridView control provides built-in support for row-level editing and deleting.</span></span> <span data-ttu-id="40c0a-208">設定支援刪除的 GridView 加入刪除按鈕的資料行。</span><span class="sxs-lookup"><span data-stu-id="40c0a-208">Configuring a GridView to support deleting adds a column of Delete buttons.</span></span> <span data-ttu-id="40c0a-209">當使用者按一下特定的資料列的 [刪除] 按鈕時，回傳展示和 GridView 執行下列步驟：</span><span class="sxs-lookup"><span data-stu-id="40c0a-209">When the end user clicks the Delete button for a particular row, a postback ensues and the GridView performs the following steps:</span></span>

1. <span data-ttu-id="40c0a-210">ObjectDataSource`DeleteParameters`指派值</span><span class="sxs-lookup"><span data-stu-id="40c0a-210">The ObjectDataSource's `DeleteParameters` value(s) are assigned</span></span>
2. <span data-ttu-id="40c0a-211">ObjectDataSource`Delete()`叫用方法時，刪除指定的記錄</span><span class="sxs-lookup"><span data-stu-id="40c0a-211">The ObjectDataSource's `Delete()` method is invoked, deleting the specified record</span></span>
3. <span data-ttu-id="40c0a-212">在 GridView 重新繫結本身 ObjectDataSource 來叫用其`Select()`方法</span><span class="sxs-lookup"><span data-stu-id="40c0a-212">The GridView rebinds itself to the ObjectDataSource by invoking its `Select()` method</span></span>

<span data-ttu-id="40c0a-213">值指派給`DeleteParameters`的值`DataKeyNames`欄位的 [刪除] 按鈕已按下的資料列。</span><span class="sxs-lookup"><span data-stu-id="40c0a-213">The values assigned to the `DeleteParameters` are the values of the `DataKeyNames` field(s) for the row whose Delete button was clicked.</span></span> <span data-ttu-id="40c0a-214">因此就很重要的 GridView`DataKeyNames`屬性正確設定。</span><span class="sxs-lookup"><span data-stu-id="40c0a-214">Therefore it's vital that a GridView's `DataKeyNames` property be correctly set.</span></span> <span data-ttu-id="40c0a-215">如果遺失`DeleteParameters`會指派`null`刪除步驟 2 中的記錄中步驟 1，又不會產生任何的值。</span><span class="sxs-lookup"><span data-stu-id="40c0a-215">If it's missing, the `DeleteParameters` will be assigned a `null` value in Step 1, which in turn will not result in any deleted records in Step 2.</span></span>

> [!NOTE]
> <span data-ttu-id="40c0a-216">`DataKeys`集合會儲存在 GridView 的控制項狀態，表示`DataKeys`值會記住在回傳，即使已停用 GridView 的檢視狀態。</span><span class="sxs-lookup"><span data-stu-id="40c0a-216">The `DataKeys` collection is stored in the GridView s control state, meaning that the `DataKeys` values will be remembered across postback even if the GridView s view state has been disabled.</span></span> <span data-ttu-id="40c0a-217">不過，它是非常重要的檢視狀態的支援編輯或刪除 （預設行為） 的 GridViews 保持啟用。</span><span class="sxs-lookup"><span data-stu-id="40c0a-217">However, it is very important that view state remains enabled for GridViews that support editing or deleting (the default behavior).</span></span> <span data-ttu-id="40c0a-218">如果您將 GridView s`EnableViewState`屬性`false`、 編輯和刪除行為會正常顯示為單一使用者，但如果沒有刪除資料的並行使用者，有這些並行的使用者可能會不小心的可能性刪除或編輯的記錄，確定它們 professionals t 想。</span><span class="sxs-lookup"><span data-stu-id="40c0a-218">If you set the GridView s `EnableViewState` property to `false`, the editing and deleting behavior will work fine for a single user, but if there are concurrent users deleting data, there exists the possibility that these concurrent users may accidentally delete or edit records that they didn t intend.</span></span> <span data-ttu-id="40c0a-219">請參閱我部落格文章：[警告： 已停用並行問題與 ASP.NET 2.0 GridViews/DetailsView/FormViews 該支援編輯和/或刪除與的檢視狀態](http://scottonwriting.net/sowblog/archive/2006/10/03/163215.aspx)，如需詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="40c0a-219">See my blog entry, [WARNING: Concurrency Issue with ASP.NET 2.0 GridViews/DetailsView/FormViews that Support Editing and/or Deleting and Whose View State is Disabled](http://scottonwriting.net/sowblog/archive/2006/10/03/163215.aspx), for more information.</span></span>


<span data-ttu-id="40c0a-220">這個相同警告亦適用於 DetailsViews 和 FormViews。</span><span class="sxs-lookup"><span data-stu-id="40c0a-220">This same warning also applies to DetailsViews and FormViews.</span></span>

<span data-ttu-id="40c0a-221">若要新增的 GridView 刪除功能，只需移至其智慧標籤和選取啟用刪除的核取方塊。</span><span class="sxs-lookup"><span data-stu-id="40c0a-221">To add deleting capabilities to a GridView, simply go to its smart tag and check the Enable Deleting checkbox.</span></span>


![核取 啟用刪除核取方塊](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image24.png)

<span data-ttu-id="40c0a-223">**圖 10**： 核取 啟用刪除核取方塊</span><span class="sxs-lookup"><span data-stu-id="40c0a-223">**Figure 10**: Check the Enable Deleting Checkbox</span></span>


<span data-ttu-id="40c0a-224">檢查啟用刪除 核取方塊的智慧標籤將 CommandField 加入至 GridView。</span><span class="sxs-lookup"><span data-stu-id="40c0a-224">Checking the Enable Deleting checkbox from the smart tag adds a CommandField to the GridView.</span></span> <span data-ttu-id="40c0a-225">CommandField 轉譯按鈕，執行一或多個下列工作的 GridView 中的資料行： 選取資料錄、 編輯記錄，以及刪除記錄。</span><span class="sxs-lookup"><span data-stu-id="40c0a-225">The CommandField renders a column in the GridView with buttons for performing one or more of the following tasks: selecting a record, editing a record, and deleting a record.</span></span> <span data-ttu-id="40c0a-226">我們先前所見以選取資料錄中的動作中 CommandField[主要/詳細說明可選取的主要 GridView 使用詳細資料 DetailView](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md)教學課程。</span><span class="sxs-lookup"><span data-stu-id="40c0a-226">We previously saw the CommandField in action with selecting records in the [Master/Detail Using a Selectable Master GridView with a Details DetailView](../masterdetail/master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md) tutorial.</span></span>

<span data-ttu-id="40c0a-227">CommandField 包含數個`ShowXButton`指出哪些系列的按鈕會顯示在 CommandField 屬性。</span><span class="sxs-lookup"><span data-stu-id="40c0a-227">The CommandField contains a number of `ShowXButton` properties that indicate what series of buttons are displayed in the CommandField.</span></span> <span data-ttu-id="40c0a-228">藉由檢查啟用刪除核取方塊 CommandField 其`ShowDeleteButton`屬性是`true`已新增至 GridView 的資料行集合。</span><span class="sxs-lookup"><span data-stu-id="40c0a-228">By checking the Enable Deleting checkbox a CommandField whose `ShowDeleteButton` property is `true` has been added to the GridView's Columns collection.</span></span>


[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-cs/samples/sample5.aspx)]

<span data-ttu-id="40c0a-229">此時，信不，我們已順利完成刪除支援新增至 GridView ！</span><span class="sxs-lookup"><span data-stu-id="40c0a-229">At this point, believe it or not, we're done with adding deleting support to the GridView!</span></span> <span data-ttu-id="40c0a-230">圖 11 顯示，因為瀏覽透過瀏覽器的刪除按鈕資料行的這個頁面出現時。</span><span class="sxs-lookup"><span data-stu-id="40c0a-230">As Figure 11 shows, when visiting this page through a browser a column of Delete buttons is present.</span></span>


<span data-ttu-id="40c0a-231">[![CommandField 加入資料行的刪除按鈕](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image26.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="40c0a-231">[![The CommandField Adds a Column of Delete Buttons](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image26.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image25.png)</span></span>

<span data-ttu-id="40c0a-232">**圖 11**: CommandField 加入資料行的刪除按鈕 ([按一下以檢視完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="40c0a-232">**Figure 11**: The CommandField Adds a Column of Delete Buttons ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image27.png))</span></span>


<span data-ttu-id="40c0a-233">如果您建立本教學課程從無到有自己，在測試此頁面，按一下 [刪除] 按鈕就會引發例外狀況。</span><span class="sxs-lookup"><span data-stu-id="40c0a-233">If you've been building this tutorial from the ground up on your own, when testing this page clicking the Delete button will raise an exception.</span></span> <span data-ttu-id="40c0a-234">請繼續閱讀，若要了解這些例外狀況發生原因和如何加以修正。</span><span class="sxs-lookup"><span data-stu-id="40c0a-234">Continue reading to learn as to why these exceptions were raised and how to fix them.</span></span>

> [!NOTE]
> <span data-ttu-id="40c0a-235">如果您要遵照沿著使用下載隨附此教學課程中，這些問題有已經尚未指明可以被。</span><span class="sxs-lookup"><span data-stu-id="40c0a-235">If you're following along using the download accompanying this tutorial, these problems have already been accounted for.</span></span> <span data-ttu-id="40c0a-236">不過，建議您閱讀下面所列，以協助識別可能發生的問題和適當的因應措施的詳細資料。</span><span class="sxs-lookup"><span data-stu-id="40c0a-236">However, I encourage you to read through the details listed below to help identify problems that may arise and suitable workarounds.</span></span>


<span data-ttu-id="40c0a-237">如果您嘗試刪除產品，您會取得例外狀況的訊息會類似於 「*ObjectDataSource 'ObjectDataSource1' 找不到非泛型方法 'DeleteProduct' 具有參數： productID，原始\_ProductID*，「 您可能忘記移除`OldValuesParameterFormatString`從 ObjectDataSource 屬性。</span><span class="sxs-lookup"><span data-stu-id="40c0a-237">If, when attempting to delete a product, you get an exception whose message is similar to "*ObjectDataSource 'ObjectDataSource1' could not find a non-generic method 'DeleteProduct' that has parameters: productID, original\_ProductID*," you likely forgot to remove the `OldValuesParameterFormatString` property from the ObjectDataSource.</span></span> <span data-ttu-id="40c0a-238">與`OldValuesParameterFormatString`指定屬性，傳入同時嘗試 ObjectDataSource`productID`和`original_ProductID`輸入參數來`DeleteProduct`方法。</span><span class="sxs-lookup"><span data-stu-id="40c0a-238">With the `OldValuesParameterFormatString` property specified, the ObjectDataSource attempts to pass in both `productID` and `original_ProductID` input parameters to the `DeleteProduct` method.</span></span> <span data-ttu-id="40c0a-239">`DeleteProduct`不過，只接受單一輸入的參數，因此例外狀況。</span><span class="sxs-lookup"><span data-stu-id="40c0a-239">`DeleteProduct`, however, only accepts a single input parameter, hence the exception.</span></span> <span data-ttu-id="40c0a-240">移除`OldValuesParameterFormatString`屬性 (或將它設定為`{0}`) 會指示要嘗試的原始的輸入參數中傳遞 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="40c0a-240">Removing the `OldValuesParameterFormatString` property (or setting it to `{0}`) instructs the ObjectDataSource to not attempt to pass in the original input parameter.</span></span>


<span data-ttu-id="40c0a-241">[![確認已清除 參數屬性](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image29.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="40c0a-241">[![Ensure That the OldValuesParameterFormatString Property Has Been Cleared Out](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image29.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image28.png)</span></span>

<span data-ttu-id="40c0a-242">**圖 12**： 請確定`OldValuesParameterFormatString`屬性已被清除 Out ([按一下以檢視完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="40c0a-242">**Figure 12**: Ensure That the `OldValuesParameterFormatString` Property Has Been Cleared Out ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image30.png))</span></span>


<span data-ttu-id="40c0a-243">即使您已移除`OldValuesParameterFormatString`屬性，將時仍然出現例外狀況嘗試刪除的產品與訊息: 「*與參考條件約束衝突的 DELETE 陳述式 ' FK\_順序\_詳細資料\_產品的*。 」Northwind 資料庫所包含的外部索引鍵條件約束之間`Order Details`和`Products`資料表，這表示從系統無法刪除的產品，如果有一或多個記錄中的`Order Details`資料表。</span><span class="sxs-lookup"><span data-stu-id="40c0a-243">Even if you had removed the `OldValuesParameterFormatString` property, you still will get an exception when trying to delete a product with the message: "*The DELETE statement conflicted with the REFERENCE constraint 'FK\_Order\_Details\_Products'*." The Northwind database contains a foreign key constraint between the `Order Details` and `Products` table, meaning that a product cannot be deleted from the system if there are one or more records for it in the `Order Details` table.</span></span> <span data-ttu-id="40c0a-244">因為 Northwind 資料庫中的每一個產品有至少一筆記錄`Order Details`，我們先刪除產品的相關聯的訂單詳細資料記錄之前，我們無法刪除任何產品。</span><span class="sxs-lookup"><span data-stu-id="40c0a-244">Since every product in the Northwind database has at least one record in `Order Details`, we cannot delete any products until we first delete the product's associated order details records.</span></span>


<span data-ttu-id="40c0a-245">[![外部索引鍵條件約束會禁止刪除產品](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image32.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="40c0a-245">[![A Foreign Key Constraint Prohibits the Deletion of Products](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image32.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image31.png)</span></span>

<span data-ttu-id="40c0a-246">**圖 13**： 的 Foreign Key 條件約束會禁止刪除產品 ([按一下以檢視完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="40c0a-246">**Figure 13**: A Foreign Key Constraint Prohibits the Deletion of Products ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image33.png))</span></span>


<span data-ttu-id="40c0a-247">教學課程中，我們只要刪除所有記錄的`Order Details`資料表。</span><span class="sxs-lookup"><span data-stu-id="40c0a-247">For our tutorial, let's just delete all of the records from the `Order Details` table.</span></span> <span data-ttu-id="40c0a-248">在真實世界應用程式中，我們需要為：</span><span class="sxs-lookup"><span data-stu-id="40c0a-248">In a real-world application we'd need to either:</span></span>

- <span data-ttu-id="40c0a-249">有另一個螢幕，來管理訂單詳細資料資訊</span><span class="sxs-lookup"><span data-stu-id="40c0a-249">Have another screen to manage order details information</span></span>
- <span data-ttu-id="40c0a-250">加強`DeleteProduct`方法，將包含邏輯，可刪除指定的產品訂單詳細資料</span><span class="sxs-lookup"><span data-stu-id="40c0a-250">Augment the `DeleteProduct` method to include logic to delete the specified product's order details</span></span>
- <span data-ttu-id="40c0a-251">修改 SQL 查詢的 TableAdapter 用於包含刪除指定的產品訂單詳細資料</span><span class="sxs-lookup"><span data-stu-id="40c0a-251">Modify the SQL query used by the TableAdapter to include deletion of the specified product's order details</span></span>

<span data-ttu-id="40c0a-252">讓我們只要刪除所有記錄的`Order Details`規避 foreign key 條件約束的資料表。</span><span class="sxs-lookup"><span data-stu-id="40c0a-252">Let's just delete all of the records from the `Order Details` table to circumvent the foreign key constraint.</span></span> <span data-ttu-id="40c0a-253">請移至 Visual Studio 中的 [伺服器總管]，以滑鼠右鍵按一下`NORTHWND.MDF`] 節點，然後選擇 [新的查詢。</span><span class="sxs-lookup"><span data-stu-id="40c0a-253">Go to the Server Explorer in Visual Studio, right-click on the `NORTHWND.MDF` node, and choose New Query.</span></span> <span data-ttu-id="40c0a-254">然後，在查詢視窗中，執行下列 SQL 陳述式： `DELETE FROM [Order Details]`</span><span class="sxs-lookup"><span data-stu-id="40c0a-254">Then, in the query window, run the following SQL statement: `DELETE FROM [Order Details]`</span></span>


<span data-ttu-id="40c0a-255">[![從訂單詳細資料資料表刪除所有記錄](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image35.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="40c0a-255">[![Delete All Records from the Order Details Table](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image35.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image34.png)</span></span>

<span data-ttu-id="40c0a-256">**圖 14**： 刪除所有記錄`Order Details`資料表 ([按一下以檢視完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="40c0a-256">**Figure 14**: Delete All Records from the `Order Details` Table ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image36.png))</span></span>


<span data-ttu-id="40c0a-257">在之後清除`Order Details`按一下 [刪除] 按鈕上的資料表將會刪除產品不會發生錯誤。</span><span class="sxs-lookup"><span data-stu-id="40c0a-257">After clearing out the `Order Details` table clicking on the Delete button will delete the product without error.</span></span> <span data-ttu-id="40c0a-258">如果按一下 [刪除] 按鈕不會刪除產品，請檢查以確保 GridView 的`DataKeyNames`屬性設定為主要索引鍵欄位 (`ProductID`)。</span><span class="sxs-lookup"><span data-stu-id="40c0a-258">If clicking on the Delete button does not delete the product, check to ensure that the GridView's `DataKeyNames` property is set to the primary key field (`ProductID`).</span></span>

> [!NOTE]
> <span data-ttu-id="40c0a-259">按一下 [刪除] 按鈕時回傳展示並刪除該記錄。</span><span class="sxs-lookup"><span data-stu-id="40c0a-259">When clicking on the Delete button a postback ensues and the record is deleted.</span></span> <span data-ttu-id="40c0a-260">這可能十分危險，因為很容易就不小心按的錯誤資料列的 [刪除] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="40c0a-260">This can be dangerous since it is easy to accidentally click on the wrong row's Delete button.</span></span> <span data-ttu-id="40c0a-261">在未來的教學課程中我們會看到如何將用戶端確認刪除記錄時。</span><span class="sxs-lookup"><span data-stu-id="40c0a-261">In a future tutorial we'll see how to add a client-side confirmation when deleting a record.</span></span>


## <a name="editing-data-with-the-gridview"></a><span data-ttu-id="40c0a-262">編輯 GridView 的資料</span><span class="sxs-lookup"><span data-stu-id="40c0a-262">Editing Data with the GridView</span></span>

<span data-ttu-id="40c0a-263">以及刪除 GridView 控制項也提供內建的資料列層級編輯的支援。</span><span class="sxs-lookup"><span data-stu-id="40c0a-263">Along with deleting, the GridView control also provides built-in row-level editing support.</span></span> <span data-ttu-id="40c0a-264">設定為支援編輯 GridView 加入編輯按鈕的資料行。</span><span class="sxs-lookup"><span data-stu-id="40c0a-264">Configuring a GridView to support editing adds a column of Edit buttons.</span></span> <span data-ttu-id="40c0a-265">從使用者的觀點來看，按一下變成可編輯的資料列的資料列的編輯按鈕原因將開啟到包含現有的值，取代更新，[編輯] 按鈕和 [取消] 按鈕的文字方塊的資料格。</span><span class="sxs-lookup"><span data-stu-id="40c0a-265">From the end user's perspective, clicking a row's Edit button causes that row to become editable, turning the cells into textboxes containing the existing values and replacing the Edit button with Update and Cancel buttons.</span></span> <span data-ttu-id="40c0a-266">在其所需的變更後，終端使用者可以按一下以認可變更的 [更新] 按鈕或 [取消] 按鈕，以捨棄它們。</span><span class="sxs-lookup"><span data-stu-id="40c0a-266">After making their desired changes, the end user can click the Update button to commit the changes or the Cancel button to discard them.</span></span> <span data-ttu-id="40c0a-267">在任一情況下後按一下 [更新] 或 [取消] 5d; GridView 回到其預先編輯狀態。</span><span class="sxs-lookup"><span data-stu-id="40c0a-267">In either case, after clicking Update or Cancel the GridView returns to its pre-editing state.</span></span>

<span data-ttu-id="40c0a-268">從我們的觀點來看，為網頁開發人員，當使用者按一下特定的資料列的 [編輯] 按鈕，回傳展示和 GridView 執行下列步驟：</span><span class="sxs-lookup"><span data-stu-id="40c0a-268">From our perspective as the page developer, when the end user clicks the Edit button for a particular row, a postback ensues and the GridView performs the following steps:</span></span>

1. <span data-ttu-id="40c0a-269">GridView`EditItemIndex`屬性指派給其編輯 按鈕已按下資料列的索引</span><span class="sxs-lookup"><span data-stu-id="40c0a-269">The GridView's `EditItemIndex` property is assigned to the index of the row whose Edit button was clicked</span></span>
2. <span data-ttu-id="40c0a-270">在 GridView 重新繫結本身 ObjectDataSource 來叫用其`Select()`方法</span><span class="sxs-lookup"><span data-stu-id="40c0a-270">The GridView rebinds itself to the ObjectDataSource by invoking its `Select()` method</span></span>
3. <span data-ttu-id="40c0a-271">比對的資料列索引`EditItemIndex`呈現在 「 編輯模式 」。</span><span class="sxs-lookup"><span data-stu-id="40c0a-271">The row index that matches the `EditItemIndex` is rendered in "edit mode."</span></span> <span data-ttu-id="40c0a-272">此模式中，編輯 按鈕會被取代更新 和 取消 5d; 按鈕和 BoundFields 其`ReadOnly`屬性為 False （預設值） 會轉譯文字方塊的 Web 控制項的`Text`屬性指派給資料欄位的值。</span><span class="sxs-lookup"><span data-stu-id="40c0a-272">In this mode, the Edit button is replaced by Update and Cancel buttons and BoundFields whose `ReadOnly` properties are False (the default) are rendered as TextBox Web controls whose `Text` properties are assigned to the data fields' values.</span></span>

<span data-ttu-id="40c0a-273">此時標記會傳回給瀏覽器中，允許使用者變更資料列的資料。</span><span class="sxs-lookup"><span data-stu-id="40c0a-273">At this point the markup is returned to the browser, allowing the end user to make any changes to the row's data.</span></span> <span data-ttu-id="40c0a-274">當使用者按一下 [更新] 按鈕時，就會發生回傳和 GridView 執行下列步驟：</span><span class="sxs-lookup"><span data-stu-id="40c0a-274">When the user clicks the Update button, a postback occurs and the GridView performs the following steps:</span></span>

1. <span data-ttu-id="40c0a-275">ObjectDataSource`UpdateParameters`值會指派 GridView 的編輯介面中輸入使用者的值</span><span class="sxs-lookup"><span data-stu-id="40c0a-275">The ObjectDataSource's `UpdateParameters` value(s) are assigned the values entered by the end user into the GridView's editing interface</span></span>
2. <span data-ttu-id="40c0a-276">ObjectDataSource`Update()`叫用方法時，更新指定的記錄</span><span class="sxs-lookup"><span data-stu-id="40c0a-276">The ObjectDataSource's `Update()` method is invoked, updating the specified record</span></span>
3. <span data-ttu-id="40c0a-277">在 GridView 重新繫結本身 ObjectDataSource 來叫用其`Select()`方法</span><span class="sxs-lookup"><span data-stu-id="40c0a-277">The GridView rebinds itself to the ObjectDataSource by invoking its `Select()` method</span></span>

<span data-ttu-id="40c0a-278">主索引鍵值指派給`UpdateParameters`在步驟 1 中來自中指定的值`DataKeyNames`屬性，而非主索引鍵值來自中編輯資料列的文字方塊中的 Web 控制項的文字。</span><span class="sxs-lookup"><span data-stu-id="40c0a-278">The primary key values assigned to the `UpdateParameters` in Step 1 come from the values specified in the `DataKeyNames` property, whereas the non-primary key values come from the text in the TextBox Web controls for the edited row.</span></span> <span data-ttu-id="40c0a-279">為刪除，很重要的 GridView`DataKeyNames`屬性正確設定。</span><span class="sxs-lookup"><span data-stu-id="40c0a-279">As with deleting, it is vital that a GridView's `DataKeyNames` property be correctly set.</span></span> <span data-ttu-id="40c0a-280">如果遺失`UpdateParameters`會指派主索引鍵值`null`更新步驟 2 中的記錄中步驟 1，又不會產生任何的值。</span><span class="sxs-lookup"><span data-stu-id="40c0a-280">If it's missing, the `UpdateParameters` primary key value will be assigned a `null` value in Step 1, which in turn will not result in any updated records in Step 2.</span></span>

<span data-ttu-id="40c0a-281">藉由只檢查 GridView 的智慧標籤的 啟用編輯核取方塊，就可以啟動編輯功能。</span><span class="sxs-lookup"><span data-stu-id="40c0a-281">Editing functionality can be activated by simply checking the Enable Editing checkbox in the GridView's smart tag.</span></span>


![核取 [啟用編輯] 核取方塊](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image37.png)

<span data-ttu-id="40c0a-283">**圖 15**： 核取 [啟用編輯] 核取方塊</span><span class="sxs-lookup"><span data-stu-id="40c0a-283">**Figure 15**: Check the Enable Editing Checkbox</span></span>


<span data-ttu-id="40c0a-284">檢查 [啟用編輯] 核取方塊，將 CommandField （如有需要） 並設定其`ShowEditButton`屬性`true`。</span><span class="sxs-lookup"><span data-stu-id="40c0a-284">Checking the Enable Editing checkbox will add a CommandField (if needed) and set its `ShowEditButton` property to `true`.</span></span> <span data-ttu-id="40c0a-285">如稍早所見，CommandField 包含數個`ShowXButton`指出哪些系列的按鈕會顯示在 CommandField 屬性。</span><span class="sxs-lookup"><span data-stu-id="40c0a-285">As we saw earlier, the CommandField contains a number of `ShowXButton` properties that indicate what series of buttons are displayed in the CommandField.</span></span> <span data-ttu-id="40c0a-286">檢查 [啟用編輯] 核取方塊新增`ShowEditButton`現有 CommandField 屬性：</span><span class="sxs-lookup"><span data-stu-id="40c0a-286">Checking the Enable Editing checkbox adds the `ShowEditButton` property to the existing CommandField:</span></span>


[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-cs/samples/sample6.aspx)]

<span data-ttu-id="40c0a-287">這就是新增基本編輯的支援。</span><span class="sxs-lookup"><span data-stu-id="40c0a-287">That's all there is to adding rudimentary editing support.</span></span> <span data-ttu-id="40c0a-288">粗糙編輯介面是 Figure16 所示，每個 BoundField 其`ReadOnly`屬性設定為`false`（預設值） 會轉譯為文字方塊。</span><span class="sxs-lookup"><span data-stu-id="40c0a-288">As Figure16 shows, the editing interface is rather crude each BoundField whose `ReadOnly` property is set to `false` (the default) is rendered as a TextBox.</span></span> <span data-ttu-id="40c0a-289">這包括欄位`CategoryID`和`SupplierID`，這是與其他資料表的索引鍵。</span><span class="sxs-lookup"><span data-stu-id="40c0a-289">This includes fields like `CategoryID` and `SupplierID`, which are keys to other tables.</span></span>


<span data-ttu-id="40c0a-290">[![按一下 [Chai 的編輯] 按鈕顯示的資料列處於編輯模式](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image39.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="40c0a-290">[![Clicking Chai s Edit Button Displays the Row in Edit Mode](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image39.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image38.png)</span></span>

<span data-ttu-id="40c0a-291">**圖 16**： 按一下 Chai 的編輯 按鈕以編輯模式中顯示的資料列 ([按一下以檢視完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image40.png))</span><span class="sxs-lookup"><span data-stu-id="40c0a-291">**Figure 16**: Clicking Chai s Edit Button Displays the Row in Edit Mode ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image40.png))</span></span>


<span data-ttu-id="40c0a-292">除了詢問使用者直接編輯外部索引鍵值，編輯介面的介面缺少下列方式：</span><span class="sxs-lookup"><span data-stu-id="40c0a-292">In addition to asking users to edit foreign key values directly, the editing interface's interface is lacking in the following ways:</span></span>

- <span data-ttu-id="40c0a-293">如果使用者輸入`CategoryID`或`SupplierID`不在資料庫中，存在`UPDATE`將違反的外部索引鍵條件約束，造成引發例外狀況。</span><span class="sxs-lookup"><span data-stu-id="40c0a-293">If the user enters a `CategoryID` or `SupplierID` that does not exist in the database, the `UPDATE` will violate a foreign key constraint, causing an exception to be raised.</span></span>
- <span data-ttu-id="40c0a-294">編輯介面不包含任何驗證。</span><span class="sxs-lookup"><span data-stu-id="40c0a-294">The editing interface doesn't include any validation.</span></span> <span data-ttu-id="40c0a-295">如果您未提供必要的值 (例如`ProductName`)，或輸入一個數字值 （例如，輸入 「 太多 ！"的預期的字串值</span><span class="sxs-lookup"><span data-stu-id="40c0a-295">If you don't provide a required value (such as `ProductName`), or enter a string value where a numeric value is expected (such as entering "Too much!"</span></span> <span data-ttu-id="40c0a-296">到`UnitPrice`文字方塊)，將會擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="40c0a-296">into the `UnitPrice` textbox), an exception will be thrown.</span></span> <span data-ttu-id="40c0a-297">未來的教學課程將會檢驗如何加入驗證控制項來編輯的使用者介面。</span><span class="sxs-lookup"><span data-stu-id="40c0a-297">A future tutorial will examine how to add validation controls to the editing user interface.</span></span>
- <span data-ttu-id="40c0a-298">目前，*所有*不是唯讀的產品欄位必須包含在 GridView。</span><span class="sxs-lookup"><span data-stu-id="40c0a-298">Currently, *all* product fields that are not read-only must be included in the GridView.</span></span> <span data-ttu-id="40c0a-299">如果我們從 GridView 移除欄位，說出`UnitPrice`，當更新在 GridView 的資料就不應設定`UnitPrice``UpdateParameters`值，也可能會變更資料庫記錄`UnitPrice`至`NULL`值。</span><span class="sxs-lookup"><span data-stu-id="40c0a-299">If we were to remove a field from the GridView, say `UnitPrice`, when updating the data the GridView would not set the `UnitPrice` `UpdateParameters` value, which would change the database record's `UnitPrice` to a `NULL` value.</span></span> <span data-ttu-id="40c0a-300">同樣地，如果必要的欄位，例如`ProductName`，會移除從 GridView，更新將會失敗的相同 「*資料行 'ProductName' 不允許 null*"上面提到的例外狀況。</span><span class="sxs-lookup"><span data-stu-id="40c0a-300">Similarly, if a required field, such as `ProductName`, is removed from the GridView, the update will fail with the same "*Column 'ProductName' does not allow nulls*" exception mentioned above.</span></span>
- <span data-ttu-id="40c0a-301">編輯介面格式讓人滿意。</span><span class="sxs-lookup"><span data-stu-id="40c0a-301">The editing interface formatting leaves a lot to be desired.</span></span> <span data-ttu-id="40c0a-302">`UnitPrice`顯示四個小數位數。</span><span class="sxs-lookup"><span data-stu-id="40c0a-302">The `UnitPrice` is shown with four decimal points.</span></span> <span data-ttu-id="40c0a-303">在理想情況下`CategoryID`和`SupplierID`值會包含在系統中列出的類別目錄與供應商的 DropDownLists。</span><span class="sxs-lookup"><span data-stu-id="40c0a-303">Ideally the `CategoryID` and `SupplierID` values would contain DropDownLists that list the categories and suppliers in the system.</span></span>

<span data-ttu-id="40c0a-304">這些是所有的缺點，我們必須具備即時現在，但將在未來的教學課程中獲得解決。</span><span class="sxs-lookup"><span data-stu-id="40c0a-304">These are all shortcomings that we'll have to live with for now, but will be addressed in future tutorials.</span></span>

## <a name="inserting-editing-and-deleting-data-with-the-detailsview"></a><span data-ttu-id="40c0a-305">插入、 編輯和刪除資料與 DetailsView</span><span class="sxs-lookup"><span data-stu-id="40c0a-305">Inserting, Editing, and Deleting Data with the DetailsView</span></span>

<span data-ttu-id="40c0a-306">如同我們在先前的教學課程中，DetailsView 控制項一次和 like GridView 會顯示一筆記錄，允許編輯和刪除目前所顯示的記錄。</span><span class="sxs-lookup"><span data-stu-id="40c0a-306">As we've seen in earlier tutorials, the DetailsView control displays one record at a time and, like the GridView, allows for editing and deleting of the currently displayed record.</span></span> <span data-ttu-id="40c0a-307">這兩個使用者的經驗與編輯和刪除項目從 DetailsView 和從 ASP.NET 端工作流程是相同的 GridView。</span><span class="sxs-lookup"><span data-stu-id="40c0a-307">Both the end user's experience with editing and deleting items from a DetailsView and the workflow from the ASP.NET side is identical to that of the GridView.</span></span> <span data-ttu-id="40c0a-308">在 DetailsView 與 GridView 不同是它也提供內建插入的支援。</span><span class="sxs-lookup"><span data-stu-id="40c0a-308">Where the DetailsView differs from the GridView is that it also provides built-in inserting support.</span></span>

<span data-ttu-id="40c0a-309">為了示範 GridView 的資料修改功能，開始請先新增至 DetailsView`Basics.aspx`現有 GridView 上方頁面上，並將它繫結至現有的 ObjectDataSource 透過 DetailsView 的智慧標籤。</span><span class="sxs-lookup"><span data-stu-id="40c0a-309">To demonstrate the data modification capabilities of the GridView, start by adding a DetailsView to the `Basics.aspx` page above the existing GridView and bind it to the existing ObjectDataSource through the DetailsView's smart tag.</span></span> <span data-ttu-id="40c0a-310">下一步]，清除 DetailsView 的`Height`和`Width`屬性，並檢查智慧標籤的 [啟用分頁選項。</span><span class="sxs-lookup"><span data-stu-id="40c0a-310">Next, clear out the DetailsView's `Height` and `Width` properties, and check the Enable Paging option from the smart tag.</span></span> <span data-ttu-id="40c0a-311">若要啟用編輯，插入和刪除的支援，只會檢查啟用編輯、 啟用插入和刪除啟用核取方塊中的智慧標籤。</span><span class="sxs-lookup"><span data-stu-id="40c0a-311">To enable editing, inserting, and deleting support, simply check the Enable Editing, Enable Inserting, and Enable Deleting checkboxes in the smart tag.</span></span>


![設定為支援編輯、 插入和刪除 DetailsView](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image41.png)

<span data-ttu-id="40c0a-313">**圖 17**： 設定為支援編輯、 插入和刪除 DetailsView</span><span class="sxs-lookup"><span data-stu-id="40c0a-313">**Figure 17**: Configure the DetailsView to Support Editing, Inserting, and Deleting</span></span>


<span data-ttu-id="40c0a-314">做為 GridView 中加入編輯、 插入或刪除支援新增 CommandField detailsview，如下所示的宣告式語法：</span><span class="sxs-lookup"><span data-stu-id="40c0a-314">As with the GridView, adding editing, inserting, or deleting support adds a CommandField to the DetailsView, as the following declarative syntax shows:</span></span>


[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-cs/samples/sample7.aspx)]

<span data-ttu-id="40c0a-315">請注意，為 DetailsView CommandField 依預設會出現在資料行集合的結尾。</span><span class="sxs-lookup"><span data-stu-id="40c0a-315">Note that for the DetailsView the CommandField appears at the end of the Columns collection by default.</span></span> <span data-ttu-id="40c0a-316">在 DetailsView 的欄位會轉譯為資料列，CommandField 會顯示為一個資料列具有插入，因為編輯和刪除 DetailsView 底部的按鈕。</span><span class="sxs-lookup"><span data-stu-id="40c0a-316">Since the DetailsView's fields are rendered as rows, the CommandField appears as a row with Insert, Edit, and Delete buttons at the bottom of the DetailsView.</span></span>


<span data-ttu-id="40c0a-317">[![設定為支援編輯、 插入和刪除 DetailsView](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image43.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image42.png)</span><span class="sxs-lookup"><span data-stu-id="40c0a-317">[![Configure the DetailsView to Support Editing, Inserting, and Deleting](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image43.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image42.png)</span></span>

<span data-ttu-id="40c0a-318">**圖 18**： 設定來支援編輯、 插入和刪除 DetailsView ([按一下以檢視完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image44.png))</span><span class="sxs-lookup"><span data-stu-id="40c0a-318">**Figure 18**: Configure the DetailsView to Support Editing, Inserting, and Deleting ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image44.png))</span></span>


<span data-ttu-id="40c0a-319">按一下 [刪除] 按鈕啟動事件的相同順序，如同 GridView： 的回傳。後面接著填入其 ObjectDataSource DetailsView`DeleteParameters`根據`DataKeyNames`值;，並已完成，但在呼叫其 ObjectDataSource`Delete()`方法，從資料庫中實際移除產品。</span><span class="sxs-lookup"><span data-stu-id="40c0a-319">Clicking on the Delete button starts the same sequence of events as with the GridView: a postback; followed by the DetailsView populating its ObjectDataSource's `DeleteParameters` based on the `DataKeyNames` values; and completed with a call its ObjectDataSource's `Delete()` method, which actually removes the product from the database.</span></span> <span data-ttu-id="40c0a-320">編輯 DetailsView 中也能運作，以相同的 GridView 的方式。</span><span class="sxs-lookup"><span data-stu-id="40c0a-320">Editing in the DetailsView also works in a fashion identical to that of the GridView.</span></span>

<span data-ttu-id="40c0a-321">插入，使用者會看見新按鈕，按一下時，會呈現在 DetailsView 中 「 插入模式 」。</span><span class="sxs-lookup"><span data-stu-id="40c0a-321">For inserting, the end user is presented with a New button that, when clicked, renders the DetailsView in "insert mode."</span></span> <span data-ttu-id="40c0a-322">插入模式 使用 新增 按鈕和會取代插入 和 取消 5d; 按鈕只有那些 BoundFields 其`InsertVisible`屬性設定為`true`（預設值） 會顯示。</span><span class="sxs-lookup"><span data-stu-id="40c0a-322">With "insert mode" the New button is replaced by Insert and Cancel buttons and only those BoundFields whose `InsertVisible` property is set to `true` (the default) are displayed.</span></span> <span data-ttu-id="40c0a-323">識別做為自動遞增的欄位，例如那些資料欄位`ProductID`，有其[InsertVisible 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datacontrolfield.insertvisible(VS.80).aspx)設`false`繫結至資料來源透過智慧標籤的 DetailsView 時。</span><span class="sxs-lookup"><span data-stu-id="40c0a-323">Those data fields identified as auto-increment fields, such as `ProductID`, have their [InsertVisible property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.datacontrolfield.insertvisible(VS.80).aspx) set to `false` when binding the DetailsView to the data source through the smart tag.</span></span>

<span data-ttu-id="40c0a-324">當繫結的 DetailsView 透過智慧標籤的資料來源，Visual Studio 設定`InsertVisible`屬性`false`只適用於自動遞增的欄位。</span><span class="sxs-lookup"><span data-stu-id="40c0a-324">When binding a data source to a DetailsView through the smart tag, Visual Studio sets the `InsertVisible` property to `false` only for auto-increment fields.</span></span> <span data-ttu-id="40c0a-325">唯讀欄位，例如`CategoryName`和`SupplierName`，將會顯示在 「 插入模式 」 使用者介面中，除非其`InsertVisible`屬性明確設定為`false`。</span><span class="sxs-lookup"><span data-stu-id="40c0a-325">Read-only fields, like `CategoryName` and `SupplierName`, will be displayed in the "insert mode" user interface unless their `InsertVisible` property is explicitly set to `false`.</span></span> <span data-ttu-id="40c0a-326">請花一點時間來設定這兩個欄位`InsertVisible`屬性`false`，透過在 DetailsView 的宣告式語法或透過編輯的欄位中的智慧標籤連結。</span><span class="sxs-lookup"><span data-stu-id="40c0a-326">Take a moment to set these two fields' `InsertVisible` properties to `false`, either through the DetailsView's declarative syntax or through the Edit Fields link in the smart tag.</span></span> <span data-ttu-id="40c0a-327">圖 19 顯示設定`InsertVisible`屬性`false`編輯欄位上按一下連結。</span><span class="sxs-lookup"><span data-stu-id="40c0a-327">Figure 19 shows setting the `InsertVisible` properties to `false` by clicking on the Edit Fields link.</span></span>


<span data-ttu-id="40c0a-328">[![Northwind Traders 現在提供 Acme 茶杯](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image46.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image45.png)</span><span class="sxs-lookup"><span data-stu-id="40c0a-328">[![Northwind Traders Now Offers Acme Tea](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image46.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image45.png)</span></span>

<span data-ttu-id="40c0a-329">**圖 19**: Northwind Traders 現在提供 Acme 茶杯 ([按一下以檢視完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image47.png))</span><span class="sxs-lookup"><span data-stu-id="40c0a-329">**Figure 19**: Northwind Traders Now Offers Acme Tea ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image47.png))</span></span>


<span data-ttu-id="40c0a-330">設定之後`InsertVisible`屬性、 檢視`Basics.aspx`網頁瀏覽器中，按一下 [新增] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="40c0a-330">After setting the `InsertVisible` properties, view the `Basics.aspx` page in a browser and click the New button.</span></span> <span data-ttu-id="40c0a-331">圖 20 會顯示在 DetailsView 加入新的飲料時, Acme 茶杯，到我們的產品線。</span><span class="sxs-lookup"><span data-stu-id="40c0a-331">Figure 20 shows the DetailsView when adding a new beverage, Acme Tea, to our product line.</span></span>


<span data-ttu-id="40c0a-332">[![Northwind Traders 現在提供 Acme 茶杯](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image49.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image48.png)</span><span class="sxs-lookup"><span data-stu-id="40c0a-332">[![Northwind Traders Now Offers Acme Tea](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image49.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image48.png)</span></span>

<span data-ttu-id="40c0a-333">**圖 20**: Northwind Traders 現在提供 Acme 茶杯 ([按一下以檢視完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image50.png))</span><span class="sxs-lookup"><span data-stu-id="40c0a-333">**Figure 20**: Northwind Traders Now Offers Acme Tea ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image50.png))</span></span>


<span data-ttu-id="40c0a-334">回傳展示之後 Acme 茶杯的詳細資料的輸入，然後按一下 [插入] 按鈕，並加入新的記錄`Products`資料庫資料表。</span><span class="sxs-lookup"><span data-stu-id="40c0a-334">After entering the details for Acme Tea and clicking the Insert button, a postback ensues and the new record is added to the `Products` database table.</span></span> <span data-ttu-id="40c0a-335">因為此 DetailsView 按照順序列出產品與其存在於資料庫資料表，我們必須頁面上的最後一個產品才能看到新的產品。</span><span class="sxs-lookup"><span data-stu-id="40c0a-335">Since this DetailsView lists the products in order with which they exist in the database table, we must page to the last product in order to see the new product.</span></span>


<span data-ttu-id="40c0a-336">[![Acme 茶杯的詳細資料](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image52.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image51.png)</span><span class="sxs-lookup"><span data-stu-id="40c0a-336">[![Details for Acme Tea](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image52.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image51.png)</span></span>

<span data-ttu-id="40c0a-337">**圖 21**: Acme 茶杯的詳細資料 ([按一下以檢視完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image53.png))</span><span class="sxs-lookup"><span data-stu-id="40c0a-337">**Figure 21**: Details for Acme Tea ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image53.png))</span></span>


> [!NOTE]
> <span data-ttu-id="40c0a-338">在 DetailsView 的[CurrentMode 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.detailsview.currentmode(VS.80).aspx)指出所顯示的介面，而且可以是下列值之一： `Edit`， `Insert`，或`ReadOnly`。</span><span class="sxs-lookup"><span data-stu-id="40c0a-338">The DetailsView's [CurrentMode property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.detailsview.currentmode(VS.80).aspx) indicates the interface being displayed and can be one of the following values: `Edit`, `Insert`, or `ReadOnly`.</span></span> <span data-ttu-id="40c0a-339">[DefaultMode 屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.detailsview.defaultmode(VS.80).aspx)指出的模式 DetailsView 返回編輯之後，或插入已經完成，並且適用於顯示的 DetailsView 永久處於編輯，或插入模式。</span><span class="sxs-lookup"><span data-stu-id="40c0a-339">The [DefaultMode property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.detailsview.defaultmode(VS.80).aspx) indicates the mode the DetailsView returns to after an edit or insert has been completed and is useful for displaying a DetailsView that is permanently in edit or insert mode.</span></span>


<span data-ttu-id="40c0a-340">的點，並按一下插入及編輯 DetailsView 的功能會受困於從 GridView 相同的限制： 使用者必須輸入現有`CategoryID`和`SupplierID`到文字方塊中的值; 介面缺少任何驗證邏輯中，不允許的產品欄位`NULL`值沒有預設值或在資料庫層級指定的值必須包含在插入介面，依此類推。</span><span class="sxs-lookup"><span data-stu-id="40c0a-340">The point and click inserting and editing capabilities of the DetailsView suffer from the same limitations as the GridView: the user must enter existing `CategoryID` and `SupplierID` values through a textbox; the interface lacks any validation logic; all product fields that do not allow `NULL` values or don't have a default value specified at the database level must be included in the inserting interface, and so on.</span></span>

<span data-ttu-id="40c0a-341">我們將來擴充和增強 GridView 的編輯介面在未來的發行項可以套用至 DetailsView 控制項的編輯和插入介面以及檢視技術。</span><span class="sxs-lookup"><span data-stu-id="40c0a-341">The techniques we will examine for extending and enhancing the GridView's editing interface in future articles can be applied to the DetailsView control's editing and inserting interfaces as well.</span></span>

## <a name="using-the-formview-for-a-more-flexible-data-modification-user-interface"></a><span data-ttu-id="40c0a-342">在 FormView 使用更具彈性的資料修改使用者介面</span><span class="sxs-lookup"><span data-stu-id="40c0a-342">Using the FormView for a More Flexible Data Modification User Interface</span></span>

<span data-ttu-id="40c0a-343">在 FormView 提供內建支援插入、 編輯和刪除資料，但因為它會使用範本，而不是欄位沒有將 BoundFields 或 CommandField GridView 和 DetailsView 控制項用來提供的資料位置修改介面。</span><span class="sxs-lookup"><span data-stu-id="40c0a-343">The FormView offers built-in support for inserting, editing, and deleting data, but because it uses templates instead of fields there's no place to add the BoundFields or the CommandField used by the GridView and DetailsView controls to provide the data modification interface.</span></span> <span data-ttu-id="40c0a-344">相反地，此介面來收集使用者的 Web 控制項加入新項目時所輸入或編輯現有的 fgpp 以及 [新增]，編輯、 刪除、 插入、 更新和取消按鈕必須手動新增至適當的範本。</span><span class="sxs-lookup"><span data-stu-id="40c0a-344">Instead, this interface the Web controls for collecting user input when adding a new item or editing an existing one along with the New, Edit, Delete, Insert, Update, and Cancel buttons must be added manually to the appropriate templates.</span></span> <span data-ttu-id="40c0a-345">幸運的是，當繫結至資料來源透過下拉式清單中的智慧標籤的 FormView Visual Studio 會自動建立所需的介面。</span><span class="sxs-lookup"><span data-stu-id="40c0a-345">Fortunately, Visual Studio will automatically create the needed interface when binding the FormView to a data source through the drop-down list in its smart tag.</span></span>

<span data-ttu-id="40c0a-346">為了說明這些技術，開始請先新增 FormView`Basics.aspx`頁面上，並在 FormView 的智慧標籤上，從繫結到已建立 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="40c0a-346">To illustrate these techniques, start by adding a FormView to the `Basics.aspx` page and, from the FormView's smart tag, bind it to the ObjectDataSource already created.</span></span> <span data-ttu-id="40c0a-347">這會產生`EditItemTemplate`， `InsertItemTemplate`，和`ItemTemplate`收集新增使用者的輸入和按鈕 Web 控制項的 TextBox Web 控制項與 FormView，編輯、 刪除、 插入、 更新以及 [取消] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="40c0a-347">This will generate an `EditItemTemplate`, `InsertItemTemplate`, and `ItemTemplate` for the FormView with TextBox Web controls for collecting the user's input and Button Web controls for the New, Edit, Delete, Insert, Update, and Cancel buttons.</span></span> <span data-ttu-id="40c0a-348">此外，在 FormView 的`DataKeyNames`屬性設定為主要索引鍵欄位 (`ProductID`) ObjectDataSource 所傳回的物件。</span><span class="sxs-lookup"><span data-stu-id="40c0a-348">Additionally, the FormView's `DataKeyNames` property is set to the primary key field (`ProductID`) of the object returned by the ObjectDataSource.</span></span> <span data-ttu-id="40c0a-349">最後，檢查在 FormView 的智慧標籤的 [啟用分頁] 選項。</span><span class="sxs-lookup"><span data-stu-id="40c0a-349">Lastly, check the Enable Paging option in the FormView's smart tag.</span></span>

<span data-ttu-id="40c0a-350">下圖顯示的宣告式標記為在 FormView 的`ItemTemplate`FormView 已經繫結至 ObjectDataSource 之後。</span><span class="sxs-lookup"><span data-stu-id="40c0a-350">The following shows the declarative markup for the FormView's `ItemTemplate` after the FormView has been bound to the ObjectDataSource.</span></span> <span data-ttu-id="40c0a-351">根據預設，每個非布林值的產品欄位繫結至`Text`時每個布林值欄位的標籤 Web 控制項的屬性 (`Discontinued`) 繫結至`Checked`已停用核取方塊 Web 控制項的屬性。</span><span class="sxs-lookup"><span data-stu-id="40c0a-351">By default, each non-Boolean value product field is bound to the `Text` property of a Label Web control while each Boolean value field (`Discontinued`) is bound to the `Checked` property of a disabled CheckBox Web control.</span></span> <span data-ttu-id="40c0a-352">為了新增、 編輯和刪除按鈕來觸發特定 FormView 行為，在按下時，務必，其`CommandName`值設定為`New`， `Edit`，和`Delete`分別。</span><span class="sxs-lookup"><span data-stu-id="40c0a-352">In order for the New, Edit, and Delete buttons to trigger certain FormView behavior when clicked, it is imperative that their `CommandName` values be set to `New`, `Edit`, and `Delete`, respectively.</span></span>


[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-cs/samples/sample8.aspx)]

<span data-ttu-id="40c0a-353">圖 22 顯示在 FormView 的`ItemTemplate`透過瀏覽器檢視時。</span><span class="sxs-lookup"><span data-stu-id="40c0a-353">Figure 22 shows the FormView's `ItemTemplate` when viewed through a browser.</span></span> <span data-ttu-id="40c0a-354">每個產品欄位會列出在底部的新增、 編輯和刪除按鈕。</span><span class="sxs-lookup"><span data-stu-id="40c0a-354">Each product field is listed with the New, Edit, and Delete buttons at the bottom.</span></span>


<span data-ttu-id="40c0a-355">[![預設 FormView ItemTemplate 列出每個產品欄位，以及新增、 編輯和刪除按鈕](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image55.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image54.png)</span><span class="sxs-lookup"><span data-stu-id="40c0a-355">[![The Defaut FormView ItemTemplate Lists Each Product Field Along with New, Edit, and Delete Buttons](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image55.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image54.png)</span></span>

<span data-ttu-id="40c0a-356">**圖 22**: 預設 FormView`ItemTemplate`列出每個產品欄位沿著以新增、 編輯和刪除 按鈕 ([按一下以檢視完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image56.png))</span><span class="sxs-lookup"><span data-stu-id="40c0a-356">**Figure 22**: The Defaut FormView `ItemTemplate` Lists Each Product Field Along with New, Edit, and Delete Buttons ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image56.png))</span></span>


<span data-ttu-id="40c0a-357">例如 GridView 和 DetailsView，按一下 [刪除] 按鈕，或任何按鈕、 LinkButton 或 ImageButton 其`CommandName`屬性是設定為刪除，會導致回傳，並填入 ObjectDataSource`DeleteParameters`根據在 FormView 的`DataKeyNames`值，而且會叫用 ObjectDataSource`Delete()`方法。</span><span class="sxs-lookup"><span data-stu-id="40c0a-357">Like with the GridView and DetailsView, clicking the Delete button or any Button, LinkButton, or ImageButton whose `CommandName` property is set to Delete causes a postback, populates the ObjectDataSource's `DeleteParameters` based on the FormView's `DataKeyNames` value, and invokes the ObjectDataSource's `Delete()` method.</span></span>

<span data-ttu-id="40c0a-358">按一下 [編輯] 按鈕時回傳展示和資料重新繫結至`EditItemTemplate`，這是負責呈現編輯介面。</span><span class="sxs-lookup"><span data-stu-id="40c0a-358">When the Edit button is clicked a postback ensues and the data is rebound to the `EditItemTemplate`, which is responsible for rendering the editing interface.</span></span> <span data-ttu-id="40c0a-359">這個介面包含 Web 控制項編輯資料，以及更新 和 取消 5d; 按鈕。</span><span class="sxs-lookup"><span data-stu-id="40c0a-359">This interface includes the Web controls for editing data along with the Update and Cancel buttons.</span></span> <span data-ttu-id="40c0a-360">預設值`EditItemTemplate`產生的 Visual Studio 包含任何自動遞增的欄位標籤 (`ProductID`)、 的文字方塊中，每個非布林值欄位，以及每個布林值欄位的核取方塊。</span><span class="sxs-lookup"><span data-stu-id="40c0a-360">The default `EditItemTemplate` generated by Visual Studio contains a Label for any auto-increment fields (`ProductID`), a TextBox for each non-Boolean value field, and a CheckBox for each Boolean value field.</span></span> <span data-ttu-id="40c0a-361">此行為是非常類似於自動產生 BoundFields GridView 和 DetailsView 控制項中。</span><span class="sxs-lookup"><span data-stu-id="40c0a-361">This behavior is very similar to the auto-generated BoundFields in the GridView and DetailsView controls.</span></span>

> [!NOTE]
> <span data-ttu-id="40c0a-362">在 FormView 的自動產生的一個小問題`EditItemTemplate`是它呈現文字方塊中的 Web 控制項是唯讀，例如這些欄位`CategoryName`和`SupplierName`。</span><span class="sxs-lookup"><span data-stu-id="40c0a-362">One small issue with the FormView's auto-generation of the `EditItemTemplate` is that it renders TextBox Web controls for those fields that are read-only, such as `CategoryName` and `SupplierName`.</span></span> <span data-ttu-id="40c0a-363">我們會看到如何將此列入考量很快。</span><span class="sxs-lookup"><span data-stu-id="40c0a-363">We'll see how to account for this shortly.</span></span>


<span data-ttu-id="40c0a-364">TextBox 控制項中`EditItemTemplate`有其`Text`屬性繫結至其對應的資料欄位使用的值*雙向資料繫結*。</span><span class="sxs-lookup"><span data-stu-id="40c0a-364">The TextBox controls in the `EditItemTemplate` have their `Text` property bound to the value of their corresponding data field using *two-way databinding*.</span></span> <span data-ttu-id="40c0a-365">雙向資料繫結，以表示`<%# Bind("dataField") %>`，執行資料繫結這兩個範本繫結資料時，並填入 ObjectDataSource 參數插入或編輯資料錄。</span><span class="sxs-lookup"><span data-stu-id="40c0a-365">Two-way databinding, denoted by `<%# Bind("dataField") %>`, performs databinding both when binding data to the template and when populating the ObjectDataSource's parameters for inserting or editing records.</span></span> <span data-ttu-id="40c0a-366">也就是說，當使用者按一下 [編輯] 按鈕時，才`ItemTemplate`、`Bind()`方法會傳回指定的資料欄位值。</span><span class="sxs-lookup"><span data-stu-id="40c0a-366">That is, when the user clicks the Edit button from the `ItemTemplate`, the `Bind()` method returns the specified data field value.</span></span> <span data-ttu-id="40c0a-367">使用者進行變更，並按一下 更新之後，這些值回傳對應到使用指定的資料欄位`Bind()`會套用到 ObjectDataSource `UpdateParameters`。</span><span class="sxs-lookup"><span data-stu-id="40c0a-367">After the user makes their changes and clicks Update, the values posted back that correspond to the data fields specified using `Bind()` are applied to the ObjectDataSource's `UpdateParameters`.</span></span> <span data-ttu-id="40c0a-368">單向資料繫結，或者，以表示`<%# Eval("dataField") %>`，只會將資料繫結至範本時所擷取的資料欄位值，並*不*返回資料來源的參數中的使用者輸入的值，在回傳。</span><span class="sxs-lookup"><span data-stu-id="40c0a-368">Alternatively, one-way databinding, denoted by `<%# Eval("dataField") %>`, only retrieves the data field values when binding data to the template and does *not* return the user-entered values to the data source's parameters on postback.</span></span>

<span data-ttu-id="40c0a-369">下列宣告式標記會顯示在 FormView 的`EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="40c0a-369">The following declarative markup shows the FormView's `EditItemTemplate`.</span></span> <span data-ttu-id="40c0a-370">請注意，`Bind()`方法用於中的資料繫結語法，並更新和取消按鈕 Web 控制項有其`CommandName`隨之設定的屬性。</span><span class="sxs-lookup"><span data-stu-id="40c0a-370">Note that the `Bind()` method is used in the databinding syntax here and that the Update and Cancel Button Web controls have their `CommandName` properties set accordingly.</span></span>

[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-cs/samples/sample9.aspx)]

<span data-ttu-id="40c0a-371">我們`EditItemTemplate`，這點，如果我們嘗試使用它擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="40c0a-371">Our `EditItemTemplate`, at this point, will cause an exception to be thrown if we attempt to use it.</span></span> <span data-ttu-id="40c0a-372">問題在於`CategoryName`和`SupplierName`TextBox Web 控制項中，會呈現欄位`EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="40c0a-372">The problem is that the `CategoryName` and `SupplierName` fields are rendered as TextBox Web controls in the `EditItemTemplate`.</span></span> <span data-ttu-id="40c0a-373">我們可能需要變更這些文字方塊的標籤或完全移除它們。</span><span class="sxs-lookup"><span data-stu-id="40c0a-373">We either need to change these TextBoxes to Labels or remove them altogether.</span></span> <span data-ttu-id="40c0a-374">讓我們只要刪除它們完全從`EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="40c0a-374">Let's simply delete them entirely from the `EditItemTemplate`.</span></span>

<span data-ttu-id="40c0a-375">圖 23 瀏覽器中顯示 FormView 之後會在按下 Chai [編輯] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="40c0a-375">Figure 23 shows the FormView in a browser after the Edit button has been clicked for Chai.</span></span> <span data-ttu-id="40c0a-376">請注意，`SupplierName`和`CategoryName`欄位中顯示`ItemTemplate`不再存在，因為我們只移除從`EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="40c0a-376">Note that the `SupplierName` and `CategoryName` fields shown in the `ItemTemplate` are no longer present, as we just removed them from the `EditItemTemplate`.</span></span> <span data-ttu-id="40c0a-377">按一下 更新 按鈕時 FormView 就會繼續進行 GridView 和 DetailsView 控制項相同的步驟序列。</span><span class="sxs-lookup"><span data-stu-id="40c0a-377">When the Update button is clicked the FormView proceeds through the same sequence of steps as the GridView and DetailsView controls.</span></span>


<span data-ttu-id="40c0a-378">[![依預設，EditItemTemplate 顯示每個可編輯的產品欄位文字方塊或核取方塊](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image58.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image57.png)</span><span class="sxs-lookup"><span data-stu-id="40c0a-378">[![By Default the EditItemTemplate Shows Each Editable Product Field as a TextBox or CheckBox](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image58.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image57.png)</span></span>

<span data-ttu-id="40c0a-379">**圖 23**： 根據預設`EditItemTemplate`顯示每個可編輯產品欄位做為文字方塊或核取方塊 ([按一下以檢視完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image59.png))</span><span class="sxs-lookup"><span data-stu-id="40c0a-379">**Figure 23**: By Default the `EditItemTemplate` Shows Each Editable Product Field as a TextBox or CheckBox ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image59.png))</span></span>


<span data-ttu-id="40c0a-380">當按一下 [插入] 按鈕在 FormView 的`ItemTemplate`回傳展示。</span><span class="sxs-lookup"><span data-stu-id="40c0a-380">When the Insert button is clicked the FormView's `ItemTemplate` a postback ensues.</span></span> <span data-ttu-id="40c0a-381">不過，沒有資料繫結至 FormView 因為正在加入新的記錄。</span><span class="sxs-lookup"><span data-stu-id="40c0a-381">However, no data is bound to the FormView because a new record is being added.</span></span> <span data-ttu-id="40c0a-382">`InsertItemTemplate`介面包含 Web 控制項，加入新的記錄，以及 [插入] 和 [取消] 5d; 按鈕。</span><span class="sxs-lookup"><span data-stu-id="40c0a-382">The `InsertItemTemplate` interface includes the Web controls for adding a new record along with the Insert and Cancel buttons.</span></span> <span data-ttu-id="40c0a-383">預設值`InsertItemTemplate`產生的 Visual Studio 包含每個非布林值欄位的文字方塊和核取方塊，每個布林值欄位，類似於自動產生`EditItemTemplate`的介面。</span><span class="sxs-lookup"><span data-stu-id="40c0a-383">The default `InsertItemTemplate` generated by Visual Studio contains a TextBox for each non-Boolean value field and a CheckBox for each Boolean value field, similar to the auto-generated `EditItemTemplate`'s interface.</span></span> <span data-ttu-id="40c0a-384">TextBox 控制項有其`Text`屬性繫結使用雙向資料繫結及其對應資料欄位的值。</span><span class="sxs-lookup"><span data-stu-id="40c0a-384">The TextBox controls have their `Text` property bound to the value of their corresponding data field using two-way databinding.</span></span>

<span data-ttu-id="40c0a-385">下列宣告式標記會顯示在 FormView 的`InsertItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="40c0a-385">The following declarative markup shows the FormView's `InsertItemTemplate`.</span></span> <span data-ttu-id="40c0a-386">請注意，`Bind()`方法用於的資料繫結語法，而插入和取消按鈕 Web 控制項有其`CommandName`隨之設定的屬性。</span><span class="sxs-lookup"><span data-stu-id="40c0a-386">Note that the `Bind()` method is used in the databinding syntax here and that the Insert and Cancel Button Web controls have their `CommandName` properties set accordingly.</span></span>


[!code-aspx[Main](an-overview-of-inserting-updating-and-deleting-data-cs/samples/sample10.aspx)]

<span data-ttu-id="40c0a-387">沒有在 FormView 的自動產生的微妙的地方`InsertItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="40c0a-387">There's a subtlety with the FormView's auto-generation of the `InsertItemTemplate`.</span></span> <span data-ttu-id="40c0a-388">即使是唯讀，例如這些欄位的文字方塊中的 Web 控制項建立的具體來說，`CategoryName`和`SupplierName`。</span><span class="sxs-lookup"><span data-stu-id="40c0a-388">Specifically, the TextBox Web controls are created even for those fields that are read-only, such as `CategoryName` and `SupplierName`.</span></span> <span data-ttu-id="40c0a-389">例如`EditItemTemplate`，我們要移除這些文字方塊從`InsertItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="40c0a-389">Like with the `EditItemTemplate`, we need to remove these TextBoxes from the `InsertItemTemplate`.</span></span>

<span data-ttu-id="40c0a-390">圖 24 顯示 FormView 瀏覽器中，加入新的產品，Acme 咖啡時。</span><span class="sxs-lookup"><span data-stu-id="40c0a-390">Figure 24 shows the FormView in a browser when adding a new product, Acme Coffee.</span></span> <span data-ttu-id="40c0a-391">請注意，`SupplierName`和`CategoryName`欄位中顯示`ItemTemplate`不再存在，因為我們只移除。</span><span class="sxs-lookup"><span data-stu-id="40c0a-391">Note that the `SupplierName` and `CategoryName` fields shown in the `ItemTemplate` are no longer present, as we just removed them.</span></span> <span data-ttu-id="40c0a-392">[插入] 按鈕按一下時透過 DetailsView 控制項相同的步驟序列 FormView 會繼續進行，加入新的記錄，到`Products`資料表。</span><span class="sxs-lookup"><span data-stu-id="40c0a-392">When the Insert button is clicked the FormView proceeds through the same sequence of steps as the DetailsView control, adding a new record to the `Products` table.</span></span> <span data-ttu-id="40c0a-393">圖 25 FormView 中顯示 Acme 咖啡產品詳細資料之後已插入。</span><span class="sxs-lookup"><span data-stu-id="40c0a-393">Figure 25 shows Acme Coffee product's details in the FormView after it has been inserted.</span></span>


<span data-ttu-id="40c0a-394">[![上規定在 FormView 的插入介面](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image61.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image60.png)</span><span class="sxs-lookup"><span data-stu-id="40c0a-394">[![The InsertItemTemplate Dictates the FormView's Inserting Interface](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image61.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image60.png)</span></span>

<span data-ttu-id="40c0a-395">**圖 24**:`InsertItemTemplate`規定在 FormView 的插入介面 ([按一下以檢視完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image62.png))</span><span class="sxs-lookup"><span data-stu-id="40c0a-395">**Figure 24**: The `InsertItemTemplate` Dictates the FormView's Inserting Interface ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image62.png))</span></span>


<span data-ttu-id="40c0a-396">[![在 FormView 中會顯示新的產品，Acme 咖啡詳細資料](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image64.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image63.png)</span><span class="sxs-lookup"><span data-stu-id="40c0a-396">[![The Details for New Product, Acme Coffee, are Displayed in the FormView](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image64.png)](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image63.png)</span></span>

<span data-ttu-id="40c0a-397">**圖 25**： 新的產品，Acme 咖啡的詳細資料會顯示在 FormView ([按一下以檢視完整大小的影像](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image65.png))</span><span class="sxs-lookup"><span data-stu-id="40c0a-397">**Figure 25**: The Details for New Product, Acme Coffee, are Displayed in the FormView ([Click to view full-size image](an-overview-of-inserting-updating-and-deleting-data-cs/_static/image65.png))</span></span>


<span data-ttu-id="40c0a-398">藉由分隔的唯讀時，編輯，並將介面插入三個不同的範本，在 FormView 允許比 DetailsView 和 GridView 更好的控制這些介面。</span><span class="sxs-lookup"><span data-stu-id="40c0a-398">By separating out the read-only, editing, and inserting interfaces into three separate templates, the FormView allows for a finer degree of control over these interfaces than the DetailsView and GridView.</span></span>

> [!NOTE]
> <span data-ttu-id="40c0a-399">要在 DetailsView，在 FormView 的`CurrentMode`屬性會指出所顯示的介面和其`DefaultMode`屬性指出模式 FormView 返回編輯之後，或插入已經完成。</span><span class="sxs-lookup"><span data-stu-id="40c0a-399">Like the DetailsView, the FormView's `CurrentMode` property indicates the interface being displayed and its `DefaultMode` property indicates the mode the FormView returns to after an edit or insert has been completed.</span></span>


## <a name="summary"></a><span data-ttu-id="40c0a-400">總結</span><span class="sxs-lookup"><span data-stu-id="40c0a-400">Summary</span></span>

<span data-ttu-id="40c0a-401">在本教學課程，我們會檢查插入、 編輯和刪除資料使用 GridView、 DetailsView 和在 FormView 的基本概念。</span><span class="sxs-lookup"><span data-stu-id="40c0a-401">In this tutorial we examined the basics of inserting, editing, and deleting data using the GridView, DetailsView, and FormView.</span></span> <span data-ttu-id="40c0a-402">所有這三種控制項提供某種程度的內建的資料修改功能可以用不需要撰寫一行程式碼，這點受惠 Web 控制項的資料和 ObjectDataSource ASP.NET 網頁中。</span><span class="sxs-lookup"><span data-stu-id="40c0a-402">All three of these controls provide some level of built-in data modification capabilities that can be utilized without writing a single line of code in the ASP.NET page thanks to the data Web controls and the ObjectDataSource.</span></span> <span data-ttu-id="40c0a-403">不過，簡單點，然後按一下 相當身軀技術呈現和貝氏資料修改使用者介面。</span><span class="sxs-lookup"><span data-stu-id="40c0a-403">However, the simple point and click techniques render a fairly frail and naïve data modification user interface.</span></span> <span data-ttu-id="40c0a-404">若要提供的驗證，將以程式設計方式的值、 順暢地處理例外狀況、 自訂使用者介面，和等等，我們需要依賴 first 技術，將在下一步的幾個教學課程會討論。</span><span class="sxs-lookup"><span data-stu-id="40c0a-404">To provide validation, inject programmatic values, gracefully handle exceptions, customize the user interface, and so on, we'll need to rely on a bevy of techniques that will be discussed over the next several tutorials.</span></span>

<span data-ttu-id="40c0a-405">祝您程式設計 ！</span><span class="sxs-lookup"><span data-stu-id="40c0a-405">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="40c0a-406">關於作者</span><span class="sxs-lookup"><span data-stu-id="40c0a-406">About the Author</span></span>

<span data-ttu-id="40c0a-407">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，作者的七個 ASP/ASP.NET 書籍和的創辦[4GuysFromRolla.com](http://www.4guysfromrolla.com)，已從 1998 年使用 Microsoft Web 技術。</span><span class="sxs-lookup"><span data-stu-id="40c0a-407">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="40c0a-408">Scott 可做為獨立顧問、 訓練和寫入器。</span><span class="sxs-lookup"><span data-stu-id="40c0a-408">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="40c0a-409">他最新的活頁簿[ *Sam 教導您自己 ASP.NET 2.0 24 小時內*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="40c0a-409">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="40c0a-410">他可以在達到[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)或透過他的部落格，這可以在找到[ http://ScottOnWriting.NET ](http://ScottOnWriting.NET)。</span><span class="sxs-lookup"><span data-stu-id="40c0a-410">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="40c0a-411">下一步</span><span class="sxs-lookup"><span data-stu-id="40c0a-411">Next</span></span>](examining-the-events-associated-with-inserting-updating-and-deleting-cs.md)
