---
uid: web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/adding-validation-controls-to-the-datalist-s-editing-interface-vb
title: 在 DataList 中加入驗證控制項的編輯介面 (VB) |Microsoft 文件
author: rick-anderson
description: 在本教學課程中，我們會看到它是驗證控制項加入 DataList EditItemTemplate，為了提供更容易的編輯使用者 int 多麼容易...
ms.author: aspnetcontent
manager: wpickett
ms.date: 10/30/2006
ms.topic: article
ms.assetid: 6b073fc6-524d-453d-be7c-0c30986de391
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/adding-validation-controls-to-the-datalist-s-editing-interface-vb
msc.type: authoredcontent
ms.openlocfilehash: 46ff0b18c1ea24dd73c9e3034c1b5e53f2e6d0c2
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/06/2018
ms.locfileid: "30888327"
---
<a name="adding-validation-controls-to-the-datalists-editing-interface-vb"></a><span data-ttu-id="32603-103">驗證控制項加入至 DataList 編輯介面 (VB)</span><span class="sxs-lookup"><span data-stu-id="32603-103">Adding Validation Controls to the DataList's Editing Interface (VB)</span></span>
====================
<span data-ttu-id="32603-104">由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="32603-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="32603-105">[下載範例應用程式](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_39_VB.exe)或[下載 PDF](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/datatutorial39vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="32603-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_39_VB.exe) or [Download PDF](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/datatutorial39vb1.pdf)</span></span>

> <span data-ttu-id="32603-106">在本教學課程中，我們會看到將驗證控制項加入至 DataList EditItemTemplate，以便提供更容易的編輯使用者介面是多麼的輕鬆。</span><span class="sxs-lookup"><span data-stu-id="32603-106">In this tutorial we'll see how easy it is to add validation controls to the DataList's EditItemTemplate in order to provide a more foolproof editing user interface.</span></span>


## <a name="introduction"></a><span data-ttu-id="32603-107">簡介</span><span class="sxs-lookup"><span data-stu-id="32603-107">Introduction</span></span>

<span data-ttu-id="32603-108">在 DataList 為止編輯教學課程時，在編輯介面 DataLists 並未包含任何主動式使用者輸入的驗證即使無效的使用者輸入，例如遺漏的產品名稱或負的價格會產生例外狀況。</span><span class="sxs-lookup"><span data-stu-id="32603-108">In the DataList editing tutorials thus far, the DataLists editing interfaces have not included any proactive user input validation even though invalid user input such as a missing product name or negative price results in an exception.</span></span> <span data-ttu-id="32603-109">在[前述教學課程](handling-bll-and-dal-level-exceptions-vb.md)我們檢驗如何新增例外狀況處理程式碼，以在 DataList 的`UpdateCommand`才能攔截，並依正常程序顯示任何所引發的例外狀況的相關資訊的事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="32603-109">In the [preceding tutorial](handling-bll-and-dal-level-exceptions-vb.md) we examined how to add exception handling code to the DataList s `UpdateCommand` event handler in order to catch and gracefully display information about any exceptions that were raised.</span></span> <span data-ttu-id="32603-110">在理想情況下，不過，編輯介面會包含驗證控制項，以防止使用者在第一次進入這類無效的資料。</span><span class="sxs-lookup"><span data-stu-id="32603-110">Ideally, however, the editing interface would include validation controls to prevent a user from entering such invalid data in the first place.</span></span>

<span data-ttu-id="32603-111">本教學課程中我們會看到驗證控制項加入 DataList s 是多麼的輕鬆`EditItemTemplate`為了提供更容易的編輯使用者介面。</span><span class="sxs-lookup"><span data-stu-id="32603-111">In this tutorial we'll see how easy it is to add validation controls to the DataList s `EditItemTemplate` in order to provide a more foolproof editing user interface.</span></span> <span data-ttu-id="32603-112">具體來說，本教學課程採用前述教學課程中建立的範例，並擴大要包含適當驗證的編輯介面。</span><span class="sxs-lookup"><span data-stu-id="32603-112">Specifically, this tutorial takes the example created in the preceding tutorial and augments the editing interface to include appropriate validation.</span></span>

## <a name="step-1-replicating-the-example-fromhandling-bll--and-dal-level-exceptionshandling-bll-and-dal-level-exceptions-vbmd"></a><span data-ttu-id="32603-113">步驟 1： 複製的範例中[BLL 和 DAL 層級例外狀況處理](handling-bll-and-dal-level-exceptions-vb.md)</span><span class="sxs-lookup"><span data-stu-id="32603-113">Step 1: Replicating the Example from[Handling BLL- and DAL-Level Exceptions](handling-bll-and-dal-level-exceptions-vb.md)</span></span>

<span data-ttu-id="32603-114">在[處理 BLL-以及 DAL 層級例外狀況](handling-bll-and-dal-level-exceptions-vb.md)教學課程中我們建立一個頁面，列出名稱及兩個資料行，可以編輯 DataList 中產品的價格。</span><span class="sxs-lookup"><span data-stu-id="32603-114">In the [Handling BLL- and DAL-Level Exceptions](handling-bll-and-dal-level-exceptions-vb.md) tutorial we created a page that listed the names and prices of the products in a two-column, editable DataList.</span></span> <span data-ttu-id="32603-115">我們在此教學課程的目標是以擴大 DataList s 編輯介面，包含驗證的控制項。</span><span class="sxs-lookup"><span data-stu-id="32603-115">Our goal for this tutorial is to augment the DataList s editing interface to include validation controls.</span></span> <span data-ttu-id="32603-116">特別是，我們將驗證邏輯將會：</span><span class="sxs-lookup"><span data-stu-id="32603-116">In particular, our validation logic will:</span></span>

- <span data-ttu-id="32603-117">需要提供產品的名稱</span><span class="sxs-lookup"><span data-stu-id="32603-117">Require that the product s name be provided</span></span>
- <span data-ttu-id="32603-118">請確定輸入的價格的值是有效的貨幣格式</span><span class="sxs-lookup"><span data-stu-id="32603-118">Ensure that the value entered for the price is a valid currency format</span></span>
- <span data-ttu-id="32603-119">請確認輸入的價格大於或等於零，因為為負數的值`UnitPrice`值是不合法</span><span class="sxs-lookup"><span data-stu-id="32603-119">Ensure that the value entered for the price is greater than or equal to zero, since a negative `UnitPrice` value is illegal</span></span>

<span data-ttu-id="32603-120">我們來看看加強先前的範例包括驗證之前，我們必須先將複寫的範例中`ErrorHandling.aspx`頁面`EditDeleteDataList`資料夾，以在此教學課程中，頁面`UIValidation.aspx`。</span><span class="sxs-lookup"><span data-stu-id="32603-120">Before we can look at augmenting the previous example to include validation, we first need to replicate the example from the `ErrorHandling.aspx` page in the `EditDeleteDataList` folder to the page for this tutorial, `UIValidation.aspx`.</span></span> <span data-ttu-id="32603-121">若要達成我們需要透過同時複製這`ErrorHandling.aspx`s 宣告式標記和其原始碼頁。</span><span class="sxs-lookup"><span data-stu-id="32603-121">To achieve this we need to copy over both the `ErrorHandling.aspx` page s declarative markup and its source code.</span></span> <span data-ttu-id="32603-122">第一次複製的宣告式標記執行下列步驟：</span><span class="sxs-lookup"><span data-stu-id="32603-122">First copy over the declarative markup by performing the following steps:</span></span>

1. <span data-ttu-id="32603-123">開啟`ErrorHandling.aspx`Visual Studio 中的頁面</span><span class="sxs-lookup"><span data-stu-id="32603-123">Open the `ErrorHandling.aspx` page in Visual Studio</span></span>
2. <span data-ttu-id="32603-124">請移至頁面 s 宣告式標記 （在頁面底部的 [來源] 按鈕按一下）</span><span class="sxs-lookup"><span data-stu-id="32603-124">Go to the page s declarative markup (click on the Source button at the bottom of the page)</span></span>
3. <span data-ttu-id="32603-125">複製內的文字`<asp:Content>`和`</asp:Content>`圖 1 為標記 （線條 3 到 32）。</span><span class="sxs-lookup"><span data-stu-id="32603-125">Copy the text within the `<asp:Content>` and `</asp:Content>` tags (lines 3 through 32), as shown in Figure 1.</span></span>


<span data-ttu-id="32603-126">[![複製文字內&lt;asp: Content&gt;控制項](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image2.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="32603-126">[![Copy the Text Within the &lt;asp:Content&gt; Control](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image2.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image1.png)</span></span>

<span data-ttu-id="32603-127">**圖 2**： 複製文字內`<asp:Content>`控制項 ([按一下以檢視完整大小的影像](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="32603-127">**Figure 2**: Copy the Text Within the `<asp:Content>` Control ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image3.png))</span></span>


1. <span data-ttu-id="32603-128">開啟`UIValidation.aspx`頁面</span><span class="sxs-lookup"><span data-stu-id="32603-128">Open the `UIValidation.aspx` page</span></span>
2. <span data-ttu-id="32603-129">請移至頁面 s 宣告式標記</span><span class="sxs-lookup"><span data-stu-id="32603-129">Go to the page s declarative markup</span></span>
3. <span data-ttu-id="32603-130">貼上文字內`<asp:Content>`控制項。</span><span class="sxs-lookup"><span data-stu-id="32603-130">Paste the text within the `<asp:Content>` control.</span></span>

<span data-ttu-id="32603-131">若要複製的原始碼，開啟`ErrorHandling.aspx.vb`頁面上，並將複製文字*內*`EditDeleteDataList_ErrorHandling`類別。</span><span class="sxs-lookup"><span data-stu-id="32603-131">To copy over the source code, open the `ErrorHandling.aspx.vb` page and copy just the text *within* the `EditDeleteDataList_ErrorHandling` class.</span></span> <span data-ttu-id="32603-132">複製的三個事件處理常式 (`Products_EditCommand`， `Products_CancelCommand`，和`Products_UpdateCommand`) 連同`DisplayExceptionDetails`方法，但不要**不**複製類別宣告或`using`陳述式。</span><span class="sxs-lookup"><span data-stu-id="32603-132">Copy the three event handlers (`Products_EditCommand`, `Products_CancelCommand`, and `Products_UpdateCommand`) along with the `DisplayExceptionDetails` method, but do **not** copy the class declaration or `using` statements.</span></span> <span data-ttu-id="32603-133">貼上複製的文字*內*`EditDeleteDataList_UIValidation`類別`UIValidation.aspx.vb`。</span><span class="sxs-lookup"><span data-stu-id="32603-133">Paste the copied text *within* the `EditDeleteDataList_UIValidation` class in `UIValidation.aspx.vb`.</span></span>

<span data-ttu-id="32603-134">透過內容和程式碼移動之後`ErrorHandling.aspx`至`UIValidation.aspx`，花一點時間，若要測試的瀏覽器中的頁面。</span><span class="sxs-lookup"><span data-stu-id="32603-134">After moving over the content and code from `ErrorHandling.aspx` to `UIValidation.aspx`, take a moment to test out the pages in a browser.</span></span> <span data-ttu-id="32603-135">您應該會看到相同的輸出及體驗中每個網頁 （請參閱圖 2） 兩個相同的功能。</span><span class="sxs-lookup"><span data-stu-id="32603-135">You should see the same output and experience the same functionality in each of these two pages (see Figure 2).</span></span>


<span data-ttu-id="32603-136">[![UIValidation.aspx 頁面都是模仿 ErrorHandling.aspx 中的功能](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image5.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="32603-136">[![The UIValidation.aspx Page Mimics the Functionality in ErrorHandling.aspx](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image5.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image4.png)</span></span>

<span data-ttu-id="32603-137">**圖 2**:`UIValidation.aspx`頁面模擬中的功能`ErrorHandling.aspx`([按一下以檢視完整大小的影像](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="32603-137">**Figure 2**: The `UIValidation.aspx` Page Mimics the Functionality in `ErrorHandling.aspx` ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image6.png))</span></span>


## <a name="step-2-adding-the-validation-controls-to-the-datalist-s-edititemtemplate"></a><span data-ttu-id="32603-138">步驟 2： 將驗證控制項加入至 DataList 的 EditItemTemplate</span><span class="sxs-lookup"><span data-stu-id="32603-138">Step 2: Adding the Validation Controls to the DataList s EditItemTemplate</span></span>

<span data-ttu-id="32603-139">建構資料輸入表單時, 很重要，使用者輸入任何必要的欄位和所有其提供的輸入是合法、 格式正確的值。</span><span class="sxs-lookup"><span data-stu-id="32603-139">When constructing data entry forms, it is important that users enter any required fields and that all their provided inputs are legal, properly-formatted values.</span></span> <span data-ttu-id="32603-140">為協助確保使用者的輸入有效值，ASP.NET 會提供五個內建的驗證控制項，設計來驗證單一輸入 Web 控制項的值：</span><span class="sxs-lookup"><span data-stu-id="32603-140">To help ensure that a user s inputs are valid, ASP.NET provides five built-in validation controls that are designed to validate the value of a single input Web control:</span></span>

- <span data-ttu-id="32603-141">[RequiredFieldValidator](https://msdn.microsoft.com/library/5hbw267h(VS.80).aspx)可確保已提供的值</span><span class="sxs-lookup"><span data-stu-id="32603-141">[RequiredFieldValidator](https://msdn.microsoft.com/library/5hbw267h(VS.80).aspx) ensures that a value has been provided</span></span>
- <span data-ttu-id="32603-142">[CompareValidator](https://msdn.microsoft.com/library/db330ayw(VS.80).aspx)驗證值與另一個 Web 控制項值或常數的值，或確保值的格式不合法的指定的資料型別</span><span class="sxs-lookup"><span data-stu-id="32603-142">[CompareValidator](https://msdn.microsoft.com/library/db330ayw(VS.80).aspx) validates a value against another Web control value or a constant value, or ensures that the value s format is legal for a specified data type</span></span>
- <span data-ttu-id="32603-143">[RangeValidator](https://msdn.microsoft.com/library/f70d09xt.aspx)確保值的值範圍內</span><span class="sxs-lookup"><span data-stu-id="32603-143">[RangeValidator](https://msdn.microsoft.com/library/f70d09xt.aspx) ensures that a value is within a range of values</span></span>
- <span data-ttu-id="32603-144">[RegularExpressionValidator](https://msdn.microsoft.com/library/eahwtc9e.aspx)驗證值，以針對[規則運算式](http://en.wikipedia.org/wiki/Regular_expression)</span><span class="sxs-lookup"><span data-stu-id="32603-144">[RegularExpressionValidator](https://msdn.microsoft.com/library/eahwtc9e.aspx) validates a value against a [regular expression](http://en.wikipedia.org/wiki/Regular_expression)</span></span>
- <span data-ttu-id="32603-145">[一起](https://msdn.microsoft.com/library/9eee01cx(VS.80).aspx)驗證值，以符合自訂的使用者定義的方法</span><span class="sxs-lookup"><span data-stu-id="32603-145">[CustomValidator](https://msdn.microsoft.com/library/9eee01cx(VS.80).aspx) validates a value against a custom, user-defined method</span></span>

<span data-ttu-id="32603-146">如需有關這些五個控制項回頭參考[新增驗證控制項的編輯和插入介面](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md)教學課程或簽出[驗證控制項 」 一節](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/validation/default.aspx)的[ASP.NET 快速入門教學課程](https://quickstarts.asp.net)。</span><span class="sxs-lookup"><span data-stu-id="32603-146">For more information on these five controls refer back to the [Adding Validation Controls to the Editing and Inserting Interfaces](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md) tutorial or check out the [Validation Controls section](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/validation/default.aspx) of the [ASP.NET Quickstart Tutorials](https://quickstarts.asp.net).</span></span>

<span data-ttu-id="32603-147">在教學課程中我們需要使用以確保產品名稱的值已提供 RequiredFieldValidator 和 CompareValidator 以確保輸入的價格大於或等於 0 的值，而且會以正確的貨幣格式顯示。</span><span class="sxs-lookup"><span data-stu-id="32603-147">For our tutorial we'll need to use a RequiredFieldValidator to ensure that a value for the product name has been supplied and a CompareValidator to ensure that the entered price has a value greater than or equal to 0 and is presented in a valid currency format.</span></span>

> [!NOTE]
> <span data-ttu-id="32603-148">雖然 ASP.NET 1.x 具有這些相同的五個驗證控制項、 ASP.NET 2.0 已新增許多改進功能、 主要的用戶端指令碼的兩個支援除了 Internet Explorer 的瀏覽器和到頁面上的資料分割驗證控制項的功能驗證群組。</span><span class="sxs-lookup"><span data-stu-id="32603-148">While ASP.NET 1.x had these same five validation controls, ASP.NET 2.0 has added a number of improvements, the main two being client-side script support for browsers in addition to Internet Explorer and the ability to partition validation controls on a page into validation groups.</span></span> <span data-ttu-id="32603-149">如需 2.0 中的新驗證控制項功能的詳細資訊，請參閱[將 ASP.NET 2.0 中的驗證控制項的分解](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx)。</span><span class="sxs-lookup"><span data-stu-id="32603-149">For more information on the new validation control features in 2.0, refer to [Dissecting the Validation Controls in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx).</span></span>


<span data-ttu-id="32603-150">可讓啟動必要的驗證控制項加入 DataList s s `EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="32603-150">Let s start by adding the necessary validation controls to the DataList s `EditItemTemplate`.</span></span> <span data-ttu-id="32603-151">透過設計工具，依序按一下 [編輯樣板] 連結，從 DataList s 智慧標籤，或透過宣告式語法，可以執行這項工作。</span><span class="sxs-lookup"><span data-stu-id="32603-151">This task can be performed through the Designer by clicking on the Edit Templates link from the DataList s smart tag, or through the declarative syntax.</span></span> <span data-ttu-id="32603-152">可讓 s 步驟透過使用 [編輯樣板] 選項，從 [設計] 檢視的程序。</span><span class="sxs-lookup"><span data-stu-id="32603-152">Let s step through the process using the Edit Templates option from the Design view.</span></span> <span data-ttu-id="32603-153">選擇編輯 DataList s 後`EditItemTemplate`，將它從 [工具箱] 拖曳至範本編輯介面，加入 RequiredFieldValidator 放之後`ProductName`文字方塊。</span><span class="sxs-lookup"><span data-stu-id="32603-153">After choosing to edit the DataList s `EditItemTemplate`, add a RequiredFieldValidator by dragging it from the Toolbox into the template editing interface, placing it after the `ProductName` TextBox.</span></span>


<span data-ttu-id="32603-154">[![[ProductName] 文字方塊中之後，新增至 EditItemTemplate 的 RequiredFieldValidator](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image8.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="32603-154">[![Add a RequiredFieldValidator to the EditItemTemplate After the ProductName TextBox](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image8.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image7.png)</span></span>

<span data-ttu-id="32603-155">**圖 3**： 新增至 RequiredFieldValidator `EditItemTemplate After` `ProductName`文字方塊中 ([按一下以檢視完整大小的影像](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="32603-155">**Figure 3**: Add a RequiredFieldValidator to the `EditItemTemplate After` the `ProductName` TextBox ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image9.png))</span></span>


<span data-ttu-id="32603-156">所有驗證控制項的都運作方式驗證單一 ASP.NET Web 控制項的輸入。</span><span class="sxs-lookup"><span data-stu-id="32603-156">All validation controls work by validating the input of a single ASP.NET Web control.</span></span> <span data-ttu-id="32603-157">因此，我們需要表示我們剛才加入的 RequiredFieldValidator 應該驗證`ProductName`文字方塊中; 這是藉由設定驗證控制項 s [ `ControlToValidate`屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.controltovalidate(VS.80).aspx)至`ID`的適當的 Web 控制項 (`ProductName`，這個執行個體中)。</span><span class="sxs-lookup"><span data-stu-id="32603-157">Therefore, we need to indicate that the RequiredFieldValidator we just added should validate against the `ProductName` TextBox; this is done by setting the validation control s [`ControlToValidate` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.controltovalidate(VS.80).aspx) to the `ID` of the appropriate Web control (`ProductName`, in this instance).</span></span> <span data-ttu-id="32603-158">接下來，設定[`ErrorMessage`屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.errormessage(VS.80).aspx)您必須提供的產品的名稱和[`Text`屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.text(VS.80).aspx)至\*。</span><span class="sxs-lookup"><span data-stu-id="32603-158">Next, set the [`ErrorMessage` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.errormessage(VS.80).aspx) to You must provide the product s name and the [`Text` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.text(VS.80).aspx) to \*.</span></span> <span data-ttu-id="32603-159">`Text`屬性值，如果提供，是在驗證失敗時，會將驗證控制項所顯示的文字。</span><span class="sxs-lookup"><span data-stu-id="32603-159">The `Text` property value, if provided, is the text that is displayed by the validation control if the validation fails.</span></span> <span data-ttu-id="32603-160">`ErrorMessage`屬性值，這是必要的由 ValidationSummary 控制項; 如果`Text`省略屬性值，則`ErrorMessage`屬性值會顯示無效的輸入上的驗證控制項。</span><span class="sxs-lookup"><span data-stu-id="32603-160">The `ErrorMessage` property value, which is required, is used by the ValidationSummary control; if the `Text` property value is omitted, the `ErrorMessage` property value is displayed by the validation control on invalid input.</span></span>

<span data-ttu-id="32603-161">設定後的 RequiredFieldValidator 這三個屬性，請您的畫面看起來應該類似於圖 4。</span><span class="sxs-lookup"><span data-stu-id="32603-161">After setting these three properties of the RequiredFieldValidator, your screen should look similar to Figure 4.</span></span>


<span data-ttu-id="32603-162">[![設定 RequiredFieldValidator 的 ControlToValidate、 錯誤訊息，以及文字屬性](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image11.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="32603-162">[![Set the RequiredFieldValidator s ControlToValidate, ErrorMessage, and Text Properties](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image11.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image10.png)</span></span>

<span data-ttu-id="32603-163">**圖 4**： 設定 RequiredFieldValidator s `ControlToValidate`， `ErrorMessage`，和`Text`屬性 ([按一下以檢視完整大小的影像](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="32603-163">**Figure 4**: Set the RequiredFieldValidator s `ControlToValidate`, `ErrorMessage`, and `Text` Properties ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image12.png))</span></span>


<span data-ttu-id="32603-164">與加入 RequiredFieldValidator `EditItemTemplate`，則所有剩下是加入必要的驗證產品 s 價格文字方塊。</span><span class="sxs-lookup"><span data-stu-id="32603-164">With the RequiredFieldValidator added to the `EditItemTemplate`, all that remains is to add the necessary validation for the product s price TextBox.</span></span> <span data-ttu-id="32603-165">因為`UnitPrice`是選擇性的編輯時記錄，我們不 t 需要加入 RequiredFieldValidator。</span><span class="sxs-lookup"><span data-stu-id="32603-165">Since the `UnitPrice` is optional when editing a record, we don t need to add a RequiredFieldValidator.</span></span> <span data-ttu-id="32603-166">我們，不過，需要手動新增，確保 CompareValidator `UnitPrice`，提供，如果已正確格式化為貨幣，且大於或等於 0。</span><span class="sxs-lookup"><span data-stu-id="32603-166">We do, however, need to add a CompareValidator to ensure that the `UnitPrice`, if supplied, is properly formatted as a currency and is greater than or equal to 0.</span></span>

<span data-ttu-id="32603-167">新增到 CompareValidator`EditItemTemplate`並設定其`ControlToValidate`屬性`UnitPrice`、 其`ErrorMessage`價格屬性必須是大於或等於零，而且不能包含貨幣符號，且其`Text`屬性\*.</span><span class="sxs-lookup"><span data-stu-id="32603-167">Add the CompareValidator into the `EditItemTemplate` and set its `ControlToValidate` property to `UnitPrice`, its `ErrorMessage` property to The price must be greater than or equal to zero and cannot include the currency symbol, and its `Text` property to \*.</span></span> <span data-ttu-id="32603-168">表示`UnitPrice`值必須是大於或等於 0，且設定 CompareValidator s [ `Operator`屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.operator(VS.80).aspx)至`GreaterThanEqual`、 其[`ValueToCompare`屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.valuetocompare(VS.80).aspx)為 0，並其[`Type`屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basecomparevalidator.type.aspx)至`Currency`。</span><span class="sxs-lookup"><span data-stu-id="32603-168">To indicate that the `UnitPrice` value must be greater than or equal to 0, set the CompareValidator s [`Operator` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.operator(VS.80).aspx) to `GreaterThanEqual`, its [`ValueToCompare` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.valuetocompare(VS.80).aspx) to 0, and its [`Type` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basecomparevalidator.type.aspx) to `Currency`.</span></span>

<span data-ttu-id="32603-169">新增這些兩個驗證控制項中，DataList s 後`EditItemTemplate`s 宣告式語法看起來應該類似下列：</span><span class="sxs-lookup"><span data-stu-id="32603-169">After adding these two validation controls, the DataList s `EditItemTemplate` s declarative syntax should look similar to the following:</span></span>


[!code-aspx[Main](adding-validation-controls-to-the-datalist-s-editing-interface-vb/samples/sample1.aspx)]

<span data-ttu-id="32603-170">進行這些變更之後，請在瀏覽器中開啟頁面。</span><span class="sxs-lookup"><span data-stu-id="32603-170">After making these changes, open the page in a browser.</span></span> <span data-ttu-id="32603-171">如果您嘗試以省略名稱，或輸入無效的價格值編輯產品時，則會在文字方塊旁邊出現星號。</span><span class="sxs-lookup"><span data-stu-id="32603-171">If you attempt to omit the name or enter an invalid price value when editing a product, an asterisk appears next to the textbox.</span></span> <span data-ttu-id="32603-172">如圖 5 所示，包含貨幣符號，例如 $19.95 的價格值會被視為無效。</span><span class="sxs-lookup"><span data-stu-id="32603-172">As Figure 5 shows, a price value that includes the currency symbol such as $19.95 is considered invalid.</span></span> <span data-ttu-id="32603-173">CompareValidator s `Currency` `Type`允許 （例如逗號或句號，根據文化特性設定而定） 的數字分隔符號的開頭的加號或減號，但是沒有*不*允許貨幣符號。</span><span class="sxs-lookup"><span data-stu-id="32603-173">The CompareValidator s `Currency` `Type` allows for digit separators (such as commas or periods, depending on the culture settings) and a leading plus or minus sign, but does *not* permit a currency symbol.</span></span> <span data-ttu-id="32603-174">這種行為可能 perplex 使用者編輯介面目前轉譯`UnitPrice`使用貨幣格式。</span><span class="sxs-lookup"><span data-stu-id="32603-174">This behavior may perplex users as the editing interface currently renders the `UnitPrice` using the currency format.</span></span>


<span data-ttu-id="32603-175">[![具有無效的輸入的文字方塊旁邊出現星號](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image14.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="32603-175">[![An Asterisk Appears Next to the Textboxes with Invalid Input](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image14.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image13.png)</span></span>

<span data-ttu-id="32603-176">**圖 5**: 星號會顯示下一步 以無效的輸入的文字方塊 ([按一下以檢視完整大小的影像](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="32603-176">**Figure 5**: An Asterisk Appears Next to the Textboxes with Invalid Input ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image15.png))</span></span>


<span data-ttu-id="32603-177">雖然做為驗證運作的方式-就是，使用者必須手動編輯記錄，這不是可接受時，移除的貨幣符號。</span><span class="sxs-lookup"><span data-stu-id="32603-177">While the validation works as-is, the user has to manually remove the currency symbol when editing a record, which is not acceptable.</span></span> <span data-ttu-id="32603-178">此外，如果無效輸入中編輯介面都沒有更新或 [取消] 按鈕時，按下時，將會叫用回傳。</span><span class="sxs-lookup"><span data-stu-id="32603-178">Moreover, if there are invalid inputs in the editing interface neither the Update nor Cancel buttons, when clicked, will invoke a postback.</span></span> <span data-ttu-id="32603-179">在理想情況下，[取消] 按鈕就會回到 DataList 其預先編輯的狀態，不論使用者的輸入的有效性。</span><span class="sxs-lookup"><span data-stu-id="32603-179">Ideally, the Cancel button would return the DataList to its pre-editing state regardless of the validity of the user s inputs.</span></span> <span data-ttu-id="32603-180">此外，我們需要確保頁面的資料是否有效，然後再更新產品中的資訊 DataList 的`UpdateCommand`做為用戶端邏輯可以由使用者的瀏覽器不支援 JavaScript，或已略過驗證控制項的事件處理常式，停用的支援。</span><span class="sxs-lookup"><span data-stu-id="32603-180">Also, we need to ensure that the page s data is valid before updating the product information in the DataList s `UpdateCommand` event handler, as the validation controls client-side logic can be bypassed by users whose browsers either don t support JavaScript or have its support disabled.</span></span>

## <a name="removing-the-currency-symbol-from-the-edititemtemplate-s-unitprice-textbox"></a><span data-ttu-id="32603-181">移除 EditItemTemplate 的 UnitPrice 文字方塊中的貨幣符號</span><span class="sxs-lookup"><span data-stu-id="32603-181">Removing the Currency Symbol from the EditItemTemplate s UnitPrice TextBox</span></span>

<span data-ttu-id="32603-182">當使用 CompareValidator 的`Currency``Type`，正在驗證的輸入不能包含任何貨幣符號。</span><span class="sxs-lookup"><span data-stu-id="32603-182">When using the CompareValidator s `Currency``Type`, the input being validated must not include any currency symbols.</span></span> <span data-ttu-id="32603-183">這類符號存在，會導致將標示為無效的輸入 CompareValidator。</span><span class="sxs-lookup"><span data-stu-id="32603-183">The presence of such symbols causes the CompareValidator to mark the input as invalid.</span></span> <span data-ttu-id="32603-184">不過，我們編輯介面目前包含中的貨幣符號`UnitPrice`文字方塊中，這表示使用者必須明確地移除之前將其變更的貨幣符號。</span><span class="sxs-lookup"><span data-stu-id="32603-184">However, our editing interface currently includes a currency symbol in the `UnitPrice` TextBox, meaning the user must explicitly remove the currency symbol before saving their changes.</span></span> <span data-ttu-id="32603-185">若要補救這種情況中，我們有三個選項：</span><span class="sxs-lookup"><span data-stu-id="32603-185">To remedy this we have three options:</span></span>

1. <span data-ttu-id="32603-186">設定`EditItemTemplate`以便`UnitPrice`TextBox 值不格式化為貨幣。</span><span class="sxs-lookup"><span data-stu-id="32603-186">Configure the `EditItemTemplate` so that the `UnitPrice` TextBox value is not formatted as a currency.</span></span>
2. <span data-ttu-id="32603-187">可讓使用者藉由移除 CompareValidator 取代會檢查有格式正確的貨幣值 RegularExpressionValidator 輸入貨幣符號。</span><span class="sxs-lookup"><span data-stu-id="32603-187">Allow the user to enter a currency symbol by removing the CompareValidator and replacing it with a RegularExpressionValidator that checks for a properly formatted currency value.</span></span> <span data-ttu-id="32603-188">此處的挑戰是要驗證之貨幣值的規則運算式不像是那樣 CompareValidator 和需要撰寫程式碼，如果我們想要納入的文化特性設定。</span><span class="sxs-lookup"><span data-stu-id="32603-188">The challenge here is that the regular expression to validate a currency value is not as straightforward as the CompareValidator and would require writing code if we wanted to incorporate culture settings.</span></span>
3. <span data-ttu-id="32603-189">完全移除驗證控制項，而且依賴 GridView s 中的自訂伺服器端驗證邏輯`RowUpdating`事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="32603-189">Remove the validation control altogether and rely on custom server-side validation logic in the GridView s `RowUpdating` event handler.</span></span>

<span data-ttu-id="32603-190">可讓 s 隨附此教學課程中的選項 1。</span><span class="sxs-lookup"><span data-stu-id="32603-190">Let s go with option 1 for this tutorial.</span></span> <span data-ttu-id="32603-191">目前`UnitPrice`格式化為貨幣值，因為在文字方塊中的資料繫結運算式`EditItemTemplate`: `<%# Eval("UnitPrice", "{0:c}") %>`。</span><span class="sxs-lookup"><span data-stu-id="32603-191">Currently the `UnitPrice` is formatted as a currency value due to the databinding expression for the TextBox in the `EditItemTemplate`: `<%# Eval("UnitPrice", "{0:c}") %>`.</span></span> <span data-ttu-id="32603-192">變更`Eval`陳述式來`Eval("UnitPrice", "{0:n2}")`，它將結果格式化為兩位數的有效位數的數字。</span><span class="sxs-lookup"><span data-stu-id="32603-192">Change the `Eval` statement to `Eval("UnitPrice", "{0:n2}")`, which formats the result as a number with two digits of precision.</span></span> <span data-ttu-id="32603-193">這可以透過宣告式語法直接或按一下 [編輯資料繫結] 連結，從完成`UnitPrice`DataList s 中的 TextBox `EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="32603-193">This can be done directly through the declarative syntax or by clicking on the Edit DataBindings link from the `UnitPrice` TextBox in the DataList s `EditItemTemplate`.</span></span>

<span data-ttu-id="32603-194">這項變更，編輯介面中的格式化的價格包含做為群組分隔符號逗號和句號當做十進位分隔符號，但離開關閉貨幣符號。</span><span class="sxs-lookup"><span data-stu-id="32603-194">With this change, the formatted price in the editing interface includes commas as the group separator and a period as the decimal separator, but leaves off the currency symbol.</span></span>

> [!NOTE]
> <span data-ttu-id="32603-195">當從可編輯介面移除貨幣格式，我發現很有幫助將貨幣符號為外部文字方塊的文字。</span><span class="sxs-lookup"><span data-stu-id="32603-195">When removing the currency format from the editable interface, I find it helpful to put the currency symbol as text outside the TextBox.</span></span> <span data-ttu-id="32603-196">這可做為提示使用者，他們不需要提供貨幣符號。</span><span class="sxs-lookup"><span data-stu-id="32603-196">This serves as a hint to the user that they do not need to provide the currency symbol.</span></span>


## <a name="fixing-the-cancel-button"></a><span data-ttu-id="32603-197">修正 [取消] 按鈕</span><span class="sxs-lookup"><span data-stu-id="32603-197">Fixing the Cancel Button</span></span>

<span data-ttu-id="32603-198">根據預設，驗證 Web 控制項發出 JavaScript 用戶端上執行驗證。</span><span class="sxs-lookup"><span data-stu-id="32603-198">By default, the validation Web controls emit JavaScript to perform validation on the client-side.</span></span> <span data-ttu-id="32603-199">按一下按鈕、 LinkButton 或 ImageButton 時，會發生回傳之前，先檢查驗證控制項在頁面上用戶端。</span><span class="sxs-lookup"><span data-stu-id="32603-199">When a Button, LinkButton, or ImageButton is clicked, the validation controls on the page are checked on the client-side before the postback occurs.</span></span> <span data-ttu-id="32603-200">如果沒有任何無效的資料，則會取消回傳。</span><span class="sxs-lookup"><span data-stu-id="32603-200">If there is any invalid data, the postback is cancelled.</span></span> <span data-ttu-id="32603-201">某些按鈕，不過，資料的有效性可能多少都沒關係。在這種情況下，因為無效的資料而取消回傳是來進行騷擾。</span><span class="sxs-lookup"><span data-stu-id="32603-201">For certain Buttons, though, the validity of the data might be immaterial; in such a case, having the postback cancelled due to invalid data is a nuisance.</span></span>

<span data-ttu-id="32603-202">[取消] 按鈕是這類範例。</span><span class="sxs-lookup"><span data-stu-id="32603-202">The Cancel button is such an example.</span></span> <span data-ttu-id="32603-203">想像一下，使用者輸入無效的資料，例如省略 s 產品名稱，然後決定她不想要在所有儲存產品並點擊 [取消] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="32603-203">Imagine that a user enters invalid data, such as omitting the product s name, and then decides she doesn t want to save the product after all and hits the Cancel button.</span></span> <span data-ttu-id="32603-204">目前，[取消] 按鈕會觸發驗證控制項在頁面上，執行中的報表產品名稱遺漏，防止回傳。</span><span class="sxs-lookup"><span data-stu-id="32603-204">Currently, the Cancel button triggers the validation controls on the page, which report that the product name is missing and prevent the postback.</span></span> <span data-ttu-id="32603-205">我們的使用者可以輸入一些文字到`ProductName`文字方塊中，只是為了取消編輯程序。</span><span class="sxs-lookup"><span data-stu-id="32603-205">Our user has to type some text into the `ProductName` TextBox just to cancel out of the editing process.</span></span>

<span data-ttu-id="32603-206">幸運的是，按鈕、 LinkButton 和 ImageButton 已[`CausesValidation`屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.button.causesvalidation.aspx)，可以指出是否按一下按鈕應該起始驗證邏輯 (預設值為`True`)。</span><span class="sxs-lookup"><span data-stu-id="32603-206">Fortunately, the Button, LinkButton, and ImageButton have a [`CausesValidation` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.button.causesvalidation.aspx) that can indicate whether or not clicking the Button should initiate the validation logic (defaults to `True`).</span></span> <span data-ttu-id="32603-207">設定 [取消] 按鈕 s`CausesValidation`屬性`False`。</span><span class="sxs-lookup"><span data-stu-id="32603-207">Set the Cancel Button s `CausesValidation` property to `False`.</span></span>

## <a name="ensuring-the-inputs-are-valid-in-the-updatecommand-event-handler"></a><span data-ttu-id="32603-208">確保輸入都有效 UpdateCommand 的事件處理常式</span><span class="sxs-lookup"><span data-stu-id="32603-208">Ensuring the Inputs are Valid in the UpdateCommand Event Handler</span></span>

<span data-ttu-id="32603-209">因為驗證控制項中，所發出的用戶端指令碼如果使用者輸入無效的輸入驗證控制項取消按鈕，LinkButton，由起始任何回傳或 ImageButton 控制其`CausesValidation`屬性`True`(預設值）。</span><span class="sxs-lookup"><span data-stu-id="32603-209">Due to the client-side script emitted by the validation controls, if a user enters invalid input the validation controls cancel any postbacks initiated by Button, LinkButton, or ImageButton controls whose `CausesValidation` properties are `True` (the default).</span></span> <span data-ttu-id="32603-210">不過，如果使用者造訪用的瀏覽器或其中一個已停用其 JavaScript 支援時，不會執行的用戶端驗證檢查。</span><span class="sxs-lookup"><span data-stu-id="32603-210">However, if a user is visiting with an antiquated browser or one whose JavaScript support has been disabled, the client-side validation checks will not execute.</span></span>

<span data-ttu-id="32603-211">ASP.NET 驗證控制項的所有重複回傳時立即其驗證邏輯，並報告整體透過頁輸入的有效性[`Page.IsValid`屬性](https://msdn.microsoft.com/library/system.web.ui.page.isvalid.aspx)。</span><span class="sxs-lookup"><span data-stu-id="32603-211">All of the ASP.NET validation controls repeat their validation logic immediately upon postback and report the overall validity of the page s inputs via the [`Page.IsValid` property](https://msdn.microsoft.com/library/system.web.ui.page.isvalid.aspx).</span></span> <span data-ttu-id="32603-212">不過，未中斷或停止任何方式為基礎的值頁面流程`Page.IsValid`。</span><span class="sxs-lookup"><span data-stu-id="32603-212">However, the page flow is not interrupted or stopped in any way based on the value of `Page.IsValid`.</span></span> <span data-ttu-id="32603-213">身為開發人員，負責我們確定`Page.IsValid`屬性的值為`True`之前繼續執行程式碼假設有效輸入資料。</span><span class="sxs-lookup"><span data-stu-id="32603-213">As developers, it is our responsibility to ensure that the `Page.IsValid` property has a value of `True` before proceeding with code that assumes valid input data.</span></span>

<span data-ttu-id="32603-214">如果使用者已停用 JavaScript，造訪我們的頁面，編輯產品，進入價格的值太昂貴，並按一下 [更新] 按鈕，將會略過用戶端驗證，並將發生回傳。</span><span class="sxs-lookup"><span data-stu-id="32603-214">If a user has JavaScript disabled, visits our page, edits a product, enters a price value of Too expensive, and clicks the Update button, the client-side validation will be bypassed and a postback will ensue.</span></span> <span data-ttu-id="32603-215">在回傳時，ASP.NET 頁面 s`UpdateCommand`執行事件處理常式，並嘗試剖析太時引發例外狀況，是相當費時`Decimal`。</span><span class="sxs-lookup"><span data-stu-id="32603-215">On postback, the ASP.NET page s `UpdateCommand` event handler executes and an exception is raised when attempting to parse Too expensive to a `Decimal`.</span></span> <span data-ttu-id="32603-216">因為我們有例外狀況處理，會依正常程序，處理這類例外狀況，不過就可以防止無效的資料在由只能繼續使用在第一次機會通過`UpdateCommand`事件處理常式如果`Page.IsValid`的值為`True`。</span><span class="sxs-lookup"><span data-stu-id="32603-216">Since we have exception handling, such an exception will be handled gracefully, but we could prevent the invalid data from slipping through in the first place by only proceeding with the `UpdateCommand` event handler if `Page.IsValid` has a value of `True`.</span></span>

<span data-ttu-id="32603-217">開頭加入下列程式碼`UpdateCommand`事件處理常式之前，立即`Try`區塊：</span><span class="sxs-lookup"><span data-stu-id="32603-217">Add the following code to the start of the `UpdateCommand` event handler, immediately before the `Try` block:</span></span>


[!code-vb[Main](adding-validation-controls-to-the-datalist-s-editing-interface-vb/samples/sample2.vb)]

<span data-ttu-id="32603-218">與此新增功能，產品會嘗試送出的資料無效時，才會更新。</span><span class="sxs-lookup"><span data-stu-id="32603-218">With this addition, the product will attempt to be updated only if the submitted data is valid.</span></span> <span data-ttu-id="32603-219">贏了 t 的大部分使用者都可以回傳無效的資料，因為驗證控制項的用戶端指令碼，但使用者的瀏覽器不支援 JavaScript，或有支援的 JavaScript 停用，可以略過用戶端檢查和送出無效的資料。</span><span class="sxs-lookup"><span data-stu-id="32603-219">Most users won t be able to postback invalid data due to the validation controls client-side scripts, but users whose browsers don t support JavaScript or that have JavaScript support disabled, can bypass the client-side checks and submit invalid data.</span></span>

> [!NOTE]
> <span data-ttu-id="32603-220">GridView 中使用更新資料時，精明讀取器可以回想，我們 professionals t 需要明確檢查`Page.IsValid`我們頁面 s 程式碼後置類別中的屬性。</span><span class="sxs-lookup"><span data-stu-id="32603-220">The astute reader will recall that when updating data with the GridView, we didn t need to explicitly check the `Page.IsValid` property in our page s code-behind class.</span></span> <span data-ttu-id="32603-221">這是因為 GridView 參照`Page.IsValid`屬性，並繼續更新才會傳回值`True`。</span><span class="sxs-lookup"><span data-stu-id="32603-221">This is because the GridView consults the `Page.IsValid` property for us and only proceeds with the update only if it returns a value of `True`.</span></span>


## <a name="step-3-summarizing-data-entry-problems"></a><span data-ttu-id="32603-222">步驟 3： 摘要資料輸入問題</span><span class="sxs-lookup"><span data-stu-id="32603-222">Step 3: Summarizing Data Entry Problems</span></span>

<span data-ttu-id="32603-223">除了五個驗證控制項，包含 ASP.NET [ValidationSummary 控制項](https://msdn.microsoft.com/library/f9h59855(VS.80).aspx)，用來顯示`ErrorMessage`之偵測到無效的資料，這些驗證控制項。</span><span class="sxs-lookup"><span data-stu-id="32603-223">In addition to the five validation controls, ASP.NET includes the [ValidationSummary control](https://msdn.microsoft.com/library/f9h59855(VS.80).aspx), which displays the `ErrorMessage` s of those validation controls that detected invalid data.</span></span> <span data-ttu-id="32603-224">此摘要的資料可以顯示為網頁上或透過強制回應，用戶端的訊息方塊的文字。</span><span class="sxs-lookup"><span data-stu-id="32603-224">This summary data can be displayed as text on the web page or through a modal, client-side messagebox.</span></span> <span data-ttu-id="32603-225">可讓 s 強化這個教學課程，包括用戶端 messagebox 摘要的任何驗證問題。</span><span class="sxs-lookup"><span data-stu-id="32603-225">Let s enhance this tutorial to include a client-side messagebox summarizing any validation problems.</span></span>

<span data-ttu-id="32603-226">若要達成此目的，拖曳到 ValidationSummary 控制項從 [工具箱] 拖曳至設計工具。</span><span class="sxs-lookup"><span data-stu-id="32603-226">To accomplish this, drag a ValidationSummary control from the Toolbox onto the Designer.</span></span> <span data-ttu-id="32603-227">ValidationSummary 控制項規定 t 位置真的很重要，因為我們重新打算將它設定為只顯示摘要為 messagebox。</span><span class="sxs-lookup"><span data-stu-id="32603-227">The location of the ValidationSummary control doesn t really matter, since we re going to configure it to only display the summary as a messagebox.</span></span> <span data-ttu-id="32603-228">加入控制項之後, 設定其[`ShowSummary`屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showsummary(VS.80).aspx)至`False`及其[`ShowMessageBox`屬性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showmessagebox(VS.80).aspx)至`True`。</span><span class="sxs-lookup"><span data-stu-id="32603-228">After adding the control, set its [`ShowSummary` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showsummary(VS.80).aspx) to `False` and its [`ShowMessageBox` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showmessagebox(VS.80).aspx) to `True`.</span></span> <span data-ttu-id="32603-229">此新增功能，使用任何驗證錯誤會摘要在用戶端 messagebox （請參閱圖 6）。</span><span class="sxs-lookup"><span data-stu-id="32603-229">With this addition, any validation errors are summarized in a client-side messagebox (see Figure 6).</span></span>


<span data-ttu-id="32603-230">[![驗證錯誤摘要說明在用戶端訊息方塊](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image17.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="32603-230">[![The Validation Errors are Summarized in a Client-Side Messagebox](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image17.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image16.png)</span></span>

<span data-ttu-id="32603-231">**圖 6**: 驗證錯誤摘要說明在用戶端 Messagebox ([按一下以檢視完整大小的影像](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="32603-231">**Figure 6**: The Validation Errors are Summarized in a Client-Side Messagebox ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image18.png))</span></span>


## <a name="summary"></a><span data-ttu-id="32603-232">總結</span><span class="sxs-lookup"><span data-stu-id="32603-232">Summary</span></span>

<span data-ttu-id="32603-233">在此教學課程中我們可了解如何使用以主動確保我們的使用者輸入之前嘗試更新的工作流程中使用它們都是有效的驗證控制項來減少例外狀況的可能性。</span><span class="sxs-lookup"><span data-stu-id="32603-233">In this tutorial we saw how to reduce the likelihood of exceptions by using validation controls to proactively ensure that our users inputs are valid before attempting to use them in the updating workflow.</span></span> <span data-ttu-id="32603-234">ASP.NET 提供五個，設計來檢查特定 Web 驗證 Web 控制項控制 s 輸入，並回報輸入的 s 有效性。</span><span class="sxs-lookup"><span data-stu-id="32603-234">ASP.NET provides five validation Web controls that are designed to inspect a particular Web control s input and report back on the input s validity.</span></span> <span data-ttu-id="32603-235">在本教學課程中我們使用這些五個控制項的兩個 RequiredFieldValidator 和 CompareValidator 以確保提供的產品的名稱且價格必須大於或等於零的值與貨幣格式。</span><span class="sxs-lookup"><span data-stu-id="32603-235">In this tutorial we used two of those five controls the RequiredFieldValidator and the CompareValidator to ensure that the product s name was supplied and that the price had a currency format with a value greater than or equal to zero.</span></span>

<span data-ttu-id="32603-236">驗證控制項加入編輯介面 DataList s 很簡單，拖曳到`EditItemTemplate`從 [工具箱] 會設定之少數屬性。</span><span class="sxs-lookup"><span data-stu-id="32603-236">Adding validation controls to the DataList s editing interface is as simple as dragging them onto the `EditItemTemplate` from the Toolbox and setting a handful of properties.</span></span> <span data-ttu-id="32603-237">根據預設，驗證控制項自動發出用戶端驗證指令碼。它們也提供伺服器端驗證在回傳時，儲存中的累計結果`Page.IsValid`屬性。</span><span class="sxs-lookup"><span data-stu-id="32603-237">By default, the validation controls automatically emit client-side validation script; they also provide server-side validation on postback, storing the cumulative result in the `Page.IsValid` property.</span></span> <span data-ttu-id="32603-238">如果要略過用戶端驗證 按鈕、 LinkButton 或 imagebutton 已按下時，設定按鈕 s`CausesValidation`屬性`False`。</span><span class="sxs-lookup"><span data-stu-id="32603-238">To bypass the client-side validation when a Button, LinkButton, or ImageButton is clicked, set the button s `CausesValidation` property to `False`.</span></span> <span data-ttu-id="32603-239">此外，然後再執行任何工作在回傳時送出的資料，請確定`Page.IsValid`屬性會傳回`True`。</span><span class="sxs-lookup"><span data-stu-id="32603-239">Also, before performing any tasks with the data submitted on postback, ensure that the `Page.IsValid` property returns `True`.</span></span>

<span data-ttu-id="32603-240">所有的編輯教學課程 DataList 我們檢查到目前為止我們有非常簡單的編輯介面，產品 s 名稱文字方塊中，而另一個的價格。</span><span class="sxs-lookup"><span data-stu-id="32603-240">All of the DataList editing tutorials we ve examined so far have had very simple editing interfaces a TextBox for the product s name and another for the price.</span></span> <span data-ttu-id="32603-241">編輯介面，不過，可以包含不同的 Web 控制項，例如 DropDownLists、 行事曆、 選項按鈕、 核取方塊，等等的混合。</span><span class="sxs-lookup"><span data-stu-id="32603-241">The editing interface, however, can contain a mix of different Web controls, such as DropDownLists, Calendars, RadioButtons, CheckBoxes, and so on.</span></span> <span data-ttu-id="32603-242">在我們的下一個教學課程中我們將探討建置使用不同的 Web 控制項的介面。</span><span class="sxs-lookup"><span data-stu-id="32603-242">In our next tutorial we'll look at building an interface that uses a variety of Web controls.</span></span>

<span data-ttu-id="32603-243">祝您程式設計 ！</span><span class="sxs-lookup"><span data-stu-id="32603-243">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="32603-244">關於作者</span><span class="sxs-lookup"><span data-stu-id="32603-244">About the Author</span></span>

<span data-ttu-id="32603-245">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，作者的七個 ASP/ASP.NET 書籍和的創辦[4GuysFromRolla.com](http://www.4guysfromrolla.com)，已從 1998 年使用 Microsoft Web 技術。</span><span class="sxs-lookup"><span data-stu-id="32603-245">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="32603-246">Scott 可做為獨立顧問、 訓練和寫入器。</span><span class="sxs-lookup"><span data-stu-id="32603-246">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="32603-247">他最新的活頁簿[ *Sam 教導您自己 ASP.NET 2.0 24 小時內*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="32603-247">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="32603-248">他可以在達到[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)或透過他的部落格，這可以在找到[ http://ScottOnWriting.NET ](http://ScottOnWriting.NET)。</span><span class="sxs-lookup"><span data-stu-id="32603-248">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="32603-249">特別感謝</span><span class="sxs-lookup"><span data-stu-id="32603-249">Special Thanks To</span></span>

<span data-ttu-id="32603-250">許多有用的檢閱者已檢閱本教學課程系列。</span><span class="sxs-lookup"><span data-stu-id="32603-250">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="32603-251">此教學課程中的前導檢閱者已 Dennis Patterson、 Ken Pespisa 和 Liz Shulok。</span><span class="sxs-lookup"><span data-stu-id="32603-251">Lead reviewers for this tutorial were Dennis Patterson, Ken Pespisa, and Liz Shulok.</span></span> <span data-ttu-id="32603-252">檢閱我即將推出的 MSDN 文件有興趣嗎？</span><span class="sxs-lookup"><span data-stu-id="32603-252">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="32603-253">如果是這樣，卸除我一行[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="32603-253">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="32603-254">[上一頁](handling-bll-and-dal-level-exceptions-vb.md)
> [下一頁](customizing-the-datalist-s-editing-interface-vb.md)</span><span class="sxs-lookup"><span data-stu-id="32603-254">[Previous](handling-bll-and-dal-level-exceptions-vb.md)
[Next](customizing-the-datalist-s-editing-interface-vb.md)</span></span>
