---
uid: web-forms/overview/data-access/basic-reporting/declarative-parameters-vb
title: 宣告式的參數 (VB) |Microsoft 文件
author: rick-anderson
description: 在本教學課程中，我們將說明如何使用參數設為硬式編碼值來選取要在 DetailsView 控制項中顯示的資料。
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/31/2010
ms.topic: article
ms.assetid: dc1234a3-114f-4c9a-8d25-50ca03cc8e8e
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/basic-reporting/declarative-parameters-vb
msc.type: authoredcontent
ms.openlocfilehash: 933b7276c6dac5cce0e278fd23ff010c5b4a6fdd
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/06/2018
ms.locfileid: "30877407"
---
<a name="declarative-parameters-vb"></a><span data-ttu-id="88efa-103">宣告式的參數 (VB)</span><span class="sxs-lookup"><span data-stu-id="88efa-103">Declarative Parameters (VB)</span></span>
====================
<span data-ttu-id="88efa-104">由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="88efa-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="88efa-105">[下載範例應用程式](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_5_VB.exe)或[下載 PDF](declarative-parameters-vb/_static/datatutorial05vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="88efa-105">[Download Sample App](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_5_VB.exe) or [Download PDF](declarative-parameters-vb/_static/datatutorial05vb1.pdf)</span></span>

> <span data-ttu-id="88efa-106">在本教學課程中，我們將說明如何使用參數設為硬式編碼值來選取要在 DetailsView 控制項中顯示的資料。</span><span class="sxs-lookup"><span data-stu-id="88efa-106">In this tutorial we'll illustrate how to use a parameter set to a hard-coded value to select the data to display in a DetailsView control.</span></span>


## <a name="introduction"></a><span data-ttu-id="88efa-107">簡介</span><span class="sxs-lookup"><span data-stu-id="88efa-107">Introduction</span></span>

<span data-ttu-id="88efa-108">在[最後一個教學課程](displaying-data-with-the-objectdatasource-vb.md)我們探討了 GridView、 DetailsView 和 FormView 控制項繫結至叫用 ObjectDataSource 控制項與顯示資料`GetProducts()`方法從`ProductsBLL`類別。</span><span class="sxs-lookup"><span data-stu-id="88efa-108">In the [last tutorial](displaying-data-with-the-objectdatasource-vb.md) we looked at displaying data with the GridView, DetailsView, and FormView controls bound to an ObjectDataSource control that invoked the `GetProducts()` method from the `ProductsBLL` class.</span></span> <span data-ttu-id="88efa-109">`GetProducts()`方法會傳回所有來自 Northwind 資料庫的記錄填入強型別 DataTable`Products`資料表。</span><span class="sxs-lookup"><span data-stu-id="88efa-109">The `GetProducts()` method returns a strongly-typed DataTable populated with all of the records from the Northwind database's `Products` table.</span></span> <span data-ttu-id="88efa-110">`ProductsBLL`類別包含產品中，只傳回子集的其他方法`GetProductByProductID(productID)`， `GetProductsByCategoryID(categoryID)`，和`GetProductsBySupplierID(supplierID)`。</span><span class="sxs-lookup"><span data-stu-id="88efa-110">The `ProductsBLL` class contains additional methods for returning just subsets of the products - `GetProductByProductID(productID)`, `GetProductsByCategoryID(categoryID)`, and `GetProductsBySupplierID(supplierID)`.</span></span> <span data-ttu-id="88efa-111">這三個方法預期輸入的參數，指出如何篩選傳回的產品資訊。</span><span class="sxs-lookup"><span data-stu-id="88efa-111">These three methods expect an input parameter indicating how to filter the returned product information.</span></span>

<span data-ttu-id="88efa-112">ObjectDataSource 可以用於叫用方法所預期的輸入的參數，但若要這麼做，所以我們必須指定這些參數的值來自何處。</span><span class="sxs-lookup"><span data-stu-id="88efa-112">The ObjectDataSource can be used to invoke methods that expect input parameters, but in order to do so we must specify where the values for these parameters come from.</span></span> <span data-ttu-id="88efa-113">參數值可以是硬式編碼，或可能來自各種不同的動態來源，包括： 查詢字串值，工作階段變數的頁面中，或其他 Web 控制項的屬性值。</span><span class="sxs-lookup"><span data-stu-id="88efa-113">The parameter values can be hard-coded or can come from a variety of dynamic sources, including: querystring values, Session variables, the property value of a Web control on the page, or others.</span></span>

<span data-ttu-id="88efa-114">在此教學課程首先說明如何使用參數，設定為硬式編碼值。</span><span class="sxs-lookup"><span data-stu-id="88efa-114">For this tutorial let's start by illustrating how to use a parameter set to a hard-coded value.</span></span> <span data-ttu-id="88efa-115">具體來說，我們會探討顯示特定產品，也就是 Chef Anton Gumbo 混合，其具有相關資訊的頁面中加入 DetailsView`ProductID`為 5。</span><span class="sxs-lookup"><span data-stu-id="88efa-115">Specifically, we'll look at adding a DetailsView to the page that displays information about a specific product, namely Chef Anton's Gumbo Mix, which has a `ProductID` of 5.</span></span> <span data-ttu-id="88efa-116">接下來，我們會了解如何設定 Web 控制項為基礎的參數值。</span><span class="sxs-lookup"><span data-stu-id="88efa-116">Next, we'll see how to set the parameter value based on a Web control.</span></span> <span data-ttu-id="88efa-117">特別是，我們會使用文字方塊中，讓使用者輸入國家/地區之後, 他們就可以按一下按鈕以查看位於該國家/地區的供應商的清單。</span><span class="sxs-lookup"><span data-stu-id="88efa-117">In particular, we'll use a TextBox to let the user type in a country, after which they can click a Button to see the list of suppliers that reside in that country.</span></span>

## <a name="using-a-hard-coded-parameter-value"></a><span data-ttu-id="88efa-118">使用硬式編碼的參數值</span><span class="sxs-lookup"><span data-stu-id="88efa-118">Using a Hard-Coded Parameter Value</span></span>

<span data-ttu-id="88efa-119">第一個範例中，開始將 DetailsView 控制項加入`DeclarativeParams.aspx`頁面`BasicReporting`資料夾。</span><span class="sxs-lookup"><span data-stu-id="88efa-119">For the first example, start by adding a DetailsView control to the `DeclarativeParams.aspx` page in the `BasicReporting` folder.</span></span> <span data-ttu-id="88efa-120">從 DetailsView 的智慧標籤上，選取&lt;新的資料來源&gt;從下拉式清單，然後選擇要加入 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="88efa-120">From the DetailsView's smart tag, select &lt;New data source&gt; from the drop-down list and choose to add an ObjectDataSource.</span></span>


<span data-ttu-id="88efa-121">[![ObjectDataSource 加入頁面](declarative-parameters-vb/_static/image2.png)](declarative-parameters-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="88efa-121">[![Add an ObjectDataSource to the Page](declarative-parameters-vb/_static/image2.png)](declarative-parameters-vb/_static/image1.png)</span></span>

<span data-ttu-id="88efa-122">**圖 1**: ObjectDataSource 加入頁面 ([按一下以檢視完整大小的影像](declarative-parameters-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="88efa-122">**Figure 1**: Add an ObjectDataSource to the Page ([Click to view full-size image](declarative-parameters-vb/_static/image3.png))</span></span>


<span data-ttu-id="88efa-123">這會自動啟動 ObjectDataSource 控制項的 [選擇資料來源] 精靈。</span><span class="sxs-lookup"><span data-stu-id="88efa-123">This will automatically start the ObjectDataSource control's Choose Data Source wizard.</span></span> <span data-ttu-id="88efa-124">選取`ProductsBLL`類別精靈的第一個畫面。</span><span class="sxs-lookup"><span data-stu-id="88efa-124">Select the `ProductsBLL` class from the first screen of the wizard.</span></span>


<span data-ttu-id="88efa-125">[![選取 ProductsBLL 類別](declarative-parameters-vb/_static/image5.png)](declarative-parameters-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="88efa-125">[![Select the ProductsBLL Class](declarative-parameters-vb/_static/image5.png)](declarative-parameters-vb/_static/image4.png)</span></span>

<span data-ttu-id="88efa-126">**圖 2**： 選取`ProductsBLL`類別 ([按一下以檢視完整大小的影像](declarative-parameters-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="88efa-126">**Figure 2**: Select the `ProductsBLL` Class ([Click to view full-size image](declarative-parameters-vb/_static/image6.png))</span></span>


<span data-ttu-id="88efa-127">因為我們想要顯示特定產品的相關資訊，我們想要使用`GetProductByProductID(productID)`方法。</span><span class="sxs-lookup"><span data-stu-id="88efa-127">Since we want to display information about a particular product we want to use the `GetProductByProductID(productID)` method.</span></span>


<span data-ttu-id="88efa-128">[![選擇 GetProductByProductID(productID) 方法](declarative-parameters-vb/_static/image8.png)](declarative-parameters-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="88efa-128">[![Choose the GetProductByProductID(productID) method](declarative-parameters-vb/_static/image8.png)](declarative-parameters-vb/_static/image7.png)</span></span>

<span data-ttu-id="88efa-129">**圖 3**： 選擇`GetProductByProductID(productID)`方法 ([按一下以檢視完整大小的影像](declarative-parameters-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="88efa-129">**Figure 3**: Choose the `GetProductByProductID(productID)` method ([Click to view full-size image](declarative-parameters-vb/_static/image9.png))</span></span>


<span data-ttu-id="88efa-130">因為我們所選取的方法包括的參數，所以沒有一個精靈 」，我們就必須定義要用於參數的值的多個螢幕。</span><span class="sxs-lookup"><span data-stu-id="88efa-130">Since the method we selected includes a parameter, there's one more screen for the wizard, where we're asked to define the value to be used for the parameter.</span></span> <span data-ttu-id="88efa-131">在左邊的清單會顯示所有選取方法的參數。</span><span class="sxs-lookup"><span data-stu-id="88efa-131">The list on the left shows all of the parameters for the selected method.</span></span> <span data-ttu-id="88efa-132">如`GetProductByProductID(productID)`只有一個`productID`。</span><span class="sxs-lookup"><span data-stu-id="88efa-132">For `GetProductByProductID(productID)` there's only one `productID`.</span></span> <span data-ttu-id="88efa-133">在右側我們可以指定所選取參數的值。</span><span class="sxs-lookup"><span data-stu-id="88efa-133">On the right we can specify the value for the selected parameter.</span></span> <span data-ttu-id="88efa-134">參數來源下拉式清單會列舉針對參數值不同的可能來源。</span><span class="sxs-lookup"><span data-stu-id="88efa-134">The parameter source drop-down list enumerates the various possible sources for the parameter value.</span></span> <span data-ttu-id="88efa-135">因為我們想要指定為 5 的硬式編碼值`productID`參數保留為 [無參數來源和預設值] 文字方塊中輸入 5。</span><span class="sxs-lookup"><span data-stu-id="88efa-135">Since we want to specify a hard-coded value of 5 for the `productID` parameter, leave the Parameter source as None and enter 5 into the DefaultValue textbox.</span></span>


<span data-ttu-id="88efa-136">[![Hard-Coded 參數值的 5 將用於 productID 參數](declarative-parameters-vb/_static/image11.png)](declarative-parameters-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="88efa-136">[![A Hard-Coded Parameter Value of 5 Will Be Used for the productID Parameter](declarative-parameters-vb/_static/image11.png)](declarative-parameters-vb/_static/image10.png)</span></span>

<span data-ttu-id="88efa-137">**圖 4**: A Hard-Coded 參數值的 5 將用於`productID`參數 ([按一下以檢視完整大小的影像](declarative-parameters-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="88efa-137">**Figure 4**: A Hard-Coded Parameter Value of 5 Will Be Used for the `productID` Parameter ([Click to view full-size image](declarative-parameters-vb/_static/image12.png))</span></span>


<span data-ttu-id="88efa-138">完成設定資料來源精靈之後，ObjectDataSource 控制項的宣告式標記包含`Parameter`物件存放至`SelectParameters`集合中定義的方法所預期的輸入參數的每個`SelectMethod`屬性。</span><span class="sxs-lookup"><span data-stu-id="88efa-138">After completing the Configure Data Source wizard, the ObjectDataSource control's declarative markup includes a `Parameter` object in the `SelectParameters` collection for each of the input parameters expected by the method defined in the `SelectMethod` property.</span></span> <span data-ttu-id="88efa-139">在此範例中，我們會使用此方法必須要有只為單一輸入的參數，因為`parameterID`，這裡只能有一個項目。</span><span class="sxs-lookup"><span data-stu-id="88efa-139">Since the method we're using in this example expects just a single input parameter, `parameterID`, there's only one entry here.</span></span> <span data-ttu-id="88efa-140">`SelectParameters`集合可以包含任何類別衍生自`Parameter`類別`System.Web.UI.WebControls`命名空間。</span><span class="sxs-lookup"><span data-stu-id="88efa-140">The `SelectParameters` collection can contain any class that derives from the `Parameter` class in the `System.Web.UI.WebControls` namespace.</span></span> <span data-ttu-id="88efa-141">針對硬式編碼的參數值的基底`Parameter`類別會使用，但其他參數來源選項衍生`Parameter`使用類別; 您也可以建立您自己[自訂參數型別](http://www.leftslipper.com/ShowFaq.aspx?FaqId=11)有需要。</span><span class="sxs-lookup"><span data-stu-id="88efa-141">For hard-coded parameter values the base `Parameter` class is used, but for the other parameter source options a derived `Parameter` class is used; you can also create your own [custom parameter types](http://www.leftslipper.com/ShowFaq.aspx?FaqId=11), if needed.</span></span>

[!code-aspx[Main](declarative-parameters-vb/samples/sample1.aspx)]

> [!NOTE]
> <span data-ttu-id="88efa-142">如果您您按照您自己電腦上的宣告式標記您會看到在此時可能包含值`InsertMethod`， `UpdateMethod`，和`DeleteMethod`屬性，以及`DeleteParameters`。</span><span class="sxs-lookup"><span data-stu-id="88efa-142">If you're following along on your own computer the declarative markup you see at this point may include values for the `InsertMethod`, `UpdateMethod`, and `DeleteMethod` properties, as well as `DeleteParameters`.</span></span> <span data-ttu-id="88efa-143">ObjectDataSource 選擇資料來源精靈會自動將指定的方法，從`ProductBLL`用於插入、 更新和刪除，因此除非您明確地清除那些時，它們會包含在上述的標記。</span><span class="sxs-lookup"><span data-stu-id="88efa-143">The ObjectDataSource's Choose Data Source wizard automatically specifies the methods from the `ProductBLL` to use for inserting, updating, and deleting, so unless you explicitly cleared those out, they'll be included in the markup above.</span></span>


<span data-ttu-id="88efa-144">當造訪此頁，Web 控制項的資料將會叫用 ObjectDataSource`Select`方法，將會呼叫`ProductsBLL`類別的`GetProductByProductID(productID)`方法使用硬式編碼的值為 5`productID`輸入的參數。</span><span class="sxs-lookup"><span data-stu-id="88efa-144">When visiting this page, the data Web control will invoke the ObjectDataSource's `Select` method, which will call the `ProductsBLL` class's `GetProductByProductID(productID)` method using the hard-coded value of 5 for the `productID` input parameter.</span></span> <span data-ttu-id="88efa-145">方法會傳回強型別`ProductDataTable`物件，其中包含 Chef Anton Gumbo 混合的相關資訊的單一資料列 (與產品`ProductID`5)。</span><span class="sxs-lookup"><span data-stu-id="88efa-145">The method will return a strongly-typed `ProductDataTable` object that contains a single row with information about Chef Anton's Gumbo Mix (the product with `ProductID` 5).</span></span>


<span data-ttu-id="88efa-146">[![顯示的資訊關於 Chef Anton 的 Gumbo 混合](declarative-parameters-vb/_static/image14.png)](declarative-parameters-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="88efa-146">[![Information About Chef Anton's Gumbo Mix are Displayed](declarative-parameters-vb/_static/image14.png)](declarative-parameters-vb/_static/image13.png)</span></span>

<span data-ttu-id="88efa-147">**圖 5**： 顯示的資訊關於 Chef Anton 的 Gumbo 混合 ([按一下以檢視完整大小的影像](declarative-parameters-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="88efa-147">**Figure 5**: Information About Chef Anton's Gumbo Mix are Displayed ([Click to view full-size image](declarative-parameters-vb/_static/image15.png))</span></span>


## <a name="setting-the-parameter-value-to-the-property-value-of-a-web-control"></a><span data-ttu-id="88efa-148">將參數值設定為 Web 控制項的屬性值</span><span class="sxs-lookup"><span data-stu-id="88efa-148">Setting the Parameter Value to the Property Value of a Web Control</span></span>

<span data-ttu-id="88efa-149">ObjectDataSource 參數也可以設定的值為基礎的頁面上的 Web 控制項的值。</span><span class="sxs-lookup"><span data-stu-id="88efa-149">The ObjectDataSource's parameter values can also be set based on the value of a Web control on the page.</span></span> <span data-ttu-id="88efa-150">為了說明這點，讓我們先列出所有已位於使用者指定的國家/地區供應商的 GridView。</span><span class="sxs-lookup"><span data-stu-id="88efa-150">To illustrate this, let's have a GridView that lists all of the suppliers that are located in a country specified by the user.</span></span> <span data-ttu-id="88efa-151">若要完成此開始的頁面讓使用者可以輸入國家/地區名稱中加入文字方塊。</span><span class="sxs-lookup"><span data-stu-id="88efa-151">To accomplish this start by adding a TextBox to the page into which the user can enter a country name.</span></span> <span data-ttu-id="88efa-152">設定此文字方塊控制項的`ID`屬性`CountryName`。</span><span class="sxs-lookup"><span data-stu-id="88efa-152">Set this TextBox control's `ID` property to `CountryName`.</span></span> <span data-ttu-id="88efa-153">也新增按鈕 Web 控制項。</span><span class="sxs-lookup"><span data-stu-id="88efa-153">Also add a Button Web control.</span></span>


<span data-ttu-id="88efa-154">[![將文字方塊加入至識別碼 CountryName 的頁面](declarative-parameters-vb/_static/image17.png)](declarative-parameters-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="88efa-154">[![Add a TextBox to the Page with ID CountryName](declarative-parameters-vb/_static/image17.png)](declarative-parameters-vb/_static/image16.png)</span></span>

<span data-ttu-id="88efa-155">**圖 6**： 加入至包含頁面的文字方塊`ID` `CountryName` ([按一下以檢視完整大小的影像](declarative-parameters-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="88efa-155">**Figure 6**: Add a TextBox to the Page with `ID` `CountryName` ([Click to view full-size image](declarative-parameters-vb/_static/image18.png))</span></span>


<span data-ttu-id="88efa-156">接下來，將 GridView 加入至頁面，然後從智慧標籤，選擇要加入新 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="88efa-156">Next, add a GridView to the page and, from the smart tag, choose to add a new ObjectDataSource.</span></span> <span data-ttu-id="88efa-157">因為我們想要顯示供應商資訊選取`SuppliersBLL`類別從精靈的第一個畫面。</span><span class="sxs-lookup"><span data-stu-id="88efa-157">Since we want to display supplier information select the `SuppliersBLL` class from the wizard's first screen.</span></span> <span data-ttu-id="88efa-158">從第二個畫面中，選取`GetSuppliersByCountry(country)`方法。</span><span class="sxs-lookup"><span data-stu-id="88efa-158">From the second screen, pick the `GetSuppliersByCountry(country)` method.</span></span>


<span data-ttu-id="88efa-159">[![選擇 GetSuppliersByCountry(country) 方法](declarative-parameters-vb/_static/image20.png)](declarative-parameters-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="88efa-159">[![Choose the GetSuppliersByCountry(country) Method](declarative-parameters-vb/_static/image20.png)](declarative-parameters-vb/_static/image19.png)</span></span>

<span data-ttu-id="88efa-160">**圖 7**： 選擇`GetSuppliersByCountry(country)`方法 ([按一下以檢視完整大小的影像](declarative-parameters-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="88efa-160">**Figure 7**: Choose the `GetSuppliersByCountry(country)` Method ([Click to view full-size image](declarative-parameters-vb/_static/image21.png))</span></span>


<span data-ttu-id="88efa-161">因為`GetSuppliersByCountry(country)`方法都有輸入的參數，精靈會再次包含選擇的參數值的最後一個畫面。</span><span class="sxs-lookup"><span data-stu-id="88efa-161">Since the `GetSuppliersByCountry(country)` method has an input parameter, the wizard once again includes a final screen for choosing the parameter value.</span></span> <span data-ttu-id="88efa-162">此時，設定參數來源控制項。</span><span class="sxs-lookup"><span data-stu-id="88efa-162">This time, set the Parameter source to Control.</span></span> <span data-ttu-id="88efa-163">這將會填入頁面; 上的控制項名稱 ControlID 下拉式清單選取`CountryName`從清單控制項。</span><span class="sxs-lookup"><span data-stu-id="88efa-163">This will populate the ControlID drop-down list with the names of the controls on the page; select the `CountryName` control from the list.</span></span> <span data-ttu-id="88efa-164">當第一次瀏覽頁面時`CountryName`文字方塊中會是空白的所以會傳回任何結果，並不會顯示。</span><span class="sxs-lookup"><span data-stu-id="88efa-164">When the page is first visited the `CountryName` TextBox will be blank, so no results are returned and nothing is displayed.</span></span> <span data-ttu-id="88efa-165">如果您想要依預設會顯示某些結果，請據以設定 [預設值] 文字方塊。</span><span class="sxs-lookup"><span data-stu-id="88efa-165">If you want to display some results by default, set the DefaultValue textbox accordingly.</span></span>


<span data-ttu-id="88efa-166">[![設定為 CountryName 控制項值的參數值](declarative-parameters-vb/_static/image23.png)](declarative-parameters-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="88efa-166">[![Set the Parameter Value to the CountryName Control Value](declarative-parameters-vb/_static/image23.png)](declarative-parameters-vb/_static/image22.png)</span></span>

<span data-ttu-id="88efa-167">**圖 8**： 將參數值設定為`CountryName`控制項的值 ([按一下以檢視完整大小的影像](declarative-parameters-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="88efa-167">**Figure 8**: Set the Parameter Value to the `CountryName` Control Value ([Click to view full-size image](declarative-parameters-vb/_static/image24.png))</span></span>


<span data-ttu-id="88efa-168">ObjectDataSource 的宣告式標記稍有不同於第一個範例中，使用[ControlParameter](https://msdn.microsoft.com/library/system.web.ui.webcontrols.controlparameter.aspx)而不是標準`Parameter`物件。</span><span class="sxs-lookup"><span data-stu-id="88efa-168">The ObjectDataSource's declarative markup differs slightly from our first example, using a [ControlParameter](https://msdn.microsoft.com/library/system.web.ui.webcontrols.controlparameter.aspx) instead of the standard `Parameter` object.</span></span> <span data-ttu-id="88efa-169">A`ControlParameter`有其他屬性來指定`ID`Web 控制項和要用於參數的屬性值 (`PropertyName`)。</span><span class="sxs-lookup"><span data-stu-id="88efa-169">A `ControlParameter` has additional properties to specify the `ID` of the Web control and the property value to use for the parameter (`PropertyName`).</span></span> <span data-ttu-id="88efa-170">設定資料來源精靈是聰明，可以判斷，針對文字方塊中，我們可能會想要使用`Text`參數值的屬性。</span><span class="sxs-lookup"><span data-stu-id="88efa-170">The Configure Data Source wizard was smart enough to determine that, for a TextBox, we'll likely want to use the `Text` property for the parameter value.</span></span> <span data-ttu-id="88efa-171">如果您想要使用不同的屬性值從 Web 控制項的不過，您可以變更`PropertyName`此處或按一下 「 顯示進階屬性 」 的連結，在精靈中的值。</span><span class="sxs-lookup"><span data-stu-id="88efa-171">If, however, you want to use a different property value from the Web control you can change the `PropertyName` value here or by clicking the "Show advanced properties" link in the wizard.</span></span>

[!code-aspx[Main](declarative-parameters-vb/samples/sample2.aspx)]

<span data-ttu-id="88efa-172">當第一次瀏覽頁面`CountryName`文字方塊是空的。</span><span class="sxs-lookup"><span data-stu-id="88efa-172">When visiting the page for the first time the `CountryName` TextBox is empty.</span></span> <span data-ttu-id="88efa-173">ObjectDataSource`Select`仍由 GridView，而值為叫用方法`Nothing`傳入`GetSuppliersByCountry(country)`方法。</span><span class="sxs-lookup"><span data-stu-id="88efa-173">The ObjectDataSource's `Select` method is still invoked by the GridView, but a value of `Nothing` is passed into the `GetSuppliersByCountry(country)` method.</span></span> <span data-ttu-id="88efa-174">TableAdapter 會將轉換`Nothing`插入資料庫`NULL`值 (`DBNull.Value`)，但使用的查詢`GetSuppliersByCountry(country)`會寫入方法，使它不會傳回任何值時`NULL`指定值`@CategoryID`參數。</span><span class="sxs-lookup"><span data-stu-id="88efa-174">The TableAdapter converts the `Nothing` into a database `NULL` value (`DBNull.Value`), but the query used by the `GetSuppliersByCountry(country)` method is written such that it doesn't return any values when a `NULL` value is specified for the `@CategoryID` parameter.</span></span> <span data-ttu-id="88efa-175">簡單地說，就會傳回供應商。</span><span class="sxs-lookup"><span data-stu-id="88efa-175">In short, no suppliers are returned.</span></span>

<span data-ttu-id="88efa-176">一旦訪客便會進入國家/地區，不過，並按一下顯示的供應商按鈕，可導致回傳，ObjectDataSource 的`Select`方法重新查詢，在文字方塊控制項中傳遞`Text`視為`country`參數。</span><span class="sxs-lookup"><span data-stu-id="88efa-176">Once the visitor enters in a country, however, and clicks the Show Suppliers button to cause a postback, the ObjectDataSource's `Select` method is requeried, passing in the TextBox control's `Text` value as the `country` parameter.</span></span>


<span data-ttu-id="88efa-177">[![會顯示從供應商](declarative-parameters-vb/_static/image26.png)](declarative-parameters-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="88efa-177">[![Those Suppliers from Canada are Shown](declarative-parameters-vb/_static/image26.png)](declarative-parameters-vb/_static/image25.png)</span></span>

<span data-ttu-id="88efa-178">**圖 9**： 會顯示那些來自供應商加拿大 ([按一下以檢視完整大小的影像](declarative-parameters-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="88efa-178">**Figure 9**: Those Suppliers from Canada are Shown ([Click to view full-size image](declarative-parameters-vb/_static/image27.png))</span></span>


## <a name="showing-all-suppliers-by-default"></a><span data-ttu-id="88efa-179">顯示預設的所有供應商</span><span class="sxs-lookup"><span data-stu-id="88efa-179">Showing All Suppliers By Default</span></span>

<span data-ttu-id="88efa-180">而是先檢視網頁時顯示任何的供應項目比我們可能會想要顯示*所有*供應商在一開始，讓使用者在文字方塊中輸入國家/地區名稱削減清單。</span><span class="sxs-lookup"><span data-stu-id="88efa-180">Rather than show none of the suppliers when first viewing the page we may want to show *all* suppliers at first, allowing the user to pare down the list by entering a country name in the TextBox.</span></span> <span data-ttu-id="88efa-181">文字方塊是空的當`SuppliersBLL`類別的`GetSuppliersByCountry(country)`方法傳入`Nothing`針對其*`country`* 輸入的參數。</span><span class="sxs-lookup"><span data-stu-id="88efa-181">When the TextBox is empty, the `SuppliersBLL` class's `GetSuppliersByCountry(country)` method is passed in `Nothing` for its *`country`* input parameter.</span></span> <span data-ttu-id="88efa-182">這`Nothing`值接著會向下傳遞至 DAL`GetSupplierByCountry(country)`方法，它就會轉譯到資料庫`NULL`值`@Country`參數，在下列查詢：</span><span class="sxs-lookup"><span data-stu-id="88efa-182">This `Nothing` value is then passed down into the DAL's `GetSupplierByCountry(country)` method, where it's translated to a database `NULL` value for the `@Country` parameter in the following query:</span></span>

[!code-sql[Main](declarative-parameters-vb/samples/sample3.sql)]

<span data-ttu-id="88efa-183">運算式`Country = NULL`永遠傳回 False，甚至記錄其`Country`資料行具有`NULL`值; 因此，會傳回任何記錄。</span><span class="sxs-lookup"><span data-stu-id="88efa-183">The expression `Country = NULL` always returns False, even for records whose `Country` column has a `NULL` value; therefore, no records are returned.</span></span>

<span data-ttu-id="88efa-184">要傳回*所有*供應商的國家/地區的文字方塊空白時，我們可以加強`GetSuppliersByCountry(country)`方法中叫用 BLL`GetSuppliers()`方法時的國家/地區參數是`Nothing`並呼叫 DAL `GetSuppliersByCountry(country)`其他方法。</span><span class="sxs-lookup"><span data-stu-id="88efa-184">To return *all* suppliers when the country TextBox is empty, we can augment the `GetSuppliersByCountry(country)` method in the BLL to invoke the `GetSuppliers()` method when its country parameter is `Nothing` and to call the DAL's `GetSuppliersByCountry(country)` method otherwise.</span></span> <span data-ttu-id="88efa-185">這會有包含國家 （地區） 參數時，傳回不指定任何國家/地區時，所有供應商以及供應商的適當子集的效果。</span><span class="sxs-lookup"><span data-stu-id="88efa-185">This will have the effect of returning all suppliers when no country is specified and the appropriate subset of suppliers when the country parameter is included.</span></span>

<span data-ttu-id="88efa-186">變更`GetSuppliersByCountry(country)`方法中的`SuppliersBLL`下列類別：</span><span class="sxs-lookup"><span data-stu-id="88efa-186">Change the `GetSuppliersByCountry(country)` method in the `SuppliersBLL` class to the following:</span></span>

[!code-vb[Main](declarative-parameters-vb/samples/sample4.vb)]

<span data-ttu-id="88efa-187">透過這項變更`DeclarativeParams.aspx`頁面會顯示所有供應商，當第一次瀏覽 (或每當`CountryName`文字方塊是空的)。</span><span class="sxs-lookup"><span data-stu-id="88efa-187">With this change the `DeclarativeParams.aspx` page shows all of the suppliers when first visited (or whenever the `CountryName` TextBox is empty).</span></span>


<span data-ttu-id="88efa-188">[![所有的供應商為何現在根據預設顯示](declarative-parameters-vb/_static/image29.png)](declarative-parameters-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="88efa-188">[![All Suppliers are Now Shown by Default](declarative-parameters-vb/_static/image29.png)](declarative-parameters-vb/_static/image28.png)</span></span>

<span data-ttu-id="88efa-189">**圖 10**： 所有的供應商為何現在會顯示預設 ([按一下以檢視完整大小的影像](declarative-parameters-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="88efa-189">**Figure 10**: All Suppliers are Now Shown by Default ([Click to view full-size image](declarative-parameters-vb/_static/image30.png))</span></span>


## <a name="summary"></a><span data-ttu-id="88efa-190">總結</span><span class="sxs-lookup"><span data-stu-id="88efa-190">Summary</span></span>

<span data-ttu-id="88efa-191">若要使用具有輸入參數的方法，我們要指定參數的值在 ObjectDataSource`SelectParameters`集合。</span><span class="sxs-lookup"><span data-stu-id="88efa-191">In order to use methods with input parameters, we need to specify the values for the parameters in the ObjectDataSource's `SelectParameters` collection.</span></span> <span data-ttu-id="88efa-192">要從不同來源取得的參數值允許不同類型的參數。</span><span class="sxs-lookup"><span data-stu-id="88efa-192">Different types of parameters allow for the parameter value to be obtained from different sources.</span></span> <span data-ttu-id="88efa-193">預設參數類型使用硬式編碼值，但可從查詢字串、 工作階段變數、 cookie 和即使使用者輸入的值，從網頁上的 Web 控制項取得參數值一樣輕鬆 （和沒有一行程式碼）。</span><span class="sxs-lookup"><span data-stu-id="88efa-193">The default parameter type uses a hard-coded value, but just as easily (and without a line of code) parameter values can be obtained from the querystring, Session variables, cookies, and even user-entered values from Web controls on the page.</span></span>

<span data-ttu-id="88efa-194">我們探討了在本教學課程的範例將說明如何使用宣告式的參數值。</span><span class="sxs-lookup"><span data-stu-id="88efa-194">The examples we looked at in this tutorial illustrated how to use declarative parameter values.</span></span> <span data-ttu-id="88efa-195">不過，可能是我們需要使用參數的來源不可以使用，例如目前的日期和時間，或者，如果我們的網站已使用成員資格，造訪者的使用者識別碼。</span><span class="sxs-lookup"><span data-stu-id="88efa-195">However, there may be times when we need to use a parameter source that's not available, such as the current date and time, or, if our site was using Membership, the User ID of the visitor.</span></span> <span data-ttu-id="88efa-196">這種情況下我們可以設定參數值之前 ObjectDataSource 以程式設計方式叫用其基礎物件的方法。</span><span class="sxs-lookup"><span data-stu-id="88efa-196">For such scenarios we can set the parameter values programmatically prior to the ObjectDataSource invoking its underlying object's method.</span></span> <span data-ttu-id="88efa-197">我們會看到如何完成這項[下一個教學課程](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md)。</span><span class="sxs-lookup"><span data-stu-id="88efa-197">We'll see how to accomplish this in the [next tutorial](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md).</span></span>

<span data-ttu-id="88efa-198">祝您程式設計 ！</span><span class="sxs-lookup"><span data-stu-id="88efa-198">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="88efa-199">關於作者</span><span class="sxs-lookup"><span data-stu-id="88efa-199">About the Author</span></span>

<span data-ttu-id="88efa-200">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，作者的七個 ASP/ASP.NET 書籍和的創辦[4GuysFromRolla.com](http://www.4guysfromrolla.com)，已從 1998 年使用 Microsoft Web 技術。</span><span class="sxs-lookup"><span data-stu-id="88efa-200">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="88efa-201">Scott 可做為獨立顧問、 訓練和寫入器。</span><span class="sxs-lookup"><span data-stu-id="88efa-201">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="88efa-202">他最新的活頁簿[ *Sam 教導您自己 ASP.NET 2.0 24 小時內*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="88efa-202">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="88efa-203">他可以在達到[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)或透過他的部落格，這可以在找到[ http://ScottOnWriting.NET ](http://ScottOnWriting.NET)。</span><span class="sxs-lookup"><span data-stu-id="88efa-203">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="88efa-204">特別感謝</span><span class="sxs-lookup"><span data-stu-id="88efa-204">Special Thanks To</span></span>

<span data-ttu-id="88efa-205">許多有用的檢閱者已檢閱本教學課程系列。</span><span class="sxs-lookup"><span data-stu-id="88efa-205">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="88efa-206">在此教學課程的前導檢閱者已 Hilton Giesenow。</span><span class="sxs-lookup"><span data-stu-id="88efa-206">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="88efa-207">檢閱我即將推出的 MSDN 文件有興趣嗎？</span><span class="sxs-lookup"><span data-stu-id="88efa-207">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="88efa-208">如果是這樣，卸除我一行[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="88efa-208">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="88efa-209">[上一頁](displaying-data-with-the-objectdatasource-vb.md)
> [下一頁](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md)</span><span class="sxs-lookup"><span data-stu-id="88efa-209">[Previous](displaying-data-with-the-objectdatasource-vb.md)
[Next](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md)</span></span>
