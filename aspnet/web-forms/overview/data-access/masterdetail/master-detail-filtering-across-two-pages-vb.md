---
uid: web-forms/overview/data-access/masterdetail/master-detail-filtering-across-two-pages-vb
title: 主從式篩選跨兩個頁面 (VB) |Microsoft 文件
author: rick-anderson
description: 本教學課程中我們將會列出供應商的資料庫使用 GridView 實作此模式。 在 GridView 中的每個供應商資料列將包含 Vie...
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/31/2010
ms.topic: article
ms.assetid: 361d6a44-3f1f-4daf-85df-d4c2b8bf065d
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/masterdetail/master-detail-filtering-across-two-pages-vb
msc.type: authoredcontent
ms.openlocfilehash: b8250c0f8d1befacf66d6be517514aad8bc31b09
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/06/2018
---
<a name="masterdetail-filtering-across-two-pages-vb"></a><span data-ttu-id="99585-104">主從式篩選跨兩個頁面 (VB)</span><span class="sxs-lookup"><span data-stu-id="99585-104">Master/Detail Filtering Across Two Pages (VB)</span></span>
====================
<span data-ttu-id="99585-105">由[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="99585-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="99585-106">[下載範例應用程式](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_9_VB.exe)或[下載 PDF](master-detail-filtering-across-two-pages-vb/_static/datatutorial09vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="99585-106">[Download Sample App](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_9_VB.exe) or [Download PDF](master-detail-filtering-across-two-pages-vb/_static/datatutorial09vb1.pdf)</span></span>

> <span data-ttu-id="99585-107">本教學課程中我們將會列出供應商的資料庫使用 GridView 實作此模式。</span><span class="sxs-lookup"><span data-stu-id="99585-107">In this tutorial we'll implement this pattern by using a GridView to list the suppliers in the database.</span></span> <span data-ttu-id="99585-108">在 GridView 中的每個供應商資料列會包含，按下時，會將使用者導向至個別頁面，列出這些產品選取供應商檢視產品連結。</span><span class="sxs-lookup"><span data-stu-id="99585-108">Each supplier row in the GridView will contain a View Products link that, when clicked, will take the user to a separate page that lists those products for the selected supplier.</span></span>


## <a name="introduction"></a><span data-ttu-id="99585-109">簡介</span><span class="sxs-lookup"><span data-stu-id="99585-109">Introduction</span></span>

<span data-ttu-id="99585-110">在先前的兩個教學課程中我們可了解如何在單一網頁使用 DropDownLists 顯示 「 主要 」 記錄中顯示主要/詳細資料報告和[GridView](master-detail-filtering-with-a-dropdownlist-vb.md)或[DetailsView](master-detail-filtering-with-two-dropdownlists-vb.md)控制項來顯示"詳細資料。 」</span><span class="sxs-lookup"><span data-stu-id="99585-110">In the previous two tutorials we saw how to display master/detail reports in a single web page using DropDownLists to display the "master" records and a [GridView](master-detail-filtering-with-a-dropdownlist-vb.md) or [DetailsView](master-detail-filtering-with-two-dropdownlists-vb.md) control to display the "details."</span></span> <span data-ttu-id="99585-111">用於主要/詳細資料報表的另一個常見模式是同時擁有上一個網頁，並顯示在另一台的詳細資料的主要記錄。</span><span class="sxs-lookup"><span data-stu-id="99585-111">Another common pattern used for master/details reports is to have the master records on one web page and the details shown on another.</span></span> <span data-ttu-id="99585-112">論壇網站、 like [ASP.NET 論壇](https://forums.asp.net/)，是絕佳的範例，此模式實際上。</span><span class="sxs-lookup"><span data-stu-id="99585-112">A forum website, like [the ASP.NET Forums](https://forums.asp.net/), is a great example of this pattern in practice.</span></span> <span data-ttu-id="99585-113">ASP.NET 論壇是組成各種不同的論壇開始使用 Web Form，資料呈現控制項，並以此類推。</span><span class="sxs-lookup"><span data-stu-id="99585-113">The ASP.NET Forums are composed of a variety of forums Getting Started, Web Forms, Data Presentation Controls, and so on.</span></span> <span data-ttu-id="99585-114">每個論壇撰寫多執行緒，而且每個執行緒組成的文章的數字。</span><span class="sxs-lookup"><span data-stu-id="99585-114">Each forum is composed of many threads and each thread is composed of a number of posts.</span></span> <span data-ttu-id="99585-115">在 ASP.NET 論壇首頁上，會列出論壇。</span><span class="sxs-lookup"><span data-stu-id="99585-115">On the ASP.NET Forums homepage, the forums are listed.</span></span> <span data-ttu-id="99585-116">在論壇上按一下 whisks 您`ShowForum.aspx`頁面上，列出該論壇的執行緒。</span><span class="sxs-lookup"><span data-stu-id="99585-116">Clicking on a forum whisks you to a `ShowForum.aspx` page, which lists the threads for that forum.</span></span> <span data-ttu-id="99585-117">同樣地，按一下 上一個執行緒會帶您前往`ShowPost.aspx`，其中顯示之執行緒的已按下的文章。</span><span class="sxs-lookup"><span data-stu-id="99585-117">Likewise, clicking on a thread takes you to `ShowPost.aspx`, which displays the posts for the thread that was clicked.</span></span>

<span data-ttu-id="99585-118">本教學課程中我們將會列出供應商的資料庫使用 GridView 實作此模式。</span><span class="sxs-lookup"><span data-stu-id="99585-118">In this tutorial we'll implement this pattern by using a GridView to list the suppliers in the database.</span></span> <span data-ttu-id="99585-119">在 GridView 中的每個供應商資料列會包含，按下時，會將使用者導向至個別頁面，列出這些產品選取供應商檢視產品連結。</span><span class="sxs-lookup"><span data-stu-id="99585-119">Each supplier row in the GridView will contain a View Products link that, when clicked, will take the user to a separate page that lists those products for the selected supplier.</span></span>

## <a name="step-1-addingsupplierlistmasteraspxandproductsforsupplierdetailsaspxpages-to-thefilteringfolder"></a><span data-ttu-id="99585-120">步驟 1： 加入`SupplierListMaster.aspx`和`ProductsForSupplierDetails.aspx`頁面`Filtering`資料夾</span><span class="sxs-lookup"><span data-stu-id="99585-120">Step 1: Adding`SupplierListMaster.aspx`and`ProductsForSupplierDetails.aspx`Pages to the`Filtering`Folder</span></span>

<span data-ttu-id="99585-121">我們在第三個教學課程中定義的頁面配置時加入 「 起始 」 中的頁面數目`BasicReporting`， `Filtering`，和`CustomFormatting`資料夾。</span><span class="sxs-lookup"><span data-stu-id="99585-121">When defining the page layout in the third tutorial we added a number of "starter" pages in the `BasicReporting`, `Filtering`, and `CustomFormatting` folders.</span></span> <span data-ttu-id="99585-122">不過，我們並未新增起始頁面在此教學課程在該時間，因此請花一點時間加入至兩個新的頁面`Filtering`資料夾：`SupplierListMaster.aspx`和`ProductsForSupplierDetails.aspx`。</span><span class="sxs-lookup"><span data-stu-id="99585-122">However, we did not add a starter page for this tutorial at that time, so take a moment to add two new pages to the `Filtering` folder: `SupplierListMaster.aspx` and `ProductsForSupplierDetails.aspx`.</span></span> <span data-ttu-id="99585-123">`SupplierListMaster.aspx` 會列出時的 「 主要 」 記錄 （供應商）`ProductsForSupplierDetails.aspx`將顯示所選的供應商的產品。</span><span class="sxs-lookup"><span data-stu-id="99585-123">`SupplierListMaster.aspx` will list the "master" records (the suppliers) while `ProductsForSupplierDetails.aspx` will display the products for the selected supplier.</span></span>

<span data-ttu-id="99585-124">當建立這兩個新的分頁會使它們與特定`Site.master`主版頁面。</span><span class="sxs-lookup"><span data-stu-id="99585-124">When creating these two new pages be certain to associate them with the `Site.master` master page.</span></span>


![加入篩選的資料夾中的 [SupplierListMaster.aspx 和 ProductsForSupplierDetails.aspx] 頁面](master-detail-filtering-across-two-pages-vb/_static/image1.png)

<span data-ttu-id="99585-126">**圖 1**： 新增`SupplierListMaster.aspx`和`ProductsForSupplierDetails.aspx`頁面`Filtering`資料夾</span><span class="sxs-lookup"><span data-stu-id="99585-126">**Figure 1**: Add the `SupplierListMaster.aspx` and `ProductsForSupplierDetails.aspx` Pages to the `Filtering` Folder</span></span>


<span data-ttu-id="99585-127">此外，將新頁面加入至專案，請務必更新站台對應檔案`Web.sitemap`分別。</span><span class="sxs-lookup"><span data-stu-id="99585-127">Also, when adding new pages to the project, be sure to update the site map file, `Web.sitemap`, accordingly.</span></span> <span data-ttu-id="99585-128">在此教學課程只是加入`SupplierListMaster.aspx`頁面，即可使用下列 XML 內容，做為篩選的報表的子站台地圖`<siteMapNode>`項目：</span><span class="sxs-lookup"><span data-stu-id="99585-128">For this tutorial simply add the `SupplierListMaster.aspx` page to the site map using the following XML content as a child of the Filtering Reports `<siteMapNode>` element:</span></span>


[!code-xml[Main](master-detail-filtering-across-two-pages-vb/samples/sample1.xml)]

> [!NOTE]
> <span data-ttu-id="99585-129">您可以協助自動更新站台對應檔案時加入新的 ASP.NET 頁面使用的程序[K.Scott Allen](http://odetocode.com/Blogs/scott/)的免費 Visual Studio[站台對應巨集](http://odetocode.com/Blogs/scott/archive/2005/11/29/2537.aspx)。</span><span class="sxs-lookup"><span data-stu-id="99585-129">You can help automate the process of updating the site map file when adding new ASP.NET pages using [K. Scott Allen](http://odetocode.com/Blogs/scott/)'s free Visual Studio [Site Map Macro](http://odetocode.com/Blogs/scott/archive/2005/11/29/2537.aspx).</span></span>


## <a name="step-2-displaying-the-supplier-list-insupplierlistmasteraspx"></a><span data-ttu-id="99585-130">步驟 2： 顯示供應商清單中`SupplierListMaster.aspx`</span><span class="sxs-lookup"><span data-stu-id="99585-130">Step 2: Displaying the Supplier List in`SupplierListMaster.aspx`</span></span>

<span data-ttu-id="99585-131">與`SupplierListMaster.aspx`和`ProductsForSupplierDetails.aspx`建立頁面下, 一步是建立供應商的 GridView `SupplierListMaster.aspx`。</span><span class="sxs-lookup"><span data-stu-id="99585-131">With the `SupplierListMaster.aspx` and `ProductsForSupplierDetails.aspx` pages created, our next step is to create the GridView of suppliers in `SupplierListMaster.aspx`.</span></span> <span data-ttu-id="99585-132">將 GridView 加入頁面和繫結到新 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="99585-132">Add a GridView to the page and bind it to a new ObjectDataSource.</span></span> <span data-ttu-id="99585-133">應該使用這個 ObjectDataSource`SuppliersBLL`類別的`GetSuppliers()`方法來傳回所有供應商。</span><span class="sxs-lookup"><span data-stu-id="99585-133">This ObjectDataSource should use the `SuppliersBLL` class's `GetSuppliers()` method to return all suppliers.</span></span>


<span data-ttu-id="99585-134">[![選取 SuppliersBLL 類別](master-detail-filtering-across-two-pages-vb/_static/image3.png)](master-detail-filtering-across-two-pages-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="99585-134">[![Select the SuppliersBLL Class](master-detail-filtering-across-two-pages-vb/_static/image3.png)](master-detail-filtering-across-two-pages-vb/_static/image2.png)</span></span>

<span data-ttu-id="99585-135">**圖 2**： 選取`SuppliersBLL`類別 ([按一下以檢視完整大小的影像](master-detail-filtering-across-two-pages-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="99585-135">**Figure 2**: Select the `SuppliersBLL` Class ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image4.png))</span></span>


<span data-ttu-id="99585-136">[![設定為使用 GetSuppliers() 方法 ObjectDataSource](master-detail-filtering-across-two-pages-vb/_static/image6.png)](master-detail-filtering-across-two-pages-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="99585-136">[![Configure the ObjectDataSource to Use the GetSuppliers() Method](master-detail-filtering-across-two-pages-vb/_static/image6.png)](master-detail-filtering-across-two-pages-vb/_static/image5.png)</span></span>

<span data-ttu-id="99585-137">**圖 3**： 設定要使用 ObjectDataSource`GetSuppliers()`方法 ([按一下以檢視完整大小的影像](master-detail-filtering-across-two-pages-vb/_static/image7.png))</span><span class="sxs-lookup"><span data-stu-id="99585-137">**Figure 3**: Configure the ObjectDataSource to Use the `GetSuppliers()` Method ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image7.png))</span></span>


<span data-ttu-id="99585-138">我們要包含的連結中標題為檢視產品每個 GridView 資料列，按一下時，將使用者帶至`ProductsForSupplierDetails.aspx`中選取的資料列傳遞`SupplierID`透過查詢字串值。</span><span class="sxs-lookup"><span data-stu-id="99585-138">We need to include a link titled View Products in each GridView row that, when clicked, takes the user to `ProductsForSupplierDetails.aspx` passing in the selected row's `SupplierID` value through the querystring.</span></span> <span data-ttu-id="99585-139">例如，如果使用者按一下東京 Traders 供應商檢視產品連結 (其具有`SupplierID`4 的值)，應傳送至`ProductsForSupplierDetails.aspx?SupplierID=4`。</span><span class="sxs-lookup"><span data-stu-id="99585-139">For example, if user clicks on the View Products link for the Tokyo Traders supplier (which has a `SupplierID` value of 4), they should be sent to `ProductsForSupplierDetails.aspx?SupplierID=4`.</span></span>

<span data-ttu-id="99585-140">若要達成此目的，將[HyperLinkField](https://msdn.microsoft.com/library/system.web.ui.webcontrols.hyperlinkfield.aspx)至 GridView，這樣會將超連結加入每個 GridView 資料列。</span><span class="sxs-lookup"><span data-stu-id="99585-140">To accomplish this, add a [HyperLinkField](https://msdn.microsoft.com/library/system.web.ui.webcontrols.hyperlinkfield.aspx) to the GridView, which adds a hyperlink to each GridView row.</span></span> <span data-ttu-id="99585-141">按一下 編輯資料行中的連結 GridView 的智慧標籤來啟動。</span><span class="sxs-lookup"><span data-stu-id="99585-141">Start by clicking the Edit Columns link from the GridView's smart tag.</span></span> <span data-ttu-id="99585-142">接下來，HyperLinkField 從清單中選取左上方，然後按一下 [加入] 加入 HyperLinkField GridView 的欄位清單中。</span><span class="sxs-lookup"><span data-stu-id="99585-142">Next, select the HyperLinkField from the list in the upper left and click Add to include the HyperLinkField in the GridView's field list.</span></span>


<span data-ttu-id="99585-143">[![在 GridView 中加入 HyperLinkField](master-detail-filtering-across-two-pages-vb/_static/image9.png)](master-detail-filtering-across-two-pages-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="99585-143">[![Add a HyperLinkField to the GridView](master-detail-filtering-across-two-pages-vb/_static/image9.png)](master-detail-filtering-across-two-pages-vb/_static/image8.png)</span></span>

<span data-ttu-id="99585-144">**圖 4**: HyperLinkField 加入 GridView ([按一下以檢視完整大小的影像](master-detail-filtering-across-two-pages-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="99585-144">**Figure 4**: Add a HyperLinkField to the GridView ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image10.png))</span></span>


<span data-ttu-id="99585-145">HyperLinkField 可以設定為使用相同的文字或 URL 值中每個 GridView 資料列中，連結可以將這些值根據繫結至每個特定的資料列的資料值。</span><span class="sxs-lookup"><span data-stu-id="99585-145">The HyperLinkField can be configured to use the same text or URL values the link in each GridView row, or can base these values on the data values bound to each particular row.</span></span> <span data-ttu-id="99585-146">若要指定靜態值跨所有資料列使用 HyperLinkField`Text`或`NavigateUrl`屬性。</span><span class="sxs-lookup"><span data-stu-id="99585-146">To specify a static value across all rows use the HyperLinkField's `Text` or `NavigateUrl` properties.</span></span> <span data-ttu-id="99585-147">由於我們想要使用相同的所有資料列的連結文字時，將設定 HyperLinkField`Text`檢視產品的屬性。</span><span class="sxs-lookup"><span data-stu-id="99585-147">Since we want the link text to be the same for all rows, set the HyperLinkField's `Text` property to View Products.</span></span>


<span data-ttu-id="99585-148">[![將 HyperLinkField 文字屬性設定為檢視產品](master-detail-filtering-across-two-pages-vb/_static/image12.png)](master-detail-filtering-across-two-pages-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="99585-148">[![Set the HyperLinkField's Text Property to View Products](master-detail-filtering-across-two-pages-vb/_static/image12.png)](master-detail-filtering-across-two-pages-vb/_static/image11.png)</span></span>

<span data-ttu-id="99585-149">**圖 5**： 設定 HyperLinkField`Text`屬性來檢視產品 ([按一下以檢視完整大小的影像](master-detail-filtering-across-two-pages-vb/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="99585-149">**Figure 5**: Set the HyperLinkField's `Text` Property to View Products ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image13.png))</span></span>


<span data-ttu-id="99585-150">若要設定的文字或 URL 是依據基礎資料繫結至 GridView 資料列的值，指定資料欄位文字或 URL 值應提取從`DataTextField`或`DataNavigateUrlFields`屬性。</span><span class="sxs-lookup"><span data-stu-id="99585-150">To set the text or URL values to be based on the underlying data bound to the GridView row, specify the data fields the text or URL values should be pulled from in the `DataTextField` or `DataNavigateUrlFields` properties.</span></span> <span data-ttu-id="99585-151">`DataTextField` 只可以設定為單一資料欄位。`DataNavigateUrlFields`，不過，可以設定為以逗號分隔的資料欄位清單。</span><span class="sxs-lookup"><span data-stu-id="99585-151">`DataTextField` can only be set to a single data field; `DataNavigateUrlFields`, however, can be set to a comma-delimited list of data fields.</span></span> <span data-ttu-id="99585-152">我們經常需要基底的文字或目前的資料列資料欄位值和某些 static 標記的組合上的 URL。</span><span class="sxs-lookup"><span data-stu-id="99585-152">We frequently need to base the text or URL on a combination of the current row's data field value and some static markup.</span></span> <span data-ttu-id="99585-153">在本教學課程中，比方說，我們想要 HyperLinkField 連結的 URL `ProductsForSupplierDetails.aspx?SupplierID=supplierID`，其中*`supplierID`* 是每個 GridView 資料列`SupplierID`值。</span><span class="sxs-lookup"><span data-stu-id="99585-153">In this tutorial, for example, we want the URL of the HyperLinkField's links to be `ProductsForSupplierDetails.aspx?SupplierID=supplierID`, where *`supplierID`* is each GridView's row's `SupplierID` value.</span></span> <span data-ttu-id="99585-154">請注意，我們需要這兩個靜態資料導向此處值：`ProductsForSupplierDetails.aspx?SupplierID=`連結 URL 的部分是靜態的而*`supplierID`* 部分是資料導向因為其值是每個資料列的自己`SupplierID`值。</span><span class="sxs-lookup"><span data-stu-id="99585-154">Notice that we need both static and data-driven values here: the `ProductsForSupplierDetails.aspx?SupplierID=` portion of the link's URL is static, whereas the *`supplierID`* portion is data-driven as its value is each row's own `SupplierID` value.</span></span>

<span data-ttu-id="99585-155">若要表示的靜態和資料驅動的值組合，使用`DataTextFormatString`和`DataNavigateUrlFormatString`屬性。</span><span class="sxs-lookup"><span data-stu-id="99585-155">To indicate a combination of static and data-driven values, use the `DataTextFormatString` and `DataNavigateUrlFormatString` properties.</span></span> <span data-ttu-id="99585-156">這些內容中輸入所需的 static 標記，然後使用 標記`{0}`想中指定之欄位的值`DataTextField`或`DataNavigateUrlFields`出現的屬性。</span><span class="sxs-lookup"><span data-stu-id="99585-156">In these properties enter the static markup as needed and then use the marker `{0}` where you want the value of the field specified in the `DataTextField` or `DataNavigateUrlFields` properties to appear.</span></span> <span data-ttu-id="99585-157">如果`DataNavigateUrlFields`屬性有多個欄位指定的使用`{0}`其中您要插入的第一個欄位值`{1}`的第二個欄位的值，依此類推。</span><span class="sxs-lookup"><span data-stu-id="99585-157">If the `DataNavigateUrlFields` property has multiple fields specified use `{0}` where you want the first field value inserted, `{1}` for the second field value, and so on.</span></span>

<span data-ttu-id="99585-158">將此套用至我們的教學課程中，所以我們需要將`DataNavigateUrlFields`屬性`SupplierID`，因為這是資料欄位我們需要自訂針對每個資料列，其值和`DataNavigateUrlFormatString`屬性`ProductsForSupplierDetails.aspx?SupplierID={0}`。</span><span class="sxs-lookup"><span data-stu-id="99585-158">Applying this to our tutorial, we need to set the `DataNavigateUrlFields` property to `SupplierID`, since that's the data field whose value we need to customize on a per-row basis, and the `DataNavigateUrlFormatString` property to `ProductsForSupplierDetails.aspx?SupplierID={0}`.</span></span>


<span data-ttu-id="99585-159">[![設定要包含適當的連結 URL 根據 SupplierID HyperLinkField](master-detail-filtering-across-two-pages-vb/_static/image15.png)](master-detail-filtering-across-two-pages-vb/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="99585-159">[![Configure the HyperLinkField to Include the Proper Link URL Based Upon the SupplierID](master-detail-filtering-across-two-pages-vb/_static/image15.png)](master-detail-filtering-across-two-pages-vb/_static/image14.png)</span></span>

<span data-ttu-id="99585-160">**圖 6**： 設定要包含適當連結 URL 基礎時 HyperLinkField `SupplierID` ([按一下以檢視完整大小的影像](master-detail-filtering-across-two-pages-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="99585-160">**Figure 6**: Configure the HyperLinkField to Include the Proper Link URL Based Upon the `SupplierID` ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image16.png))</span></span>


<span data-ttu-id="99585-161">在新增之後 HyperLinkField，隨意自訂和 GridView 的欄位重新排列。</span><span class="sxs-lookup"><span data-stu-id="99585-161">After adding the HyperLinkField, feel free to customize and reorder the GridView's fields.</span></span> <span data-ttu-id="99585-162">下列標記顯示 GridView 之後我進行的某些次要欄位層級自訂。</span><span class="sxs-lookup"><span data-stu-id="99585-162">The following markup shows the GridView after I've made some minor field-level customizations.</span></span>


[!code-aspx[Main](master-detail-filtering-across-two-pages-vb/samples/sample2.aspx)]

<span data-ttu-id="99585-163">請花一點時間檢視`SupplierListMaster.aspx`透過瀏覽器的頁面。</span><span class="sxs-lookup"><span data-stu-id="99585-163">Take a moment to view the `SupplierListMaster.aspx` page through a browser.</span></span> <span data-ttu-id="99585-164">如圖 7 所示，頁面目前會列出所有供應商包括檢視產品連結。</span><span class="sxs-lookup"><span data-stu-id="99585-164">As Figure 7 shows, the page currently lists all of the suppliers including a View Products link.</span></span> <span data-ttu-id="99585-165">按一下 檢視產品連結將您帶到`ProductsForSupplierDetails.aspx`，並沿著供應商的傳遞`SupplierID`於 querystring 中。</span><span class="sxs-lookup"><span data-stu-id="99585-165">Clicking on the View Products link will take you to `ProductsForSupplierDetails.aspx`, passing along the supplier's `SupplierID` in the querystring.</span></span>


<span data-ttu-id="99585-166">[![每個供應商資料列都包含檢視產品連結](master-detail-filtering-across-two-pages-vb/_static/image18.png)](master-detail-filtering-across-two-pages-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="99585-166">[![Each Supplier Row Contains a View Products Link](master-detail-filtering-across-two-pages-vb/_static/image18.png)](master-detail-filtering-across-two-pages-vb/_static/image17.png)</span></span>

<span data-ttu-id="99585-167">**圖 7**： 每個供應商資料列都包含檢視產品連結 ([按一下以檢視完整大小的影像](master-detail-filtering-across-two-pages-vb/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="99585-167">**Figure 7**: Each Supplier Row Contains a View Products Link ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image19.png))</span></span>


## <a name="step-3-listing-the-suppliers-products-inproductsforsupplierdetailsaspx"></a><span data-ttu-id="99585-168">步驟 3： 列出中的供應商的產品`ProductsForSupplierDetails.aspx`</span><span class="sxs-lookup"><span data-stu-id="99585-168">Step 3: Listing the Supplier's Products in`ProductsForSupplierDetails.aspx`</span></span>

<span data-ttu-id="99585-169">此時`SupplierListMaster.aspx`頁面傳送使用者`ProductsForSupplierDetails.aspx`，傳遞所選的供應商`SupplierID`於 querystring 中。</span><span class="sxs-lookup"><span data-stu-id="99585-169">At this point the `SupplierListMaster.aspx` page is sending users to `ProductsForSupplierDetails.aspx`, passing the selected supplier's `SupplierID` in the querystring.</span></span> <span data-ttu-id="99585-170">本教學課程的最後一個步驟是在 GridView 中顯示的產品`ProductsForSupplierDetails.aspx`其`SupplierID`等於`SupplierID`傳遞查詢字串。</span><span class="sxs-lookup"><span data-stu-id="99585-170">The tutorial's final step is to display the products in a GridView in `ProductsForSupplierDetails.aspx` whose `SupplierID` equals the `SupplierID` passed in through the querystring.</span></span> <span data-ttu-id="99585-171">若要將新增至的 GridView 來完成這個入門`ProductsForSupplierDetails.aspx`頁面上，使用新的 ObjectDataSource 控制項，名為`ProductsBySupplierDataSource`會叫用`GetProductsBySupplierID(supplierID)`方法從`ProductsBLL`類別。</span><span class="sxs-lookup"><span data-stu-id="99585-171">To accomplish this start by adding a GridView to the `ProductsForSupplierDetails.aspx` page, using a new ObjectDataSource control named `ProductsBySupplierDataSource` that invokes the `GetProductsBySupplierID(supplierID)` method from the `ProductsBLL` class.</span></span>


<span data-ttu-id="99585-172">[![加入名為 ProductsBySupplierDataSource 新 ObjectDataSource](master-detail-filtering-across-two-pages-vb/_static/image21.png)](master-detail-filtering-across-two-pages-vb/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="99585-172">[![Add a New ObjectDataSource Named ProductsBySupplierDataSource](master-detail-filtering-across-two-pages-vb/_static/image21.png)](master-detail-filtering-across-two-pages-vb/_static/image20.png)</span></span>

<span data-ttu-id="99585-173">**圖 8**： 加入新的 ObjectDataSource 名為`ProductsBySupplierDataSource`([按一下以檢視完整大小的影像](master-detail-filtering-across-two-pages-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="99585-173">**Figure 8**: Add a New ObjectDataSource Named `ProductsBySupplierDataSource` ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image22.png))</span></span>


<span data-ttu-id="99585-174">[![選取 ProductsBLL 類別](master-detail-filtering-across-two-pages-vb/_static/image24.png)](master-detail-filtering-across-two-pages-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="99585-174">[![Select the ProductsBLL Class](master-detail-filtering-across-two-pages-vb/_static/image24.png)](master-detail-filtering-across-two-pages-vb/_static/image23.png)</span></span>

<span data-ttu-id="99585-175">**圖 9**： 選取`ProductsBLL`類別 ([按一下以檢視完整大小的影像](master-detail-filtering-across-two-pages-vb/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="99585-175">**Figure 9**: Select the `ProductsBLL` Class ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image25.png))</span></span>


<span data-ttu-id="99585-176">[![已叫用 GetProductsBySupplierID(supplierID) 方法 ObjectDataSource](master-detail-filtering-across-two-pages-vb/_static/image27.png)](master-detail-filtering-across-two-pages-vb/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="99585-176">[![Have the ObjectDataSource Invoke the GetProductsBySupplierID(supplierID) Method](master-detail-filtering-across-two-pages-vb/_static/image27.png)](master-detail-filtering-across-two-pages-vb/_static/image26.png)</span></span>

<span data-ttu-id="99585-177">**圖 10**： 有 ObjectDataSource 叫用`GetProductsBySupplierID(supplierID)`方法 ([按一下以檢視完整大小的影像](master-detail-filtering-across-two-pages-vb/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="99585-177">**Figure 10**: Have the ObjectDataSource Invoke the `GetProductsBySupplierID(supplierID)` Method ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image28.png))</span></span>


<span data-ttu-id="99585-178">設定資料來源精靈的最後一個步驟會要求我們提供的來源`GetProductsBySupplierID(supplierID)`方法的*`supplierID`* 參數。</span><span class="sxs-lookup"><span data-stu-id="99585-178">The final step of the Configure Data Source wizard asks us to provide the source of the `GetProductsBySupplierID(supplierID)` method's *`supplierID`* parameter.</span></span> <span data-ttu-id="99585-179">若要使用的查詢字串值，設 QueryString 參數來源，然後輸入要用於 QueryStringField 文字方塊 querystring 值的名稱 (`SupplierID`)。</span><span class="sxs-lookup"><span data-stu-id="99585-179">To use the querystring value, set the Parameter source to QueryString and enter the name of the querystring value to use in the QueryStringField textbox (`SupplierID`).</span></span>


<span data-ttu-id="99585-180">[![填入 supplierID SupplierID Querystring 值的參數值](master-detail-filtering-across-two-pages-vb/_static/image30.png)](master-detail-filtering-across-two-pages-vb/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="99585-180">[![Populate the supplierID Parameter Value from the SupplierID Querystring Value](master-detail-filtering-across-two-pages-vb/_static/image30.png)](master-detail-filtering-across-two-pages-vb/_static/image29.png)</span></span>

<span data-ttu-id="99585-181">**圖 11**： 填入*`supplierID`* 參數值從`SupplierID`Querystring 值 ([按一下以檢視完整大小的影像](master-detail-filtering-across-two-pages-vb/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="99585-181">**Figure 11**: Populate the *`supplierID`* Parameter Value from the `SupplierID` Querystring Value ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image31.png))</span></span>


<span data-ttu-id="99585-182">這就是這麼簡單 ！</span><span class="sxs-lookup"><span data-stu-id="99585-182">That's all there is to it!</span></span> <span data-ttu-id="99585-183">圖 12 顯示`ProductsForSupplierDetails.aspx`頁面上，當從東京 Traders 連結，即可瀏覽`SupplierListMaster.aspx`。</span><span class="sxs-lookup"><span data-stu-id="99585-183">Figure 12 shows the `ProductsForSupplierDetails.aspx` page when visited by clicking the Tokyo Traders link from `SupplierListMaster.aspx`.</span></span>


<span data-ttu-id="99585-184">[![東京 Traders 所提供的產品會顯示](master-detail-filtering-across-two-pages-vb/_static/image33.png)](master-detail-filtering-across-two-pages-vb/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="99585-184">[![The Products Supplied by Tokyo Traders are Shown](master-detail-filtering-across-two-pages-vb/_static/image33.png)](master-detail-filtering-across-two-pages-vb/_static/image32.png)</span></span>

<span data-ttu-id="99585-185">**圖 12**: 產品所提供的東京 Traders 會顯示 ([按一下以檢視完整大小的影像](master-detail-filtering-across-two-pages-vb/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="99585-185">**Figure 12**: The Products Supplied by Tokyo Traders are Shown ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image34.png))</span></span>


## <a name="displaying-supplier-information-inproductsforsupplierdetailsaspx"></a><span data-ttu-id="99585-186">顯示中的供應商資訊`ProductsForSupplierDetails.aspx`</span><span class="sxs-lookup"><span data-stu-id="99585-186">Displaying Supplier Information in`ProductsForSupplierDetails.aspx`</span></span>

<span data-ttu-id="99585-187">如圖 12 所示，`ProductsForSupplierDetails.aspx`頁面只會列出所提供的產品`SupplierID`於 querystring 中指定。</span><span class="sxs-lookup"><span data-stu-id="99585-187">As Figure 12 shows, the `ProductsForSupplierDetails.aspx` page simply lists the products that are supplied by the `SupplierID` specified in the querystring.</span></span> <span data-ttu-id="99585-188">有人直接傳送至這個頁面上，不過，就不知道圖 12 顯示東京 Traders' 產品。</span><span class="sxs-lookup"><span data-stu-id="99585-188">Someone sent directly to this page, however, would not know that Figure 12 is showing Tokyo Traders' products.</span></span> <span data-ttu-id="99585-189">若要補救這個我們可以在這個頁面也顯示供應商資訊。</span><span class="sxs-lookup"><span data-stu-id="99585-189">To remedy this we can display supplier information in this page as well.</span></span>

<span data-ttu-id="99585-190">將上述產品 GridView FormView 來開始。</span><span class="sxs-lookup"><span data-stu-id="99585-190">Start by adding a FormView above the products GridView.</span></span> <span data-ttu-id="99585-191">建立新的 ObjectDataSource 控制項，名為`SuppliersDataSource`會叫用`SuppliersBLL`類別的`GetSupplierBySupplierID(supplierID)`方法。</span><span class="sxs-lookup"><span data-stu-id="99585-191">Create a new ObjectDataSource control named `SuppliersDataSource` that invokes the `SuppliersBLL` class's `GetSupplierBySupplierID(supplierID)` method.</span></span>


<span data-ttu-id="99585-192">[![選取 SuppliersBLL 類別](master-detail-filtering-across-two-pages-vb/_static/image36.png)](master-detail-filtering-across-two-pages-vb/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="99585-192">[![Select the SuppliersBLL Class](master-detail-filtering-across-two-pages-vb/_static/image36.png)](master-detail-filtering-across-two-pages-vb/_static/image35.png)</span></span>

<span data-ttu-id="99585-193">**圖 13**： 選取`SuppliersBLL`類別 ([按一下以檢視完整大小的影像](master-detail-filtering-across-two-pages-vb/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="99585-193">**Figure 13**: Select the `SuppliersBLL` Class ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image37.png))</span></span>


<span data-ttu-id="99585-194">[![已叫用 GetSupplierBySupplierID(supplierID) 方法 ObjectDataSource](master-detail-filtering-across-two-pages-vb/_static/image39.png)](master-detail-filtering-across-two-pages-vb/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="99585-194">[![Have the ObjectDataSource Invoke the GetSupplierBySupplierID(supplierID) Method](master-detail-filtering-across-two-pages-vb/_static/image39.png)](master-detail-filtering-across-two-pages-vb/_static/image38.png)</span></span>

<span data-ttu-id="99585-195">**圖 14**： 有 ObjectDataSource 叫用`GetSupplierBySupplierID(supplierID)`方法 ([按一下以檢視完整大小的影像](master-detail-filtering-across-two-pages-vb/_static/image40.png))</span><span class="sxs-lookup"><span data-stu-id="99585-195">**Figure 14**: Have the ObjectDataSource Invoke the `GetSupplierBySupplierID(supplierID)` Method ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image40.png))</span></span>


<span data-ttu-id="99585-196">如同`ProductsBySupplierDataSource`，有*`supplierID`* 參數的值指派給`SupplierID`querystring 值。</span><span class="sxs-lookup"><span data-stu-id="99585-196">As with the `ProductsBySupplierDataSource`, have the *`supplierID`* parameter assigned the value of the `SupplierID` querystring value.</span></span>


<span data-ttu-id="99585-197">[![填入 supplierID SupplierID Querystring 值的參數值](master-detail-filtering-across-two-pages-vb/_static/image42.png)](master-detail-filtering-across-two-pages-vb/_static/image41.png)</span><span class="sxs-lookup"><span data-stu-id="99585-197">[![Populate the supplierID Parameter Value from the SupplierID Querystring Value](master-detail-filtering-across-two-pages-vb/_static/image42.png)](master-detail-filtering-across-two-pages-vb/_static/image41.png)</span></span>

<span data-ttu-id="99585-198">**圖 15**： 填入*`supplierID`* 參數值從`SupplierID`Querystring 值 ([按一下以檢視完整大小的影像](master-detail-filtering-across-two-pages-vb/_static/image43.png))</span><span class="sxs-lookup"><span data-stu-id="99585-198">**Figure 15**: Populate the *`supplierID`* Parameter Value from the `SupplierID` Querystring Value ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image43.png))</span></span>


<span data-ttu-id="99585-199">當繫結 [設計] 檢視中 ObjectDataSource FormView，Visual Studio 會自動建立在 FormView 的`ItemTemplate`， `InsertItemTemplate`，和`EditItemTemplate`與每個傳回的資料欄位的標籤和文字方塊中的 Web 控制項ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="99585-199">When binding the FormView to the ObjectDataSource in the Design view, Visual Studio will automatically create the FormView's `ItemTemplate`, `InsertItemTemplate`, and `EditItemTemplate` with Label and TextBox Web controls for each of the data fields returned by the ObjectDataSource.</span></span> <span data-ttu-id="99585-200">因為我們只是想要顯示供應商資訊逕行移除`InsertItemTemplate`和`EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="99585-200">Since we just want to display supplier information feel free to remove the `InsertItemTemplate` and `EditItemTemplate`.</span></span> <span data-ttu-id="99585-201">接下來，使其顯示中的供應商的公司名稱，編輯 ItemTemplate`<h3>`項目、 地址、 縣 （市）、 國家/地區，以及公司名稱下方的電話號碼。</span><span class="sxs-lookup"><span data-stu-id="99585-201">Next, edit the ItemTemplate so that it displays the supplier's company name in an `<h3>` element and the address, city, country, and phone number beneath the company name.</span></span> <span data-ttu-id="99585-202">或者，您可以手動設定在 FormView 的`DataSourceID`並建立`ItemTemplate`標記，如同回"[顯示資料與 ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-cs.md)」 教學課程。</span><span class="sxs-lookup"><span data-stu-id="99585-202">Alternatively, you can manually set the FormView's `DataSourceID` and create the `ItemTemplate` markup, as we did back in the "[Displaying Data With the ObjectDataSource](../basic-reporting/displaying-data-with-the-objectdatasource-cs.md)" tutorial.</span></span>

<span data-ttu-id="99585-203">這些編輯之後在 FormView 的宣告式標記看起來應該如下所示：</span><span class="sxs-lookup"><span data-stu-id="99585-203">After these edits the FormView's declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](master-detail-filtering-across-two-pages-vb/samples/sample3.aspx)]

<span data-ttu-id="99585-204">圖 16 顯示的螢幕擷取畫面`ProductsForSupplierDetails.aspx`頁面之後以上詳述的供應商資訊已包含在內。</span><span class="sxs-lookup"><span data-stu-id="99585-204">Figure 16 shows a screen shot of the `ProductsForSupplierDetails.aspx` page after the supplier information detailed above has been included.</span></span>


<span data-ttu-id="99585-205">[![產品的清單包含有關供應商的摘要](master-detail-filtering-across-two-pages-vb/_static/image45.png)](master-detail-filtering-across-two-pages-vb/_static/image44.png)</span><span class="sxs-lookup"><span data-stu-id="99585-205">[![The List of Products Includes a Summary About the Supplier](master-detail-filtering-across-two-pages-vb/_static/image45.png)](master-detail-filtering-across-two-pages-vb/_static/image44.png)</span></span>

<span data-ttu-id="99585-206">**圖 16**： 產品的清單包含摘要的相關供應商 ([按一下以檢視完整大小的影像](master-detail-filtering-across-two-pages-vb/_static/image46.png))</span><span class="sxs-lookup"><span data-stu-id="99585-206">**Figure 16**: The List of Products Includes a Summary About the Supplier ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image46.png))</span></span>


## <a name="applying-the-final-touches-for-theproductsforsupplierdetailsaspxui"></a><span data-ttu-id="99585-207">套用最終碰觸的`ProductsForSupplierDetails.aspx`UI</span><span class="sxs-lookup"><span data-stu-id="99585-207">Applying the Final Touches for the`ProductsForSupplierDetails.aspx`UI</span></span>

<span data-ttu-id="99585-208">若要改善使用者體驗有這份報表都是幾個新增項目，我們應該要對`ProductsForSupplierDetails.aspx`頁面。</span><span class="sxs-lookup"><span data-stu-id="99585-208">To improve the user experience for this report there are a couple of additions we ought to make to the `ProductsForSupplierDetails.aspx` page.</span></span> <span data-ttu-id="99585-209">目前的使用者可以前往從的唯一方式`ProductsForSupplierDetails.aspx`頁面回傳至供應商的清單，是按一下其瀏覽器的上一頁按鈕。</span><span class="sxs-lookup"><span data-stu-id="99585-209">Currently the only way a user can go from the `ProductsForSupplierDetails.aspx` page back to the list of suppliers is to click their browser's back button.</span></span> <span data-ttu-id="99585-210">讓我們將超連結控制項加入`ProductsForSupplierDetails.aspx`頁面連結回`SupplierListMaster.aspx`，提供使用者返回主清單的另一種方法。</span><span class="sxs-lookup"><span data-stu-id="99585-210">Let's add a HyperLink control to the `ProductsForSupplierDetails.aspx` page that links back to `SupplierListMaster.aspx`, providing another way for the user to return to the master list.</span></span>


<span data-ttu-id="99585-211">[![將超連結控制項加入使用者拿到 SupplierListMaster.aspx](master-detail-filtering-across-two-pages-vb/_static/image48.png)](master-detail-filtering-across-two-pages-vb/_static/image47.png)</span><span class="sxs-lookup"><span data-stu-id="99585-211">[![Add a HyperLink Control to Take the User Back to SupplierListMaster.aspx](master-detail-filtering-across-two-pages-vb/_static/image48.png)](master-detail-filtering-across-two-pages-vb/_static/image47.png)</span></span>

<span data-ttu-id="99585-212">**圖 17**： 將超連結控制項加入使用者回到採取`SupplierListMaster.aspx`([按一下以檢視完整大小的影像](master-detail-filtering-across-two-pages-vb/_static/image49.png))</span><span class="sxs-lookup"><span data-stu-id="99585-212">**Figure 17**: Add a HyperLink Control to Take the User Back to `SupplierListMaster.aspx` ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image49.png))</span></span>


<span data-ttu-id="99585-213">如果使用者在沒有任何產品，供應商的檢視產品連結`ProductsBySupplierDataSource`在 ObjectDataSource`ProductsForSupplierDetails.aspx`不會傳回任何結果。</span><span class="sxs-lookup"><span data-stu-id="99585-213">If the user clicks on the View Products link for a supplier that doesn't have any products, the `ProductsBySupplierDataSource` ObjectDataSource in `ProductsForSupplierDetails.aspx` won't return any results.</span></span> <span data-ttu-id="99585-214">繫結至 ObjectDataSource GridView 不會呈現任何使用者的瀏覽器中的頁面上的空白區域中所產生的標記。</span><span class="sxs-lookup"><span data-stu-id="99585-214">The GridView bound to the ObjectDataSource won't render any markup resulting in a blank region on the page in the user's browser.</span></span> <span data-ttu-id="99585-215">若要更清楚地與使用者通訊有任何選取的供應商相關聯的產品中，我們可以設定 GridView 的`EmptyDataText`我們想要在這種情況時所顯示的訊息屬性。</span><span class="sxs-lookup"><span data-stu-id="99585-215">To more clearly communicate to the user that there are no products associated with the selected supplier we can set the GridView's `EmptyDataText` property to the message we want displayed when such a situation arises.</span></span> <span data-ttu-id="99585-216">我已設定此屬性為"There are 沒有該供應商所提供的產品"</span><span class="sxs-lookup"><span data-stu-id="99585-216">I've set this property to "There are no products provided by this supplier�"</span></span>

<span data-ttu-id="99585-217">根據預設，Northwinds 資料庫中的所有供應商提供至少一個產品。</span><span class="sxs-lookup"><span data-stu-id="99585-217">By default, all suppliers in the Northwinds database provide at least one product.</span></span> <span data-ttu-id="99585-218">不過，在此教學課程我手動修改了`Products`資料表，以便讓供應商 Escargots Nouveaux 已不再與任何產品相關聯。</span><span class="sxs-lookup"><span data-stu-id="99585-218">However, for this tutorial I've manually modified the `Products` table so that the supplier Escargots Nouveaux is no longer associated with any products.</span></span> <span data-ttu-id="99585-219">圖 18 在進行這項變更之後，會顯示 Escargots Nouveaux 的詳細資料頁面。</span><span class="sxs-lookup"><span data-stu-id="99585-219">Figure 18 shows the details page for Escargots Nouveaux after this change has been made.</span></span>


<span data-ttu-id="99585-220">[![使用者會接到通知供應商不會提供任何產品](master-detail-filtering-across-two-pages-vb/_static/image51.png)](master-detail-filtering-across-two-pages-vb/_static/image50.png)</span><span class="sxs-lookup"><span data-stu-id="99585-220">[![Users are Informed that the Supplier Doesn't Provide Any Products](master-detail-filtering-across-two-pages-vb/_static/image51.png)](master-detail-filtering-across-two-pages-vb/_static/image50.png)</span></span>

<span data-ttu-id="99585-221">**圖 18**： 供應商不會提供任何產品通知使用者 ([按一下以檢視完整大小的影像](master-detail-filtering-across-two-pages-vb/_static/image52.png))</span><span class="sxs-lookup"><span data-stu-id="99585-221">**Figure 18**: Users are Informed that the Supplier Doesn't Provide Any Products ([Click to view full-size image](master-detail-filtering-across-two-pages-vb/_static/image52.png))</span></span>


## <a name="summary"></a><span data-ttu-id="99585-222">總結</span><span class="sxs-lookup"><span data-stu-id="99585-222">Summary</span></span>

<span data-ttu-id="99585-223">雖然主要/詳細資料報表可以在單一頁面上會顯示主要和詳細記錄，在許多網站會分隔跨兩個網頁。</span><span class="sxs-lookup"><span data-stu-id="99585-223">While master/detail reports can display both the master and detail records on a single page, in many websites they are separated out across two web pages.</span></span> <span data-ttu-id="99585-224">在此教學課程中我們討論了如何實作主要/詳細資料報表需要 「 主要 」 的網頁中的 GridView 中列出供應商 和 詳細資料 頁面中所列的相關聯的產品。</span><span class="sxs-lookup"><span data-stu-id="99585-224">In this tutorial we looked at how to implement such a master/detail report by having the suppliers listed in a GridView in the "master" web page and the associated products listed in the "details" page.</span></span> <span data-ttu-id="99585-225">主版網頁中的每個供應商資料列所包含的資料列所傳遞的詳細資料頁面的連結`SupplierID`值。</span><span class="sxs-lookup"><span data-stu-id="99585-225">Each supplier row in the master web page contained a link to the details page that passed along the row's `SupplierID` value.</span></span> <span data-ttu-id="99585-226">這類特定資料列的連結可以輕鬆地加入使用 GridView HyperLinkField。</span><span class="sxs-lookup"><span data-stu-id="99585-226">Such row-specific links can be easily added using the GridView's HyperLinkField.</span></span>

<span data-ttu-id="99585-227">藉由叫用已完成的詳細資料頁面擷取指定的供應商的那些產品`ProductsBLL`類別的`GetProductsBySupplierID(supplierID)`方法。</span><span class="sxs-lookup"><span data-stu-id="99585-227">In the details page retrieving those products for the specified supplier was accomplished by invoking the `ProductsBLL` class's `GetProductsBySupplierID(supplierID)` method.</span></span> <span data-ttu-id="99585-228">*`supplierID`* 做為參數的來源使用查詢字串以宣告方式指定參數值。</span><span class="sxs-lookup"><span data-stu-id="99585-228">The *`supplierID`* parameter value was specified declaratively using the querystring as the parameter source.</span></span> <span data-ttu-id="99585-229">我們也討論了如何使用程式設計的詳細資料頁面中顯示的供應商的詳細資料。</span><span class="sxs-lookup"><span data-stu-id="99585-229">We also looked at how to display the supplier details in the details page using a FormView.</span></span>

<span data-ttu-id="99585-230">我們[下一個教學課程](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb.md)是主要/詳細資料報表中的最後一個。</span><span class="sxs-lookup"><span data-stu-id="99585-230">Our [next tutorial](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb.md) is the final one on master/detail reports.</span></span> <span data-ttu-id="99585-231">我們會探討如何在每個資料列之選取按鈕的 GridView 中顯示的產品清單。</span><span class="sxs-lookup"><span data-stu-id="99585-231">We'll look at how to display a list of products in a GridView where each row has a Select button.</span></span> <span data-ttu-id="99585-232">按一下 [選取] 按鈕會在相同頁面上 DetailsView 控制項中顯示該產品的詳細資料。</span><span class="sxs-lookup"><span data-stu-id="99585-232">Clicking on the Select button will display that product's details in a DetailsView control on the same page.</span></span>

<span data-ttu-id="99585-233">祝您程式設計 ！</span><span class="sxs-lookup"><span data-stu-id="99585-233">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="99585-234">關於作者</span><span class="sxs-lookup"><span data-stu-id="99585-234">About the Author</span></span>

<span data-ttu-id="99585-235">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，作者的七個 ASP/ASP.NET 書籍和的創辦[4GuysFromRolla.com](http://www.4guysfromrolla.com)，已從 1998 年使用 Microsoft Web 技術。</span><span class="sxs-lookup"><span data-stu-id="99585-235">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="99585-236">Scott 可做為獨立顧問、 訓練和寫入器。</span><span class="sxs-lookup"><span data-stu-id="99585-236">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="99585-237">他最新的活頁簿[ *Sam 教導您自己 ASP.NET 2.0 24 小時內*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="99585-237">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="99585-238">他可以在達到[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)或透過他的部落格，這可以在找到[ http://ScottOnWriting.NET ](http://ScottOnWriting.NET)。</span><span class="sxs-lookup"><span data-stu-id="99585-238">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="99585-239">特別感謝</span><span class="sxs-lookup"><span data-stu-id="99585-239">Special Thanks To</span></span>

<span data-ttu-id="99585-240">許多有用的檢閱者已檢閱本教學課程系列。</span><span class="sxs-lookup"><span data-stu-id="99585-240">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="99585-241">在此教學課程的前導檢閱者已 Hilton Giesenow。</span><span class="sxs-lookup"><span data-stu-id="99585-241">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="99585-242">檢閱我即將推出的 MSDN 文件有興趣嗎？</span><span class="sxs-lookup"><span data-stu-id="99585-242">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="99585-243">如果是這樣，卸除我一行[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="99585-243">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="99585-244">[上一頁](master-detail-filtering-with-two-dropdownlists-vb.md)
> [下一頁](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb.md)</span><span class="sxs-lookup"><span data-stu-id="99585-244">[Previous](master-detail-filtering-with-two-dropdownlists-vb.md)
[Next](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-vb.md)</span></span>
